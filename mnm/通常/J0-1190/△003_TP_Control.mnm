DEVICE:128
;MODULE:△003_TP_Control
;MODULE_TYPE:0
;SCRIPT_TYPE:
;<h1/>画面遷移
LD CR2008                ; 運転開始時1ｽｷｬﾝON
OR M1216                 ; Unit1_自動動作中
ORP M103                 ; 自動ﾓｰﾄﾞ選択
AND<> W08 K1             ; TP_切替ページNo.
DW K1 W08                ; TP_切替ページNo.
LDP M104                 ; 手動ﾓｰﾄﾞ選択
AND<> W08 K11            ; TP_切替ページNo.
DW K11 W08               ; TP_切替ページNo.
;<h1/>メイン画面
;<h1/>├車種信号
LD T22                   ; 車種信号1
MOV K1 D1010             ; TP_現在品種No.
LD T23                   ; 車種信号2
MOV K2 D1010             ; TP_現在品種No.
LD T24                   ; 車種信号4
MOV K4 D1010             ; TP_現在品種No.
LD T25                   ; 車種信号6
MOV K6 D1010             ; TP_現在品種No.
LDB T22                  ; 車種信号1
ANB T23                  ; 車種信号2
ANB T24                  ; 車種信号4
ANB T25                  ; 車種信号6
MOV K0 D1010             ; TP_現在品種No.
;<h1/>├検査ﾌﾟﾛｾｽ表示
LD M100                  ; 自動運転中
ANB B129A                ; TP補助_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OR M110                  ; 異常ﾘｾｯﾄﾊﾟﾙｽ
OR M1275                 ; Unit1_自動_ﾜｰｸｸﾗﾝﾌﾟｷｬﾝｾﾙ
OUT B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
LD B128A                 ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OR B129A                 ; TP補助_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
AND M100                 ; 自動運転中
OUT B129A                ; TP補助_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
LD M100                  ; 自動運転中
OR B1280                 ; TPﾒｲﾝ_開始LP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1280                ; TPﾒｲﾝ_開始LP
LD M1230                 ; Unit1_自動_ﾜｰｸｸﾗﾝﾌﾟ中
OR B128F                 ; TP補助_ﾜｰｸｸﾗﾝﾌﾟLP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B128F                ; TP補助_ﾜｰｸｸﾗﾝﾌﾟLP
LD B128F                 ; TP補助_ﾜｰｸｸﾗﾝﾌﾟLP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1230                ; Unit1_自動_ﾜｰｸｸﾗﾝﾌﾟ中
ANL
OUT B127F                ; TPﾒｲﾝ_ﾜｰｸｸﾗﾝﾌﾟLP
LD M1231                 ; Unit1_自動_FLC動作確認中
OR B1291                 ; TP補助_ﾌﾛｰﾄﾚｽｽｲｯﾁ動作確認LP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1291                ; TP補助_ﾌﾛｰﾄﾚｽｽｲｯﾁ動作確認LP
LD B1291                 ; TP補助_ﾌﾛｰﾄﾚｽｽｲｯﾁ動作確認LP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1231                ; Unit1_自動_FLC動作確認中
ANL
OUT B1281                ; TPﾒｲﾝ_ﾌﾛｰﾄﾚｽｽｲｯﾁ動作確認LP
LD M1232                 ; Unit1_自動_ｸﾘｱﾗﾝｽ検査実行中
OR B1292                 ; TP補助_ｸﾘｱﾗﾝｽ検査LP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1292                ; TP補助_ｸﾘｱﾗﾝｽ検査LP
LD B1292                 ; TP補助_ｸﾘｱﾗﾝｽ検査LP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1232                ; Unit1_自動_ｸﾘｱﾗﾝｽ検査実行中
ANL
OUT B1282                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査LP
LD M1233                 ; Unit1_自動_幅計測実行中
OR B1293                 ; TP補助_幅計測LP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1293                ; TP補助_幅計測LP
LD B1293                 ; TP補助_幅計測LP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1233                ; Unit1_自動_幅計測実行中
ANL
OUT B1283                ; TPﾒｲﾝ_幅計測LP
LD M1234                 ; Unit1_自動_ﾏｰｷﾝｸﾞ実行中
OR B1294                 ; TP補助_ﾏｰｷﾝｸﾞLP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1294                ; TP補助_ﾏｰｷﾝｸﾞLP
LD B1294                 ; TP補助_ﾏｰｷﾝｸﾞLP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1234                ; Unit1_自動_ﾏｰｷﾝｸﾞ実行中
ANL
OUT B1284                ; TPﾒｲﾝ_ﾏｰｷﾝｸﾞLP
LD M1235                 ; Unit1_自動_ｸﾞﾘｽ吐出実行中
OR B1295                 ; TP補助_ｸﾞﾘｽ吐出LP
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1295                ; TP補助_ｸﾞﾘｽ吐出LP
LD B1295                 ; TP補助_ｸﾞﾘｽ吐出LP
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1235                ; Unit1_自動_ｸﾞﾘｽ吐出実行中
ANL
OUT B1285                ; TPﾒｲﾝ_ｸﾞﾘｽ吐出LP
LD M1236                 ; Unit1_自動_ｸﾗﾝﾌﾟ解除中
OR B1296                 ; TP補助_完了
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1296                ; TP補助_完了
LD B1296                 ; TP補助_完了
LD CR2006                ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB M1236                ; Unit1_自動_ｸﾗﾝﾌﾟ解除中
ANL
OUT B1286                ; TPﾒｲﾝ_完了LP
LD M1238                 ; Unit1_自動_ｸﾞﾘｽへら通過確認完了
OR B1287                 ; TPﾒｲﾝ_ｸﾞﾘｽへら通過確認
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1287                ; TPﾒｲﾝ_ｸﾞﾘｽへら通過確認
LD M1239                 ; Unit1_自動_ﾜｰｸ取り外し確認完了
OR B1288                 ; TPﾒｲﾝ_ﾜｰｸ取り外し確認
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1288                ; TPﾒｲﾝ_ﾜｰｸ取り外し確認
;<h1/>├総合判定
LD M1271                 ; Unit1_ｸﾘｱﾗﾝｽ検査NG
OR M1273                 ; Unit1_幅計測NG
OR B1275                 ; TPﾒｲﾝ_総合判定NG
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1275                ; TPﾒｲﾝ_総合判定NG
LD M1270                 ; Unit1_ｸﾘｱﾗﾝｽ検査OK
AND M1272                ; Unit1_幅計測OK
OR B1276                 ; TPﾒｲﾝ_総合判定OK
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1276                ; TPﾒｲﾝ_総合判定OK
LDB B1275                ; TPﾒｲﾝ_総合判定NG
ANB B1276                ; TPﾒｲﾝ_総合判定OK
OUT B1274                ; TPﾒｲﾝ_総合判定ﾃﾞｰﾀなし
;<h1/>├ｸﾘｱﾗﾝｽ検査判定
LD M1271                 ; Unit1_ｸﾘｱﾗﾝｽ検査NG
OR B1278                 ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査NG
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1278                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査NG
LD M1270                 ; Unit1_ｸﾘｱﾗﾝｽ検査OK
OR B1279                 ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査OK
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B1279                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査OK
LDB B1278                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査NG
ANB B1279                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査OK
OUT B1277                ; TPﾒｲﾝ_ｸﾘｱﾗﾝｽ検査ﾃﾞｰﾀなし
;<h1/>├幅計測判定
LD M1273                 ; Unit1_幅計測NG
OR B127B                 ; TPﾒｲﾝ_幅計測NG
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B127B                ; TPﾒｲﾝ_幅計測NG
LD M1272                 ; Unit1_幅計測OK
OR B127C                 ; TPﾒｲﾝ_幅計測OK
ANB B128A                ; TPﾒｲﾝ_ﾌﾟﾛｾｽ表示LPﾘｾｯﾄ
OUT B127C                ; TPﾒｲﾝ_幅計測OK
LDB B127B                ; TPﾒｲﾝ_幅計測NG
ANB B127C                ; TPﾒｲﾝ_幅計測OK
OUT B127A                ; TPﾒｲﾝ_幅計測ﾃﾞｰﾀなし
;<h1/>├言語設定ランプ
;日本語
LD B1220                 ; TP_言語設定SW_日本語
LD CR2008                ; 運転開始時1ｽｷｬﾝON
AND= K0 D2524            ; 言語設定
ORL
OR B122A                 ; TP_言語設定LP_日本語
ANB B1221                ; TP_言語設定SW_英語
ANB B1222                ; TP_言語設定SW_言語3
OUT B122A                ; TP_言語設定LP_日本語
LDP B1220                ; TP_言語設定SW_日本語
MOV K0 D2524             ; 言語設定
;英語
LD B1221                 ; TP_言語設定SW_英語
LD CR2008                ; 運転開始時1ｽｷｬﾝON
AND= K1 D2524            ; 言語設定
ORL
OR B122B                 ; TP_言語設定LP_英語
ANB B1220                ; TP_言語設定SW_日本語
ANB B1222                ; TP_言語設定SW_言語3
OUT B122B                ; TP_言語設定LP_英語
LDP B1221                ; TP_言語設定SW_英語
MOV K1 D2524             ; 言語設定
;言語3
LD B1222                 ; TP_言語設定SW_言語3
LD CR2008                ; 運転開始時1ｽｷｬﾝON
AND<> D2524 K0           ; 言語設定
AND<> D2524 K1           ; 言語設定
ORL
OR B122C                 ; TP_言語設定LP_言語3
ANB B1220                ; TP_言語設定SW_日本語
ANB B1221                ; TP_言語設定SW_英語
OUT B122C                ; TP_言語設定LP_言語3
LDP B1222                ; TP_言語設定SW_言語3
MOV K2 D2524             ; 言語設定
;<h1/>IOモニタ画面制御
;タブ制御
;D1001 = W0 / 10 * 10
;W8 = D1000 + D1001
;
;
LD B1008                 ; TabSW
NCJ K1000
;D1001 = W0 / 10 * 10
;
LD CR2002                ; 常時ON
LDA W00                  ; TP_表示中ページNo.
CON
EXT
CON
EXT.L
CON
DIV.L +10
CON
MUL.L +10
CON
STA D1001                ; ﾀﾌﾞ_画面切替
;W8 = D1000 + D1001
;
LD CR2002                ; 常時ON
LDA D1001                ; ﾀﾌﾞ_画面切替
CON
EXT
CON
STA.L @VM0
CON
LDA D1000                ; 手動Tab
CON
EXT
CON
ADD.L @VM0
CON
STA W08                  ; TP_切替ページNo.
LABEL K1000
;
;<h1/>ﾌﾞｻﾞｰ
LD M105                  ; 異常発生
ANB B129B                ; TP補助_ﾌﾞｻﾞｰ停止
OR Y59                   ; ﾌﾞｻﾞｰ
ANB B1006                ; ﾌﾞｻﾞｰstop
ANB M110                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
OUT Y59                  ; ﾌﾞｻﾞｰ
OUT B1058                ; ブザーLP
LD Y59                   ; ﾌﾞｻﾞｰ
OR B129B                 ; TP補助_ﾌﾞｻﾞｰ停止
AND M105                 ; 異常発生
OUT B129B                ; TP補助_ﾌﾞｻﾞｰ停止
;<h1/>装置設定
LD<= K511 W08            ; TP_切替ページNo.
AND>= K520 W08           ; TP_切替ページNo.
OUT M1014                ; 装置設定登録画面
LD M1014                 ; 装置設定登録画面
MPS
ANB B1071                ; 装置設定書込中
OUT M1015                ; 装置設定値表示
MPP
ANB M1216                ; Unit1_自動動作中
OUT M1016                ; 装置設定値入力ｲﾝﾀｰﾛｯｸ
;<h1/>├読出
LDP M1015                ; 装置設定値表示
BMOV D500 D1300 K100     ; 装置設定1_幅計測上限  TP_装置設定1_幅計測上限
;<h1/>├登録
LDP B1021                ; 装置設定書込SW
AND M1015                ; 装置設定値表示
ANB B1071                ; 装置設定書込中
BMOV D1300 D500 K100     ; TP_装置設定1_幅計測上限  装置設定1_幅計測上限
;<h1/>└表示
LD B1021                 ; 装置設定書込SW
AND M1015                ; 装置設定値表示
OR B1071                 ; 装置設定書込中
AND M1014                ; 装置設定登録画面
ANB T6                   ; 装置設定書込ﾀｲﾏ
OUT B1071                ; 装置設定書込中
TMR K6 K20               ; 装置設定書込ﾀｲﾏ
LDB M1014                ; 装置設定登録画面
FMOV K0 D1300 K100       ; TP_装置設定1_幅計測上限
END
ENDH
