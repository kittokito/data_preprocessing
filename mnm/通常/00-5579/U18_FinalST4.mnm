DEVICE:53
;MODULE:U18_FinalST4
;MODULE_TYPE:0
;SCRIPT_TYPE:
;<h1/>□_入力受け
;関連する入力受け(ｾﾝｻのﾃﾞｨﾚｲﾀｲﾏ等)を必要があれば作成する。
;通常は入力ﾕﾆｯﾄに入力時定数(ﾃﾞｨﾚｲ)があるので直接使用しても問題は無い。
LD M123                  ; 安全扉正常
AND M124                 ; ｴﾘｱｾﾝｻ正常
TMR K1801 K5             ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
LD X1354                 ; ST4_電特部_ﾜｰｸ押_下降端
TMH K1802 K50            ; ST4_電特部_ﾜｰｸ押_下降端
LD CR2003                ; 常時OFF
TMR K1803 K3
LD M9621                 ; RB7_ﾜｰｸ受取り位置(ID確認位置)
TMR K1804 K5             ; ST4_電特部_ﾊﾟﾚｯﾄ_後退端
;ｺﾝﾀｸﾄﾍｯﾄﾞID
LD X1358                 ; ST4_電特部_ｺﾝﾀｸﾄﾍｯﾄﾞID_1
OUT D9606.0
LD X1359                 ; ST4_電特部_ｺﾝﾀｸﾄﾍｯﾄﾞID_2
OUT D9606.1
LD X135A                 ; ST4_電特部_ｺﾝﾀｸﾄﾍｯﾄﾞID_3
OUT D9606.2
;ﾊﾟﾚｯﾄID
LD X135B                 ; ST4_電特部_ﾊﾟﾚｯﾄID_1
OUT D9607.0
LD X135C                 ; ST4_電特部_ﾊﾟﾚｯﾄID_2
OUT D9607.1
LD X135D                 ; ST4_電特部_ﾊﾟﾚｯﾄID_3
OUT D9607.2
;ＩＤ保持
LD M71                   ; 自動運転開始BZ
AND L1800                ; FINALST4_有効状態
LD M9912                 ; FinalST4_ID保持ﾄﾘｶﾞ
ANB M9910                ; FainlST4_無効中
ORL
AND M71                  ; 自動運転開始BZ
OUT M9912                ; FinalST4_ID保持ﾄﾘｶﾞ
;____ｺﾝﾀｸﾄﾍｯﾄﾞＩＤ保持
;※PC送信用は生ﾃﾞｰﾀに変更
LD L1800                 ; FINALST4_有効状態
MPS
TMR K1806 K5             ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_更新_DLY
MPP
AND T1806                ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_更新_DLY
@MOV D9606 D9600         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_Copy  FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID
LD CR2002                ; 常時ON
MOV D9606 W013B          ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_Copy  電特ﾃｽﾄﾍｯﾄﾞID#4
LDB L1800                ; FINALST4_有効状態
MOV K0 D9600             ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID
;____ﾊﾟﾚｯﾄＩＤ保持
LD L1800                 ; FINALST4_有効状態
LD T1804                 ; ST4_電特部_ﾊﾟﾚｯﾄ_後退端
OR T1807                 ; FinalST4_ﾊﾟﾚｯﾄID_更新_DLY
ANL
TMR K1807 K5             ; FinalST4_ﾊﾟﾚｯﾄID_更新_DLY
@MOV D9607 D9601         ; FinalST4_ﾊﾟﾚｯﾄID_ｾﾝｻ状態  FinalST4_ﾊﾟﾚｯﾄID
LD CR2002                ; 常時ON
MOV D9601 W0133          ; FinalST4_ﾊﾟﾚｯﾄID  電特ﾊﾟﾚｯﾄID#4
LDB L1800                ; FINALST4_有効状態
MOV K0 D9601             ; FinalST4_ﾊﾟﾚｯﾄID
;<h1/>__FINAL_ST_治具有効/無効選択
;段取り状態中ﾌﾗｸﾞの追加
;自動中は段取り状態中に、ST上のﾜｰｸ無、RBﾊﾝﾄﾞﾜｰｸ無し、供給部ﾜｰｸ無しにて無効状態OKとなる
LDB X1248                ; ST4_電特検査 有効/無効SW
ANB B12AA                ; ST4_Final検査_有効/無効_Tpb
INV
OUT M9904                ; ST4電特検査_有効/無効SW
LD= D1201 K0             ; 投入部1_ﾜｰｸ有無記憶
OR= D1207 K1             ; 投入部_BreakMode品(ONで)
LD= D6201 K0             ; Leak_ST1_ﾜｰｸ有無記憶
OR= D6207 K1             ; Leak_ST1_BreakMode品(ONで)
ANL
LD= D7201 K0             ; Leak_ST2_ﾜｰｸ有無記憶
OR= D7207 K1             ; Leak_ST2_BreakMode品(ONで)
ANL
ANB M3102                ; ﾊﾝﾄﾞ1_Final検査品
ANB M3152                ; ﾊﾝﾄﾞ2_Final検査品
LDB T220                 ; ST1-2_ﾊﾝﾄﾞ1吸着確認ONﾀｲﾏ
OR M3103                 ; ﾊﾝﾄﾞ1_検査完了品(排出ﾜｰｸ)
ANL
LDB T222                 ; ST1-2_ﾊﾝﾄﾞ2吸着確認ONﾀｲﾏ
OR M3153                 ; ﾊﾝﾄﾞ2_検査完了品(排出ﾜｰｸ)
ANL
LD L1400                 ; FINALST2_有効状態
AND= D9600 D7600         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  FinalST2_ｺﾝﾀｸﾄﾍｯﾄﾞID
AND= D9601 D7601         ; FinalST4_ﾊﾟﾚｯﾄID  FinalST2_ﾊﾟﾚｯﾄID
LD L1600                 ; FINALST3_有効状態
AND= D9600 D8600         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  FinalST3_ｺﾝﾀｸﾄﾍｯﾄﾞID
AND= D9601 D8601         ; FinalST4_ﾊﾟﾚｯﾄID  FinalST3_ﾊﾟﾚｯﾄID
ORL
ANB M99                  ; 能拡後対応FLG
ORL
LD L2000                 ; FINALST5_有効状態
AND= D9600 D10600        ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  FinalST5_ｺﾝﾀｸﾄﾍｯﾄﾞID
AND= D9601 D10601        ; FinalST4_ﾊﾟﾚｯﾄID  FinalST5_ﾊﾟﾚｯﾄID
ORL
LD L2200                 ; FINALST6_有効状態
AND= D9600 D11600        ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  FinalST6_ｺﾝﾀｸﾄﾍｯﾄﾞID
AND= D9601 D11601        ; FinalST4_ﾊﾟﾚｯﾄID  FinalST6_ﾊﾟﾚｯﾄID
ORL
OR W09.11                ; 電特ｽﾃｰｼﾞ#4 無効切替要求
LDB M9574                ; U18-1起動中
LD M9501                 ; U18-1_S1_ﾜｰｸ供給要求
ANB M4864                ; 【搬送2】搬送→FINAL_ST4搬送開始
ORL
ANL
LDB M3111                ; ﾊﾝﾄﾞ1_FinalST1再検品
ANB M3161                ; ﾊﾝﾄﾞ2_FinalST1再検品
OR W09.11                ; 電特ｽﾃｰｼﾞ#4 無効切替要求
ANL
ANB M3222                ; ﾊﾝﾄﾞ1_FinalST4給材中flg
ANB M3223                ; ﾊﾝﾄﾞ2_FinalST4給材中flg
LD= D9701 K0             ; Final_ST4_ﾜｰｸ有無記憶
LD= D9701 K1             ; Final_ST4_ﾜｰｸ有無記憶
AND<> D9704 K0           ; Final_ST4_Final検査結果(1=OK_2=N
ORL
ANL
OUT M9907                ; FainlST4_自動中無効条件OK
LDB M71                  ; 自動運転開始BZ
LD M9909                 ; FainlST4_無効予約(自動運転)
AND M9907                ; FainlST4_自動中無効条件OK
ORL
OUT M9908                ; FainlST4_無効OK条件
LD M9909                 ; FainlST4_無効予約(自動運転)
ANB M9910                ; FainlST4_無効中
ANP M9904                ; ST4電特検査_有効/無効SW
ANB W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
ANB D9708.0
OUT M9911                ; FainlST4_予約ｷｬﾝｾﾙ
LDP M9904                ; ST4電特検査_有効/無効SW
ORP W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
AND L1800                ; FINALST4_有効状態
AND M71                  ; 自動運転開始BZ
ANB M9909                ; FainlST4_無効予約(自動運転)
LD M9909                 ; FainlST4_無効予約(自動運転)
ANB M9910                ; FainlST4_無効中
ANB M9911                ; FainlST4_予約ｷｬﾝｾﾙ
ORL
OUT M9909                ; FainlST4_無効予約(自動運転)
LD M9909                 ; FainlST4_無効予約(自動運転)
AND M9908                ; FainlST4_無効OK条件
LDP M9904                ; ST4電特検査_有効/無効SW
ANB W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
ORP W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
ANB M41                  ; U_起動中
ORL
LDB B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
ANB B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
INV
MEP
ORL
LDB M300                 ; PC通信正常
ANB M3                   ; OFFLINE_MODE
ORL
LD M9910                 ; FainlST4_無効中
ANB L1800                ; FINALST4_有効状態
ORL
OUT M9910                ; FainlST4_無効中
;<h1/>__Final ST_有効処理
LDP M9904                ; ST4電特検査_有効/無効SW
LD<> D9606 K0            ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_Copy
AND<> D9607 K0           ; FinalST4_ﾊﾟﾚｯﾄID_ｾﾝｻ状態
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
LD M35                   ; 空運転ﾓｰﾄﾞ
AND= D9606 K0            ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_Copy
AND= D9607 K0            ; FinalST4_ﾊﾟﾚｯﾄID_ｾﾝｻ状態
ORL
ANL
ANB L1800                ; FINALST4_有効状態
LD M9915                 ; FinalST4有効要求
ANB M9917                ; ST有効OK
ANB M9918                ; ST有効化NG
ORL
LD M300                  ; PC通信正常
OR M3                    ; OFFLINE_MODE
ANL
OUT M9915                ; FinalST4有効要求
LD M9915                 ; FinalST4有効要求
ANB M3                   ; OFFLINE_MODE
ANB M9                   ; ﾁｪｯｶｰﾁｪｯｸ有効ﾓｰﾄﾞOFF(step2でOFF)
OUT W0108.3              ; ﾁｪｯｶｰ#4確認要求
LD M9915                 ; FinalST4有効要求
LD W0108.3               ; ﾁｪｯｶｰ#4確認要求
OR M3                    ; OFFLINE_MODE
OR M9                    ; ﾁｪｯｶｰﾁｪｯｸ有効ﾓｰﾄﾞOFF(step2でOFF)
ANL
OR M9916                 ; ST有効確認要求
AND M9915                ; FinalST4有効要求
OUT M9916                ; ST有効確認要求
;有効化ok
LD M9916                 ; ST有効確認要求
LD W0A.3                 ; ﾁｪｯｶｰ#4確認完了
ANB W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
OR M3                    ; OFFLINE_MODE
OR M9                    ; ﾁｪｯｶｰﾁｪｯｸ有効ﾓｰﾄﾞOFF(step2でOFF)
ANL
OR M9917                 ; ST有効OK
AND M9915                ; FinalST4有効要求
OUT M9917                ; ST有効OK
LD M9917                 ; ST有効OK
LD L1800                 ; FINALST4_有効状態
ANB M9910                ; FainlST4_無効中
ANB M9918                ; ST有効化NG
ORL
OUT L1800                ; FINALST4_有効状態
;有効化不可
LD M9916                 ; ST有効確認要求
ANB M3                   ; OFFLINE_MODE
ANB M9                   ; ﾁｪｯｶｰﾁｪｯｸ有効ﾓｰﾄﾞOFF(step2でOFF)
AND W0A.3                ; ﾁｪｯｶｰ#4確認完了
AND W09.11               ; 電特ｽﾃｰｼﾞ#4 無効切替要求
OR M9918                 ; ST有効化NG
AND M9915                ; FinalST4有効要求
OUT M9918                ; ST有効化NG
;JIG_ID一致確認
LD L1800                 ; FINALST4_有効状態
MPS
LD M99                   ; 能拡後対応FLG
AND= D9600 D1714         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  搬送ﾊﾝﾄﾞ1_電特ﾃｽﾄﾍｯﾄﾞID
AND= D9601 D1713         ; FinalST4_ﾊﾟﾚｯﾄID  搬送ﾊﾝﾄﾞ1_電特ﾊﾟﾚｯﾄID
LDB M99                  ; 能拡後対応FLG
AND= D9600 D3714         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  搬送2ﾊﾝﾄﾞ1_電特ﾃｽﾄﾍｯﾄﾞID
AND= D9601 D3713         ; FinalST4_ﾊﾟﾚｯﾄID  搬送2ﾊﾝﾄﾞ1_電特ﾊﾟﾚｯﾄID
ORL
OR M35                   ; 空運転ﾓｰﾄﾞ
ANL
OUT M9901                ; FinalST4-搬送2ﾊﾝﾄﾞ1ID一致ﾌﾗｸﾞ
MPP
LD M99                   ; 能拡後対応FLG
AND= D9600 D1814         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  搬送ﾊﾝﾄﾞ2_電特ﾃｽﾄﾍｯﾄﾞID
AND= D9601 D1813         ; FinalST4_ﾊﾟﾚｯﾄID  搬送ﾊﾝﾄﾞ2_電特ﾊﾟﾚｯﾄID
LDB M99                  ; 能拡後対応FLG
AND= D9600 D3814         ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  搬送2ﾊﾝﾄﾞ2_電特ﾃｽﾄﾍｯﾄﾞID
AND= D9601 D3813         ; FinalST4_ﾊﾟﾚｯﾄID  搬送2ﾊﾝﾄﾞ2_電特ﾊﾟﾚｯﾄID
ORL
OR M35                   ; 空運転ﾓｰﾄﾞ
ANL
OUT M9902                ; FinalST4-搬送2ﾊﾝﾄﾞ2ID一致ﾌﾗｸﾞ
;<h1/>□_装置状態・動作条件
;ﾕﾆｯﾄまとめ
LD M9570                 ; U18-1原点
AND M9730                ; U18-3原点
OUT M9980                ; FinalST4U18原点
;□ 非常停止
LDB M9571                ; U18-1全異常
ANB M9731                ; U18-3全異常
INV
OUT M9981                ; U18即停止異常
;□ 起動条件
LD CR2003                ; 常時OFF
OUT M9982                ; U18起動条件
;□ 起動OFF
LDB M50                  ; 運転準備
LD M60                   ; ｴﾗｰ発生
OR M52                   ; ｻｲｸﾙ停止異常(ｻｲｸﾙ停止)
AND M9984                ; U18原点復帰中
ORL
OR T15                   ; 強制停止
OUT M9983                ; U18起動OFF
;□ 原点復帰
LD M82                   ; 原点復帰開始
ANB M9984                ; U18原点復帰中
OR M9984                 ; U18原点復帰中
ANB M9983                ; U18起動OFF
ANB M9991                ; U18ｴﾗｰ発生
ANB M9797                ; OrgSEND
OUT M9984                ; U18原点復帰中
;□ 起動中
LDB M9574                ; U18-1起動中
ANB M9734                ; U18-3(電特検査SUB)起動中
INV
OUT M9985                ; U18起動中
;□ ｻｲｸﾙ停止異常
LDB M9575                ; U18-1ｻｲｸﾙ停止異常
ANB M9735                ; U18-3ｻｲｸﾙ停止異常
INV
OUT M9986                ; U18ｻｲｸﾙ停止異常
;□ 払出停止異常
LDB CR2003               ; 常時OFF
INV
OUT M9987                ; U18払出停止異常
;□ 警報補助
LDB CR2003               ; 常時OFF
INV
OUT M9988                ; U18警報補助
;□ 機器準備確認
LD CR2002                ; 常時ON
OUT M9990                ; U18機器準備完了
;□ ｴﾗｰ発生　一時停止
LDB M9576                ; U18-1ｴﾗｰ発生
ANB M9736                ; U18-3ｴﾗｰ発生
INV
OUT M9991                ; U18ｴﾗｰ発生
;□ 動作中ﾕﾆｯﾄ無し
LD M9577                 ; U18-1動作無し
AND M9737                ; U18-3動作無し
OUT M9992                ; U18動作無し確認
;□ 払出しﾜｰｸ無し
LDB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
ANB M6421                ; LeakST1_ﾜｰｸ除材要求
ANB M7421                ; LeakST2_ﾜｰｸ除材要求
ANB M2574                ; U2-1起動中
AND M36                  ; 払出ﾓｰﾄﾞ
ANB M3100                ; ﾊﾝﾄﾞ1_ﾜｰｸ有
ANB M3150                ; ﾊﾝﾄﾞ2_ﾜｰｸ有
ANB M5100                ; Hand1_ﾜｰｸ有
ANB M5150                ; Hand2_ﾜｰｸ有
TMR K1814 K10            ; U18_ﾜｰｸ無し(払出時)
LD T1814                 ; U18_ﾜｰｸ無し(払出時)
OUT M9993                ; U18ﾜｰｸ無し
;□ ｽﾃｯﾌﾟ起動
LD M30                   ; 自動ﾓｰﾄﾞ
OR M31                   ; 手動ﾓｰﾄﾞ
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
ANB M130                 ; 一時停止
ANB M51                  ; 即停止異常(緊急停止)
ANB M52                  ; ｻｲｸﾙ停止異常(ｻｲｸﾙ停止)
ANB M57                  ; 自動起動停止指令(払出停止)
ANB M59                  ; 払出停止異常まとめ
ANB M60                  ; ｴﾗｰ発生
OUT M9979                ; U18ｽﾃｯﾌﾟ動作
;<h1/>□_自動回路
;<h1/>◇_ﾕﾆｯﾄ-1状態・動作条件(補助)
LD X1355                 ; ST4_電特部_ﾜｰｸ押_上昇端
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
ANB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
AND= D9701 K0            ; Final_ST4_ﾜｰｸ有無記憶
OUT M9570                ; U18-1原点
LDB B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
ANB B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
ANB B0244                ; 580)FinalST4ﾜｰｸ受取異常
ANB B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
INV
OUT M9571                ; U18-1全異常
LD M9570                 ; U18-1原点
ANB M9574                ; U18-1起動中
AND M9979                ; U18ｽﾃｯﾌﾟ動作
ANB L11                  ; Final検査有無(0_有/1_無)
ANB M9908                ; FainlST4_無効OK条件
ANB M9993                ; U18ﾜｰｸ無し
OUT M9572                ; U18-1起動条件
LDB M50                  ; 運転準備
ORB L1800                ; FINALST4_有効状態
OR M9986                 ; U18ｻｲｸﾙ停止異常
OR T15                   ; 強制停止
OUT M9573                ; U18-1起動OFF
LD M73                   ; 各工程起動指令
AND M9572                ; U18-1起動条件
OR M9574                 ; U18-1起動中
ANB M9573                ; U18-1起動OFF
ANB M9563                ; U18-1ｻｲｸﾙ終了
OUT M9574                ; U18-1起動中
;ﾕﾆｯﾄ1-1 ｻｲｸﾙ停止異常
LDB CR2003               ; 常時OFF
INV
OUT M9575                ; U18-1ｻｲｸﾙ停止異常
;ﾕﾆｯﾄ1-1 ｴﾗｰ発生まとめ
LDB B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
ANB B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
ANB B0341                ; 833)FinalST4ﾜｰｸ除去要求
ANB B0342                ; 834)FinalST4検査中
INV
OUT M9576                ; U18-1ｴﾗｰ発生
;ﾕﾆｯﾄ1-1 停止判定
LD= D9500 D9505          ; U18-1自動運転ｽﾃｯﾌﾟ  U18-1動作中判定
ORB M9574                ; U18-1起動中
ANB M9604                ; RB7位置決めSub起動中
TMR K1810 K20            ; U18-1_停止中
LD CR2002                ; 常時ON
MOV D9500 D9505          ; U18-1自動運転ｽﾃｯﾌﾟ  U18-1動作中判定
LD T1810                 ; U18-1_停止中
OUT M9577                ; U18-1動作無し
;□
;□　ﾕﾆｯﾄ1-1 自動運転ステップ開始
;□
LD CR2002                ; 常時ON
FMOV K0 M9500 K4         ; U18-1_S0
LDB M9574                ; U18-1起動中
MOV K0 D9500             ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9574                 ; U18-1起動中
MOV D9500 Z1             ; U18-1自動運転ｽﾃｯﾌﾟ
SET M9500:Z1             ; U18-1_S0
;　ｶｳﾝﾄﾘｾｯﾄ
LDP M73                  ; 各工程起動指令
ORP L1800                ; FINALST4_有効状態
MOV K0 D9520             ; ﾜｰｸ投入数(ST4)
MOV K0 D9521             ; ﾜｰｸ排出数(ST4)
;　ｻｲｸﾙ開始
LD M9500                 ; U18-1_S0
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
ANB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;<h1/>__S01_ﾜｰｸ給材要求
LD M9501                 ; U18-1_S1_ﾜｰｸ供給要求
MPS
LD L1800                 ; FINALST4_有効状態
ANB M9993                ; U18ﾜｰｸ無し
ANL
MPS
AND M4864                ; 【搬送2】搬送→FINAL_ST4搬送開始
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
LD M9901                 ; FinalST4-搬送2ﾊﾝﾄﾞ1ID一致ﾌﾗｸﾞ
OR M9902                 ; FinalST4-搬送2ﾊﾝﾄﾞ2ID一致ﾌﾗｸﾞ
ANB D3721.3              ; 再投入品投入不可能#4
ANB D3821.3              ; 再投入品投入不可能#4
ANL
OUT M9920                ; FinalST4→搬送ﾜｰｸ供給要求
MPP
LD M9993                 ; U18ﾜｰｸ無し
LD M9910                 ; FainlST4_無効中
ANB L1800                ; FINALST4_有効状態
ORL
ANL
MOV K63 D9500            ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9502                 ; U18-1_S2
LD M4874                 ; 【搬送2】搬送→FINAL_ST4搬送完了
OR M9922                 ; FinalST4→搬送ﾜｰｸ受取り完了
ANL
MPS
LDB M4864                ; 【搬送2】搬送→FINAL_ST4搬送開始
ANB M4874                ; 【搬送2】搬送→FINAL_ST4搬送完了
ANL
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
OUT M9922                ; FinalST4→搬送ﾜｰｸ受取り完了
LD M9503                 ; U18-1_S3
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND= D9701 K1            ; Final_ST4_ﾜｰｸ有無記憶
MPS
LD X1356                 ; ST4_電特部_ﾜｰｸ確認(ON=有)
OR M35                   ; 空運転ﾓｰﾄﾞ
ANL
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
LDB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
ANB M35                  ; 空運転ﾓｰﾄﾞ
ANL
MOV K60 D9500            ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9560                 ; U18-1_S60_FinalST4_ﾜｰｸ受取異常
AND B0244                ; 580)FinalST4ﾜｰｸ受取異常
MOV K63 D9500            ; U18-1自動運転ｽﾃｯﾌﾟ
;　　ｸﾗﾝﾌﾟ指令
LD M9504                 ; U18-1_S4_ｸﾗﾝﾌﾟ指令
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND X1354                ; ST4_電特部_ﾜｰｸ押_下降端
ANB B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;　　Z軸上昇確認
LD M9505                 ; U18-1_S5_電特開始確認待ち
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
LD L309                  ; Z_搬送高さ(P9)
OR L308                  ; Z_搬送高さ(P8)
ANL
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9506                 ; U18-1_S6
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LDP M9506                ; U18-1_S6
AND= D9705 K0            ; Final_ST4_再検査品st
LD= D6203 K2             ; Leak_ST1_Leak検査結果(1=OK_2=NG)
ANB M98                  ; Break品優先排出変更ﾌﾗｸﾞ
AND= D6207 K0            ; Leak_ST1_BreakMode品(ONで)
MEP
AND CR2003               ; 常時OFF
ORL
@INC D9520               ; ﾜｰｸ投入数(ST4)
LD M9507                 ; U18-1_S7
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9508                 ; U18-1_S8
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9509                 ; U18-1_S9
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;　　■電特検査前処理
LD M9510                 ; U18-1_S10
MPS
LD= D9703 K1             ; Final_ST4_Leak検査結果(1=OK_2=NG
OR<> D9705 K0            ; Final_ST4_再検査品st
OR L10                   ; Leak検査有無(0_有/1_無)
ANL
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
LD= D9703 K2             ; Final_ST4_Leak検査結果(1=OK_2=NG
AND<> D9705 K0           ; Final_ST4_再検査品st
ANB L10                  ; Leak検査有無(0_有/1_無)
ANL
MOV K20 D9500            ; U18-1自動運転ｽﾃｯﾌﾟ
;	■_電特connecter接触前位置移動
LD M9511                 ; U18-1_S11
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M9603                ; RB7位置決めSub起動条件
MOV D9541 D9530          ; ｺﾈｸﾀ挿入開始位置指令Pos  RB7_指令Pos_NO.
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9512                 ; U18-1_S12_
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9623                ; RB7_ｺﾈｸﾀ挿入開始位置
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9513                 ; U18-1_S13
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M9603                ; RB7位置決めSub起動条件
MOV D9542 D9530          ; ｺﾈｸﾀ挿入押込み位置指令Pos  RB7_指令Pos_NO.
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9514                 ; U18-1_S14_ﾊﾟﾚｯﾄ前進指令
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9624                ; RB7_ｺﾈｸﾀ挿入押込み位置
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;<h1/>__S15_電特検査処理開始
LD M9515                 ; U18-1_S15
AND M9979                ; U18ｽﾃｯﾌﾟ動作
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9516                 ; U18-1_S16_電特検査SUB開始ﾌﾗｸﾞ
AND M9734                ; U18-3(電特検査SUB)起動中
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9517                 ; U18-1_S17
ANB M9734                ; U18-3(電特検査SUB)起動中
AND<> D9704 K0           ; Final_ST4_Final検査結果(1=OK_2=N
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;　　ｽﾃｰｼﾞ後退
LD M9518                 ; U18-1_S18
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M9603                ; RB7位置決めSub起動条件
MOV D9543 D9530          ; ｺﾈｸﾀ抜き位置Pos  RB7_指令Pos_NO.
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9519                 ; U18-1_S19
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9625                ; RB7_ｺﾈｸﾀ抜き位置
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9520                 ; U18-1_S20_ｽﾃｰｼﾞ後退命令
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M9603                ; RB7位置決めSub起動条件
MOV D9549 D9530          ; 待機位置指令Pos  RB7_指令Pos_NO.
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9521                 ; U18-1_S21_
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9522                 ; U18-1_S22
AND M9979                ; U18ｽﾃｯﾌﾟ動作
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9523                 ; U18-1_S23
AND M9979                ; U18ｽﾃｯﾌﾟ動作
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LD M9524                 ; U18-1_S24
AND M9979                ; U18ｽﾃｯﾌﾟ動作
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
;<h1/>__S25_ﾜｰｸ除材要求
LD M9525                 ; U18-1_S25
MPS
AND M4884                ; 【搬送2】FinalST4除材開始
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
LDB M3101                ; ﾊﾝﾄﾞ1_ﾘｰｸ検査品
ANB M3151                ; ﾊﾝﾄﾞ2_ﾘｰｸ検査品
ANB M5101                ; Hand1_Leak検査品
ANB M5151                ; Hand2_Leak検査品
OR<> D9705 K0            ; Final_ST4_再検査品st
OR L10                   ; Leak検査有無(0_有/1_無)
LD M3236                 ; ﾊﾝﾄﾞ1_FinalST4除材中flg
OR M3237                 ; ﾊﾝﾄﾞ2_FinalST4除材中flg
AND M99                  ; 能拡後対応FLG
ORL
OR M5236                 ; Hand1_FinalST4除材中flg
OR M5237                 ; Hand2_FinalST4除材中flg
ANL
OUT M9921                ; FinalST4→搬送1除材要求
LD M9526                 ; U18-1_S26
LD M4894                 ; 【搬送2】FinalST4除材完了
OR M9923                 ; FinalST4→搬送除材完了受取
ANL
MPS
LDB M4884                ; 【搬送2】FinalST4除材開始
ANB M4894                ; 【搬送2】FinalST4除材完了
ANL
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
OUT M9923                ; FinalST4→搬送除材完了受取
LD M9527                 ; U18-1_S27
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND= D9701 K0            ; Final_ST4_ﾜｰｸ有無記憶
LD L309                  ; Z_搬送高さ(P9)
OR L308                  ; Z_搬送高さ(P8)
OR L307                  ; Z_ﾜｰｸ入替高さ(搬送禁止)
ANL
MPS
ANB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
MPP
AND X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
OUT M9930                ; Final_ST4_ﾜｰｸ受渡し異常
LD M9528                 ; U18-1_S28
INC D9500                ; U18-1自動運転ｽﾃｯﾌﾟ
LDP M9528                ; U18-1_S28
AND= D9705 K0            ; Final_ST4_再検査品st
LD= D6203 K2             ; Leak_ST1_Leak検査結果(1=OK_2=NG)
MEP
AND CR2003               ; 常時OFF
ORL
@INC D9521               ; ﾜｰｸ排出数(ST4)
LD M9529                 ; U18-1_S29
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
MOV K63 D9500            ; U18-1自動運転ｽﾃｯﾌﾟ
;<h1/>◇_ﾕﾆｯﾄ-3(電特検査SUB)状態・動作条件(補助)
LD CR2002                ; 常時ON
OUT M9730                ; U18-3原点
LDB CR2003               ; 常時OFF
INV
OUT M9731                ; U18-3全異常
LD M9730                 ; U18-3原点
ANB M9734                ; U18-3(電特検査SUB)起動中
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M300                 ; PC通信正常
OUT M9732                ; U18-3起動条件
LDB M50                  ; 運転準備
OR M9986                 ; U18ｻｲｸﾙ停止異常
OR T15                   ; 強制停止
OUT M9733                ; U18-3起動OFF
LD M9516                 ; U18-1_S16_電特検査SUB開始ﾌﾗｸﾞ
AND M9732                ; U18-3起動条件
OR M9734                 ; U18-3(電特検査SUB)起動中
ANB M9733                ; U18-3起動OFF
ANB M9723                ; U18-3ｻｲｸﾙ終了
OUT M9734                ; U18-3(電特検査SUB)起動中
;tp表示
LD CR2002                ; 常時ON
DW K0 D9900              ; Final検査_ｽﾃｰﾀｽ表示
LD M9734                 ; U18-3(電特検査SUB)起動中
DW K1 D9900              ; Final検査_ｽﾃｰﾀｽ表示
LD= D9704 K1             ; Final_ST4_Final検査結果(1=OK_2=N
DW K2 D9900              ; Final検査_ｽﾃｰﾀｽ表示
LD= D9704 K2             ; Final_ST4_Final検査結果(1=OK_2=N
DW K3 D9900              ; Final検査_ｽﾃｰﾀｽ表示
LDB L1800                ; FINALST4_有効状態
DW K4 D9900              ; Final検査_ｽﾃｰﾀｽ表示
;ﾕﾆｯﾄ1-3ｻｲｸﾙ停止異常
LDB CR2003               ; 常時OFF
INV
OUT M9735                ; U18-3ｻｲｸﾙ停止異常
;ﾕﾆｯﾄ1-3ｴﾗｰ発生まとめ
LDB CR2003               ; 常時OFF
INV
OUT M9736                ; U18-3ｴﾗｰ発生
;ﾕﾆｯﾄ1-3停止判定
LD= D9502 D9507          ; U18-3自動運転ｽﾃｯﾌﾟ  U18-3動作中判定
TMR K1812 K20            ; U18-3_停止中
LD CR2002                ; 常時ON
MOV D9502 D9507          ; U18-3自動運転ｽﾃｯﾌﾟ  U18-3動作中判定
LD T1812                 ; U18-3_停止中
ORB M9734                ; U18-3(電特検査SUB)起動中
OUT M9737                ; U18-3動作無し
;□
;□　ﾕﾆｯﾄ1-3自動運転ステップ開始
;□
LD CR2002                ; 常時ON
FMOV K0 M9660 K4         ; U18-3_S0
LDB M9734                ; U18-3(電特検査SUB)起動中
MOV K0 D9502             ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9734                 ; U18-3(電特検査SUB)起動中
MOV D9502 Z1             ; U18-3自動運転ｽﾃｯﾌﾟ
SET M9660:Z1             ; U18-3_S0
;<h1/>__S0_ﾜｰｸ有無判定
LD M9660                 ; U18-3_S0
MPS
LD T1801                 ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
ANB M35                  ; 空運転ﾓｰﾄﾞ
ANB M3                   ; OFFLINE_MODE
ANL
INC D9502                ; U18-3自動運転ｽﾃｯﾌﾟ
MPP
LD M35                   ; 空運転ﾓｰﾄﾞ
OR M3                    ; OFFLINE_MODE
ANL
MPS
AND T1830                ; Final検査時間(仮)
INC D9502                ; U18-3自動運転ｽﾃｯﾌﾟ
MPP
TMR K1830 K450           ; Final検査時間(仮)
LD M9661                 ; U18-3_S1_Final検査ｽﾀｰﾄ要求
AND W0107.3              ; 電気特性検査開始要求#4
LD W07.3                 ; 電気特性検査ｽﾃｰｼﾞ状態#4
OR M3                    ; OFFLINE_MODE
OR M35                   ; 空運転ﾓｰﾄﾞ
ANL
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9662                 ; U18-3_S2
LDB W07.3                ; 電気特性検査ｽﾃｰｼﾞ状態#4
OR M3                    ; OFFLINE_MODE
ANL
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9663                 ; U18-3_S3
MPS
AND<> D9704 K0           ; Final_ST4_Final検査結果(1=OK_2=N
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
MRD
LDB M35                  ; 空運転ﾓｰﾄﾞ
ANB M3                   ; OFFLINE_MODE
ANL
MPS
AND W07.11               ; 電気特性検査結果#4
MOV K1 D9704             ; Final_ST4_Final検査結果(1=OK_2=N
MPP
ANB W07.11               ; 電気特性検査結果#4
MOV K2 D9704             ; Final_ST4_Final検査結果(1=OK_2=N
MPP
LD M3                    ; OFFLINE_MODE
OR M35                   ; 空運転ﾓｰﾄﾞ
ANL
MPS
ANB B1038                ; ﾌｧｲﾅﾙST2_強制NG_TEST
MOV K1 D9704             ; Final_ST4_Final検査結果(1=OK_2=N
MPP
AND B1038                ; ﾌｧｲﾅﾙST2_強制NG_TEST
MOV K2 D9704             ; Final_ST4_Final検査結果(1=OK_2=N
LD M9664                 ; U18-3_S4
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9665                 ; U18-3_S5
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9666                 ; U18-3_S6
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9667                 ; U18-3_S7
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9668                 ; U18-3_S8
@INC D9502               ; U18-3自動運転ｽﾃｯﾌﾟ
LD M9669                 ; U18-3_S9
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
MOV K63 D9502            ; U18-3自動運転ｽﾃｯﾌﾟ
;<h1/>□_原点復帰回路
LD CR2002                ; 常時ON
FMOV K0 M9750 K3         ; OrgS0
LDB M9984                ; U18原点復帰中
MOV K0 D9510             ; U18原点復帰ｽﾃｯﾌﾟ
LD M9984                 ; U18原点復帰中
MOV D9510 Z1             ; U18原点復帰ｽﾃｯﾌﾟ
SET M9750:Z1             ; OrgS0
;原点復帰ｻｲｸﾙ監視
LD M9984                 ; U18原点復帰中
TMR K1800 K200
;原点復帰ステップ開始
LD M9750                 ; OrgS0
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND L309                 ; Z_搬送高さ(P9)
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9751                 ; OrgS1
MPS
ANB X184A                ; RB7_ST4_原点確定_HEND
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
MPP
AND X184A                ; RB7_ST4_原点確定_HEND
MOV K3 D9510             ; U18原点復帰ｽﾃｯﾌﾟ
LD M9752                 ; OrgS2_ｽﾃｰｼﾞ戻り指令
AND X184A                ; RB7_ST4_原点確定_HEND
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9753                 ; OrgS3_ｸﾗﾝﾌﾟ上昇指令
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND M9603                ; RB7位置決めSub起動条件
MOV D9549 D9530          ; 待機位置指令Pos  RB7_指令Pos_NO.
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9754                 ; OrgS4
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9755                 ; OrgS5_
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9756                 ; OrgS6_
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND X1355                ; ST4_電特部_ﾜｰｸ押_上昇端
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
;　　ﾜｰｸ有無ﾁｪｯｸ
LD M9757                 ; OrgS7
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
MPS
ANB X1356                ; ST4_電特部_ﾜｰｸ確認(ON=有)
MOV K10 D9510            ; U18原点復帰ｽﾃｯﾌﾟ
MPP
LD X1356                 ; ST4_電特部_ﾜｰｸ確認(ON=有)
AND M89                  ; 全STﾜｰｸｱﾝｸﾗﾝﾌﾟ状態
ANL
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
;　　ﾜｰｸ除去要求
LD M9758                 ; OrgS8_ORGﾜｰｸ除去要求
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
AND B0341                ; 833)FinalST4ﾜｰｸ除去要求
MOV K46 D9510            ; U18原点復帰ｽﾃｯﾌﾟ
;　　
LD M9759                 ; OrgS9
AND T1801                ; ST3-4間ﾗｲﾄｶｰﾃﾝOK
AND M9979                ; U18ｽﾃｯﾌﾟ動作
INC D9510                ; U18原点復帰ｽﾃｯﾌﾟ
LD M9760                 ; OrgS10
MPS
AND M9980                ; FinalST4U18原点
MOV K46 D9510            ; U18原点復帰ｽﾃｯﾌﾟ
MPP
FMOV K0 D9700 K100       ; Final_ST4_INDEX NO.
LD M9796                 ; OrgS46
ANB M82                  ; 原点復帰開始
MOV K47 D9510            ; U18原点復帰ｽﾃｯﾌﾟ
;<h1/>□_手動回路
LD M31                   ; 手動ﾓｰﾄﾞ
AND M32                  ; ﾒｲﾝ手動操作可能条件
ANB M9985                ; U18起動中
ANB M9984                ; U18原点復帰中
MC
;Pallet RB 位置移動
LD CR2002                ; 常時ON
AND M129                 ; 安全入力OK
AND L309                 ; Z_搬送高さ(P9)
LD X1354                 ; ST4_電特部_ﾜｰｸ押_下降端
ORB X184A                ; RB7_ST4_原点確定_HEND
ANL
AND M9603                ; RB7位置決めSub起動条件
ANB W07.3                ; 電気特性検査ｽﾃｰｼﾞ状態#4
OUT M9842                ; ST4_Pallet 待機位置条件
OUT M9843                ; ST4_Pallet ｺﾈｸﾀ挿入前条件
OUT M9844                ; ST4_Pallet ｺﾈｸﾀ接触位置条件
OUT M9845                ; ST4_Pallet ｺﾈｸﾀ接触後戻位置条件
LDB M9840                ; M_ST4_選択位置移動指令
MPS
LDP B12B0                ; ST4_Pallet 待機位置SW
AND M9842                ; ST4_Pallet 待機位置条件
ANL
MOV D9549 D9530          ; 待機位置指令Pos  RB7_指令Pos_NO.
MRD
LDP B12B1                ; ST4_Pallet ｺﾈｸﾀ挿入前SW
AND M9843                ; ST4_Pallet ｺﾈｸﾀ挿入前条件
ANL
MOV D9541 D9530          ; ｺﾈｸﾀ挿入開始位置指令Pos  RB7_指令Pos_NO.
MRD
LDP B12B2                ; ST4_Pallet ｺﾈｸﾀ接触位置SW
AND M9844                ; ST4_Pallet ｺﾈｸﾀ接触位置条件
ANL
MOV D9542 D9530          ; ｺﾈｸﾀ挿入押込み位置指令Pos  RB7_指令Pos_NO.
MPP
LDP B12B3                ; ST4_Pallet ｺﾈｸﾀ接触後戻り位置SW
AND M9845                ; ST4_Pallet ｺﾈｸﾀ接触後戻位置条件
ANL
MOV D9543 D9530          ; ｺﾈｸﾀ抜き位置Pos  RB7_指令Pos_NO.
LDP B12B0                ; ST4_Pallet 待機位置SW
AND M9842                ; ST4_Pallet 待機位置条件
LDP B12B1                ; ST4_Pallet ｺﾈｸﾀ挿入前SW
AND M9843                ; ST4_Pallet ｺﾈｸﾀ挿入前条件
ORL
LDP B12B2                ; ST4_Pallet ｺﾈｸﾀ接触位置SW
AND M9844                ; ST4_Pallet ｺﾈｸﾀ接触位置条件
ORL
LDP B12B3                ; ST4_Pallet ｺﾈｸﾀ接触後戻り位置SW
AND M9845                ; ST4_Pallet ｺﾈｸﾀ接触後戻位置条件
ORL
OR M9840                 ; M_ST4_選択位置移動指令
ANB M9841                ; M_ST4_選択位置移動完了
OUT M9840                ; M_ST4_選択位置移動指令
LD M9840                 ; M_ST4_選択位置移動指令
LD M9600                 ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
OR M9841                 ; M_ST4_選択位置移動完了
ANL
OUT M9841                ; M_ST4_選択位置移動完了
;　　ｸﾗﾝﾌﾟ上下
LD CR2002                ; 常時ON
AND M129                 ; 安全入力OK
LD M2732                 ; U2-3_RCX240起動条件
AND M2801                ; RCX240動作完了
LD M4732                 ; U6-3_RCX240起動条件
AND M4801                ; RCX240動作完了
ORL
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
OR M39                   ; ｴﾘｱｾﾝｻ-無視Mode
ANL
OUT M9804                ; ｸﾗﾝﾌﾟ開閉_閉_起動OK
LDP B12A2                ; ST4_Clamp下降TpSW
ORP M9822                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ閉指令
AND M9804                ; ｸﾗﾝﾌﾟ開閉_閉_起動OK
LD M9805                 ; ｸﾗﾝﾌﾟ開閉_閉_指令
ANB M9807                ; ｸﾗﾝﾌﾟ開閉_開__指令
ORL
OUT M9805                ; ｸﾗﾝﾌﾟ開閉_閉_指令
LD CR2002                ; 常時ON
ANB W07.3                ; 電気特性検査ｽﾃｰｼﾞ状態#4
LD M9621                 ; RB7_ﾜｰｸ受取り位置(ID確認位置)
OR M39                   ; ｴﾘｱｾﾝｻ-無視Mode
ANL
OUT M9806                ; ｸﾗﾝﾌﾟ開閉_開_起動OK
LDP B12A3                ; ST4_Clamp上昇TpSW
ORP M9834                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開指令
AND M9806                ; ｸﾗﾝﾌﾟ開閉_開_起動OK
LD M9807                 ; ｸﾗﾝﾌﾟ開閉_開__指令
ANB M9805                ; ｸﾗﾝﾌﾟ開閉_閉_指令
ORL
OUT M9807                ; ｸﾗﾝﾌﾟ開閉_開__指令
;ｸﾗﾝﾌﾟ閉→ﾊﾟﾚｯﾄ前進
LD M129                  ; 安全入力OK
LD M2732                 ; U2-3_RCX240起動条件
AND M2801                ; RCX240動作完了
AND L309                 ; Z_搬送高さ(P9)
LD M4732                 ; U6-3_RCX240起動条件
AND M4801                ; RCX240動作完了
AND L709                 ; Z_搬送高さ(P9)
ORL
ANL
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
OUT M9820                ; 電特ｸﾗﾝﾌﾟ&前進指令条件
LD M9813                 ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
ANP X0E                  ; ﾜｲﾔﾚｽSW1
ANB X0F                  ; ﾜｲﾔﾚｽSW2
AND M9804                ; ｸﾗﾝﾌﾟ開閉_閉_起動OK
AND M9820                ; 電特ｸﾗﾝﾌﾟ&前進指令条件
OR M9821                 ; 電特ｸﾗﾝﾌﾟ&前進開始
ANB M9828                ; ｸﾗﾝﾌﾟ閉→ﾊﾟﾚｯﾄ前進動作完了
ANB B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
ANB B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
AND M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
OUT M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
LD M9821                 ; 電特ｸﾗﾝﾌﾟ&前進開始
AND M9804                ; ｸﾗﾝﾌﾟ開閉_閉_起動OK
OR M9822                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ閉指令
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9822                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ閉指令
LD M9822                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ閉指令
AND T1802                ; ST4_電特部_ﾜｰｸ押_下降端
OR M9823                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ確認
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9823                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ確認
LD M9823                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ確認
AND M9603                ; RB7位置決めSub起動条件
OR M9824                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進指令
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9824                ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進指令
@MOV D9541 D9530         ; ｺﾈｸﾀ挿入開始位置指令Pos  RB7_指令Pos_NO.
LD M9824                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進指令
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9623                ; RB7_ｺﾈｸﾀ挿入開始位置
OR M9825                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進確認
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9825                ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進確認
LD M9825                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進確認
AND M9603                ; RB7位置決めSub起動条件
OR M9826                 ; RB7_ｺﾈｸﾀ挿入押込み位置移動指令
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9826                ; RB7_ｺﾈｸﾀ挿入押込み位置移動指令
@MOV D9542 D9530         ; ｺﾈｸﾀ挿入押込み位置指令Pos  RB7_指令Pos_NO.
LD M9826                 ; RB7_ｺﾈｸﾀ挿入押込み位置移動指令
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9624                ; RB7_ｺﾈｸﾀ挿入押込み位置
OR M9827                 ; RB7_ｺﾈｸﾀ挿入押込み位置移動完了
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9827                ; RB7_ｺﾈｸﾀ挿入押込み位置移動完了
LD M9827                 ; RB7_ｺﾈｸﾀ挿入押込み位置移動完了
ANB M9600                ; RB7位置決め指令
ANB M9601                ; RB7位置決め完了
OR M9828                 ; ｸﾗﾝﾌﾟ閉→ﾊﾟﾚｯﾄ前進動作完了
AND M9821                ; 電特ｸﾗﾝﾌﾟ&前進開始
OUT M9828                ; ｸﾗﾝﾌﾟ閉→ﾊﾟﾚｯﾄ前進動作完了
;ﾊﾟﾚｯﾄ後退→ｸﾗﾝﾌﾟ解除
LD M129                  ; 安全入力OK
LD M2732                 ; U2-3_RCX240起動条件
AND M2801                ; RCX240動作完了
AND L309                 ; Z_搬送高さ(P9)
LD M4732                 ; U6-3_RCX240起動条件
AND M4801                ; RCX240動作完了
AND L709                 ; Z_搬送高さ(P9)
ORL
ANL
OUT M9830                ; 電特ｸﾗﾝﾌﾟ解除&ﾊﾟﾚｯﾄ後退_指令条件
LD M9813                 ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
ANB X0E                  ; ﾜｲﾔﾚｽSW1
ANP X0F                  ; ﾜｲﾔﾚｽSW2
AND M9820                ; 電特ｸﾗﾝﾌﾟ&前進指令条件
AND M9830                ; 電特ｸﾗﾝﾌﾟ解除&ﾊﾟﾚｯﾄ後退_指令条件
OR M9831                 ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
ANB M9836                ; ﾊﾟﾚｯﾄ後退→ｸﾗﾝﾌﾟ開動作完了
ANB B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
ANB B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
AND M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
OUT M9831                ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
LD M9831                 ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
AND M9603                ; RB7位置決めSub起動条件
OR M9832                 ; 電特ﾊﾟﾚｯﾄ後退指令
AND M9831                ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
OUT M9832                ; 電特ﾊﾟﾚｯﾄ後退指令
@MOV D9549 D9530         ; 待機位置指令Pos  RB7_指令Pos_NO.
LD M9832                 ; 電特ﾊﾟﾚｯﾄ後退指令
AND M9600                ; RB7位置決め指令
AND M9601                ; RB7位置決め完了
AND M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
OR M9833                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ後退確認
AND M9831                ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
OUT M9833                ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ後退確認
LD M9833                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ後退確認
ANB M9600                ; RB7位置決め指令
ANB M9601                ; RB7位置決め完了
AND M9806                ; ｸﾗﾝﾌﾟ開閉_開_起動OK
OR M9834                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開指令
AND M9831                ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
OUT M9834                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開指令
LD M9834                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開指令
AND X1355                ; ST4_電特部_ﾜｰｸ押_上昇端
OR M9835                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開確認
AND M9831                ; 電特ﾊﾟﾚｯﾄ後退&ｸﾗﾝﾌﾟ解除開始
OUT M9835                ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開確認
LD M9835                 ; 電特ｸﾗﾝﾌﾟ&前進_ｸﾗﾝﾌﾟ開確認
OUT M9836                ; ﾊﾟﾚｯﾄ後退→ｸﾗﾝﾌﾟ開動作完了
MCR
LDP B12A6                ; ST4_SWBox_Pallet前後ﾓｰﾄﾞsw
ANB M9812                ; SwBoxMode_電特ﾊﾟﾚｯﾄ前後Flag
LDPB B12A6               ; ST4_SWBox_Pallet前後ﾓｰﾄﾞsw
AND M9812                ; SwBoxMode_電特ﾊﾟﾚｯﾄ前後Flag
ANB M6312                ; SwBoxMode_LeakﾁｬﾝﾊﾞｰFlag
ANB M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
ORL
AND= D50 K201            ; TpM-K_表示中ページNo.
AND M31                  ; 手動ﾓｰﾄﾞ
ANB M81                  ; 原点復帰動作中
AND M50                  ; 運転準備
OUT M9812                ; SwBoxMode_電特ﾊﾟﾚｯﾄ前後Flag
LDP B12A7                ; ST4_SWBox_Clamp&Palletﾓｰﾄﾞsw
ANB M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
LDPB B12A7               ; ST4_SWBox_Clamp&Palletﾓｰﾄﾞsw
AND M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
ANB M9812                ; SwBoxMode_電特ﾊﾟﾚｯﾄ前後Flag
ANB M6312                ; SwBoxMode_LeakﾁｬﾝﾊﾞｰFlag
ORL
AND= D50 K201            ; TpM-K_表示中ページNo.
AND M31                  ; 手動ﾓｰﾄﾞ
ANB M81                  ; 原点復帰動作中
AND M50                  ; 運転準備
OUT M9813                ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
;<h1/>□_RB7位置決めSub[M9600]
;__ロボット等機器入力受け
LD X184B                 ; RB7_ST4_位置決め完了_PEND
ORB Y284C                ; RB7_ST4_一時停止_*STP
AND X184A                ; RB7_ST4_原点確定_HEND
MPS
LDA X1840                ; RB7_ST4_完了Pos_PM1
CON
ANDA H00FF
CON
STA D9534                ; RB7_完了Pos
MRD
INV
MOV K0 D9534             ; RB7_完了Pos
MPP
AND<> D9534 K0           ; RB7_完了Pos
MPS
AND= D9534 K1            ; RB7_完了Pos
OUT M9621                ; RB7_ﾜｰｸ受取り位置(ID確認位置)
MRD
AND= D9540 D9534         ; ﾜｰｸ浮き確認位置指令Pos  RB7_完了Pos
OUT M9622                ; RB7_ﾜｰｸ浮き確認位置
MRD
AND= D9541 D9534         ; ｺﾈｸﾀ挿入開始位置指令Pos  RB7_完了Pos
OUT M9623                ; RB7_ｺﾈｸﾀ挿入開始位置
MRD
AND= D9542 D9534         ; ｺﾈｸﾀ挿入押込み位置指令Pos  RB7_完了Pos
OUT M9624                ; RB7_ｺﾈｸﾀ挿入押込み位置
MPP
AND= D9543 D9534         ; ｺﾈｸﾀ抜き位置Pos  RB7_完了Pos
OUT M9625                ; RB7_ｺﾈｸﾀ抜き位置
; POS NO.
LD CR2002                ; 常時ON
MOV K1 D9549             ; 待機位置指令Pos
;'RB3 POS MANUAL JIG SETTING
;IF D500 < K1 THEN
;   D500 = K1
;END IF
;D9540 = D500 + 10 		   '浮き確認位置
;D9541 = (D500 - K1)*3 + 51 'ｺﾈｸﾀ挿入開始
;D9542 = (D500 - K1)*3 + 52 'ｺﾈｸﾀ挿入完了位置
;D9543 = (D500 - K1)*3 + 53 'ｺﾈｸﾀ挿入完了位置
LD M31                   ; 手動ﾓｰﾄﾞ
NCJ K1000
;'RB3 POS MANUAL JIG SETTING
;
;IF D500 < K1 THEN
;
LD< D500 K1              ; 手動_JIG_NO.指定
NCJ K2000
;   D500 = K1
;
LD CR2002                ; 常時ON
MOV K1 D500              ; 手動_JIG_NO.指定
;END IF
;
LABEL K2000
;D9540 = D500 + 10 		   '浮き確認位置
;
LD CR2002                ; 常時ON
LDA D500                 ; 手動_JIG_NO.指定
CON
EXT
CON
ADD.L +10
CON
STA D9540                ; ﾜｰｸ浮き確認位置指令Pos
;D9541 = (D500 - K1)*3 + 51 'ｺﾈｸﾀ挿入開始
;
LD CR2002                ; 常時ON
LDA D500                 ; 手動_JIG_NO.指定
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +51
CON
STA D9541                ; ｺﾈｸﾀ挿入開始位置指令Pos
;D9542 = (D500 - K1)*3 + 52 'ｺﾈｸﾀ挿入完了位置
;
LD CR2002                ; 常時ON
LDA D500                 ; 手動_JIG_NO.指定
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +52
CON
STA D9542                ; ｺﾈｸﾀ挿入押込み位置指令Pos
;D9543 = (D500 - K1)*3 + 53 'ｺﾈｸﾀ挿入完了位置
LD CR2002                ; 常時ON
LDA D500                 ; 手動_JIG_NO.指定
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +53
CON
STA D9543                ; ｺﾈｸﾀ抜き位置Pos
LABEL K1000
;
;'RB3 POS AUTO JIG SETTING
;D9540 = D9713 + 10 			'浮き確認位置
;D9541 = (D9713 - K1)*3 + 51	'ｺﾈｸﾀ挿入開始
;D9542 = (D9713 - K1)*3 + 52 'ｺﾈｸﾀ挿入完了位置
;D9543 = (D9713 - K1)*3 + 53 'ｺﾈｸﾀ挿入完了位置
LD M30                   ; 自動ﾓｰﾄﾞ
NCJ K1001
;'RB3 POS AUTO JIG SETTING
;
;D9540 = D9713 + 10 			'浮き確認位置
;
LD CR2002                ; 常時ON
LDA D9713                ; Final_ST4_電特ﾊﾟﾚｯﾄID
CON
EXT
CON
ADD.L +10
CON
STA D9540                ; ﾜｰｸ浮き確認位置指令Pos
;D9541 = (D9713 - K1)*3 + 51	'ｺﾈｸﾀ挿入開始
;
LD CR2002                ; 常時ON
LDA D9713                ; Final_ST4_電特ﾊﾟﾚｯﾄID
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +51
CON
STA D9541                ; ｺﾈｸﾀ挿入開始位置指令Pos
;D9542 = (D9713 - K1)*3 + 52 'ｺﾈｸﾀ挿入完了位置
;
LD CR2002                ; 常時ON
LDA D9713                ; Final_ST4_電特ﾊﾟﾚｯﾄID
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +52
CON
STA D9542                ; ｺﾈｸﾀ挿入押込み位置指令Pos
;D9543 = (D9713 - K1)*3 + 53 'ｺﾈｸﾀ挿入完了位置
LD CR2002                ; 常時ON
LDA D9713                ; Final_ST4_電特ﾊﾟﾚｯﾄID
CON
EXT
CON
SUB.L +1
CON
MUL.L +3
CON
ADD.L +53
CON
STA D9543                ; ｺﾈｸﾀ抜き位置Pos
LABEL K1001
;
;	位置決めSub
LDB X1849                ; RB7_ST4_運転ﾓｰﾄﾞ_RMDS
LD X184A                 ; RB7_ST4_原点確定_HEND
OR CR2002                ; 常時ON
ANL
AND X184C                ; RB7_ST4_ｻｰﾎﾞ状態_SV
AND X184D                ; RB7_ST4_非常停止_*EMGS
AND X184E                ; RB7_ST4_ｱﾗｰﾑ_*ALM
OUT M9602                ; RB7_状態OK
LD M50                   ; 運転準備
ANB M51                  ; 即停止異常(緊急停止)
AND M9602                ; RB7_状態OK
ANB M9600                ; RB7位置決め指令
ANB M9601                ; RB7位置決め完了
ANB M9604                ; RB7位置決めSub起動中
OUT M9603                ; RB7位置決めSub起動条件
LDB M9512                ; U18-1_S12_
ANB M9514                ; U18-1_S14_ﾊﾟﾚｯﾄ前進指令
ANB M9519                ; U18-1_S19
ANB M9521                ; U18-1_S21_
ANB M9754                ; OrgS4
ANB M9840                ; M_ST4_選択位置移動指令
LDB M9824                ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進指令
OR M9825                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ前進確認
ANL
LDB M9826                ; RB7_ｺﾈｸﾀ挿入押込み位置移動指令
OR M9827                 ; RB7_ｺﾈｸﾀ挿入押込み位置移動完了
ANL
LDB M9832                ; 電特ﾊﾟﾚｯﾄ後退指令
OR M9833                 ; 電特ｸﾗﾝﾌﾟ&前進_ﾊﾟﾚｯﾄ後退確認
ANL
INV
LD M9603                 ; RB7位置決めSub起動条件
OR M9604                 ; RB7位置決めSub起動中
ANL
AND M50                  ; 運転準備
ANB M51                  ; 即停止異常(緊急停止)
AND X184D                ; RB7_ST4_非常停止_*EMGS
AND X184E                ; RB7_ST4_ｱﾗｰﾑ_*ALM
OUT M9600                ; RB7位置決め指令
LD M9600                 ; RB7位置決め指令
MC
LD M9600                 ; RB7位置決め指令
AND M9603                ; RB7位置決めSub起動条件
OR M9604                 ; RB7位置決めSub起動中
OUT M9604                ; RB7位置決めSub起動中
LD M9604                 ; RB7位置決めSub起動中
MPS
@MOV D9530 D9532         ; RB7_指令Pos_NO.  RB7_ｺﾝﾄﾛｰﾗへ指令Pos_NO.
MPP
AND Y284C                ; RB7_ST4_一時停止_*STP
TMH K1820 K5
LD T1820
OR M9605                 ; RB7位置決めｽﾀｰﾄ指令ON
AND Y284C                ; RB7_ST4_一時停止_*STP
OUT M9605                ; RB7位置決めｽﾀｰﾄ指令ON
LD M9605                 ; RB7位置決めｽﾀｰﾄ指令ON
AND Y284D                ; RB7_ST4_ｽﾀｰﾄ_CSTR
ANB X184B                ; RB7_ST4_位置決め完了_PEND
OR M9606                 ; RB7位置決め動作中
AND M124                 ; ｴﾘｱｾﾝｻ正常
OUT M9606                ; RB7位置決め動作中
LD M9606                 ; RB7位置決め動作中
ANB Y284D                ; RB7_ST4_ｽﾀｰﾄ_CSTR
AND X184B                ; RB7_ST4_位置決め完了_PEND
AND= D9530 D9534         ; RB7_指令Pos_NO.  RB7_完了Pos
OR M9607                 ; RB7位置決め完了
OUT M9607                ; RB7位置決め完了
LD M9607                 ; RB7位置決め完了
OUT M9601                ; RB7位置決め完了
MCR
;<h1/>□_出力回路
;ソレノイドバルブ出力
;<h1/>__RB動作出力
LD M9605                 ; RB7位置決めｽﾀｰﾄ指令ON
ANB M9606                ; RB7位置決め動作中
OUT Y284D                ; RB7_ST4_ｽﾀｰﾄ_CSTR
LD CR2002                ; 常時ON
MPS
AND D9532.0
OUT Y2840                ; RB7_ST4_指令pos_PC1
MRD
AND D9532.1
OUT Y2841                ; RB7_ST4_指令pos_PC2
MRD
AND D9532.2
OUT Y2842                ; RB7_ST4_指令pos_PC4
MRD
AND D9532.3
OUT Y2843                ; RB7_ST4_指令pos_PC8
MRD
AND D9532.4
OUT Y2844                ; RB7_ST4_指令pos_PC16
MRD
AND D9532.5
OUT Y2845                ; RB7_ST4_指令pos_PC32
MRD
AND D9532.6
OUT Y2846                ; RB7_ST4_指令pos_PC64
MPP
AND D9532.7
OUT Y2847                ; RB7_ST4_指令pos_PC128
LDP B12AF                ; ST4_RB_AUTO/MANU切替SW
ANB Y284A                ; RB7_ST4_運転ﾓｰﾄﾞ_RMOD
LDPB B12AF               ; ST4_RB_AUTO/MANU切替SW
AND Y284A                ; RB7_ST4_運転ﾓｰﾄﾞ_RMOD
ORL
AND M50                  ; 運転準備
ANB M71                  ; 自動運転開始BZ
ANB M82                  ; 原点復帰開始
AND<> D50 K1             ; TpM-K_表示中ページNo.
ANB B12A6                ; ST4_SWBox_Pallet前後ﾓｰﾄﾞsw
ANB B12A7                ; ST4_SWBox_Clamp&Palletﾓｰﾄﾞsw
OUT Y284A                ; RB7_ST4_運転ﾓｰﾄﾞ_RMOD
LD M9752                 ; OrgS2_ｽﾃｰｼﾞ戻り指令
AND M124                 ; ｴﾘｱｾﾝｻ正常
AND M9979                ; U18ｽﾃｯﾌﾟ動作
OUT Y284B                ; RB7_ST4_原点復帰_HOME
LD X06                   ; ST1-2部ﾗｲﾄｶｰﾃﾝOUT1
AND X0A                  ; ST1-2背面ﾗｲﾄｶｰﾃﾝOUT1
AND X06                  ; ST1-2部ﾗｲﾄｶｰﾃﾝOUT1
AND X07                  ; ST1-2部ﾗｲﾄｶｰﾃﾝOUT2
AND X08                  ; ST3-4部ﾗｲﾄｶｰﾃﾝOUT1
AND X09                  ; ST3-4部ﾗｲﾄｶｰﾃﾝOUT2
AND X0A                  ; ST1-2背面ﾗｲﾄｶｰﾃﾝOUT1
AND X0B                  ; ST1-2背面ﾗｲﾄｶｰﾃﾝOUT1
AND X0C                  ; ST3-4背面ﾗｲﾄｶｰﾃﾝOUT1
AND X0D                  ; ST3-4背面ﾗｲﾄｶｰﾃﾝOUT1
OR M39                   ; ｴﾘｱｾﾝｻ-無視Mode
AND M120                 ; 圧空正常
AND M121                 ; 非常停止正常
AND M123                 ; 安全扉正常
OUT Y284C                ; RB7_ST4_一時停止_*STP
LD M16                   ; ﾘｾｯﾄPB
ANB X184E                ; RB7_ST4_ｱﾗｰﾑ_*ALM
OUT Y284E                ; RB7_ST4_ﾘｾｯﾄ_RES
LD M50                   ; 運転準備
AND X184E                ; RB7_ST4_ｱﾗｰﾑ_*ALM
OUT Y284F                ; RB7_ST4_ｻｰﾎﾞON_SON
;<h1/>__I/O
;ｽﾃｰｼﾞ(ﾊﾟﾚｯﾄ前後)
LD M9805                 ; ｸﾗﾝﾌﾟ開閉_閉_指令
AND M9804                ; ｸﾗﾝﾌﾟ開閉_閉_起動OK
LD M1919                 ; U2-S419_電特部ｸﾗﾝﾌﾟ指令
LD M3223                 ; ﾊﾝﾄﾞ2_FinalST4給材中flg
OR M3222                 ; ﾊﾝﾄﾞ1_FinalST4給材中flg
ANL
ORL
LD M3919                 ; U6-S419_電特部ｸﾗﾝﾌﾟ指令
LD M5223                 ; Hand2_FinalST4給材中flg
OR M5222                 ; Hand1_FinalST4給材中flg
ANL
ORL
OR M9504                 ; U18-1_S4_ｸﾗﾝﾌﾟ指令
LD Y2686                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_下降
ANB Y2687                ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_上昇
ORL
AND M50                  ; 運転準備
OUT Y2686                ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_下降
LD M9807                 ; ｸﾗﾝﾌﾟ開閉_開__指令
AND M9806                ; ｸﾗﾝﾌﾟ開閉_開_起動OK
LDB M9756                ; OrgS6_
ANB M3289                ; ST4_電特部_ﾜｰｸ押_上昇指令
ANB M5289                ; ST4_電特部_ﾜｰｸ押_上昇指令
INV
ORL
LD Y2687                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_上昇
ANB Y2686                ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_下降
ORL
AND M50                  ; 運転準備
OUT Y2687                ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_上昇
;■その他制御出力
LD M9661                 ; U18-3_S1_Final検査ｽﾀｰﾄ要求
OUT W0107.3              ; 電気特性検査開始要求#4
LD L1800                 ; FINALST4_有効状態
OUT W0107.11             ; 電気特性検査ｽﾃｰｼﾞ有効/無効#4
LD L1800                 ; FINALST4_有効状態
ANB M9909                ; FainlST4_無効予約(自動運転)
LD M9909                 ; FainlST4_無効予約(自動運転)
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
LD M9916                 ; ST有効確認要求
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
ORL
OUT Y2258                ; ST4_電特_有効/無効表示
OUT B17AA                ; ST4_Final検査_有効/無効_Tpb
;□□　　パネル表示　　□□
LD Y2686                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_下降
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR X1354                 ; ST4_電特部_ﾜｰｸ押_下降端
OUT B17A2                ; ST4_Clamp下降TpPL
LD Y2687                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_上昇
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR X1355                 ; ST4_電特部_ﾜｰｸ押_上昇端
OUT B17A3                ; ST4_Clamp上昇TpPL
LD M9812                 ; SwBoxMode_電特ﾊﾟﾚｯﾄ前後Flag
OUT B17A6                ; ST4_PLBox_Pallet前後ﾓｰﾄﾞPL
LD M9813                 ; SwBoxMode_電特ｸﾗﾝﾌﾟ&ﾊﾟﾚｯﾄFlag
OUT B17A7                ; ST4_PLBox_Clamp&PalletﾓｰﾄﾞPL
LD= D9549 D9530          ; 待機位置指令Pos  RB7_指令Pos_NO.
AND M9600                ; RB7位置決め指令
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR M9621                 ; RB7_ﾜｰｸ受取り位置(ID確認位置)
OUT B17B0                ; ST4_Pallet 待機位置PL
LD= D9541 D9530          ; ｺﾈｸﾀ挿入開始位置指令Pos  RB7_指令Pos_NO.
AND M9600                ; RB7位置決め指令
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR M9623                 ; RB7_ｺﾈｸﾀ挿入開始位置
OUT B17B1                ; ST4_Pallet ｺﾈｸﾀ挿入前PL
LD= D9542 D9530          ; ｺﾈｸﾀ挿入押込み位置指令Pos  RB7_指令Pos_NO.
AND M9600                ; RB7位置決め指令
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR M9624                 ; RB7_ｺﾈｸﾀ挿入押込み位置
OUT B17B2                ; ST4_Pallet ｺﾈｸﾀ接触位置PL
LD= D9543 D9530          ; ｺﾈｸﾀ抜き位置Pos  RB7_指令Pos_NO.
AND M9600                ; RB7位置決め指令
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR M9625                 ; RB7_ｺﾈｸﾀ抜き位置
OUT B17B3                ; ST4_Pallet ｺﾈｸﾀ接触後戻り位置PL
;<h1/>□_異常検出
LD M50                   ; 運転準備
ANB X184E                ; RB7_ST4_ｱﾗｰﾑ_*ALM
LD CR2003                ; 常時OFF
ANB B0740                ; 608)LeakST4上治具上下CLS異常
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
ORL
MPS
AND T1890                ; CLSﾀｲﾑｱｳﾄ
OUT B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
MPP
TMR K1890 K50            ; CLSﾀｲﾑｱｳﾄ
LDP B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K1576 D13500         ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0740                 ; 608)LeakST4上治具上下CLS異常
AND B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
OUT B0740                ; 608)LeakST4上治具上下CLS異常
;　　
LD Y2686                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_下降
ANB X1354                ; ST4_電特部_ﾜｰｸ押_下降端
LD Y2687                 ; 電特ST4_ﾜｰｸｸﾗﾝﾌﾟ_上昇
ANB X1355                ; ST4_電特部_ﾜｰｸ押_上昇端
ORL
LD X1354                 ; ST4_電特部_ﾜｰｸ押_下降端
AND X1355                ; ST4_電特部_ﾜｰｸ押_上昇端
ORL
LD CR2003                ; 常時OFF
ANB B0741                ; 609)LeakST4ｺﾈｸﾀｼｰﾙ前後CLS異常
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
ORL
MPS
AND T1891                ; CLSﾀｲﾑｱｳﾄ
OUT B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
MPP
TMR K1891 K100           ; CLSﾀｲﾑｱｳﾄ
LDP B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K577 D13500          ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0741                 ; 609)LeakST4ｺﾈｸﾀｼｰﾙ前後CLS異常
AND B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
OUT B0741                ; 609)LeakST4ｺﾈｸﾀｼｰﾙ前後CLS異常
;
LD T1806                 ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_更新_DLY
AND L1800                ; FINALST4_有効状態
AND<> D9600 D9606        ; FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID  FinalST4_ｺﾝﾀｸﾄﾍｯﾄﾞID_Copy
LD CR2003                ; 常時OFF
ANB B0742                ; 610)LeakST4ﾜｰｸ浮き検出異常
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
ORL
OUT B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
LDP B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K1578 D13500         ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0742                 ; 610)LeakST4ﾜｰｸ浮き検出異常
AND B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
OUT B0742                ; 610)LeakST4ﾜｰｸ浮き検出異常
;
LD T1807                 ; FinalST4_ﾊﾟﾚｯﾄID_更新_DLY
AND L1800                ; FINALST4_有効状態
AND<> D9601 D9607        ; FinalST4_ﾊﾟﾚｯﾄID  FinalST4_ﾊﾟﾚｯﾄID_ｾﾝｻ状態
AND T1804                ; ST4_電特部_ﾊﾟﾚｯﾄ_後退端
LD CR2003                ; 常時OFF
ANB B0743                ; 611)LeakST4Leakﾃｽﾀ異常
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
ORL
OUT B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
LDP B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K1579 D13500         ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0743                 ; 611)LeakST4Leakﾃｽﾀ異常
AND B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
OUT B0743                ; 611)LeakST4Leakﾃｽﾀ異常
;
LD M9560                 ; U18-1_S60_FinalST4_ﾜｰｸ受取異常
LD CR2003                ; 常時OFF
ANB B0744                ; 612)LeakST4下治具位置決めcls異
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0244                ; 580)FinalST4ﾜｰｸ受取異常
ORL
OUT B0244                ; 580)FinalST4ﾜｰｸ受取異常
LDP B0244                ; 580)FinalST4ﾜｰｸ受取異常
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K1580 D13500         ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0744                 ; 612)LeakST4下治具位置決めcls異
AND B0244                ; 580)FinalST4ﾜｰｸ受取異常
OUT B0744                ; 612)LeakST4下治具位置決めcls異
;
LD M9930                 ; Final_ST4_ﾜｰｸ受渡し異常
LD CR2003                ; 常時OFF
ANB B0745                ; 613)LeakST4上治具ID不一致
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
ORL
OUT B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
LDP B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K1581 D13500         ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0745                 ; 613)LeakST4上治具ID不一致
AND B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
OUT B0745                ; 613)LeakST4上治具ID不一致
;　　
LD M9758                 ; OrgS8_ORGﾜｰｸ除去要求
LD M2020                 ; U2_S520_吸着ﾐｽ発報orﾜｰｸ除去要求
LD M3236                 ; ﾊﾝﾄﾞ1_FinalST4除材中flg
OR M3237                 ; ﾊﾝﾄﾞ2_FinalST4除材中flg
ANL
AND>= D1540 K2           ; 吸着ﾘﾄﾗｲ回数ｶｳﾝﾀ
ORL
LD CR2003                ; 常時OFF
ANB B0841                ; 833)BzStop
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0341                ; 833)FinalST4ﾜｰｸ除去要求
ORL
OUT B0341                ; 833)FinalST4ﾜｰｸ除去要求
LDP B0341                ; 833)FinalST4ﾜｰｸ除去要求
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K833 D13500          ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0841                 ; 833)BzStop
AND B0341                ; 833)FinalST4ﾜｰｸ除去要求
OUT B0841                ; 833)BzStop
;
LD W07.3                 ; 電気特性検査ｽﾃｰｼﾞ状態#4
AND M31                  ; 手動ﾓｰﾄﾞ
ANP M17                  ; 原点復帰PB
LD CR2003                ; 常時OFF
ANB B0842                ; 834)BzStop
ORB M111                 ; 異常ﾘｾｯﾄﾊﾟﾙｽ
AND B0342                ; 834)FinalST4検査中
ORL
OUT B0342                ; 834)FinalST4検査中
LDP B0342                ; 834)FinalST4検査中
AND< D13510 K64          ; FIFO_DATA_VALUE
MOV K818 D13500          ; ALM_WRITE_CODE(複合)
FIFOW D13500 D13510      ; ALM_WRITE_CODE(複合)  FIFO_DATA_VALUE
LD M110                  ; ﾌﾞｻﾞｰ停止ﾊﾟﾙｽ
OR B0842                 ; 834)BzStop
AND B0342                ; 834)FinalST4検査中
OUT B0842                ; 834)BzStop
;異常ﾌﾞｻﾞｰまとめ
LDB B0240                ; 576)FinalST4ｽﾃｰｼﾞ前後CL異常
OR B0740                 ; 608)LeakST4上治具上下CLS異常
LDB B0241                ; 577)FinalST4ｸﾗﾝﾌﾟ開閉CLS異常
OR B0741                 ; 609)LeakST4ｺﾈｸﾀｼｰﾙ前後CLS異常
ANL
LDB B0242                ; 578)FinalST4ﾃｽﾄﾍｯﾄﾞID不
OR B0742                 ; 610)LeakST4ﾜｰｸ浮き検出異常
ANL
LDB B0243                ; 579)FinalST4ﾊﾟﾚｯﾄID不一
OR B0743                 ; 611)LeakST4Leakﾃｽﾀ異常
ANL
LDB B0244                ; 580)FinalST4ﾜｰｸ受取異常
OR B0744                 ; 612)LeakST4下治具位置決めcls異
ANL
LDB B0245                ; 581)FinalST4ﾜｰｸ受渡し異常
OR B0745                 ; 613)LeakST4上治具ID不一致
ANL
LDB B0246                ; 582)
OR B0746                 ; 614)LeakST4下治具ID不一致
ANL
LDB B0247                ; 583)
OR B0747                 ; 615)LeakST4ﾜｰｸ受取異常
ANL
LDB B0248                ; 584)
OR B0748                 ; 616)LeakST4ﾜｰｸ受渡し異常
ANL
LDB B0249                ; 585)
OR B0749                 ; 617)LeakST4ﾜｰｸ検知OFF異常
ANL
LDB B024A                ; 586)
OR B074A                 ; 618)
ANL
LDB B024B                ; 587)
OR B074B                 ; 619)
ANL
LDB B024C                ; 588)
OR B074C                 ; 620)
ANL
LDB B024D                ; 589)
OR B074D                 ; 621)
ANL
LDB B024E                ; 590)
OR B074E                 ; 622)
ANL
LDB B024F                ; 591)
OR B074F                 ; 623)
ANL
LDB B0250                ; 592)
OR B0750                 ; 624)
ANL
LDB B0251                ; 593)
OR B0751                 ; 625)
ANL
LDB B0252                ; 594)
OR B0752                 ; 626)
ANL
LDB B0253                ; 595)
OR B0753                 ; 627)
ANL
LDB B0174                ; 372)
OR B0674                 ; 244)_Bz停止
ANL
LDB B0175                ; 373)
OR B0675                 ; 245)_Bz停止
ANL
LDB B0176                ; 374)
OR B0676                 ; 246)_Bz停止
ANL
LDB B0177                ; 375)
OR B0677                 ; 247)_Bz停止
ANL
LDB B0178                ; 376)
OR B0678                 ; 248)_Bz停止
ANL
LDB B0179                ; 377)
OR B0679                 ; 249)_Bz停止
ANL
LDB B017A                ; 378)
OR B067A                 ; 250)_Bz停止
ANL
LDB B017B                ; 379)
OR B067B                 ; 251)_Bz停止
ANL
LDB B017C                ; 380)
OR B067C                 ; 252)_Bz停止
ANL
LDB B017D                ; 381)
OR B067D                 ; 253)_Bz停止
ANL
LDB B017E                ; 382)
OR B067E                 ; 254)_Bz停止
ANL
LDB B017F                ; 383)
OR B067F                 ; 255)_Bz停止
ANL
LDB B0341                ; 833)FinalST4ﾜｰｸ除去要求
OR B0841                 ; 833)BzStop
ANL
LDB B0342                ; 834)FinalST4検査中
OR B0842                 ; 834)BzStop
ANL
INV
OUT M9989                ; U18異常BZ補助
END
ENDH
