DEVICE:53
;MODULE:AlwaysMonitor
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	AlwaysMonitor
;ModuleType	:	Sub Module
;Function	:	常時監視
;---------------------------------------
;<使用方法>
;常時監視が必要な物は本ﾓｼﾞｭｰﾙ内に記述して下さい
;・ﾋｰﾀｰ過昇温検知による非常停止
;・ﾁｬﾝﾊﾞｰ排気量低下によるｴﾗｰ出力
;など
;非常停止で出力RST
LD R46104                ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
OR CR2008                ; 運転開始時1ｽｷｬﾝON
ZRES B020 B03E           ; Press->Index AUTO  Press->Index 
;金型セット32列目モード(ﾃﾞﾊﾞｯｸﾞ)
LD CR2002                ; 常時ON
AND MR9915               ; ﾃﾞﾊﾞｯｸﾞ用(確認中)
AND CR2003               ; 常時OFF
DW #32 DM20013           ; 大々判ﾌﾟﾚｽｾｯﾄNo
;非常停止時ﾌﾟﾚｽ状況記憶
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4701                ; 裏面取出 ﾉｯｸｱｳﾄ上下 下降限
SET LR006                ; 金型内ｽﾍﾟｰｻ未除去
;ｸﾘｰﾝﾕﾆｯﾄ1ｱﾗｰﾑ
LDB R4000                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1 ALM1
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB @MR002
ANB @T1                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ1ﾀｲﾏ
TMR @1 #300              ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ1ﾀｲﾏ
CON
AND @T1                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ1ﾀｲﾏ
@SET R39004              ; ｴﾗｰ処理中
CON
SET MR9913               ; ﾎﾟｰｽﾞ要求
CON
DW #2 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R001               ; Always ERROR処理
LDB R4001                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1 ALM2
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB @MR002
ANB @T2                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ2ﾀｲﾏ
TMR @2 #300              ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ2ﾀｲﾏ
CON
AND @T2                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ1 ｱﾗｰﾑ2ﾀｲﾏ
@SET R39004              ; ｴﾗｰ処理中
CON
SET MR9913               ; ﾎﾟｰｽﾞ要求
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R001               ; Always ERROR処理
;ｸﾘｰﾝﾕﾆｯﾄ2ｱﾗｰﾑ
LDB R4002                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2 ALM1
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB @MR002
ANB @T3                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ1ﾀｲﾏ
TMR @3 #300              ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ1ﾀｲﾏ
CON
AND @T3                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ1ﾀｲﾏ
@SET R39004              ; ｴﾗｰ処理中
CON
SET MR9913               ; ﾎﾟｰｽﾞ要求
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R001               ; Always ERROR処理
LDB R4003                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2 ALM2
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB @MR002
ANB @T4                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ2ﾀｲﾏ
TMR @4 #300              ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ2ﾀｲﾏ
CON
AND @T4                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ2ﾀｲﾏ
@SET R39004              ; ｴﾗｰ処理中
CON
SET MR9913               ; ﾎﾟｰｽﾞ要求
CON
DW #5 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R001               ; Always ERROR処理
;元真空異常
LDB R4708                ; 元真空確認1OUT1
ORB R4710                ; 元真空確認2OUT1
ORB R4712                ; 元真空確認3OUT1
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB @MR002
ANB @T4                  ; ｴｱｸﾘｰﾝﾕﾆｯﾄ2 ｱﾗｰﾑ2ﾀｲﾏ
TMR @7 #10
CON
AND @T7
@SET R39004              ; ｴﾗｰ処理中
CON
SET MR9913               ; ﾎﾟｰｽﾞ要求
CON
DW #8 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R001               ; Always ERROR処理
;ｴﾗｰSTG
STG @R001                ; Always ERROR処理
JMP @MR002
STG @MR002
AND @MR101               ; Always ERROR完了
AND @MR105               ; SW1
RES @MR105               ; SW1
CON
RES @MR101               ; Always ERROR完了
CON
RES R39004               ; ｴﾗｰ処理中
CON
ENDS
;ｶﾊﾞｰ開時RB位置監視
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
DW #0 DM20050            ; RB現在値記憶不一致
;DM20050 = 0
;DM20040.L=DM10500.L 'RB1現在値保存
;DM20042.L=DM10508.L 'RB2現在値保存
;DM20044.L=DM10516.L 'RB3現在値保存
;DM20046.L=DM10524.L 'RB4現在値保存
;DM20048.L=DM10532.L 'RB5現在値保存
LDF R007                 ; 安全ｶﾊﾞｰ(ON閉)
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR CR2008                ; 運転開始時1ｽｷｬﾝON
SET MR10009              ; RB記憶確認中
CON
NCJ #1005
;DM20050 = 0
;
LD CR2002                ; 常時ON
MOV #0 DM20050           ; RB現在値記憶不一致
;DM20040.L=DM10500.L 'RB1現在値保存
;
LD CR2002                ; 常時ON
MOV.L DM10500 DM20040    ; RB1 現在位置(下位)  RB1現在値記憶
;DM20042.L=DM10508.L 'RB2現在値保存
;
LD CR2002                ; 常時ON
MOV.L DM10508 DM20042    ; RB2 現在位置(下位)  RB2現在値記憶
;DM20044.L=DM10516.L 'RB3現在値保存
;
LD CR2002                ; 常時ON
MOV.L DM10516 DM20044    ; RB3 現在位置(下位)  RB3現在値記憶
;DM20046.L=DM10524.L 'RB4現在値保存
;
LD CR2002                ; 常時ON
MOV.L DM10524 DM20046    ; RB4 現在位置(下位)  RB4現在値記憶
;DM20048.L=DM10532.L 'RB5現在値保存
LD CR2002                ; 常時ON
MOV.L DM10532 DM20048    ; RB5 現在位置(下位)  RB5現在値記憶
LABEL #1005
;
;'RB1現在値比較
;IF DM20040.L<>0 AND DM20040.L+20<DM10500.L OR DM20040.L-20>DM10500.L  THEN
;  BSET(CR2002,DM20050,1)
;ELSE
;  BRES(CR2002,DM20050,1)
;END IF
;
;'RB2現在値比較
;IF DM20042.L<>0 AND DM20042.L+10<DM10508.L OR DM20042.L-10>DM10508.L THEN
; BSET(CR2002,DM20050,2)
;ELSE
; BRES(CR2002,DM20050,2)
;END IF
;
;'RB3現在値比較
;IF DM20044.L<>0 AND DM20044.L+10<DM10516.L OR DM20044.L-10>DM10516.L THEN
; BSET(CR2002,DM20050,3)
;ELSE
; BRES(CR2002,DM20050,3)
;END IF
;
;'RB4現在値比較 
;IF DM20046.L<>0 AND DM20046.L+10<DM10524.L OR DM20046.L-10>DM10524.L THEN
; BSET(CR2002,DM20050,4)
;ELSE
; BRES(CR2002,DM20050,4)
;END IF
;
;'RB5現在値比較 
;IF DM20048.L<>0 AND DM20048.L+10<DM10532.L OR DM20048.L-10>DM10532.L THEN 
; BSET(CR2002,DM20050,5)
;ELSE
; BRES(CR2002,DM20050,5)
;END IF
;
;RES(CR2002,MR10009)
LDP R007                 ; 安全ｶﾊﾞｰ(ON閉)
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
NCJ #1006
;'RB1現在値比較
;
;IF DM20040.L<>0 AND DM20040.L+20<DM10500.L OR DM20040.L-20>DM10500.L  THEN
;
LD<>.L DM20040 +0        ; RB1現在値記憶
OUT @VB00
LD CR2002                ; 常時ON
LDA.L DM20040            ; RB1現在値記憶
CON
ADD.L +20
CON
CMP.L DM10500            ; RB1 現在位置(下位)
LD CR2009                ; 演算結果が負
AND @VB00
OUT @VB01
LD CR2002                ; 常時ON
LDA.L DM20040            ; RB1現在値記憶
CON
SUB.L +20
CON
CMP.L DM10500            ; RB1 現在位置(下位)
LD CR2011                ; 演算結果が正
OR @VB01
NCJ #2000
;  BSET(CR2002,DM20050,1)
;
LD CR2002                ; 常時ON
BSET DM20050 #1          ; RB現在値記憶不一致
;ELSE
;
LD CR2002                ; 常時ON
CJ #2001
LABEL #2000
;  BRES(CR2002,DM20050,1)
;
LD CR2002                ; 常時ON
BRES DM20050 #1          ; RB現在値記憶不一致
;END IF
;
LABEL #2001
;'RB2現在値比較
;
;IF DM20042.L<>0 AND DM20042.L+10<DM10508.L OR DM20042.L-10>DM10508.L THEN
;
LD<>.L DM20042 +0        ; RB2現在値記憶
OUT @VB02
LD CR2002                ; 常時ON
LDA.L DM20042            ; RB2現在値記憶
CON
ADD.L +10
CON
CMP.L DM10508            ; RB2 現在位置(下位)
LD CR2009                ; 演算結果が負
AND @VB02
OUT @VB03
LD CR2002                ; 常時ON
LDA.L DM20042            ; RB2現在値記憶
CON
SUB.L +10
CON
CMP.L DM10508            ; RB2 現在位置(下位)
LD CR2011                ; 演算結果が正
OR @VB03
NCJ #2002
; BSET(CR2002,DM20050,2)
;
LD CR2002                ; 常時ON
BSET DM20050 #2          ; RB現在値記憶不一致
;ELSE
;
LD CR2002                ; 常時ON
CJ #2003
LABEL #2002
; BRES(CR2002,DM20050,2)
;
LD CR2002                ; 常時ON
BRES DM20050 #2          ; RB現在値記憶不一致
;END IF
;
LABEL #2003
;'RB3現在値比較
;
;IF DM20044.L<>0 AND DM20044.L+10<DM10516.L OR DM20044.L-10>DM10516.L THEN
;
LD<>.L DM20044 +0        ; RB3現在値記憶
OUT @VB04
LD CR2002                ; 常時ON
LDA.L DM20044            ; RB3現在値記憶
CON
ADD.L +10
CON
CMP.L DM10516            ; RB3 現在位置(下位)
LD CR2009                ; 演算結果が負
AND @VB04
OUT @VB05
LD CR2002                ; 常時ON
LDA.L DM20044            ; RB3現在値記憶
CON
SUB.L +10
CON
CMP.L DM10516            ; RB3 現在位置(下位)
LD CR2011                ; 演算結果が正
OR @VB05
NCJ #2004
; BSET(CR2002,DM20050,3)
;
LD CR2002                ; 常時ON
BSET DM20050 #3          ; RB現在値記憶不一致
;ELSE
;
LD CR2002                ; 常時ON
CJ #2005
LABEL #2004
; BRES(CR2002,DM20050,3)
;
LD CR2002                ; 常時ON
BRES DM20050 #3          ; RB現在値記憶不一致
;END IF
;
LABEL #2005
;'RB4現在値比較 
;
;IF DM20046.L<>0 AND DM20046.L+10<DM10524.L OR DM20046.L-10>DM10524.L THEN
;
LD<>.L DM20046 +0        ; RB4現在値記憶
OUT @VB06
LD CR2002                ; 常時ON
LDA.L DM20046            ; RB4現在値記憶
CON
ADD.L +10
CON
CMP.L DM10524            ; RB4 現在位置(下位)
LD CR2009                ; 演算結果が負
AND @VB06
OUT @VB07
LD CR2002                ; 常時ON
LDA.L DM20046            ; RB4現在値記憶
CON
SUB.L +10
CON
CMP.L DM10524            ; RB4 現在位置(下位)
LD CR2011                ; 演算結果が正
OR @VB07
NCJ #2006
; BSET(CR2002,DM20050,4)
;
LD CR2002                ; 常時ON
BSET DM20050 #4          ; RB現在値記憶不一致
;ELSE
;
LD CR2002                ; 常時ON
CJ #2007
LABEL #2006
; BRES(CR2002,DM20050,4)
;
LD CR2002                ; 常時ON
BRES DM20050 #4          ; RB現在値記憶不一致
;END IF
;
LABEL #2007
;'RB5現在値比較 
;
;IF DM20048.L<>0 AND DM20048.L+10<DM10532.L OR DM20048.L-10>DM10532.L THEN 
;
LD<>.L DM20048 +0        ; RB5現在値記憶
OUT @VB08
LD CR2002                ; 常時ON
LDA.L DM20048            ; RB5現在値記憶
CON
ADD.L +10
CON
CMP.L DM10532            ; RB5 現在位置(下位)
LD CR2009                ; 演算結果が負
AND @VB08
OUT @VB09
LD CR2002                ; 常時ON
LDA.L DM20048            ; RB5現在値記憶
CON
SUB.L +10
CON
CMP.L DM10532            ; RB5 現在位置(下位)
LD CR2011                ; 演算結果が正
OR @VB09
NCJ #2008
; BSET(CR2002,DM20050,5)
;
LD CR2002                ; 常時ON
BSET DM20050 #5          ; RB現在値記憶不一致
;ELSE
;
LD CR2002                ; 常時ON
CJ #2009
LABEL #2008
; BRES(CR2002,DM20050,5)
;
LD CR2002                ; 常時ON
BRES DM20050 #5          ; RB現在値記憶不一致
;END IF
;
LABEL #2009
;RES(CR2002,MR10009)
LD CR2002                ; 常時ON
RES MR10009              ; RB記憶確認中
LABEL #1006
;
LD<> #0 DM20050          ; RB現在値記憶不一致
ANB MR10007              ; RB位置記憶不一致中
SET MR10007              ; RB位置記憶不一致中
LD MR10007               ; RB位置記憶不一致中
ANB @R003
ANB @MR004
ANB R39004               ; ｴﾗｰ処理中
ANB MR10006              ; 確認画面表示ｴﾗｰ
ANB @MR002
@SET R39004              ; ｴﾗｰ処理中
CON
DW #7 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #9000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Always ERROR
CON
@SET @R003
;ｴﾗｰSTG
STG @R003
JMP @MR004
STG @MR004
AND @MR101               ; Always ERROR完了
RES MR10007              ; RB位置記憶不一致中
CON
AND @MR105               ; SW1
DW #0 DM20050            ; RB現在値記憶不一致
CON
SET MR10013              ; 強制終了/要再原点復帰
CON
RES @MR105               ; SW1
CON
RES @MR101               ; Always ERROR完了
CON
RES R39004               ; ｴﾗｰ処理中
CON
ENDS
;<h1/>MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Always ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #0 @DM0
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102
CON
SET @MR101               ; Always ERROR完了
CON
ENDS
;<h1/>BBS_MSG　装置メッセージ３行
;
;
;BBS_MSG表示位置ﾙｰﾌﾟ
;@DM19 = @DM19 + 1
;IF @DM19 > 3 THEN
;	@DM19 = 1
;END IF
LD CR2002                ; 常時ON
NCJ #1000
;@DM19 = @DM19 + 1
;
LD CR2002                ; 常時ON
LDA @DM19                ; BBS_MSG_Line
CON
EXT
CON
ADD.L +1
CON
STA @DM19                ; BBS_MSG_Line
;IF @DM19 > 3 THEN
;
LD> @DM19 #3             ; BBS_MSG_Line
NCJ #2010
;	@DM19 = 1
;
LD CR2002                ; 常時ON
MOV #1 @DM19             ; BBS_MSG_Line
;END IF
LABEL #2010
LABEL #1000
;
LD CR2008                ; 運転開始時1ｽｷｬﾝON
ZRES @DM20 @DM29         ; BBS_MSG_TEXT
;Line1
;隣接ｾﾙPAUSE警告
LD= @DM19 #1             ; BBS_MSG_Line
AND B05                  ; Index->Press ﾎﾟｰｽﾞ要求
OUT @MR200               ; BBS_MSG_Line1
;'文字表示半角19文字以内
;'点滅させたい時は @MR005 をSETする
;RES (@MR204)
;@DM20.T = "次工程 PAUSE中！"
;SET (@MR204)
LD= @DM19 #1             ; BBS_MSG_Line
AND B05                  ; Index->Press ﾎﾟｰｽﾞ要求
NCJ #1001
;'文字表示半角19文字以内
;
;'点滅させたい時は @MR005 をSETする
;
;RES (@MR204)
;
LD CR2002                ; 常時ON
RES @MR204               ; BBS_MSG_BLINK_Line1
;@DM20.T = "次工程 PAUSE中！"
;
LD CR2002                ; 常時ON
SMOV "次工程 PAUSE中！" @DM20 ; BBS_MSG_TEXT
;SET (@MR204)
LD CR2002                ; 常時ON
SET @MR204               ; BBS_MSG_BLINK_Line1
LABEL #1001
;
;Line2
;動作ﾊﾟﾗﾒｰﾀ変更中
LD= @DM19 #2             ; BBS_MSG_Line
AND<> DM2000 #0          ; _動作ﾊﾟﾗﾒｰﾀ
OUT @MR201               ; BBS_MSG_Line2
;'文字表示半角19文字以内
;'点滅させたい時は @MR005 をSETする
;RES (@MR205)
;@DM20.T = "動作ﾊﾟﾗﾒｰﾀ変更中！"
;SET (@MR205)
LD= @DM19 #2             ; BBS_MSG_Line
AND<> DM2000 #0          ; _動作ﾊﾟﾗﾒｰﾀ
NCJ #1002
;'文字表示半角19文字以内
;
;'点滅させたい時は @MR005 をSETする
;
;RES (@MR205)
;
LD CR2002                ; 常時ON
RES @MR205               ; BBS_MSG_BLINK_Line2
;@DM20.T = "動作ﾊﾟﾗﾒｰﾀ変更中！"
;
LD CR2002                ; 常時ON
SMOV "動作ﾊﾟﾗﾒｰﾀ変更中！" @DM20; BBS_MSG_TEXT
;SET (@MR205)
LD CR2002                ; 常時ON
SET @MR205               ; BBS_MSG_BLINK_Line2
LABEL #1002
;
;Line3
;隣接ｾﾙPAUSE待ち
LD= @DM19 #3             ; BBS_MSG_Line
ANB MR17701              ; 動作ﾊﾟﾗﾒｰﾀ1_Index装置無し
AND B025                 ; Press->Index ﾎﾟｰｽﾞ要求
ANB B06                  ; Index->Press ﾎﾟｰｽﾞ許可
OUT @MR202               ; BBS_MSG_Line3
;'文字表示半角19文字以内
;'点滅させたい時は @MR005 をSETする
;RES (@MR206)
;@DM20.T = "隣接ｾﾙPAUSE待ち"
;SET (@MR206)
LD= @DM19 #3             ; BBS_MSG_Line
ANB MR17701              ; 動作ﾊﾟﾗﾒｰﾀ1_Index装置無し
AND B025                 ; Press->Index ﾎﾟｰｽﾞ要求
ANB B06                  ; Index->Press ﾎﾟｰｽﾞ許可
NCJ #1003
;'文字表示半角19文字以内
;
;'点滅させたい時は @MR005 をSETする
;
;RES (@MR206)
;
LD CR2002                ; 常時ON
RES @MR206               ; BBS_MSG_BLINK_Line3
;@DM20.T = "隣接ｾﾙPAUSE待ち"
;
LD CR2002                ; 常時ON
SMOV "隣接ｾﾙPAUSE待ち" @DM20 ; BBS_MSG_TEXT
;SET (@MR206)
LD CR2002                ; 常時ON
SET @MR206               ; BBS_MSG_BLINK_Line3
LABEL #1003
;
;BBS_MSG表示
LD CR2002                ; 常時ON
LD= @DM19 #1             ; BBS_MSG_Line
AND @MR200               ; BBS_MSG_Line1
LDB @MR204               ; BBS_MSG_BLINK_Line1
LD @MR204                ; BBS_MSG_BLINK_Line1
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
ANL
LD= @DM19 #2             ; BBS_MSG_Line
AND @MR201               ; BBS_MSG_Line2
LDB @MR205               ; BBS_MSG_BLINK_Line2
LD @MR205                ; BBS_MSG_BLINK_Line2
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
ANL
ORL
LD= @DM19 #3             ; BBS_MSG_Line
AND @MR202               ; BBS_MSG_Line3
LDB @MR206               ; BBS_MSG_BLINK_Line3
LD @MR206                ; BBS_MSG_BLINK_Line3
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
ANL
ORL
ANL
MSTRT BBS_MSG_W #1 @DM19 @DM20;BBS_MSG_Line  BBS_MSG_TEXT
INV
OUT @MR203               ; BBS_MSG_Del
;BBS_MSG表示ｸﾘｱ
LD @MR203                ; BBS_MSG_Del
MSTRT BBS_MSG_C #1 @DM19 ; BBS_MSG_Line
;<h1/>MSG	0-31　警告表示
;DM60051	Bz_Use	#0=No/#1=Yes
;DM60052	R_Lamp	#0=On/#1=Off
;MSG_DISP	0
LD CR2003                ; 常時OFF
MPS
LDB LR16100              ; TP_MSG_Busy
BANB.D DM9016 #0         ; _MSG_DISP1表示状態
ANL
DW #0 DM60050            ; ScreenNo /MSG_DISP
CON
DW #1 DM60051            ; Bz_Use /MSG_DISP
CON
DW #1 DM60052            ; R_Lamp_ON /MSG_DISP
CON
SET LR16101              ; TP_MSG_Start
MPP
INV
AND LR16100              ; TP_MSG_Busy
AND LR16101              ; TP_MSG_Start
ANB LR16102              ; TP_MSG_END
BAND.D DM9016 #0         ; _MSG_DISP1表示状態
AND= DM60050 #0          ; ScreenNo /MSG_DISP
RES LR16101              ; TP_MSG_Start
;WARNING_DISP	1
;ﾊﾞｯｸｱｯﾌﾟ電池異常
LD CR2003                ; 常時OFF
AND CR2306               ; ﾊﾞｯｸｱｯﾌﾟ電池異常
MPS
LDB LR16105              ; TP_Warn_Busy
BANB.D DM9000 #1         ; _WARNING1表示状態
ANL
DW #1 DM60055            ; ScreenNo /WARNING_DISP
CON
DW #0 DM60056            ; Bz_Use /WARNING_DISP
CON
DW #1 DM60057            ; R_Lamp_ON /WARNING_DISP
CON
SET LR16106              ; TP_Warn_Start
MPP
INV
AND LR16105              ; TP_Warn_Busy
AND LR16106              ; TP_Warn_Start
ANB LR16107              ; TP_Warn_END
BAND.D DM9000 #1         ; _WARNING1表示状態
AND= DM60055 #1          ; ScreenNo /WARNING_DISP
RES LR16106              ; TP_Warn_Start
;MSG_DISP	31
LD CR2003                ; 常時OFF
MPS
LDB LR16100              ; TP_MSG_Busy
BANB.D DM9016 #31        ; _MSG_DISP1表示状態
ANL
DW #31 DM60050           ; ScreenNo /MSG_DISP
CON
DW #1 DM60051            ; Bz_Use /MSG_DISP
CON
DW #1 DM60052            ; R_Lamp_ON /MSG_DISP
CON
SET LR16101              ; TP_MSG_Start
MPP
INV
AND LR16100              ; TP_MSG_Busy
AND LR16101              ; TP_MSG_Start
ANB LR16102              ; TP_MSG_END
BAND.D DM9016 #31        ; _MSG_DISP1表示状態
AND= DM60050 #31         ; ScreenNo /MSG_DISP
RES LR16101              ; TP_MSG_Start
;優先ｴﾗｰ元圧検出
LDB R006                 ; 元圧検出
ANB CR2008               ; 運転開始時1ｽｷｬﾝON
AND CR2003               ; 常時OFF
MSTRT F_ERROR_DISP #1
;優先ｴﾗｰ元真空圧検出
LDB R4708                ; 元真空確認1OUT1
ORB R4710                ; 元真空確認2OUT1
ORB R4712                ; 元真空確認3OUT1
AND R3805                ; ｵﾝﾗｲﾝ状態
ANB CR2008               ; 運転開始時1ｽｷｬﾝON
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
AND CR2003               ; 常時OFF
MSTRT F_ERROR_DISP #2
;RB1ｱﾌﾞｿﾊﾞｯﾃﾘｴﾗｰ
;RB1 ﾏｶﾞｼﾞﾝ上下 ｲﾝﾀｰﾛｯｸ
LDB R4600                ; ﾏｶﾞｼﾞﾝﾌﾟｯｼｬ 位置決め側限
AND R4601                ; ﾏｶﾞｼﾞﾝﾌﾟｯｼｬ ﾏｶﾞｼﾞﾝ側限
ANB DM20050.1
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND DM10507.4            ; RB1ｻｰﾎﾞ
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
ANB MR10007              ; RB位置記憶不一致中
ANB MR10009              ; RB記憶確認中
OUT MR3000               ; RB1 起動IL ON=起動可能
;RB2 大々判搬送X ｲﾝﾀｰﾛｯｸ
;ﾀｰｹﾞｯﾄﾎﾟｼﾞｼｮﾝ
;1待機 2中間位置決め 3打ち抜き後捨て 4金型進入直前 
;11～42金型ｾｯﾄ1～32
;100原点
LD>= EM1302 #1           ; RB2 Target Pos
AND<= EM1302 #4          ; RB2 Target Pos
AND MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
LD>= EM1302 #11          ; RB2 Target Pos
AND<= EM1302 #42         ; RB2 Target Pos
AND MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
ANB R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4703                ; 金型ﾌﾟﾚｽ上下 上昇限
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
LDB MR22500              ; ｸﾘｰﾆﾝｸﾞﾛｰﾗﾌﾘｰ中
OR CR2002                ; 常時ON
ANL
ORL
LD= EM1302 #100          ; RB2 Target Pos
AND MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
ORL
ANB DM20050.2
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND DM10515.4            ; RB2ｻｰﾎﾞ
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
ANB MR10007              ; RB位置記憶不一致中
ANB MR10009              ; RB記憶確認中
OUT MR3001               ; RB2 起動IL ON=起動可能
;RB3 大々判搬送Z ｲﾝﾀｰﾛｯｸ
;ﾀｰｹﾞｯﾄﾎﾟｼﾞｼｮﾝ
;1待機 2金型搬送高さ 3中間位置決め直前 4中間位置決め 5金型ｾｯﾄ直前
;6打ち抜き後捨て
;11～42金型ｾｯﾄ1～32
;100原点
;IF em1303>=11 and em1303<=42 THEN
;@DM1=em1303 MOD 2
;'除算を行い、その剰余を返します
;IF @DM1=1 THEN
;SET (CR2002,@MR504)
;RES (CR2002,@MR505)
;'奇数の場合
;ELSE 
;RES (CR2002,@MR504)
;SET (CR2002,@MR505)
;'偶数の場合
;END IF
;
;ELSE
;'金型受渡し位置以外
;RES (CR2002,@MR504)
;RES (CR2002,@MR505)
;END IF
LD CR2002                ; 常時ON
NCJ #1004
;IF em1303>=11 and em1303<=42 THEN
;
LD>= EM1303 #11          ; RB2現在地Pos
OUT @VB0A
LD<= EM1303 #42          ; RB2現在地Pos
AND @VB0A
NCJ #2011
;@DM1=em1303 MOD 2
;
LD CR2002                ; 常時ON
LDA EM1303               ; RB2現在地Pos
CON
EXT
CON
EXT.L
CON
DIV.L +2
CON
LDA.L TM2
CON
STA @DM1                 ; ErrorNo /ERROR_DISP
;'除算を行い、その剰余を返します
;
;IF @DM1=1 THEN
;
LD= @DM1 #1              ; ErrorNo /ERROR_DISP
NCJ #2012
;SET (CR2002,@MR504)
;
LD CR2002                ; 常時ON
SET @MR504               ; 大々判ﾌﾟﾚｽｾｯﾄNo=奇数
;RES (CR2002,@MR505)
;
LD CR2002                ; 常時ON
RES @MR505               ; 大々判ﾌﾟﾚｽｾｯﾄNo=偶数
;'奇数の場合
;
;ELSE 
;
LD CR2002                ; 常時ON
CJ #2013
LABEL #2012
;RES (CR2002,@MR504)
;
LD CR2002                ; 常時ON
RES @MR504               ; 大々判ﾌﾟﾚｽｾｯﾄNo=奇数
;SET (CR2002,@MR505)
;
LD CR2002                ; 常時ON
SET @MR505               ; 大々判ﾌﾟﾚｽｾｯﾄNo=偶数
;'偶数の場合
;
;END IF
;
LABEL #2013
;ELSE
;
LD CR2002                ; 常時ON
CJ #2014
LABEL #2011
;'金型受渡し位置以外
;
;RES (CR2002,@MR504)
;
LD CR2002                ; 常時ON
RES @MR504               ; 大々判ﾌﾟﾚｽｾｯﾄNo=奇数
;RES (CR2002,@MR505)
;
LD CR2002                ; 常時ON
RES @MR505               ; 大々判ﾌﾟﾚｽｾｯﾄNo=偶数
;END IF
LABEL #2014
LABEL #1004
;
LD= EM1304 #1            ; RB3 Target Pos
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
OR= EM1304 #2            ; RB3 Target Pos
OR= EM1304 #7            ; RB3 Target Pos
LD= EM1304 #3            ; RB3 Target Pos
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
LD= EM1304 #4            ; RB3 Target Pos
ANB R4610                ; 大々判受け搬送 ﾏｶﾞｼﾞﾝ側限
AND R4611                ; 大々判受け搬送 金型側限
ORL
AND R4606                ; 大々判ﾋﾟｯﾁ変換 後退限(手前)
ANB R4607                ; 大々判ﾋﾟｯﾁ変換 前進限(奥)
ORL
LD= EM1304 #6            ; RB3 Target Pos
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
ORL
LD= EM1304 #5            ; RB3 Target Pos
LD>= EM1304 #11          ; RB3 Target Pos
AND<= EM1304 #42         ; RB3 Target Pos
ORL
LD @MR504                ; 大々判ﾌﾟﾚｽｾｯﾄNo=奇数
ANB R4606                ; 大々判ﾋﾟｯﾁ変換 後退限(手前)
AND R4607                ; 大々判ﾋﾟｯﾁ変換 前進限(奥)
LD @MR505                ; 大々判ﾌﾟﾚｽｾｯﾄNo=偶数
AND R4606                ; 大々判ﾋﾟｯﾁ変換 後退限(手前)
ANB R4607                ; 大々判ﾋﾟｯﾁ変換 前進限(奥)
ORL
ANL
AND R4610                ; 大々判受け搬送 ﾏｶﾞｼﾞﾝ側限
ANB R4611                ; 大々判受け搬送 金型側限
ORL
LD= EM1304 #100          ; RB3 Target Pos
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
ORL
ANB DM20050.3
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND DM10523.4            ; RB3ｻｰﾎﾞ
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
ANB MR10007              ; RB位置記憶不一致中
ANB MR10009              ; RB記憶確認中
OUT MR3002               ; RB3 起動IL ON=起動可能
;RB4 ﾌﾟﾚｽｸﾘｰﾆﾝｸﾞ移動 ｲﾝﾀｰﾛｯｸ
LDB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
LD R4614                 ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
ANB R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ORL
ANB MR21610              ; MC 軸1動作中
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
AND DM10531.4            ; RB4ｻｰﾎﾞ
ANB DM20050.4
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB MR10007              ; RB位置記憶不一致中
ANB MR10009              ; RB記憶確認中
OUT MR3003               ; RB4 起動IL ON=起動可能
;RB5 画像検査 ｲﾝﾀｰﾛｯｸ
LD B04                   ; Index->Press IL ｽｶﾗZ退避ON
OR= EM1308 #1            ; RB5 Target Pos
OR MR17701               ; 動作ﾊﾟﾗﾒｰﾀ1_Index装置無し
ANB DM20050.5
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND DM10539.4            ; RB5ｻｰﾎﾞ
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
ANB MR10007              ; RB位置記憶不一致中
ANB B09                  ; Index->Press ｽﾍﾟｰｻ取出開始
ANB MR10009              ; RB記憶確認中
OUT MR3004               ; RB5 起動IL ON=起動可能
;DRV1 ﾌﾟﾚｽｸﾘｰﾆﾝｸﾞﾓｰﾀ ｲﾝﾀｰﾛｯｸ
LDB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
LD R4614                 ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
ANB R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ORL
ANB DM10531.2            ; RB4移動中
ANB MR21115              ; MC 軸1ｴﾗｰ検出
ANB R2003                ; DRV-1(M1)FREE (励磁OFFﾌﾞﾚｰｷ開放)
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R24513               ; 軸1 ｻｰﾎﾞﾚﾃﾞｨ
AND R22800               ; 動作可能
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
AND R24513               ; 軸1 ｻｰﾎﾞﾚﾃﾞｨ
ANB MR10009              ; RB記憶確認中
OUT MR3005               ; DRV1 起動IL ON=起動可能
;DRV2 裏面取出ﾓｰﾀ ｲﾝﾀｰﾛｯｸ
LDB R4700                ; 裏面取出 ﾉｯｸｱｳﾄ上下 上昇限
AND R4701                ; 裏面取出 ﾉｯｸｱｳﾄ上下 下降限
ANB R7414                ; 裏面取出ﾉｯｸｱｳﾄ上下 上昇
ANB MR21315              ; MC 軸2ｴﾗｰ検出
ANB R2007                ; DRV-2(M2)FREE (励磁OFFﾌﾞﾚｰｷ開放)
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R25313               ; 軸2 ｻｰﾎﾞﾚﾃﾞｨ
AND R22800               ; 動作可能
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
AND R25313               ; 軸2 ｻｰﾎﾞﾚﾃﾞｨ
ANB MR10009              ; RB記憶確認中
OUT MR3006               ; DRV2 起動IL ON=起動可能
;ﾌﾟﾚｽ下降ｲﾝﾀｰﾛｯｸ
LD R4612                 ; 金型ﾌﾟﾚｽ落下防止 開放
ANB R4613                ; 金型ﾌﾟﾚｽ落下防止 固定
AND R007                 ; 安全ｶﾊﾞｰ(ON閉)
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
ANB R4507                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ有無確認 (L-ON)
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
TMR @5 #10
CON
AND @T5
OUT MR3200               ; ﾌﾟﾚｽ下降ｲﾝﾀｰﾛｯｸ
LD R007                  ; 安全ｶﾊﾞｰ(ON閉)
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ANB MR17211              ; RB2ｴﾘｱ1(金型進入範囲)
ANB R4507                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ有無確認 (L-ON)
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
TMR @6 #10
CON
AND @T6
OUT MR3201               ; ﾌﾟﾚｽ下降開放ｲﾝﾀｰﾛｯｸ
;ﾒﾝﾃ1_ﾏｶﾞｼﾞﾝ交換条件
LDB R4600                ; ﾏｶﾞｼﾞﾝﾌﾟｯｼｬ 位置決め側限
AND R4601                ; ﾏｶﾞｼﾞﾝﾌﾟｯｼｬ ﾏｶﾞｼﾞﾝ側限
AND DM10507.4            ; RB1ｻｰﾎﾞ
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT MR3007               ; ﾒﾝﾃ動作1 起動IL ON=起動可能
;ﾒﾝﾃ2_大々判ｾｯﾄ中間位置決め条件
LD MR3007                ; ﾒﾝﾃ動作1 起動IL ON=起動可能
AND MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
OUT MR3008               ; ﾒﾝﾃ動作2 起動IL ON=起動可能
;ﾒﾝﾃ3_大々判取出し条件
LD MR17411               ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
AND DM10515.4            ; RB2ｻｰﾎﾞ
AND DM10523.4            ; RB3ｻｰﾎﾞ
AND<=.L DM10508 +17000   ; RB2 現在位置(下位)
OUT MR3009               ; ﾒﾝﾃ動作3 起動IL ON=起動可能
;ﾒﾝﾃ4_大々判廃棄条件
LD MR17411               ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
AND<=.L DM10508 +17000   ; RB2 現在位置(下位)
OR MR17401               ; RB3_Pos#2
AND DM10515.4            ; RB2ｻｰﾎﾞ
AND DM10523.4            ; RB3ｻｰﾎﾞ
OUT MR3010               ; ﾒﾝﾃ動作4 起動IL ON=起動可能
;ﾒﾝﾃ5_大々判金型ｾｯﾄ条件
LD MR17411               ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
AND DM10515.4            ; RB2ｻｰﾎﾞ
AND DM10523.4            ; RB3ｻｰﾎﾞ
AND<=.L DM10508 +17000   ; RB2 現在位置(下位)
ANB R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4703                ; 金型ﾌﾟﾚｽ上下 上昇限
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
AND R4610                ; 大々判受け搬送 ﾏｶﾞｼﾞﾝ側限
ANB R4611                ; 大々判受け搬送 金型側限
OUT MR3011               ; ﾒﾝﾃ動作5 起動IL ON=起動可能
;ﾒﾝﾃ6_大々判ﾌﾟﾚｽ条件
LD<=.L DM10508 +17000    ; RB2 現在位置(下位)
ANB R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4703                ; 金型ﾌﾟﾚｽ上下 上昇限
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
AND MR20802              ; MC 軸2原点復帰完了記憶
OUT MR3012               ; ﾒﾝﾃ動作6 起動IL ON=起動可能
;ﾒﾝﾃ7_ｸﾘｰﾆﾝｸﾞ条件
LD<=.L DM10508 +17000    ; RB2 現在位置(下位)
ANB R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4703                ; 金型ﾌﾟﾚｽ上下 上昇限
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ANB R4612                ; 金型ﾌﾟﾚｽ落下防止 開放
AND R4613                ; 金型ﾌﾟﾚｽ落下防止 固定
AND MR21109              ; MC 軸1原点復帰完了記憶
OUT MR3013               ; ﾒﾝﾃ動作7 起動IL ON=起動可能
;ﾒﾝﾃ8_大々判取出し(金型)条件
LD<=.L DM10508 +17000    ; RB2 現在位置(下位)
AND MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
OR MR17401               ; RB3_Pos#2
ANB R4702                ; 金型ﾌﾟﾚｽ上下 下降限
AND R4703                ; 金型ﾌﾟﾚｽ上下 上昇限
ANB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
AND R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
ANB R4612                ; 金型ﾌﾟﾚｽ落下防止 開放
AND R4613                ; 金型ﾌﾟﾚｽ落下防止 固定
OUT MR3014               ; ﾒﾝﾃ動作8 起動IL ON=起動可能
;ﾒﾝﾃ9_画像検査条件
LD B04                   ; Index->Press IL ｽｶﾗZ退避ON
OR MR17701               ; 動作ﾊﾟﾗﾒｰﾀ1_Index装置無し
OUT MR3015               ; ﾒﾝﾃ動作9 起動IL ON=起動可能
;RB1ﾏｶﾞｼﾞﾝFERROR
;①ﾌﾟｯｼｬが位置決め側にある(ｾﾝｻON)
;②ﾌﾟｯｼｬが位置決め側にある(ﾊﾞﾙﾌﾞON)
;③中間位置決めがﾏｶﾞｼﾞﾝ側にあるとき干渉域まで上昇
LD R4600                 ; ﾏｶﾞｼﾞﾝﾌﾟｯｼｬ 位置決め側限
OR R7400                 ; ﾏｶﾞｼﾞﾝ ﾌﾟｯｼｬ 位置決め側(ON)
LD>=.L DM10500 +25000    ; RB1 現在位置(下位)
AND R4610                ; 大々判受け搬送 ﾏｶﾞｼﾞﾝ側限
ANB R4611                ; 大々判受け搬送 金型側限
ORL
AND DM10507.2            ; RB1移動中
MSTRT F_ERROR_DISP #3
;RB2大々判搬送X軸FERROR
;①RB3搬送Z移動中
;②RB3搬送Zが金型搬送高さ以外(金型進入時)
;③RB3搬送Zのﾊﾟｽﾗｲﾝ外
LD DM10523.2             ; RB3移動中
LDB MR17401              ; RB3_Pos#2
AND>=.L DM10508 +17000   ; RB2 現在位置(下位)
ORL
ORB MR17411              ; RB3ｴﾘｱ1(ﾊﾟｽﾗｲﾝ)
AND DM10515.2            ; RB2移動中
MSTRT F_ERROR_DISP #4
;RB3大々判搬送Z軸FERROR
;①RB2搬送X移動中
;②金型進入時に制限高さ以上になる
LD DM10515.2             ; RB2移動中
LD>=.L DM10508 +17000    ; RB2 現在位置(下位)
AND<=.L DM10516 +1800    ; RB3 現在位置(下位)
ORL
AND DM10523.2            ; RB3移動中
MSTRT F_ERROR_DISP #5
;RB4ｸﾘｰﾆﾝｸﾞﾛｰﾗ移動FERROR
;①ｸﾘｰﾆﾝｸﾞﾛｰﾗが前限、後限のどちらにもない
;②ｸﾘｰﾆﾝｸﾞﾛｰﾗｰが回転中
LDB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
ANB R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
OR MR21610               ; MC 軸1動作中
AND DM10531.2            ; RB4移動中
ANB MR10003              ; ｸﾘｰﾆﾝｸﾞﾛｰﾗｰSW表示
MSTRT F_ERROR_DISP #6
;RB5ｶﾒﾗ移動FERROR
;①隣ｾﾙのｽｶﾗが進入中(通常時)
;②ｽｶﾗの進入許可を立てているのに移動した
LDB B04                  ; Index->Press IL ｽｶﾗZ退避ON
AND CR2003               ; 常時OFF
OR B024                  ; Press->Index IL 進入許可
OR B09                   ; Index->Press ｽﾍﾟｰｻ取出開始
ANB MR17701              ; 動作ﾊﾟﾗﾒｰﾀ1_Index装置無し
AND DM10539.2            ; RB5移動中
AND<> EM1308 #100        ; RB5 Target Pos
AND<> EM1308 #1          ; RB5 Target Pos
MSTRT F_ERROR_DISP #7
;MC1ｸﾘｰﾆﾝｸﾞﾛｰﾗ回転FERROR
;①ｸﾘｰﾆﾝｸﾞﾛｰﾗが前限、後限のどちらにもない
;②RB4ﾛｰﾗｰ移動が移動中
LDB R4614                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 前進限
ANB R4615                ; ｸﾘｰﾆﾝｸﾞﾛｰﾗ前後 後退限
OR DM10531.2             ; RB4移動中
AND MR21610              ; MC 軸1動作中
MSTRT F_ERROR_DISP #8
;MC2裏面取出しFERROR
;①ﾉｯｸｱｳﾄが下降していない(ｾﾝｻOFF) 
;②ﾉｯｸｱｳﾄが下降していない(ﾊﾞﾙﾌﾞOFF)
LD R4700                 ; 裏面取出 ﾉｯｸｱｳﾄ上下 上昇限
ORB R4701                ; 裏面取出 ﾉｯｸｱｳﾄ上下 下降限
AND MR21910              ; MC 軸2動作中
MSTRT F_ERROR_DISP #9
;金型ﾌﾟﾚｽFERROR
;①ｶﾊﾞｰ開中にﾌﾟﾚｽが下降
;②ﾌﾟﾚｽ下降ｲﾝﾀｰﾛｯｸ中にﾌﾟﾚｽ下降
LDB R007                 ; 安全ｶﾊﾞｰ(ON閉)
ORB MR3200               ; ﾌﾟﾚｽ下降ｲﾝﾀｰﾛｯｸ
ANP MR7308               ; 金型ﾌﾟﾚｽ上下 下降(ON)
MSTRT F_ERROR_DISP #10
;金型ﾌﾟﾚｽ落下防止開放FERROR
;①ｶﾊﾞｰ開中にﾌﾟﾚｽ落下防止が開放
;②ﾌﾟﾚｽ落下防止開放ｲﾝﾀｰﾛｯｸ中にﾌﾟﾚｽ落下防止が開放
LDB R007                 ; 安全ｶﾊﾞｰ(ON閉)
ORB MR3201               ; ﾌﾟﾚｽ下降開放ｲﾝﾀｰﾛｯｸ
ANP MR7410               ; 金型ﾌﾟﾚｽ落下防止 開放(ON)
MSTRT F_ERROR_DISP #11
END
ENDH
