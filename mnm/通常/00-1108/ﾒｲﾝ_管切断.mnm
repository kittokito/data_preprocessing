DEVICE:51
;MODULE:ﾒｲﾝ_管切断
;MODULE_TYPE:0
;非常停止
LD R50010                ; 非常停止
ORB R1203                ; 装置電源ON
LDB R22008               ; 定寸切断中
AND R49900               ; 非常停止2
ORL
LD R22008                ; 定寸切断中
AND R49900               ; 非常停止2
AND R49901               ; 切断完了
ORL
OR @MR001                ; 001
ZRES @MR002 @MR2915      ; 管切断部 AUTO完了
CON
RES MR3504               ; ｶｯﾀｰｶﾑ回転
CON
ZRES MR2605 MR2607       ; 生地管回転ﾓｰﾀ　回転  ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
OUT @MR001               ; 001
TMR @0 #5                ; Wait timer00
LD @T0                   ; Wait timer00
MDSTOP ﾒｲﾝ_管切断
;PP搬送動作可能条件
;
LD T1103                 ; 生地管搬送ﾁｬｯｸ上下_上昇行補助Ｔ
ANB T1102                ; 生地管搬送ﾁｬｯｸ上下_下降行補助Ｔ
ANB T1114                ; 生地管ｸﾗﾝﾌﾟ1_下降限補助Ｔ
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
ANB T1200                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下限補助T
AND T1201                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上限補助T
ANB T1400                ; 切断側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
OUT @MR005               ; PP搬送動作可能条件
;生地管搬送PP部へ給材要求条件
;
LDB T1114                ; 生地管ｸﾗﾝﾌﾟ1_下降限補助Ｔ
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
ANB T1200                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下限補助T
AND T1201                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上限補助T
ANB T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
AND T1109                ; 終端側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
ANB T1400                ; 切断側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
OUT @MR006               ; 生地管搬送PP部へ給材要求条件
;HOME：装置原点復帰ﾒｲﾝ
;
LD R50003                ; 原点復帰
ANB R50200               ; ﾒｲﾝ_切断部 Do
SET R50215               ; 原点復帰中
CON
SET R50200               ; ﾒｲﾝ_切断部 Do
CON
SET @MR1100              ; 装置原点復帰開始
LDB R50003               ; 原点復帰
ANB R50001               ; 自動運転中
AND @MR1015              ; 装置 原点復帰完了
RES R50200               ; ﾒｲﾝ_切断部 Do
CON
RES @MR1015              ; 装置 原点復帰完了
CON
RES R50215               ; 原点復帰中
;原点復帰開始
;
STG @MR1100              ; 装置原点復帰開始
ANB R50008               ; 全体ERROR
LDA #0
CON
STA DM6040               ; 切断回数表示
CON
SET R50300               ; ﾃﾞｰﾀｾｯﾄ要求
CON
ZRES MR2510 MR2513       ; ｸﾞﾚｰｼﾞﾝｸﾞ_焼ｴｱｰﾌﾞﾛｰ1  ｸﾞﾚｰｼﾞﾝｸﾞ_焼ｴｱｰﾌﾞﾛｰ4
CON
TMR #95 #1
CON
AND T95
JMP @MR1200
STG @MR1200
ANB R50008               ; 全体ERROR
RES MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
SET MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
RES MR2412               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下降行
CON
SET MR2413               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上昇行
CON
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
AND T1201                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上限補助T
RES R50300               ; ﾃﾞｰﾀｾｯﾄ要求
CON
RES MR2404               ; 生地管搬送ﾁｬｯｸ開閉_開行
CON
SET MR2405               ; 生地管搬送ﾁｬｯｸ開閉_閉行
CON
RES MR2506               ; 切断除材ﾁｬｯｸ開閉_開行
CON
SET MR2507               ; 切断除材ﾁｬｯｸ開閉_閉行
CON
JMP @MR1201
STG @MR1201
ANB R50008               ; 全体ERROR
RES MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
RES MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
JMP @MR1202
STG @MR1202
ANB R50008               ; 全体ERROR
MPS
ANB T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
RES MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
JMP @MR1203
MPP
AND T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
RES MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
JMP @MR1203
STG @MR1203
SET MR502                ; ｻｰﾎﾞ　ｻｰﾎﾞON
CON
TMR #390 #1
CON
AND T390
@SET @MR1500             ; ｻｰﾎﾞ原点復帰要求
CON
AND CR3004               ; X軸原点復帰動作中
JMP @MR1204
STG @MR1204
RES @MR1500              ; ｻｰﾎﾞ原点復帰要求
CON
AND CR3005               ; X軸原点復帰完了
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR1205
STG @MR1205
ANB R50008               ; 全体ERROR
SET @MR2500              ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
CON
RES MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
AND T1109                ; 終端側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
TMR #460 #5
CON
AND T460
JMP @MR1206
STG @MR1206
ANB R50008               ; 全体ERROR
RES MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
JMP @MR1300
STG @MR1300
ANB R50008               ; 全体ERROR
RES MR2402               ; 生地管搬送ﾁｬｯｸ上下_下降行
CON
SET MR2403               ; 生地管搬送ﾁｬｯｸ上下_上昇行
CON
AND T1103                ; 生地管搬送ﾁｬｯｸ上下_上昇行補助Ｔ
JMP @MR1301
STG @MR1301
ANB R50008               ; 全体ERROR
AND @MR005               ; PP搬送動作可能条件
RES MR2400               ; 生地管搬送_定寸送り側行
CON
SET MR2401               ; 生地管搬送_ﾎｯﾊﾟｰ側行
CON
AND T1101                ; 生地管搬送_ﾎｯﾊﾟｰ側限補助Ｔ
JMP @MR1302
STG @MR1302
ANB R50008               ; 全体ERROR
RES MR2408               ; 給材ｻﾎﾟｰﾄ_上昇行
CON
SET MR2409               ; 給材ｻﾎﾟｰﾄ_下降行
CON
AND T1113                ; 給材ｻﾎﾟｰﾄ（反給材側）_下降限補助
AND T1111                ; 給材ｻﾎﾟｰﾄ（給材側）_下降限補助Ｔ
JMP @MR1304
STG @MR1304
ANB R50008               ; 全体ERROR
RES MR2500               ; 初端落下補助_上昇行
CON
SET MR2501               ; 初端落下補助_下降行
CON
AND T1405                ; 初端落下補助（排出側）_下限補助
AND T1403                ; 初端落下補助（供給側）_下限補助
JMP @MR1305
STG @MR1305
ANB R50008               ; 全体ERROR
RES MR2504               ; 切断除材ﾁｬｯｸ上下_下降行
CON
SET MR2505               ; 切断除材ﾁｬｯｸ上下_上昇行
CON
AND T1413                ; 切断除材ﾁｬｯｸ上下_上昇限補助Ｔ
JMP @MR1306
STG @MR1306
ANB R50008               ; 全体ERROR
MPS
AND R1513                ; 除材横搬送RB　位置決め完2
JMP @MR1308
MPP
LDB R1513                ; 除材横搬送RB　位置決め完2
AND R1511                ; 除材横搬送RB　READY
ANL
SET MR2713               ; 除材横搬送RB　駆動指令2
CON
RES MR2712               ; 除材横搬送RB　駆動指令1
CON
RES MR2714               ; 除材横搬送RB　駆動指令3
CON
JMP @MR1307
STG @MR1307
ANB R1511                ; 除材横搬送RB　READY
ZRES MR2712 MR2714       ; 除材横搬送RB　駆動指令1  除材横搬送RB　駆動指令3
CON
JMP @MR1308
STG @MR1308
ANB R50008               ; 全体ERROR
AND R1511                ; 除材横搬送RB　READY
AND R1513                ; 除材横搬送RB　位置決め完2
RES MR2508               ; 切断除材ﾋﾟｯﾁ変換_閉行
CON
SET MR2509               ; 切断除材ﾋﾟｯﾁ変換_開行
CON
AND T1415                ; 切断除材ﾋﾟｯﾁ変換_開限補助Ｔ
JMP @MR1309
STG @MR1309
ANB CR3006               ; X軸位置決め完了ﾘﾚｰ
@SET @MR1501             ; ﾎﾟｲﾝﾄ0　移動要求
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR1310
STG @MR1310
RES @MR1501              ; ﾎﾟｲﾝﾄ0　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR1311
STG @MR1311
ANB R50008               ; 全体ERROR
MPS
AND<=.D CM2020 #78000    ; X軸現在位置
RES MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
AND T1109                ; 終端側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
JMP @MR1312
MPP
AND>.D CM2020 #78000     ; X軸現在位置
RES MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
JMP @MR1312
STG @MR1312
MPS
AND LR110                ; ﾁｬｯｸ確認する？
SET @MR100               ; 生地管、切断管有無確認要求
CON
JMP @MR1313
MPP
ANB LR110                ; ﾁｬｯｸ確認する？
JMP @MR1314
STG @MR1313
AND @MR107               ; ｴﾗｰ05　解除
RES @MR107               ; ｴﾗｰ05　解除
CON
JMP @MR1314
STG @MR1314
AND @MR2502              ; ｶｯﾀｰｶﾑ一回転停止完了
JMP @MR1315
STG @MR1315
RES MR2405               ; 生地管搬送ﾁｬｯｸ開閉_閉行
CON
SET MR2404               ; 生地管搬送ﾁｬｯｸ開閉_開行
CON
RES MR2507               ; 切断除材ﾁｬｯｸ開閉_閉行
CON
SET MR2506               ; 切断除材ﾁｬｯｸ開閉_開行
CON
ZRES MR2600 MR2601       ; ﾎｯﾊﾟﾓｰﾀ　CW回転  ﾎｯﾊﾟﾓｰﾀ　解除入力
CON
ZRES MR2603 MR2609       ; 生地管搬送ﾓｰﾀ　回転  ｸﾞﾚｰｼﾞﾝｸﾞﾓｰﾀ　回転
CON
SET R50410               ; ﾒｲﾝ_切断部   1ｻｲｸﾙ終了
CON
RES @MR2502              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
SET @MR1015              ; 装置 原点復帰完了
CON
ENDS
;AUTO：自動運転帰ﾒｲﾝ
;
LD R50001                ; 自動運転中
ANB R50200               ; ﾒｲﾝ_切断部 Do
SET R50200               ; ﾒｲﾝ_切断部 Do
CON
SET @MR2000              ; 管切断部自動運転開始
LDB R50003               ; 原点復帰
ANB R50001               ; 自動運転中
ANB R50002               ; 手動　MODE
AND @MR2915              ; 管切断部 AUTO完了
RES R50200               ; ﾒｲﾝ_切断部 Do
CON
RES @MR2915              ; 管切断部 AUTO完了
;自動運転開始
;
STG @MR2000              ; 管切断部自動運転開始
ANB R50008               ; 全体ERROR
AND R50209               ; 動作開始
MPS
AND @MR2900              ; 2回目以降動作
JMP @MR2001              ; 2001
MPP
ANB @MR2900              ; 2回目以降動作
JMP @MR2901              ; 初回のみ動作
STG @MR2901              ; 初回のみ動作
SET @MR2900              ; 2回目以降動作
CON
MPS
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2902
MRD
MDSTRT 生地管搬送PP部
MRD
MDSTRT 切断管排出PP部
MRD
MDSTRT 切断管搬送CV
MPP
MDSTRT 投入CV部
STG @MR2902
TMR #220 #1
CON
AND T220
RES R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
SET R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
SET MR2606               ; ｶｯﾀｰ刃回転ﾓｰﾀ　回転
CON
@SET @MR2503             ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
CON
SET MR2000               ; 投入CV部動作要求
CON
SET MR2001               ; 生地管搬送PP部動作要求
CON
SET MR2002               ; 切断管排出PP部動作要求
CON
SET MR2003               ; 切断管搬送CV動作要求
CON
LDA #0
CON
STA DM6040               ; 切断回数表示
CON
JMP @MR2001              ; 2001
;　通常動作　（2回目以降）はここから
STG @MR2001              ; 2001
ANB R50008               ; 全体ERROR
RES MR2409               ; 給材ｻﾎﾟｰﾄ_下降行
CON
SET MR2408               ; 給材ｻﾎﾟｰﾄ_上昇行
CON
AND T1110                ; 給材ｻﾎﾟｰﾄ（給材側）_上昇限補助Ｔ
AND T1112                ; 給材ｻﾎﾟｰﾄ（反給材側）_上昇限補助
AND @MR006               ; 生地管搬送PP部へ給材要求条件
SET MR9504               ; 生地管切断部より給材要求
CON
JMP @MR2002
STG @MR2002
MPS
AND MR9505               ; 生地管搬送動作中
JMP @MR2003
MPP
LDB MR9505               ; 生地管搬送動作中
AND MR1303               ; 生地管搬送PP停止完了
ANL
SET MR1400               ; 切断部停止完了
CON
JMP @MR2010
STG @MR2010
AND R50000               ; HOLD
JMP @MR2908              ; 終了処理
STG @MR2003
ANB MR9505               ; 生地管搬送動作中
AND MR9506               ; 生地管　切断部給材完了
RES R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
SET R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
RES MR9506               ; 生地管　切断部給材完了
CON
JMP @MR2100
STG @MR2100
ANB R50008               ; 全体ERROR
RES MR2413               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上昇行
CON
SET MR2412               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下降行
CON
RES MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1200                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下限補助T
AND T1108                ; 終端側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
JMP @MR2101
STG @MR2101
ANB R50008               ; 全体ERROR
SET MR2605               ; 生地管回転ﾓｰﾀ　回転
CON
TMR #3 #9999             ; 生地管回転ﾓｰﾀ回転後ｳｪｲﾄ
CON
AND T3                   ; 生地管回転ﾓｰﾀ回転後ｳｪｲﾄ
JMP @MR2102
STG @MR2102
RES R22005               ; 20mm切断中
CON
SET R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
JMP @MR2103
STG @MR2103
@SET @MR2800             ; ﾎﾟｲﾝﾄ1　移動要求
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2104
STG @MR2104
RES @MR2800              ; ﾎﾟｲﾝﾄ1　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2105
STG @MR2105
RES MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
SET MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
RES MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1114                ; 生地管ｸﾗﾝﾌﾟ1_下降限補助Ｔ
AND T1400                ; 切断側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
ANB MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2106
STG @MR2106
@SET @MR2503             ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
CON
SET R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
JMP @MR2107
STG @MR2107
LDA #0
CON
STA DM6040               ; 切断回数表示
CON
JMP @MR2108
STG @MR2108
AND @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
MPS
ANB R49900               ; 非常停止2
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2109
MPP
AND R49900               ; 非常停止2
SET R49901               ; 切断完了
CON
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
ENDS
STG @MR2109
MPS
ANB R58000               ; ONで立合い用ﾀﾞﾐｰ運転
RES MR2501               ; 初端落下補助_下降行
CON
SET MR2500               ; 初端落下補助_上昇行
CON
AND T1402                ; 初端落下補助（供給側）_上限補助
JMP @MR2110
MPP
AND R58000               ; ONで立合い用ﾀﾞﾐｰ運転
JMP @MR2113
STG @MR2110
RES MR2500               ; 初端落下補助_上昇行
CON
SET MR2501               ; 初端落下補助_下降行
CON
AND T1403                ; 初端落下補助（供給側）_下限補助
JMP @MR2111
STG @MR2111
MPS
ANB T1406                ; ｶｯﾄ不良検出補助Ｔ
JMP @MR2113
MPP
AND T1406                ; ｶｯﾄ不良検出補助Ｔ
RES MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
SET @MR108               ; 切断不良
CON
JMP @MR2112
STG @MR2112
AND @MR115               ; ｴﾗｰ10　解除
RES @MR115               ; ｴﾗｰ10　解除
CON
JMP @MR2300
STG @MR2300
MPS
ANB T1406                ; ｶｯﾄ不良検出補助Ｔ
JMP @MR2113
MPP
AND T1406                ; ｶｯﾄ不良検出補助Ｔ
SET MR3510               ; ｶｯﾄ不良ﾜｰｸ有り
CON
JMP @MR2113
STG @MR2113
ANB R50008               ; 全体ERROR
RES MR2500               ; 初端落下補助_上昇行
CON
SET MR2501               ; 初端落下補助_下降行
CON
RES MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
SET MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
RES MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
AND T1403                ; 初端落下補助（供給側）_下限補助
JMP @MR2200
STG @MR2200
MPS
AND<=.D CM2020 #78000    ; X軸現在位置
JMP @MR2202
MPP
AND>.D CM2020 #78000     ; X軸現在位置
RES MR2408               ; 給材ｻﾎﾟｰﾄ_上昇行
CON
SET MR2409               ; 給材ｻﾎﾟｰﾄ_下降行
CON
RES MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
SET MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
RES MR2412               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下降行
CON
SET MR2413               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上昇行
CON
JMP @MR2201
STG @MR2201
AND T1111                ; 給材ｻﾎﾟｰﾄ（給材側）_下降限補助Ｔ
AND T1113                ; 給材ｻﾎﾟｰﾄ（反給材側）_下降限補助
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
AND T1201                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上限補助T
JMP @MR2202
STG @MR2202
RES R22005               ; 20mm切断中
CON
SET R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
JMP @MR2203
STG @MR2203
ANB CR3006               ; X軸位置決め完了ﾘﾚｰ
@SET @MR2801             ; ﾎﾟｲﾝﾄ2　移動要求
CON
@INC DM6040              ; 切断回数表示
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2204
STG @MR2204
RES @MR2801              ; ﾎﾟｲﾝﾄ2　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2205
STG @MR2205
MPS
AND<=.D CM2020 #78000    ; X軸現在位置
RES MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
SET MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
RES MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1114                ; 生地管ｸﾗﾝﾌﾟ1_下降限補助Ｔ
AND T1400                ; 切断側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
ANB MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
JMP @MR2208
MPP
AND>.D CM2020 #78000     ; X軸現在位置
RES MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
SET MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
AND T1400                ; 切断側生地管ｸﾗﾝﾌﾟ_下降限補助Ｔ
ANB MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
JMP @MR2208
STG @MR2208
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2206
STG @MR2206
@SET @MR2503             ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
CON
RES R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
SET R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
SET MR9600               ; 切断中、下降可
CON
JMP @MR2207
STG @MR2207
AND @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
SET MR9604               ; 切断完了
CON
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2209
STG @MR2209
MPS
AND< DM6040 DM6020       ; 切断回数表示  切断数確定
JMP @MR2210
MPP
AND>= DM6040 DM6020      ; 切断回数表示  切断数確定
JMP @MR2211
STG @MR2210
RES MR2500               ; 初端落下補助_上昇行
CON
SET MR2501               ; 初端落下補助_下降行
CON
RES MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
SET MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
AND R1413                ; 切断除材ﾁｬｯｸ上下_上昇限
JMP @MR2213
STG @MR2213
RES MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
LD MR9605                ; 切断管排出完了
LD R49902                ; 切断管取り出し完了
AND R49900               ; 非常停止2
ORL
ANL
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
AND T1403                ; 初端落下補助（供給側）_下限補助
MPS
ANB R49900               ; 非常停止2
JMP @MR2212
MPP
AND R49900               ; 非常停止2
SET R49901               ; 切断完了
CON
ENDS
STG @MR2211
RES MR2500               ; 初端落下補助_上昇行
CON
SET MR2501               ; 初端落下補助_下降行
CON
RES MR2410               ; 生地管ｸﾗﾝﾌﾟ1_下降行
CON
SET MR2411               ; 生地管ｸﾗﾝﾌﾟ1_上昇行
CON
AND R1413                ; 切断除材ﾁｬｯｸ上下_上昇限
JMP @MR2214
STG @MR2214
RES MR2412               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_下降行
CON
SET MR2413               ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上昇行
CON
RES MR2414               ; 切断側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2415               ; 切断側生地管ｸﾗﾝﾌﾟ_上昇行
CON
RES MR2408               ; 給材ｻﾎﾟｰﾄ_上昇行
CON
SET MR2409               ; 給材ｻﾎﾟｰﾄ_下降行
CON
AND MR9605               ; 切断管排出完了
AND T1201                ; 生地管ｸﾗﾝﾌﾟ2（ﾍﾞｰｽ側）_上限補助T
AND T1115                ; 生地管ｸﾗﾝﾌﾟ1_上昇限補助Ｔ
AND T1401                ; 切断側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
AND T1403                ; 初端落下補助（供給側）_下限補助
AND T1111                ; 給材ｻﾎﾟｰﾄ（給材側）_下降限補助Ｔ
AND T1113                ; 給材ｻﾎﾟｰﾄ（反給材側）_下降限補助
MPS
ANB R49900               ; 非常停止2
JMP @MR2212
MPP
AND R49900               ; 非常停止2
SET R49901               ; 切断完了
CON
ENDS
STG @MR2212
MPS
AND< DM6040 DM6020       ; 切断回数表示  切断数確定
RES MR9605               ; 切断管排出完了
CON
JMP @MR2200
MPP
AND>= DM6040 DM6020      ; 切断回数表示  切断数確定
RES MR9605               ; 切断管排出完了
CON
JMP @MR2400
STG @MR2400
RES @MR2505              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
RES R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
RES R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
SET R22010               ; 残管廃棄動作中
CON
JMP @MR2401
STG @MR2401
ANB CR3006               ; X軸位置決め完了ﾘﾚｰ
@SET @MR2802             ; ﾎﾟｲﾝﾄ3　移動要求
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2402
STG @MR2402
RES @MR2802              ; ﾎﾟｲﾝﾄ3　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2403
STG @MR2403
RES MR2406               ; 終端側生地管ｸﾗﾝﾌﾟ_下降行
CON
SET MR2407               ; 終端側生地管ｸﾗﾝﾌﾟ_上昇行
CON
AND T1109                ; 終端側生地管ｸﾗﾝﾌﾟ_上昇限補助Ｔ
TMR #4 #9999             ; 残管破棄後ｳｪｲﾄ
CON
AND T4                   ; 残管破棄後ｳｪｲﾄ
RES R22005               ; 20mm切断中
CON
RES R22006               ; ﾋﾟｯﾁ送り中
CON
SET R22007               ; 管到着待ち
CON
RES R22008               ; 定寸切断中
CON
RES R22009               ; ﾋﾟｯﾁ送り準備中
CON
RES R22010               ; 残管廃棄動作中
CON
JMP @MR2410
STG @MR2410
MPS
LD>=.D DM6664 #15500     ; 廃棄管長
ANB CR3006               ; X軸位置決め完了ﾘﾚｰ
ANL
@SET @MR2803             ; ﾎﾟｲﾝﾄ4　移動命令
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2411
MPP
AND<.D DM6664 #15500     ; 廃棄管長
JMP @MR2404
STG @MR2411
RES @MR2803              ; ﾎﾟｲﾝﾄ4　移動命令
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2412
STG @MR2412
TMR #415 #0
CON
AND T415
JMP @MR2413
STG @MR2413
ANB CR3006               ; X軸位置決め完了ﾘﾚｰ
@SET @MR2802             ; ﾎﾟｲﾝﾄ3　移動要求
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2414
STG @MR2414
RES @MR2802              ; ﾎﾟｲﾝﾄ3　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2404
STG @MR2404
@SET @MR1501             ; ﾎﾟｲﾝﾄ0　移動要求
CON
AND CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
JMP @MR2405
STG @MR2405
RES @MR1501              ; ﾎﾟｲﾝﾄ0　移動要求
CON
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES MR2605               ; 生地管回転ﾓｰﾀ　回転
CON
LDA #0
CON
STA DM6040               ; 切断回数表示
CON
RES CR3006               ; X軸位置決め完了ﾘﾚｰ
CON
JMP @MR2908              ; 終了処理
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR1500              ; ｻｰﾎﾞ原点復帰要求
ORGX
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR1501              ; ﾎﾟｲﾝﾄ0　移動要求
PLSX #0
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR2800              ; ﾎﾟｲﾝﾄ1　移動要求
PLSX #1
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR2801              ; ﾎﾟｲﾝﾄ2　移動要求
PLSX #2
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR2802              ; ﾎﾟｲﾝﾄ3　移動要求
PLSX #3
LD R60000                ; 定寸送りｻｰﾎﾞ動作可
AND @MR2803              ; ﾎﾟｲﾝﾄ4　移動命令
PLSX #4
;ﾒｲﾝ_管切断部 AUTO終了処理
STG @MR2908              ; 終了処理
SET R50410               ; ﾒｲﾝ_切断部   1ｻｲｸﾙ終了
CON
JMP @MR2909
STG @MR2909
ANB R50209               ; 動作開始
MPS
LDB R50000               ; HOLD
AND R50409               ; 1ｻｲｸﾙ完了
ANL
SET @MR2000              ; 管切断部自動運転開始
CON
ENDS
MPP
AND R50000               ; HOLD
ZRES MR2600 MR2601       ; ﾎｯﾊﾟﾓｰﾀ　CW回転  ﾎｯﾊﾟﾓｰﾀ　解除入力
CON
ZRES MR2603 MR2609       ; 生地管搬送ﾓｰﾀ　回転  ｸﾞﾚｰｼﾞﾝｸﾞﾓｰﾀ　回転
CON
ZRES MR9000 MR9915
CON
ZRES MR3000 MR3915       ; 手動ﾎｯﾊﾟﾓｰﾀ回転中
CON
ZRES MR2000 MR2005       ; 投入CV部動作要求
CON
ZRES R22000 R22115       ; CV生地管搬送中
CON
JMP @MR2914
STG @MR2914
ZRES MR41502 MR41507
CON
RES @MR2900              ; 2回目以降動作
CON
SET @MR2915              ; 管切断部 AUTO完了
CON
ENDS
;ｶｯﾀｰｶﾑﾓｰﾀ1回転停止動作
;
STG @MR2500              ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
SET MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
ANP R1408                ; ｶｯﾄ完了ﾀｲﾐﾝｸﾞｾﾝｻ
JMP @MR2501
STG @MR2501
TMR #395 #5
CON
AND T395
RES MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
SET @MR2502              ; ｶｯﾀｰｶﾑ一回転停止完了
CON
ENDS
;ｶｯﾀｰｶﾑﾓｰﾀ1回転停止動作　AUTO時
;
STG @MR2503              ; ｶｯﾀｰｶﾑﾓｰﾀ1回転停止
SET MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
ANP R1408                ; ｶｯﾄ完了ﾀｲﾐﾝｸﾞｾﾝｻ
@SET @MR2505             ; ｶｯﾀｰｶﾑ一回転停止完了
CON
JMP @MR2504
STG @MR2504
TMR #397 #5
CON
AND T397
RES MR2607               ; ｶｯﾀｰｶﾑ回転ﾓｰﾀ　回転
CON
ENDS
;ｴﾗｰ05　　ﾁｬｯｸ　管有無確認要求
STG @MR100               ; 生地管、切断管有無確認要求
ANB R50008               ; 全体ERROR
SET R50008               ; 全体ERROR
CON
SET R50110               ; Err ﾒｲﾝ_切断部
CON
SET R51005               ; 装置全体
CON
SET R50505               ; ERR05
CON
JMP @MR101
MOV #5 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR101
AND R50008               ; 全体ERROR
JMP @MR102
STG @MR102
ANB R50008               ; 全体ERROR
SET @MR107               ; ｴﾗｰ05　解除
CON
ENDS
;ｴﾗｰ10　　切断不良
STG @MR108               ; 切断不良
ANB R50008               ; 全体ERROR
SET R50008               ; 全体ERROR
CON
SET R50110               ; Err ﾒｲﾝ_切断部
CON
SET R51000               ; ﾒｲﾝ_切断部
CON
SET R50510               ; ERR10
CON
JMP @MR109
MOV #10 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR109
AND R50008               ; 全体ERROR
JMP @MR110
STG @MR110
ANB R50008               ; 全体ERROR
SET @MR115               ; ｴﾗｰ10　解除
CON
ENDS
END
ENDH
