DEVICE:53
;MODULE:OneSystem6_Display
;MODULE_TYPE:0
;OneSystem Master-Module
;
;-----------------------------------------
;ModuleName	:	OneSystem6_Display
;ModuleType	:	Master Module
;Function	:	Lamp/Buzzer
;-----------------------------------------
;
;Copylight(C) 2011 SEIKO EPSON Corp. All rights reserved.
;<h1/>*Lamp and Buzzer/ﾗﾝﾌﾟ|ﾌﾞｻﾞｰ制御
;<h1/>Group1/ｸﾞﾙｰﾌﾟ1
;StartSw_Lamp/ｽﾀｰﾄSWﾗﾝﾌﾟ
;・点灯：動作中
;・点滅：ｴﾗｰ発生中、安全ｶﾊﾞｰﾛｯｸ解除中、ｴｱｰ圧低下中、ﾒﾝﾃﾅﾝｽ動作Post中
LD R46208                ; _Group1　ｴﾗｰ発生中
OR R46200                ; _安全ｶﾊﾞｰ1開中
OR R50700                ; _Group1 ｴｱｰ元圧状態
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
LDB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46208               ; _Group1　ｴﾗｰ発生中
ANB R46200               ; _安全ｶﾊﾞｰ1開中
ANB R50700               ; _Group1 ｴｱｰ元圧状態
LD R47500                ; _Group1　ﾒﾝﾃ動作中
LD= DM2020 #1            ; _Group1　ﾗﾝﾌﾟ状態
ANB R46208               ; _Group1　ｴﾗｰ発生中
ANB R46200               ; _安全ｶﾊﾞｰ1開中
ANB R50700               ; _Group1 ｴｱｰ元圧状態
LD= DM2020 #2            ; _Group1　ﾗﾝﾌﾟ状態
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
ANL
ORL
ANL
ORL
OUT R44500               ; *Group1　ｽﾀｰﾄSWﾗﾝﾌﾟ
;StopSw_Lamp/ｽﾄｯﾌﾟSWﾗﾝﾌﾟ
;・点灯：定停止移行中
LDB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
LD R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R46106               ; _定停止移行中
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
ORL
ANL
OUT R44501               ; *Group1　ｽﾄｯﾌﾟSWﾗﾝﾌﾟ
;CoverSw_Lamp/ｶﾊﾞｰSWﾗﾝﾌﾟ
;・点灯：安全ｶﾊﾞｰ開中
;・点滅：安全ｶﾊﾞｰ開処理中
LD R46700                ; _安全ｶﾊﾞｰ1開処理中
LDB R46200               ; _安全ｶﾊﾞｰ1開中
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR R46200                ; _安全ｶﾊﾞｰ1開中
ANL
OUT R44502               ; *Group1　ｶﾊﾞｰ開要求SWﾗﾝﾌﾟ
OUT R44511               ; *Group1　3連ｶﾊﾞｰ開要求SWﾗﾝﾌﾟ
;AreaSw_Lamp/ｴﾘｱｾﾝｻ復帰SWﾗﾝﾌﾟ
;・点滅：ｴﾘｱｾﾝｻ遮断処理中
LD R40300                ; _ｴﾘｱｾﾝｻ1使用時出力
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R46300               ; _Group1　ｴﾘｱｾﾝｻ遮断中
MPS
LD<= DM9211 #2           ; _ｴﾘｱｾﾝｻ1復帰SW数
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ANL
OUT R44505               ; *Group1　ｴﾘｱｾﾝｻ継続実行SW1ﾗﾝﾌﾟ
MPP
LD= DM9211 #2            ; _ｴﾘｱｾﾝｻ1復帰SW数
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ANL
OUT R44506               ; *Group1　ｴﾘｱｾﾝｻ継続実行SW2ﾗﾝﾌﾟ
;Continue StartSw_Lamp/3連ｽﾀｰﾄSWﾗﾝﾌﾟ
;・点滅：安全ｶﾊﾞｰ開中
LD R46200                ; _安全ｶﾊﾞｰ1開中
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OUT R44510               ; *Group1　ｶﾊﾞｰ継続実行SWﾗﾝﾌﾟ
;Post/ﾒﾝﾃ動作区切り
;・ﾒﾝﾃ動作時のみ有効
;・Post SETでｽﾀｰﾄSW待ち状態
;・ｽﾀｰﾄSW押下でPost_OK成立
LDB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LDB R46208               ; _Group1　ｴﾗｰ発生中
ANB R46200               ; _安全ｶﾊﾞｰ1開中
ANB R46300               ; _Group1　ｴﾘｱｾﾝｻ遮断中
ANB R50700               ; _Group1 ｴｱｰ元圧状態
AND R47600               ; _Group1　動作区切り開始
LD R44400                ; *Group1　ｽﾀｰﾄSW
OR R50800                ; _Group1 Post無効宣言
ANL
ORL
OUT R47608               ; _Group1　動作区切り完了
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LD R47600                ; _Group1　動作区切り開始
ANB R47608               ; _Group1　動作区切り完了
ANL
MOV #2 DM2020            ; _Group1　ﾗﾝﾌﾟ状態
MPP
LDB R47600               ; _Group1　動作区切り開始
OR R50800                ; _Group1 Post無効宣言
ANL
MOV #1 DM2020            ; _Group1　ﾗﾝﾌﾟ状態
;Buzzer/ﾌﾞｻﾞｰ処理
;・非常停止、ｴｱｰ元圧低下などCPU全体に係わるﾌﾞｻﾞｰ出力はﾒｲﾝTP管轄のみ
;<ﾌﾞｻﾞｰOFF要求>
LDP R44403               ; *Group1　ﾌﾞｻﾞｰｵﾌSW
ORF R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ORF R50700               ; _Group1 ｴｱｰ元圧状態
ORF R46208               ; _Group1　ｴﾗｰ発生中
ORF R46300               ; _Group1　ｴﾘｱｾﾝｻ遮断中
ORF R47700               ; _Group1　ﾌﾞｻﾞｰ要求
LDF R48208               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求1
AND= DM2010 #0           ; _Group1　ﾌﾞｻﾞｰ状態
ORL
ORF R48209               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求2
ORF R48210               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求3
ORF R48211               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求4
RES @R100                ; Bz1_On_RQ
LDF R48208               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求1
AND @R200                ; Bz1_Flik_RQ
ORP R44403               ; *Group1　ﾌﾞｻﾞｰｵﾌSW
RES @R200                ; Bz1_Flik_RQ
;<ﾌﾞｻﾞｰON要求>
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ORP R50700               ; _Group1 ｴｱｰ元圧状態
ORP R46208               ; _Group1　ｴﾗｰ発生中
LDP R46300               ; _Group1　ｴﾘｱｾﾝｻ遮断中
AND R59700               ; _ｴﾘｱｾﾝｻ1遮断時ﾌﾞｻﾞｰ出力有無
ORL
ORP R47700               ; _Group1　ﾌﾞｻﾞｰ要求
LDP R48208               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求1
AND= DM2010 #0           ; _Group1　ﾌﾞｻﾞｰ状態
ORL
ORP R48209               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求2
ORP R48210               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求3
ORP R48211               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求4
SET @R100                ; Bz1_On_RQ
LDP R48208               ; _Group1　ｼｽﾃﾑﾌﾞｻﾞｰ要求1
AND= DM2010 #1           ; _Group1　ﾌﾞｻﾞｰ状態
SET @R200                ; Bz1_Flik_RQ
;ﾌﾞｻﾞｰは出力ONが優先とする
;ﾌﾞｻﾞｰﾌﾘｯｶ要求(WARNING_DISP)中に別ﾌﾞｻﾞｰON要求が来たらそちらを優先
LD @R100                 ; Bz1_On_RQ
OR @R200                 ; Bz1_Flik_RQ
MPS
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OUT R44503               ; *Group1　ﾌﾞｻﾞｰｵﾌSWﾗﾝﾌﾟ
MPP
LDB @R100                ; Bz1_On_RQ
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR @R100                 ; Bz1_On_RQ
ANL
OUT R44504               ; *Group1　ﾌﾞｻﾞｰ
;<h1/>*Tower Lamp/ﾀﾜｰﾗﾝﾌﾟ制御
;指定範囲外ﾁｪｯｸ(異常値ならJIS準拠に)
LD< DM9210 #0            ; _ﾀﾜｰﾗﾝﾌﾟ制御選択
OR> DM9210 #10           ; _ﾀﾜｰﾗﾝﾌﾟ制御選択
MOV #0 DM9210            ; _ﾀﾜｰﾗﾝﾌﾟ制御選択
;●標準ﾀﾜｰﾗﾝﾌﾟ(JIS準拠)
;ﾕｰｻﾞｰｶｽﾀﾑﾀﾜｰﾗﾝﾌﾟ未使用時に使用
LD= DM9210 #0            ; _ﾀﾜｰﾗﾝﾌﾟ制御選択
MC
;<h1/>Red/ﾀﾜｰﾗﾝﾌﾟ赤
;・点灯：非常停止中
;・点滅：ｴﾗｰ発生中、ｴｱｰ圧低下中
LD R46104                ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46208                ; _Group1　ｴﾗｰ発生中
OR R48408                ; _Group1　ﾗﾝﾌﾟ赤点滅要求1
OR R48409                ; _Group1　ﾗﾝﾌﾟ赤点滅要求2
OR R48410                ; _Group1　ﾗﾝﾌﾟ赤点滅要求3
OR R48411                ; _Group1　ﾗﾝﾌﾟ赤点滅要求4
OUT R44507               ; *Group1　ﾀﾜｰﾗﾝﾌﾟ赤
;<h1/>Green/ﾀﾜｰﾗﾝﾌﾟ緑
;・点灯：定停止中
;・点滅：安全ｶﾊﾞｰﾛｯｸ解除中、ｴﾘｱｾﾝｻ遮断QP、ｴｱｰ圧低下QP
LDB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46200               ; _安全ｶﾊﾞｰ1開中
ANB R46300               ; _Group1　ｴﾘｱｾﾝｻ遮断中
ANB R50700               ; _Group1 ｴｱｰ元圧状態
LD R46200                ; _安全ｶﾊﾞｰ1開中
OR R46300                ; _Group1　ｴﾘｱｾﾝｻ遮断中
OR R50700                ; _Group1 ｴｱｰ元圧状態
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORL
OUT R44508               ; *Group1　ﾀﾜｰﾗﾝﾌﾟ緑
;<h1/>Yellow/ﾀﾜｰﾗﾝﾌﾟ黄
;・点灯：動作中
;・点滅：ｵｰﾊﾞｰﾌﾛｰ状態（AUTOのみ）
LDB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LD R47708                ; _Group1　ｵｰﾊﾞｰﾌﾛｰ宣言
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ORB R47708               ; _Group1　ｵｰﾊﾞｰﾌﾛｰ宣言
ANL
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R47500               ; _Group1　ﾒﾝﾃ動作中
ORL
ANL
OUT R44509               ; *Group1　ﾀﾜｰﾗﾝﾌﾟ黄
MCR
END
ENDH
