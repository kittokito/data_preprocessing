DEVICE:53
;MODULE:D_INPUT_SC
;MODULE_TYPE:1
;SMCｸﾗﾝﾌﾟ ﾃﾞｰﾀ書き込み
;Data input to SMC Clamp controller
;Clamp Close Data
;加減速度→ HEX → 入替 → 10進
;  1000 → E801 → 01E8 → 59395
;　1500 → DC05 → 05CD → 56325 
;  2000 → D007 → 07D0 → 53255
;　3000 → B80B → 0DB8 → 47115
LD @CR2008
ZRES @M0 @M15            ; ﾃﾞｰﾀ変換
FMOV K0 @D0 K10          ; Axis No.
MOV V0 @D0               ; Axix_No.  Axis No.
MPS
LDA @D0                  ; Axis No.
CON
SUB K1
CON
MUL K9
CON
STA Z1
MRD
ADRSET D32516:Z1 @E0     ; ID1 起動ﾌﾗｸﾞ/ｽﾃｯﾌﾟNo./動作方法  Axis INPUT Head address
MRD
ADRSET D32324:Z1 @E2     ; ID1 ｺﾝﾄﾛｰﾗIF状態ﾌﾗｸﾞ
MRD
MOV V1 @D1               ; Point_No.  書き込み動作方法
MRD
MOV V3 @D2               ; Vel._Data  書き込み速度ﾃﾞｰﾀ
MRD
MOV.D V2 @D3             ; Pos_Data  書き込み位置ﾃﾞｰﾀ1
MRD
MOV.D V4 @D8             ; Ｔhrust_Dat  推力設定値
MRD
MOV.D V5 @D9             ; Thr_hold_Dat  閾値設定値
MPP
SET @M0                  ; ﾃﾞｰﾀ変換
LD CR2002                ; 常時ON
MOV *@E2 @D6             ; ｺﾝﾄﾛｰﾗIF状態ﾌﾗｸﾞ
STG @M0                  ; ﾃﾞｰﾀ変換
MPS
LDA @D9                  ; 閾値設定値
CON
SLA K8
CON
ORA @D8                  ; 推力設定値
CON
STA @D5                  ; 書込み押当推力_閾値ﾃﾞｰﾀ
MRD
BSWAP @D2 K3             ; 書き込み速度ﾃﾞｰﾀ
MRD
XCH @D3 @D4              ; 書き込み位置ﾃﾞｰﾀ1  書き込み位置ﾃﾞｰﾀ2
MRD
LDA K10
CON
SLA K8
CON
ORA K10
CON
STA @D12                 ; #7書込ﾃﾞｰﾀ
MRD
LDA K500
CON
SWAP
CON
STA @D14                 ; #8書込ﾃﾞｰﾀ
MPP
JMP @M1                  ; ﾃﾞｰﾀ書き込み
;#0･････動作方法,Point No.,     #5･････Deceleration
;#1･････Velocity                #6･････Push power,Threshold
;#2,3･･･Position                #7･････Push speed,Positioning thrust
;#4･････Acceleration            #8･････Inposition
STG @M1                  ; ﾃﾞｰﾀ書き込み
BMOV @D1 *@E0 K4         ; 書き込み動作方法  Axis INPUT Head address
MOV K53255 *@E0:#4       ; Axis INPUT Head address
MOV K53255 *@E0:#5       ; Axis INPUT Head address
MOV @D5 *@E0:#6          ; 書込み押当推力_閾値ﾃﾞｰﾀ  Axis INPUT Head address
MOV @D12 *@E0:#7         ; #7書込ﾃﾞｰﾀ  Axis INPUT Head address
MOV @D14 *@E0:#8         ; #8書込ﾃﾞｰﾀ  Axis INPUT Head address
JMP @M2                  ; ﾃﾞｰﾀ転送
STG @M2                  ; ﾃﾞｰﾀ転送
ANPB @M2                 ; ﾃﾞｰﾀ転送
BSET *@E0 K8             ; Axis INPUT Head address
CON
JMP @M3                  ; 転送完了待ち
STG @M3                  ; 転送完了待ち
AND @D6.8
BRES *@E0 K8             ; Axis INPUT Head address
CON
JMP @M4                  ; 転送完了
STG @M4                  ; 転送完了
ANB @D6.8
SET P0                   ; End_FLG.
CON
ENDS
END
ENDH
