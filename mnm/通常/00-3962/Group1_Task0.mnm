DEVICE:53
;MODULE:Group1_Task0
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task0
;ModuleType	:	Main Module
;Line		:	μTFP CAV Plate Assembly Line
;Cell		:	<CR> 2Cell
;Function	:	ｲﾝﾃﾞｯｸｽ動作制御
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000〜@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100〜@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;Home			@MR1000〜@MR1515		HOME動作時使用ｴﾘｱ
;Maintenance		@MR2000〜@MR2915		MAINTE動作時使用ｴﾘｱ
;Auto(Main1)		@MR3000〜@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000〜@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;Subroutine		@MR4500〜@MR6015		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG〜JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR6609               ; ﾏｼﾝｻｲｸﾙ
CON
RES MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
ZRES MR000 MR6504        ; ﾍﾟｰｼﾞ切替無効中
CON
ZRES MR6507 MR24915      ; 転写UNIT ﾜｰｸ救済可  仮ｽｲｯﾁ
CON
ZRES @MR100 @MR6015      ; Task0 ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM600.U,EM601.U,@MR000.U,@MR3000.U
;
;FOR EM600 = EM600 TO 160 STEP 16
;	IF @MR3000:EM600 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM600 < 160 THEN
;	EM601 = (EM600 / 16) * 100 + DMX(@MR3000:EM600) + #3000
;END IF		
;		
;EM600 = EM600 + 16		
;IF EM600 > 160 THEN		
;	EM600 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM600.U,EM601.U,@MR000.U,@MR3000.U
;
;FOR EM600 = EM600 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM600 EM600          ; Task0 Main1@MR  Task0 Main1@MR
LABEL #2000
LD> EM600 #160           ; Task0 Main1@MR
CJ #2001
;	IF @MR3000:EM600 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM600                ; Task0 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM600                ; Task0 Main1@MR
CON
ADD #16
CON
STA EM600                ; Task0 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM600 < 160 THEN
;
LD< EM600 #160           ; Task0 Main1@MR
NCJ #2004
;	EM601 = (EM600 / 16) * 100 + DMX(@MR3000:EM600) + #3000
;
LD CR2002                ; 常時ON
LDA EM600                ; Task0 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12
CON
DMX
CON
STA @VM0
CON
LDA EM600                ; Task0 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM601                ; Task0 Main1@MR
;END IF		
;
LABEL #2004
;EM600 = EM600 + 16		
;
LD CR2002                ; 常時ON
LDA EM600                ; Task0 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM600                ; Task0 Main1@MR
;IF EM600 > 160 THEN		
;
LD> EM600 #160           ; Task0 Main1@MR
NCJ #2005
;	EM600 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM600             ; Task0 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM602.U,EM603.U,@MR4000.U
;
;FOR EM602 = EM602 TO 80 STEP 16
;	IF @MR4000:EM602 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM602 < 80 THEN
;	EM603 = (EM602 / 16) * 100 + DMX(@MR4000:EM602) + #4000
;END IF
;
;EM602 = EM602 + 16		
;
;IF EM602 > 80 THEN
;	EM602 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM602.U,EM603.U,@MR4000.U
;
;FOR EM602 = EM602 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM602 EM602          ; Task0 Main2@MR  Task0 Main2@MR
LABEL #2006
LD> EM602 #80            ; Task0 Main2@MR
CJ #2007
;	IF @MR4000:EM602 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM602                ; Task0 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM602                ; Task0 Main2@MR
CON
ADD #16
CON
STA EM602                ; Task0 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM602 < 80 THEN
;
LD< EM602 #80            ; Task0 Main2@MR
NCJ #2010
;	EM603 = (EM602 / 16) * 100 + DMX(@MR4000:EM602) + #4000
;
LD CR2002                ; 常時ON
LDA EM602                ; Task0 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12
CON
DMX
CON
STA @VM3
CON
LDA EM602                ; Task0 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM603                ; Task0 Main2@MR
;END IF
;
LABEL #2010
;EM602 = EM602 + 16		
;
LD CR2002                ; 常時ON
LDA EM602                ; Task0 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM602                ; Task0 Main2@MR
;IF EM602 > 80 THEN
;
LD> EM602 #80            ; Task0 Main2@MR
NCJ #2011
;	EM602 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM602             ; Task0 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM604.U,EM605.U,@MR4500.U
;	
;FOR EM604 = EM604 TO 320 STEP 16
;	IF @MR4500:EM604 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM604 < 320 THEN
;	EM605 = (EM604 / 16) * 100 + DMX(@MR4500:EM604) + #4500
;END IF
;		
;EM604 = EM604 + 16	
;
;IF EM604 > 320 THEN
;   EM604 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM604.U,EM605.U,@MR4500.U
;
;FOR EM604 = EM604 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM604 EM604          ; Task0 Sub@MR  Task0 Sub@MR
LABEL #2012
LD> EM604 #320           ; Task0 Sub@MR
CJ #2013
;	IF @MR4500:EM604 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM604                ; Task0 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; INDEX原点復帰開始
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM604                ; Task0 Sub@MR
CON
ADD #16
CON
STA EM604                ; Task0 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM604 < 320 THEN
;
LD< EM604 #320           ; Task0 Sub@MR
NCJ #2016
;	EM605 = (EM604 / 16) * 100 + DMX(@MR4500:EM604) + #4500
;
LD CR2002                ; 常時ON
LDA EM604                ; Task0 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; INDEX原点復帰開始
CON
DMX
CON
STA @VM6
CON
LDA EM604                ; Task0 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM605                ; Task0 Sub@MR
;END IF
;
LABEL #2016
;EM604 = EM604 + 16	
;
LD CR2002                ; 常時ON
LDA EM604                ; Task0 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM604                ; Task0 Sub@MR
;IF EM604 > 320 THEN
;
LD> EM604 #320           ; Task0 Sub@MR
NCJ #2017
;   EM604 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM604             ; Task0 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
LD= DM60000 #0           ; TaskNo /ERROR_DISP
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK_0 ERROR
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR800                ; _Grp1_Task0_Init.STG
ENDS
;<h1/>Condition/条件
LDB R7514                ; ﾌｨﾙﾑ受け部  F受け 下限
AND R7515                ; ﾌｨﾙﾑ受け部  F受け 上限
ANB R11402               ; ﾌｨﾙﾑ受け 下降
ANB R7608                ; 治具ｴｱｰ真空  上限
AND R7609                ; 治具ｴｱｰ真空  下限
ANB R11410               ; 治具ｴｱｰ真空  上昇
OUT @MR010               ; INDEX回転可条件-1
LDB R7700                ; 給材側 吸着治具 上限
AND R7701                ; 給材側 吸着治具 下限
ANB R11412               ; 給材側 吸着治具 上昇
ANB R7900                ; 除材側  吸着治具 上限
AND R7901                ; 除材側  吸着治具 下限
ANB R11414               ; 除材側  吸着治具 上昇
OUT @MR011               ; INDEX回転可条件-2
LD CR2002                ; 常時ON
AND R7604                ; 転写部  転写RB原点位置
OUT @MR012               ; INDEX回転可条件-3
LD CR2002                ; 常時ON
OUT @MR013               ; INDEX回転可条件-4
LD @MR010                ; INDEX回転可条件-1
AND @MR011               ; INDEX回転可条件-2
AND @MR012               ; INDEX回転可条件-3
AND @MR013               ; INDEX回転可条件-4
LD R5502                 ; I_ｲﾝﾀｰﾛｯｸ信号1（隣ｾﾙ1）
OR DM2000.14             ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
ANL
OUT MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR400                ; _Grp1_Task0_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5200               ; _Grp1_Task0_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR6609               ; ﾏｼﾝｻｲｸﾙ
CON
JMP LR5400               ; _Grp1_Task0_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5600               ; _Grp1_Task0_MAINTE.STG
;Cylinder Error 監視
LD MR4500
ZRES MR7000 MR9000       ; 画面切替
CON
RES R42600               ; _Grp1_Task0_ﾎﾟｰｽﾞ許可
CON
RES R41200               ; TASK0 PAUSE 
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR600                ; _Grp1_Task0_Fin.STG
ANB @MR001               ; TASK_0 ERROR
ANB R41200               ; TASK0 PAUSE 
RES R41000               ; _Grp1_Task0_起動中ﾌﾗｸﾞ
CON
ENDS
;<h1/>HOME
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5200               ; _Grp1_Task0_HOME.STG
ANB @MR001               ; TASK_0 ERROR
MPS
ANB R41200               ; TASK0 PAUSE 
JMP @MR1000              ; HOME
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR1000              ; HOME
MPS
LDB R41200               ; TASK0 PAUSE 
AND MR005                ; TASK1原点復帰完了
AND MR007                ; TASK3原点復帰完了
AND MR009                ; TASK5原点復帰完了
ANL
ZRES MR005 MR009         ; TASK1原点復帰完了  TASK5原点復帰完了
CON
JMP @MR1100
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR1100
ANB @MR1001              ; TASK0　原点復帰動作中
SET @MR1001              ; TASK0　原点復帰動作中
CON
JMP @MR1101
STG @MR1101
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET @MR4500              ; INDEX原点復帰開始
CON
JMP @MR1102
STG @MR1102
AND @MR4501              ; INDEX原点復帰完了
DW #0 DM29000            ; 装置内ﾜｰｸ個数
CON
RES @MR4501              ; INDEX原点復帰完了
CON
JMP @MR1103
STG @MR1103
SET @MR4700              ; CR_INDEX上ﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR1104
STG @MR1104
AND @MR4701              ; INDEX上ﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝ処理完
RES @MR4701              ; INDEX上ﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝ処理完
CON
JMP @MR1105
STG @MR1105
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR1200
STG @MR1200
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1201
STG @MR1201
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
JMP @MR1202
MPP
AND<> DM35000 #0         ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
JMP @MR1103
STG @MR1202
MPS
LD= DM35012 #3           ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
AND<> #0 DM29000         ; 装置内ﾜｰｸ個数
ANL
JMP @MR1203
MRD
AND<> DM35012 #3         ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
JMP @MR1205
MPP
AND= #0 DM29000          ; 装置内ﾜｰｸ個数
DW #0 DM35012            ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
CON
JMP @MR1205
STG @MR1203
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR1204
STG @MR1204
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
MPS
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
DW #10 DM29000           ; 装置内ﾜｰｸ個数
CON
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1206
MPP
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1206
STG @MR1205
MPS
AND= DM35012 #2          ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
JMP @MR1206
MPP
AND<> DM35012 #2         ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
JMP @MR1208
STG @MR1206
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR1207
STG @MR1207
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
MPS
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
DW #10 DM29000           ; 装置内ﾜｰｸ個数
CON
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1209
MPP
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1209
STG @MR1208
MPS
AND= DM35012 #1          ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
JMP @MR1209
MPP
AND<> DM35012 #1         ; 非常停止時のｲﾝﾃﾞｯｸｽ位置
JMP @MR1215
STG @MR1209
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR1210
STG @MR1210
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
MPS
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
DW #10 DM29000           ; 装置内ﾜｰｸ個数
CON
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1215
MPP
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR1215
STG @MR1215
ANB MR013                ; Index HOME Data Shift finished 
ANB @MR001               ; TASK_0 ERROR
RES @MR1001              ; TASK0　原点復帰動作中
CON
JMP @MR1300
STG @MR1300
JMP @MR1515              ; HOME END
STG @MR1515              ; HOME END
RES LR12500              ; 転写UNIT ﾜｰｸ救済可
CON
RES MR16004              ; 巻だしﾀﾞﾝｻﾛｰﾗ動作ON
CON
RES MR16104              ; 巻取りﾀﾞﾝｻﾛｰﾗ動作ON
CON
RES @MR1001              ; TASK0　原点復帰動作中
CON
DW #0 DM26000            ; 1STﾜｰｸ救済
CON
DW #0 DM26001            ; 2STﾜｰｸ救済
CON
DW #0 DM26002            ; 3STﾜｰｸ救済
CON
JMP LR600                ; _Grp1_Task0_Fin.STG
;<h1/>AUTO
STG LR5400               ; _Grp1_Task0_AUTO.STG
SET R46115               ; _装置ｻｲｸﾙﾀｲﾑ計測中
CON
RES MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR3000
;<h1/>Auto (Main1)
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1〜32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000
ANB @MR001               ; TASK_0 ERROR
MPS
ANB R41200               ; TASK0 PAUSE 
JMP @MR3003
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3003
MPS
ANB R46106               ; _定停止移行中
JMP @MR3100
MPP
AND R46106               ; _定停止移行中
MPS
ANB LR100                ; _割り込みSW1　ON/OFF状態
SET MR22601              ; TASK0→TASK1 HOLD
CON
JMP @MR3005
MPP
AND LR100                ; _割り込みSW1　ON/OFF状態
JMP @MR3100
STG @MR3005
MPS
LD MR10609               ; ST1ﾜｰｸ吸着 吸着ON
OR MR9101                ; INDEX_治具-1上ﾜｰｸ全て有り
OR MR10612               ; ST2ﾜｰｸ吸着 吸着ON
OR MR9102                ; INDEX_治具-2上ﾜｰｸ全て有り
OR MR10700               ; ST3ﾜｰｸ吸着 吸着ON
OR MR9103                ; INDEX_治具-3上ﾜｰｸ全て有り
OR MR10703               ; ST4ﾜｰｸ吸着 吸着ON
OR MR9104                ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3010
MPP
LDB MR10609              ; ST1ﾜｰｸ吸着 吸着ON
ANB MR10612              ; ST2ﾜｰｸ吸着 吸着ON
ANB MR10700              ; ST3ﾜｰｸ吸着 吸着ON
ANB MR10703              ; ST4ﾜｰｸ吸着 吸着ON
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
JMP @MR3908
STG @MR3010
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3011
STG @MR3011
SET MR6609               ; ﾏｼﾝｻｲｸﾙ
CON
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
LDB R41200               ; TASK0 PAUSE 
ANB MR22503              ; TASK0→TASK3 START
ANB MR22505              ; TASK0→TASK5 START
ANL
JMP @MR3012
STG @MR3012
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
LDB R41200               ; TASK0 PAUSE 
AND MR24904              ; 4ST　動作完了
ANL
MPS
LD MR24903               ; 3ST　動作完了
ANB MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3108
MPP
LDB MR24903              ; 3ST　動作完了
AND MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3800              ; ﾌｨﾙﾑ交換ﾓｰﾄﾞ開始
STG @MR3100
MPS
ANB R46106               ; _定停止移行中
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND LR10500              ; INDEX治具1 使用可
SET MR22501              ; TASK0→TASK1 START
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
ANB LR10500              ; INDEX治具1 使用可
SET MR24901              ; 1ST　動作完了
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND LR10501              ; INDEX治具2 使用可
SET MR22501              ; TASK0→TASK1 START
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
ANB LR10501              ; INDEX治具2 使用可
SET MR24901              ; 1ST　動作完了
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND LR10502              ; INDEX治具3 使用可
SET MR22501              ; TASK0→TASK1 START
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
ANB LR10502              ; INDEX治具3 使用可
SET MR24901              ; 1ST　動作完了
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND LR10503              ; INDEX治具4 使用可
SET MR22501              ; TASK0→TASK1 START
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
ANB LR10503              ; INDEX治具4 使用可
SET MR24901              ; 1ST　動作完了
CON
SET MR22503              ; TASK0→TASK3 START
CON
SET MR22505              ; TASK0→TASK5 START
CON
JMP @MR3101
MPP
AND R46106               ; _定停止移行中
JMP @MR3908
STG @MR3101
SET MR6609               ; ﾏｼﾝｻｲｸﾙ
CON
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
LDB R41200               ; TASK0 PAUSE 
ANB MR22501              ; TASK0→TASK1 START
ANB MR22503              ; TASK0→TASK3 START
ANB MR22505              ; TASK0→TASK5 START
ANB MR22511              ; TASK1_2 動作無し
ANL
JMP @MR3102
STG @MR3102
MPS
ANB R41200               ; TASK0 PAUSE 
MPS
LD MR24901               ; 1ST　動作完了
AND MR24904              ; 4ST　動作完了
ANL
MPS
LD MR24903               ; 3ST　動作完了
ANB MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3108
MPP
LDB MR24903              ; 3ST　動作完了
AND MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3800              ; ﾌｨﾙﾑ交換ﾓｰﾄﾞ開始
MPP
LDB MR24901              ; 1ST　動作完了
LD MR24907               ; 1STﾜｰｸ無し終了
LDB MR24410              ; 自動動作中
AND R46106               ; _定停止移行中
ORL
ANL
AND MR24904              ; 4ST　動作完了
ANL
MPS
LD MR24903               ; 3ST　動作完了
ANB MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3108
MPP
LDB MR24903              ; 3ST　動作完了
AND MR9800               ; ﾌｨﾙﾑ受け交換中
ANL
JMP @MR3800              ; ﾌｨﾙﾑ交換ﾓｰﾄﾞ開始
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3108
MPS
LDB LR10002              ; ﾜｰｸｾｯﾄｼﾞｸﾞ 90度回転使用/未使用
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
ANL
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
SET MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR3104
MPP
AND LR10002              ; ﾜｰｸｾｯﾄｼﾞｸﾞ 90度回転使用/未使用
JMP @MR3109
STG @MR3109
RES MR11304              ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下 上昇
CON
MPS
LDB MR8111               ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下奥側下限ｴﾗｰ
ANB MR8113               ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上手前側 下限ｴﾗｰ
AND R8111                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下奥側 下限
ANB R8110                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下奥側 上限
AND R8113                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上手前側 下限
ANB R8112                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下手前側 上限
ANL
JMP @MR3110
MPP
LD MR8111                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上下奥側下限ｴﾗｰ
OR MR8113                ; ﾌｨﾙﾑ巻取り ﾛｰﾗ上手前側 下限ｴﾗｰ
AND R41200               ; TASK0 PAUSE 
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR3110
MPS
AND MR24901              ; 1ST　動作完了
RES MR11412              ; 給材側 吸着治具 上昇
CON
SET MR11413              ; 給材側 吸着治具 下降
CON
MPS
LDB R7700                ; 給材側 吸着治具 上限
ANB MR7701               ; 給材側 吸着治具 下限ｴﾗｰ
AND R7701                ; 給材側 吸着治具 下限
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
ANL
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
SET MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR3104
MPP
LD MR7701                ; 給材側 吸着治具 下限ｴﾗｰ
AND R41201               ; TASK1 PAUSE 
ANL
SET @MR1900              ; Main1 HALT許可
MPP
LDB MR24901              ; 1ST　動作完了
AND R7701                ; 給材側 吸着治具 下限
ANL
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
SET MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR3104
STG @MR3104
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES MR6600               ; ｲﾝﾃﾞｯｸｽ回転中 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR3105
STG @MR3105
@FMOV #0 EM44000 #500    ; 自動中非常停止によるﾃｰﾌﾞﾙ4状態
@BMOV EM43000 EM44000 #500;自動中非常停止によるﾃｰﾌﾞﾙ3状態  自動中非常停止によるﾃｰﾌﾞﾙ4状態
@BMOV EM42000 EM43000 #500;自動中非常停止によるﾃｰﾌﾞﾙ2状態  自動中非常停止によるﾃｰﾌﾞﾙ3状態
@BMOV EM41000 EM42000 #500;自動中非常停止によるﾃｰﾌﾞﾙ1状態  自動中非常停止によるﾃｰﾌﾞﾙ2状態
@FMOV #0 EM41000 #500    ; 自動中非常停止によるﾃｰﾌﾞﾙ1状態
TMR @0 #1
CON
AND @T0
RES MR6609               ; ﾏｼﾝｻｲｸﾙ
CON
JMP @MR3900
;ｻｲｸﾙ終了
STG @MR3900
ANB @MR001               ; TASK_0 ERROR
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41200               ; TASK0 PAUSE 
JMP @MR3901
STG @MR3901
ZRES MR24900 MR24915     ; 仮ｽｲｯﾁ
CON
JMP @MR3000
;ﾌｨﾙﾑ交換ﾓｰﾄﾞ
STG @MR3800              ; ﾌｨﾙﾑ交換ﾓｰﾄﾞ開始
JMP @MR3803
STG @MR3803
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR3804
STG @MR3804
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR3805
STG @MR3805
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR3806
STG @MR3806
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR3807
STG @MR3807
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR3808
STG @MR3808
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR3809
STG @MR3809
JMP @MR3810
STG @MR3810
MPS
LDB R41200               ; TASK0 PAUSE 
AND MR9802               ; ﾌｨﾙﾑ交換完了
ANL
RES MR9802               ; ﾌｨﾙﾑ交換完了
CON
JMP @MR3811
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3811
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
CON
JMP @MR3812
STG @MR3812
AND @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
RES @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
JMP @MR3813
STG @MR3813
ANB MR9800               ; ﾌｨﾙﾑ受け交換中
JMP @MR3102
;Auto終了処理
STG @MR3908
SET MR22601              ; TASK0→TASK1 HOLD
CON
SET MR22603              ; TASK0→TASK3 HOLD
CON
SET MR22605              ; TASK0→TASK5 HOLD
CON
JMP @MR3909
STG @MR3909
MPS
LDB R41200               ; TASK0 PAUSE 
LDB MR22601              ; TASK0→TASK1 HOLD
ORB R41001               ; _Grp1_Task1_起動中ﾌﾗｸﾞ
ANL
ANB MR22603              ; TASK0→TASK3 HOLD
ANB MR22605              ; TASK0→TASK5 HOLD
ANB R41001               ; _Grp1_Task1_起動中ﾌﾗｸﾞ
ANB R41003               ; _Grp1_Task3_起動中ﾌﾗｸﾞ
ANB R41005               ; _Grp1_Task5_起動中ﾌﾗｸﾞ
ANL
JMP @MR3910
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3910
ZRES MR22601 MR22605     ; TASK0→TASK1 HOLD  TASK0→TASK5 HOLD
CON
JMP @MR3915
STG @MR3915
ANB @MR001               ; TASK_0 ERROR
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41200               ; TASK0 PAUSE 
ZRES LR100 LR103         ; _割り込みSW1　ON/OFF状態  _割り込みSW4　ON/OFF状態
CON
ZRES MR24900 MR24915     ; 仮ｽｲｯﾁ
CON
JMP LR600                ; _Grp1_Task0_Fin.STG
;<h1/>Maintenance
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1〜32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5600               ; _Grp1_Task0_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
SET MR23914              ; ﾒﾝﾃﾅﾝｽ中
CON
JMP @MR2100
STG @MR2100
LD> #2000 DM3000         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR> DM3000 #2118         ; _MainTP　表示中ﾍﾟｰｼﾞNo
LD<= #2000 DM3000        ; _MainTP　表示中ﾍﾟｰｼﾞNo
AND<= DM3000 #2118       ; _MainTP　表示中ﾍﾟｰｼﾞNo
ORL
ANL
MPS
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
MRD
ANB R41200               ; TASK0 PAUSE 
MPS
AND= DM4110 #25          ; _Group1　ﾒﾝﾃ動作番号
@DW #2018 DM3008         ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
ANF R45015               ; 単動終了
JMP @MR2108
MPP
AND= DM4110 #26          ; _Group1　ﾒﾝﾃ動作番号
@DW #1900 DM3008         ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
ANP R44914               ; *Group3　ｴﾘｱｾﾝｻ継続実行SW2ﾗﾝﾌﾟ
JMP @MR2108
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR2110
LD MR23914               ; ﾒﾝﾃﾅﾝｽ中
LD= DM3000 #2118         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR= DM3000 #2018         ; _MainTP　表示中ﾍﾟｰｼﾞNo
ANL
MPS
LDB MR3803               ; ｲﾝﾃﾞｯｸｽｻｰﾎﾞｵﾝ SW
ANB MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
ANL
@SET MR6110              ; INDEX 非常停止
MRD
AND MR6110               ; INDEX 非常停止
OUT MR3902               ; ｲﾝﾃﾞｯｸｽｻｰﾎﾞｵﾝ中 ﾗﾝﾌﾟ
MRD
AND MR6110               ; INDEX 非常停止
MPS
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
MPS
AND MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
OUT MR003                ; ｲﾝﾃﾞｯｸｽOK
MPP
OUT MR4013               ; ｲﾝﾃﾞｯｸｽ回転可 ﾗﾝﾌﾟ
MPP
ANB MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
OUT MR3907               ; ｲﾝﾃﾞｯｸｽｲﾝﾀｰﾛｯｸ ﾗﾝﾌﾟ
MRD
LD MR4013                ; ｲﾝﾃﾞｯｸｽ回転可 ﾗﾝﾌﾟ
ANP MR3806               ; 原点復帰 SW
ANL
SET @MR4500              ; INDEX原点復帰開始
MRD
LD MR003                 ; ｲﾝﾃﾞｯｸｽOK
ANP MR3805               ; ｲﾝﾃﾞｯｸｽ回転 SW
ANL
SET @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
MRD
LD @MR4502               ; INDEX原点復帰動作中
OR @MR5002               ; INDEX動作ｻﾌﾞﾙｰﾁﾝ処理中
ANL
SET MR000                ; ﾍﾟｰｼﾞ切替無効中
MPP
LDB @MR4502              ; INDEX原点復帰動作中
ANB @MR5002              ; INDEX動作ｻﾌﾞﾙｰﾁﾝ処理中
ANL
RES MR000                ; ﾍﾟｰｼﾞ切替無効中
STG @MR2108
ANB R39104               ; SELECT_Y_N Interlock
SET R39104               ; SELECT_Y_N Interlock
CON
DW #7 @DM21              ; ScreenNo /SELECT_Y_N
CON
DW #0 @DM22              ; Bz_Use /SELECT_Y_N
CON
SET @MR300               ; Task0 SELECT_Y_N
CON
JMP @MR2109
STG @MR2109
AND @MR301               ; Task0 Y/N END
RES @MR301               ; Task0 Y/N END
CON
RES R39104               ; SELECT_Y_N Interlock
CON
MPS
AND @MR306               ; Task0 Y/N
JMP @MR2000              ; Mainte
MPP
ANB @MR306               ; Task0 Y/N
DW #211 DM3008           ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
JMP @MR2110
STG @MR2110
MCALL HOLD_REQUEST #1
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
ANB @MR4502              ; INDEX原点復帰動作中
ANB @MR5002              ; INDEX動作ｻﾌﾞﾙｰﾁﾝ処理中
MPS
MCALL MODE_INDI #2
MPP
ANB @MR001               ; TASK_0 ERROR
MPS
ANB R41200               ; TASK0 PAUSE 
RES MR23914              ; ﾒﾝﾃﾅﾝｽ中
CON
SET R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
CON
JMP LR600                ; _Grp1_Task0_Fin.STG
MPP
AND R41200               ; TASK0 PAUSE 
SET @MR1900              ; Main1 HALT許可
;<h1/>ERROR
;[使用方法]
;・@DM1にERROR番号を代入
;・@DM2にSensor番号を代入(ｾﾝｻ無しｴﾗｰの場合は0)
;・@DM9に復帰SW番号(1〜9、0はSW無し)をdegit単位で4桁入力
;・Task0 ERROR SET(@MR100)でｴﾗｰ処理開始
;・ｴﾗｰ復帰でTask0 ERROR END(@MR101)がON
;・押下復帰SW番号により左から対応した@MR105,@MR106,@MR107,@MR108のいずれかがON
;・上記ONが成立したらJMPするSTGに対応する処理を記述
;Error0を左側から1,2,3,4の番号に対応した復帰選択SWを出力する
;MyTask Error Process Substance/ｴﾗｰ処理実体
STG @MR100               ; Task0 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task0 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task0 ERROR Busy
CON
SET @MR101               ; Task0 ERROR_End
CON
RES @MR1900              ; Main1 HALT許可
CON
ENDS
;<h1/>SELECT_ACT
;//*Select_ACT Sample
;画面番号33をﾌﾞｻﾞｰ有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
STG @MR4104
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
DW #33 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #1 @DM32              ; Bz_Use /SELECT_ACT
CON
DW #5 @DM33              ; SW1_No /SELECT_ACT
CON
DW #10 @DM34             ; SW2_No /SELECT_ACT
CON
DW #0 @DM35              ; SW3_No /SELECT_ACT
CON
DW #34 @DM36             ; SW4_No /SELECT_ACT
MPP
SET @MR200               ; Task0 SELECT_ACT
CON
JMP @MR4105
STG @MR4105
AND @MR201               ; Task0 SEL_ACT END
RES @MR201               ; Task0 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
JMP @MR4106
MRD
AND @MR206               ; SW2
JMP @MR4107
MRD
AND @MR207               ; SW3
JMP @MR4108
MPP
AND @MR208               ; SW4
JMP @MR4109
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task0 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #0 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task0 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task0 SEL_ACT Busy
CON
SET @MR201               ; Task0 SEL_ACT END
CON
ENDS
;<h1/>SELECT_Y_N
;//*Select_Y_N Sample
STG @MR4203
ANB R39104               ; SELECT_Y_N Interlock
SET R39104               ; SELECT_Y_N Interlock
CON
DW #7 @DM21              ; ScreenNo /SELECT_Y_N
CON
DW #0 @DM22              ; Bz_Use /SELECT_Y_N
CON
SET @MR300               ; Task0 SELECT_Y_N
CON
JMP @MR4204
STG @MR4204
AND @MR301               ; Task0 Y/N END
RES @MR301               ; Task0 Y/N END
CON
RES R39104               ; SELECT_Y_N Interlock
CON
MPS
AND @MR306               ; Task0 Y/N
JMP @MR4205
MPP
ANB @MR306               ; Task0 Y/N
JMP @MR4206
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task0 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task0 Y/N
CON
DW #0 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task0 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task0 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task0 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task0 Y_N Busy
CON
SET @MR301               ; Task0 Y/N END
CON
ENDS
;<h1/>TIMEUP_ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task0 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #0 @DM40              ; TaskNo /TIMEUP_ERR
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR  TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task0 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task0 TIMEUP Busy
CON
SET @MR401               ; Task0 TIMEUP_END
CON
ENDS
;<h1/>Subroutines/ｻﾌﾞﾙｰﾁﾝ
;<h1/>INDEX原点復帰動作ｻﾌﾞﾙｰﾁﾝ
;・ﾌﾟﾛｸﾞﾗﾑNo.6にて原点復帰を行う
STG @MR4500              ; INDEX原点復帰開始
RES MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
CON
SET MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
SET @MR4502              ; INDEX原点復帰動作中
CON
SET MR10010              ; 原点復帰動作中
CON
JMP @MR4503
STG @MR4503
SET MR6110               ; INDEX 非常停止
CON
TMH @30 #3
CON
AND @T30
JMP @MR4504
STG @MR4504
SET MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR4505
STG @MR4505
MPS
LD R5308                 ; INDEX ｱﾗｰﾑ1
AND R5309                ; INDEX ｱﾗｰﾑ2
ANL
RES MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR4506
MPP
LDB R5308                ; INDEX ｱﾗｰﾑ1
ORB R5309                ; INDEX ｱﾗｰﾑ2
ANL
TMH @31 #3               ; INDEXｱﾗｰﾑﾘｾｯﾄ待ち時間
CON
AND @T31                 ; INDEXｱﾗｰﾑﾘｾｯﾄ待ち時間
RES MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR4600
STG @MR4600
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #16 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4601
STG @MR4601
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR4602
STG @MR4602
AND @MR105               ; SW1
JMP @MR4503
STG @MR4506
AND R5307                ; INDEX 起動入力待ち
RES MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
SET MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
SET MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
TMH @32 #10
CON
AND @T32
JMP @MR4507
STG @MR4507
SET MR6106               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1桁目
CON
TMH @33 #10
CON
AND @T33
JMP @MR4508
STG @MR4508
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET MR002                ; ｲﾝﾃﾞｯｸｽ回転中
CON
SET MR6108               ; INDEX 起動
CON
ANB R5307                ; INDEX 起動入力待ち
JMP @MR4509
STG @MR4509
RES MR6106               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1桁目
CON
RES MR6108               ; INDEX 起動
CON
RES MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
RES MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
JMP @MR4510
STG @MR4510
MPS
AND R5306                ; INDEX 位置決め完了
JMP @MR4511
MPP
ANB R5306                ; INDEX 位置決め完了
TMR @34 #300
CON
AND @T34
RES MR002                ; ｲﾝﾃﾞｯｸｽ回転中
CON
RES @MR4501              ; INDEX原点復帰完了
CON
RES MR10010              ; 原点復帰動作中
CON
ENDS
STG @MR4511
SET MR6109               ; INDEX ｱﾝｻ
CON
JMP @MR4512
STG @MR4512
ANB R5306                ; INDEX 位置決め完了
DW #0 DM35000            ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
CON
SET MR012                ; Index HOME Posi Data Request 
CON
JMP @MR4513
STG @MR4513
ANB MR012                ; Index HOME Posi Data Request 
SET MR013                ; Index HOME Data Shift finished 
CON
JMP @MR4514
STG @MR4514
ANB MR013                ; Index HOME Data Shift finished 
ANB MR012                ; Index HOME Posi Data Request 
RES MR6109               ; INDEX ｱﾝｻ
CON
RES MR002                ; ｲﾝﾃﾞｯｸｽ回転中
CON
SET MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
CON
RES @MR4502              ; INDEX原点復帰動作中
CON
MPS
ANB MR23914              ; ﾒﾝﾃﾅﾝｽ中
SET @MR4501              ; INDEX原点復帰完了
CON
RES MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
RES MR10010              ; 原点復帰動作中
CON
ENDS
MPP
AND MR23914              ; ﾒﾝﾃﾅﾝｽ中
RES MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
RES MR10010              ; 原点復帰動作中
CON
ENDS
;<h1/>INDEX上のﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝ
;・原点復帰後に各ﾃｰﾌﾞﾙ（ﾜｰｸｾｯﾄ治具）上のﾜｰｸの有無を確認する
STG @MR4700              ; CR_INDEX上ﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝｺｰﾙ
JMP @MR4703
;　Table No. 1  ﾜｰｸ有無確認
;　　非常停止時にこのﾜｰｸｾｯﾄ台が次の場合で再利用可の場合、且つﾜｰｸが全て乗ってる状態で有れば無視する
;　　　　　1.給材位置にあり全てのﾜｰｸの給材完了していた
;　　　　　2.ﾊﾞｯﾌｧ位置にいた
;　　　　　3.転写位置にあったが、接着剤転写前の状態であった
;　　　但し、上記条件のﾜｰｸｾｯﾄ台であっても、全ﾜｰｸ吸着の吸着圧がONでない場合は除材とする
STG @MR4703
ANB @MR001               ; TASK_0 ERROR
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
TMH @60 #3
CON
AND @T60
SET MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
JMP @MR4704
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
TMH @61 #3
CON
AND @T61
SET MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
JMP @MR4704
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
TMH @62 #3
CON
AND @T62
SET MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
JMP @MR4704
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
TMH @63 #3
CON
AND @T63
SET MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
JMP @MR4704
STG @MR4704
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13005               ; Table-1 救済ｽｲｯﾁ表示
AND R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
JMP @MR4915
MRD
AND LR13005              ; Table-1 救済ｽｲｯﾁ表示
MPS
ANB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
JMP @MR4705
MPP
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MPP
ANB LR13005              ; Table-1 救済ｽｲｯﾁ表示
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13105               ; Table-2 救済ｽｲｯﾁ表示
AND R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
JMP @MR4915
MRD
AND LR13105              ; Table-2 救済ｽｲｯﾁ表示
MPS
ANB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
JMP @MR4705
MPP
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MPP
ANB LR13105              ; Table-2 救済ｽｲｯﾁ表示
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13205               ; Table-3 救済ｽｲｯﾁ表示
AND R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
JMP @MR4915
MRD
AND LR13205              ; Table-3 救済ｽｲｯﾁ表示
MPS
ANB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
JMP @MR4705
MPP
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MPP
ANB LR13205              ; Table-3 救済ｽｲｯﾁ表示
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13305               ; Table-4 救済ｽｲｯﾁ表示
AND R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
AND MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
JMP @MR4915
MRD
AND LR13305              ; Table-4 救済ｽｲｯﾁ表示
MPS
ANB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
JMP @MR4705
MPP
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
MPP
ANB LR13305              ; Table-4 救済ｽｲｯﾁ表示
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
STG @MR4705
ANB R39004               ; ｴﾗｰ中
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #115 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4706
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #116 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4706
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #117 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4706
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #118 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4706
STG @MR4706
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR4707
STG @MR4707
MPS
AND @MR105               ; SW1
JMP @MR4703
MPP
AND @MR108               ; SW4
RES LR13305              ; Table-4 救済ｽｲｯﾁ表示
CON
JMP @MR4708              ; 接着剤塗布部　原点復帰要求
STG @MR4708              ; 接着剤塗布部　原点復帰要求
RES MR11413              ; 給材側 吸着治具 下降
CON
SET MR11412              ; 給材側 吸着治具 上昇
CON
MPS
LDB R7701                ; 給材側 吸着治具 下限
ANB MR7700               ; 給材側 吸着治具 上限ｴﾗｰ
AND R7700                ; 給材側 吸着治具 上限
ANL
JMP @MR4709
MPP
AND MR7700               ; 給材側 吸着治具 上限ｴﾗｰ
SET @MR1900              ; Main1 HALT許可
STG @MR4709
ZRES MR12100 MR12515     ; 給材部ﾜｰｸ1 吸着確認開始
CON
TMR @40 #1
CON
AND @T40
JMP @MR4710
STG @MR4710
SET MR12100              ; 給材部ﾜｰｸ1 吸着確認開始
CON
MPS
AND MR12101              ; 給材部ﾜｰｸ1 吸着確認-ON
SET @MR5800              ; 給材-1 ﾜｰｸ有り
CON
JMP @MR4711
MPP
AND MR12102              ; 給材部ﾜｰｸ1 吸着確認-OFF
RES @MR5800              ; 給材-1 ﾜｰｸ有り
CON
JMP @MR4711
STG @MR4711
SET MR12104              ; 給材部ﾜｰｸ1 破壊確認開始
CON
AND MR12105              ; 給材部ﾜｰｸ1 吸着破壊OK
ZRES MR12100 MR12107     ; 給材部ﾜｰｸ1 吸着確認開始
CON
JMP @MR4712
STG @MR4712
SET MR12108              ; 給材部ﾜｰｸ2 吸着確認開始
CON
MPS
AND MR12109              ; 給材部ﾜｰｸ2 吸着確認-ON
SET @MR5801              ; 給材-2 ﾜｰｸ有り
CON
JMP @MR4713
MPP
AND MR12110              ; 給材部ﾜｰｸ2 吸着確認-OFF
RES @MR5801              ; 給材-2 ﾜｰｸ有り
CON
JMP @MR4713
STG @MR4713
SET MR12112              ; 給材部ﾜｰｸ2 破壊確認開始
CON
AND MR12113              ; 給材部ﾜｰｸ2 吸着破壊OK
ZRES MR12108 MR12115     ; 給材部ﾜｰｸ2 吸着確認開始
CON
JMP @MR4714
STG @MR4714
SET MR12200              ; 給材部ﾜｰｸ3 吸着確認開始
CON
MPS
AND MR12201              ; 給材部ﾜｰｸ3 吸着確認-ON
SET @MR5802              ; 給材-3 ﾜｰｸ有り
CON
JMP @MR4715
MPP
AND MR12202              ; 給材部ﾜｰｸ3 吸着確認-OFF
RES @MR5802              ; 給材-3 ﾜｰｸ有り
CON
JMP @MR4715
STG @MR4715
SET MR12204              ; 給材部ﾜｰｸ3 破壊確認開始
CON
AND MR12205              ; 給材部ﾜｰｸ3 吸着破壊OK
ZRES MR12200 MR12207     ; 給材部ﾜｰｸ3 吸着確認開始
CON
JMP @MR4800
STG @MR4800
SET MR12208              ; 給材部ﾜｰｸ4 吸着確認開始
CON
MPS
AND MR12209              ; 給材部ﾜｰｸ4 吸着確認-ON
SET @MR5803              ; 給材-4 ﾜｰｸ有り
CON
JMP @MR4801
MPP
AND MR12210              ; 給材部ﾜｰｸ4 吸着確認-OFF
RES @MR5803              ; 給材-4 ﾜｰｸ有り
CON
JMP @MR4801
STG @MR4801
SET MR12212              ; 給材部ﾜｰｸ4 破壊確認開始
CON
AND MR12213              ; 給材部ﾜｰｸ4 吸着破壊OK
ZRES MR12208 MR12215     ; 給材部ﾜｰｸ4 吸着確認開始
CON
JMP @MR4802
STG @MR4802
SET MR12300              ; 給材部ﾜｰｸ5 吸着確認開始
CON
MPS
AND MR12301              ; 給材部ﾜｰｸ5 吸着確認-ON
SET @MR5804              ; 給材-5 ﾜｰｸ有り
CON
JMP @MR4803
MPP
AND MR12302              ; 給材部ﾜｰｸ5 吸着確認-OFF
RES @MR5804              ; 給材-5 ﾜｰｸ有り
CON
JMP @MR4803
STG @MR4803
SET MR12304              ; 給材部ﾜｰｸ5 破壊確認開始
CON
AND MR12305              ; 給材部ﾜｰｸ5 吸着破壊OK
ZRES MR12300 MR12307     ; 給材部ﾜｰｸ5 吸着確認開始
CON
JMP @MR4804
STG @MR4804
SET MR12308              ; 給材部ﾜｰｸ6 吸着確認開始
CON
MPS
AND MR12309              ; 給材部ﾜｰｸ6 吸着確認-ON
SET @MR5805              ; 給材-6 ﾜｰｸ有り
CON
JMP @MR4805
MPP
AND MR12310              ; 給材部ﾜｰｸ6 吸着確認-OFF
RES @MR5805              ; 給材-6 ﾜｰｸ有り
CON
JMP @MR4805
STG @MR4805
SET MR12312              ; 給材部ﾜｰｸ6 破壊確認開始
CON
AND MR12313              ; 給材部ﾜｰｸ6 吸着破壊OK
ZRES MR12308 MR12315     ; 給材部ﾜｰｸ6 吸着確認開始
CON
JMP @MR4806
STG @MR4806
SET MR12400              ; 給材部ﾜｰｸ7 吸着確認開始
CON
MPS
AND MR12401              ; 給材部ﾜｰｸ7 吸着確認-ON
SET @MR5806              ; 給材-7 ﾜｰｸ有り
CON
JMP @MR4807
MPP
AND MR12402              ; 給材部ﾜｰｸ7 吸着確認-OFF
RES @MR5806              ; 給材-7 ﾜｰｸ有り
CON
JMP @MR4807
STG @MR4807
SET MR12404              ; 給材部ﾜｰｸ7 破壊確認開始
CON
AND MR12405              ; 給材部ﾜｰｸ7 吸着破壊OK
ZRES MR12400 MR12407     ; 給材部ﾜｰｸ7 吸着確認開始
CON
JMP @MR4808
STG @MR4808
SET MR12408              ; 給材部ﾜｰｸ8 吸着確認開始
CON
MPS
AND MR12409              ; 給材部ﾜｰｸ8 吸着確認-ON
SET @MR5807              ; 給材-8 ﾜｰｸ有り
CON
JMP @MR4809
MPP
AND MR12410              ; 給材部ﾜｰｸ8 吸着確認-OFF
RES @MR5807              ; 給材-8 ﾜｰｸ有り
CON
JMP @MR4809
STG @MR4809
SET MR12412              ; 給材部ﾜｰｸ8 破壊確認開始
CON
AND MR12413              ; 給材部ﾜｰｸ8 吸着破壊OK
ZRES MR12408 MR12415     ; 給材部ﾜｰｸ8 吸着確認開始
CON
JMP @MR4810
STG @MR4810
SET MR12500              ; 給材部ﾜｰｸ9 吸着確認開始
CON
MPS
AND MR12501              ; 給材部ﾜｰｸ9 吸着確認-ON
SET @MR5808              ; 給材-9 ﾜｰｸ有り
CON
JMP @MR4811
MPP
AND MR12502              ; 給材部ﾜｰｸ9 吸着確認-OFF
RES @MR5808              ; 給材-9 ﾜｰｸ有り
CON
JMP @MR4811
STG @MR4811
SET MR12504              ; 給材部ﾜｰｸ9 破壊確認開始
CON
AND MR12505              ; 給材部ﾜｰｸ9 吸着破壊OK
ZRES MR12500 MR12507     ; 給材部ﾜｰｸ9 吸着確認開始
CON
JMP @MR4812
STG @MR4812
SET MR12508              ; 給材部ﾜｰｸ10 吸着確認開始
CON
MPS
AND MR12509              ; 給材部ﾜｰｸ10 吸着確認-ON
SET @MR5809              ; 給材-10 ﾜｰｸ有り
CON
JMP @MR4813
MPP
AND MR12510              ; 給材部ﾜｰｸ10 吸着確認-OFF
RES @MR5809              ; 給材-10 ﾜｰｸ有り
CON
JMP @MR4813
STG @MR4813
SET MR12512              ; 給材部ﾜｰｸ10 破壊確認開始
CON
AND MR12513              ; 給材部ﾜｰｸ10 吸着破壊OK
ZRES MR12508 MR12515     ; 給材部ﾜｰｸ10 吸着確認開始
CON
JMP @MR4900
STG @MR4900
MPS
LDB @MR5800              ; 給材-1 ﾜｰｸ有り
ANB @MR5801              ; 給材-2 ﾜｰｸ有り
ANB @MR5802              ; 給材-3 ﾜｰｸ有り
ANB @MR5803              ; 給材-4 ﾜｰｸ有り
ANB @MR5804              ; 給材-5 ﾜｰｸ有り
ANB @MR5805              ; 給材-6 ﾜｰｸ有り
ANB @MR5806              ; 給材-7 ﾜｰｸ有り
ANB @MR5807              ; 給材-8 ﾜｰｸ有り
ANL
JMP @MR4906
MPP
LD @MR5800               ; 給材-1 ﾜｰｸ有り
OR @MR5801               ; 給材-2 ﾜｰｸ有り
OR @MR5802               ; 給材-3 ﾜｰｸ有り
OR @MR5803               ; 給材-4 ﾜｰｸ有り
OR @MR5804               ; 給材-5 ﾜｰｸ有り
OR @MR5805               ; 給材-6 ﾜｰｸ有り
OR @MR5806               ; 給材-7 ﾜｰｸ有り
OR @MR5807               ; 給材-8 ﾜｰｸ有り
OR @MR5808               ; 給材-9 ﾜｰｸ有り
OR @MR5809               ; 給材-10 ﾜｰｸ有り
ANL
JMP @MR4901
STG @MR4901
ANB R39004               ; ｴﾗｰ中
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #6000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #32 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4902
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #6000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #33 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4902
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #6000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #34 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4902
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET R39004               ; ｴﾗｰ中
CON
DW #6000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #35 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR4902
STG @MR4902
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR4903
STG @MR4903
AND @MR105               ; SW1
ANB MR10011              ; ﾌｨﾙﾑ受けｾｯﾄ中
JMP @MR4904
STG @MR4904
ANB @MR001               ; TASK_0 ERROR
RES MR11412              ; 給材側 吸着治具 上昇
CON
SET MR11413              ; 給材側 吸着治具 下降
CON
MPS
LDB R7700                ; 給材側 吸着治具 上限
ANB MR7701               ; 給材側 吸着治具 下限ｴﾗｰ
AND R7701                ; 給材側 吸着治具 下限
ANB R41200               ; TASK0 PAUSE 
ANL
JMP @MR4905
MPP
LD MR7701                ; 給材側 吸着治具 下限ｴﾗｰ
AND R41200               ; TASK0 PAUSE 
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR4905
ZRES MR12100 MR12515     ; 給材部ﾜｰｸ1 吸着確認開始
CON
TMR @41 #1
CON
AND @T41
JMP @MR4709
STG @MR4906
SET MR12104              ; 給材部ﾜｰｸ1 破壊確認開始
CON
SET MR12112              ; 給材部ﾜｰｸ2 破壊確認開始
CON
SET MR12204              ; 給材部ﾜｰｸ3 破壊確認開始
CON
SET MR12212              ; 給材部ﾜｰｸ4 破壊確認開始
CON
SET MR12304              ; 給材部ﾜｰｸ5 破壊確認開始
CON
SET MR12312              ; 給材部ﾜｰｸ6 破壊確認開始
CON
SET MR12404              ; 給材部ﾜｰｸ7 破壊確認開始
CON
SET MR12412              ; 給材部ﾜｰｸ8 破壊確認開始
CON
SET MR12504              ; 給材部ﾜｰｸ9 破壊確認開始
CON
SET MR12512              ; 給材部ﾜｰｸ10 破壊確認開始
CON
JMP @MR4907
STG @MR4907
AND MR12105              ; 給材部ﾜｰｸ1 吸着破壊OK
AND MR12113              ; 給材部ﾜｰｸ2 吸着破壊OK
AND MR12205              ; 給材部ﾜｰｸ3 吸着破壊OK
AND MR12213              ; 給材部ﾜｰｸ4 吸着破壊OK
AND MR12305              ; 給材部ﾜｰｸ5 吸着破壊OK
AND MR12313              ; 給材部ﾜｰｸ6 吸着破壊OK
AND MR12405              ; 給材部ﾜｰｸ7 吸着破壊OK
AND MR12413              ; 給材部ﾜｰｸ8 吸着破壊OK
AND MR12505              ; 給材部ﾜｰｸ9 吸着破壊OK
AND MR12513              ; 給材部ﾜｰｸ10 吸着破壊OK
JMP @MR4908
STG @MR4908
ZRES MR12100 MR12515     ; 給材部ﾜｰｸ1 吸着確認開始
CON
JMP @MR4909
STG @MR4909
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13005              ; Table-1 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR4910
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13105              ; Table-2 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR4911
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13205              ; Table-3 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR4912
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13305              ; Table-4 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR4913
STG @MR4910
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
TMH @42 #3
CON
AND @T42
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12001 LR12010     ; INDEX_治具1 ﾜｰｸ有無-1  INDEX_治具1 ﾜｰｸ有無-10
CON
JMP @MR4914
STG @MR4911
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
TMH @43 #3
CON
AND @T43
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12101 LR12110     ; INDEX_治具2 ﾜｰｸ有無-1  INDEX_治具2 ﾜｰｸ有無-10
CON
JMP @MR4914
STG @MR4912
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
TMH @44 #3
CON
AND @T44
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12201 LR12210     ; INDEX_治具3 ﾜｰｸ有無-1  INDEX_治具3 ﾜｰｸ有無-10
CON
JMP @MR4914
STG @MR4913
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
TMH @45 #3
CON
AND @T45
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12301 LR12310     ; INDEX_治具4 ﾜｰｸ有無-1  INDEX_治具4 ﾜｰｸ有無-10
CON
JMP @MR4914
STG @MR4914
ANB MR10011              ; ﾌｨﾙﾑ受けｾｯﾄ中
ANB @MR001               ; TASK_0 ERROR
RES MR11412              ; 給材側 吸着治具 上昇
CON
SET MR11413              ; 給材側 吸着治具 下降
CON
MPS
LDB R7700                ; 給材側 吸着治具 上限
ANB MR7701               ; 給材側 吸着治具 下限ｴﾗｰ
AND R7701                ; 給材側 吸着治具 下限
ANL
JMP @MR4915
MPP
LD MR7701                ; 給材側 吸着治具 下限ｴﾗｰ
AND R41200               ; TASK0 PAUSE 
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR4915
SET @MR4701              ; INDEX上ﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝ処理完
CON
ENDS
;<h1/>NR_LINE INDEX上のﾜｰｸ有無確認ｻﾌﾞﾙｰﾁﾝ
STG @MR5200
BANB DM16000 #15
ANB @MR5503
JMP @MR5303
;　Table ﾜｰｸ有無確認
;　　非常停止時にこのﾜｰｸｾｯﾄ台が次の場合で再利用可の場合、且つﾜｰｸが全て乗ってる状態で有れば無視する
;　　　　　1.給材位置にあり全てのﾜｰｸの給材完了していた
;　　　　　2.ﾊﾞｯﾌｧ位置にいた
;　　　　　3.転写位置にあったが、接着剤転写前の状態であった
;　　　但し、上記条件のﾜｰｸｾｯﾄ台であっても、全ﾜｰｸ吸着の吸着圧がONでない場合は除材とする
STG @MR5303
ANB @MR001               ; TASK_0 ERROR
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
TMH @65 #3
CON
AND @T65
SET MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
JMP @MR5304
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
TMH @66 #3
CON
AND @T66
SET MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
JMP @MR5304
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
TMH @67 #3
CON
AND @T67
SET MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
JMP @MR5304
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
TMH @68 #3
CON
AND @T68
SET MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
JMP @MR5304
STG @MR5304
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13005               ; Table-1 救済ｽｲｯﾁ表示
AND R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
JMP @MR5502
MRD
AND LR13005              ; Table-1 救済ｽｲｯﾁ表示
MPS
ANB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
JMP @MR5411
MPP
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
JMP @MR5406
MPP
ANB LR13005              ; Table-1 救済ｽｲｯﾁ表示
JMP @MR5406
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13105               ; Table-2 救済ｽｲｯﾁ表示
AND R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
JMP @MR5502
MRD
AND LR13105              ; Table-2 救済ｽｲｯﾁ表示
MPS
ANB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
JMP @MR5411
MPP
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
JMP @MR5406
MPP
ANB LR13105              ; Table-2 救済ｽｲｯﾁ表示
JMP @MR5406
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13205               ; Table-3 救済ｽｲｯﾁ表示
AND R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
JMP @MR5502
MRD
AND LR13205              ; Table-3 救済ｽｲｯﾁ表示
MPS
ANB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
JMP @MR5411
MPP
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
JMP @MR5406
MPP
ANB LR13205              ; Table-3 救済ｽｲｯﾁ表示
JMP @MR5406
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LDB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
DW #0 EM31404
MRD
LD LR13305               ; Table-4 救済ｽｲｯﾁ表示
AND R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
AND MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
JMP @MR5502
MRD
AND LR13305              ; Table-4 救済ｽｲｯﾁ表示
MPS
ANB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
JMP @MR5411
MPP
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
JMP @MR5406
MPP
ANB LR13305              ; Table-4 救済ｽｲｯﾁ表示
JMP @MR5406
STG @MR5411
MPS
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #115 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5412
MRD
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #116 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5412
MRD
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #117 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5412
MPP
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #118 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5412
STG @MR5412
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5413
STG @MR5413
MPS
AND @MR105               ; SW1
JMP @MR5303
MPP
AND @MR108               ; SW4
RES LR13305              ; Table-4 救済ｽｲｯﾁ表示
CON
JMP @MR5406
STG @MR5406
TMR @46 #10
CON
AND @T46
JMP @MR5500
STG @MR5407
AND R18001               ; 画像　給材部ﾜｰｸ検査完了
RES R18001               ; 画像　給材部ﾜｰｸ検査完了
CON
JMP @MR5408
LD @MR5408
AND R18201               ; ﾜｰｸ1　無し
AND R18203               ; ﾜｰｸ2　無し
AND R18205               ; ﾜｰｸ3　無し
AND R18207               ; ﾜｰｸ4　無し
AND R18209               ; ﾜｰｸ5　無し
AND R18211               ; ﾜｰｸ6　無し
AND R18213               ; ﾜｰｸ7　無し
AND R18215               ; ﾜｰｸ8　無し
AND R18301               ; ﾜｰｸ9　無し
AND R18303               ; ﾜｰｸ10　無し
SET @MR6003              ; 不要ﾜｰｸ無し
STG @MR5408
MPS
AND @MR6003              ; 不要ﾜｰｸ無し
JMP @MR5500
MPP
ANB @MR6003              ; 不要ﾜｰｸ無し
TMR @47 #10
CON
AND @T47
JMP @MR5409
STG @MR5409
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #6004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #32 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW #1024 DM29050
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5410
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #6004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #33 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW #1024 DM29050
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5410
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #6004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #34 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW #1024 DM29050
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5410
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #6004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #35 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW #1024 DM29050
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5410
STG @MR5410
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR6003              ; 不要ﾜｰｸ無し
CON
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5414
STG @MR5414
MPS
AND @MR105               ; SW1
DW #0 DM29050
CON
JMP @MR5406
MPP
AND @MR108               ; SW4
DW #0 DM29050
CON
JMP @MR5500
STG @MR5500
RES @MR6003              ; 不要ﾜｰｸ無し
CON
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13005              ; Table-1 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR5501
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13105              ; Table-2 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR5501
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13205              ; Table-3 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR5501
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES LR13305              ; Table-4 救済ｽｲｯﾁ表示
CON
DW #0 EM30000            ; 1stﾜｰｸ情報
CON
JMP @MR5501
STG @MR5501
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
TMH @70 #3
CON
AND @T70
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12001 LR12010     ; INDEX_治具1 ﾜｰｸ有無-1  INDEX_治具1 ﾜｰｸ有無-10
CON
JMP @MR5502
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
TMH @71 #3
CON
AND @T71
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12101 LR12110     ; INDEX_治具2 ﾜｰｸ有無-1  INDEX_治具2 ﾜｰｸ有無-10
CON
JMP @MR5502
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
TMH @72 #3
CON
AND @T72
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12201 LR12210     ; INDEX_治具3 ﾜｰｸ有無-1  INDEX_治具3 ﾜｰｸ有無-10
CON
JMP @MR5502
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
TMH @73 #3
CON
AND @T73
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
ZRES LR12301 LR12310     ; INDEX_治具4 ﾜｰｸ有無-1  INDEX_治具4 ﾜｰｸ有無-10
CON
JMP @MR5502
STG @MR5502
SET @MR5201
CON
ENDS
;<h1/>INDEX動作ｻﾌﾞﾙｰﾁﾝ
;・INDEX回転は、ﾌﾟﾛｸﾞﾗﾑNo.0〜3にて行う。
;・各ﾌﾟﾛｸﾞﾗﾑは、4分割指定。
;・移動完了で、ｲﾝﾃﾞｯｸｽ位置に次の番号を書き込む。
STG @MR5000              ; INDEX回転ｻﾌﾞﾙｰﾁﾝｺｰﾙ
SET MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
SET MR6110               ; INDEX 非常停止
CON
JMP @MR5100
STG @MR5100
TMH @50 #3
CON
AND @T50
SET MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR5101
STG @MR5101
MPS
LD R5308                 ; INDEX ｱﾗｰﾑ1
AND R5309                ; INDEX ｱﾗｰﾑ2
ANL
RES MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR5004
MPP
LDB R5308                ; INDEX ｱﾗｰﾑ1
ORB R5309                ; INDEX ｱﾗｰﾑ2
ANL
TMH @51 #3
CON
AND @T51
RES MR6107               ; INDEX ﾘｾｯﾄ
CON
JMP @MR5102
STG @MR5102
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #16 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5103
STG @MR5103
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5104
STG @MR5104
AND @MR105               ; SW1
JMP @MR5100
STG @MR5004
AND R5307                ; INDEX 起動入力待ち
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
RES MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
JMP @MR5005
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
SET MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
JMP @MR5005
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
SET MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
JMP @MR5005
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
RES MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
JMP @MR5005
STG @MR5005
TMH @52 #3
CON
AND @T52
SET MR6106               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1桁目
CON
JMP @MR5006
STG @MR5006
TMH @53 #3
CON
AND @T53
AND MR004                ; ｲﾝﾃﾞｯｸｽ回転ｲﾝﾀｰﾛｯｸOK 
SET MR002                ; ｲﾝﾃﾞｯｸｽ回転中
CON
SET MR6108               ; INDEX 起動
CON
JMP @MR5007
STG @MR5007
ANB R5307                ; INDEX 起動入力待ち
RES MR6108               ; INDEX 起動
CON
RES MR6112               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 0ﾋﾞｯﾄ
CON
RES MR6113               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1ﾋﾞｯﾄ
CON
RES MR6114               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 2ﾋﾞｯﾄ
CON
RES MR6106               ; INDEX ﾌﾟﾛｸﾞﾗﾑNo. 1桁目
CON
JMP @MR5008
STG @MR5008
AND R5306                ; INDEX 位置決め完了
JMP @MR5009
STG @MR5009
SET MR6109               ; INDEX ｱﾝｻ
CON
JMP @MR5010
STG @MR5010
ANB R5306                ; INDEX 位置決め完了
RES MR6109               ; INDEX ｱﾝｻ
CON
RES MR002                ; ｲﾝﾃﾞｯｸｽ回転中
CON
JMP @MR5011
STG @MR5011
AND R5307                ; INDEX 起動入力待ち
JMP @MR5012
STG @MR5012
MPS
AND<= DM35000 #2         ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
JMP @MR5013
MPP
AND>= DM35000 #3         ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
JMP @MR5014
STG @MR5013
@INC DM35000             ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
CON
SET MR014                ; Index Data shift Request 
CON
JMP @MR5015
STG @MR5014
DW #0 DM35000            ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
CON
SET MR014                ; Index Data shift Request 
CON
JMP @MR5015
STG @MR5015
AND MR510                ; 完了
RES @MR5002              ; INDEX動作ｻﾌﾞﾙｰﾁﾝ処理中
CON
MPS
ANB MR23914              ; ﾒﾝﾃﾅﾝｽ中
RES MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
SET @MR5001              ; INDEX回転ｻﾌﾞﾙｰﾁﾝ処理完了
CON
RES MR510                ; 完了
CON
ENDS
MPP
AND MR23914              ; ﾒﾝﾃﾅﾝｽ中
RES MR5602               ; O_ｲﾝﾀｰﾛｯｸ信号1
CON
RES MR510                ; 完了
CON
ENDS
;<h1/>画像検査要求ｻﾌﾞﾙｰﾁﾝ
;DM16000（仮割付）：給材ｶﾒﾗ状態信号
;bit0:FLG　　ｺﾏﾝﾄﾞ実行完了時ON
;bit1:BUSY　 制御ｺﾏﾝﾄﾞ実行中ON
;bit2:READY　ONでｺﾏﾝﾄﾞ実行可能
;bit3:OR　　 判定結果NGでON
;bit4:RUN　　ｶﾒﾗ運転ﾓｰﾄﾞ中にON
;bit15:ERR　 異常時ON
;
;DM16040：給材ｶﾒﾗ制御信号
;bit0:EXE　　制御ｺﾏﾝﾄﾞ実行
;bit1:TRG　　計測実行
;bit15:ERCLR ｴﾗｰｸﾘｱ
BLD DM16000 #15
ANB @MR003               ; 給材ｶﾒﾗｱﾗｰﾑ
OUT @MR5503
;最新ｴﾗｰ情報取得 ｺﾏﾝﾄﾞｺｰﾄﾞ：00205000
;下位4桁 DM16042→5000＝0101,0000,0000,0000（10進数：#20480）
;上位4桁 DM16043→0020＝0000,0000,0010,0000 (10進数：＃32）
LDP @MR5503
ANB R39004               ; ｴﾗｰ中
SET @MR003               ; 給材ｶﾒﾗｱﾗｰﾑ
CON
SET R39004               ; ｴﾗｰ中
CON
MOV #20480 DM16042
MOV #32 DM16043
SET @MR5504
;給材ｶﾒﾗ制御ｺﾏﾝﾄﾞ実行
STG @MR5504
BSET DM16040 #0
CON
BRES DM16040 #1
CON
BAND DM16000 #1
JMP @MR5505
STG @MR5505
BAND DM16000 #0
BRES DM16040 #0
CON
JMP @MR5506
;給材ｶﾒﾗ計測実行
STG @MR5506
BRES DM16040 #0
CON
BSET DM16040 #1
CON
BAND DM16000 #1
JMP @MR5508
STG @MR5508
BRES DM16040 #1
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #50 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @MR5510
STG @MR5510
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task0 ERROR_End
RES @MR101               ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5512
STG @MR5512
AND @MR105               ; SW1
BSET DM16040 #15
CON
BANB DM16000 #15
TMR @98 #5
CON
AND @T98
BRES DM16040 #15
CON
RES @MR003               ; 給材ｶﾒﾗｱﾗｰﾑ
CON
ENDS
;<h1/>HALT
LD R41200                ; TASK0 PAUSE 
AND @MR1900              ; Main1 HALT許可
ANB MR002                ; ｲﾝﾃﾞｯｸｽ回転中
TMR @190 #2
CON
AND @T190
SET R42600               ; _Grp1_Task0_ﾎﾟｰｽﾞ許可
LDB R41200               ; TASK0 PAUSE 
RES @MR1900              ; Main1 HALT許可
CON
RES R42600               ; _Grp1_Task0_ﾎﾟｰｽﾞ許可
;
END
ENDH
