DEVICE:51
;MODULE:厚み検査
;MODULE_TYPE:0
;非常停止 / Emergency stop
LD R50010                ; 非常停止
OR @MR001
ZRES @MR1915 @MR315
CON
ZRES MR1100 MR1115       ; 厚み検査開始ﾌﾗｸﾞ  ｴﾘｱｾﾝｻ遮光有り
CON
OUT @MR001
TMR @0 #5
LD @T0
MDSTOP 厚み検査
LDB R50300               ; 一時停止中
ANB R50008               ; 全体ERROR
OUT @MR012
;ﾒｲﾝ動作
LD R50001                ; 自動運転中
AND MR2000               ; AUTO：各ﾓｼﾞｭｰﾙ開始
@SET @MR1000
STG @MR1000
RES MR1114               ; ﾘﾄﾗｲ要求
CON
ANB MR1110               ; 厚み検査動作中
MPS
AND MR1100               ; 厚み検査開始ﾌﾗｸﾞ
ZRES MR31100 MR31103     ; ｽﾃｰﾀ検査OK  ﾛｰﾀｰ検査NG
CON
SET MR1110               ; 厚み検査動作中
CON
RES R55004               ; TP_停止中表示
CON
SET R55005               ; TP_動作中表示
CON
JMP @MR1001
MPP
LDB MR1100               ; 厚み検査開始ﾌﾗｸﾞ
AND MR1107               ; 厚み検査停止ﾌﾗｸﾞ
ANL
ZRES MR31100 MR31103     ; ｽﾃｰﾀ検査OK  ﾛｰﾀｰ検査NG
CON
SET MR1108               ; 厚み検査停止完了
CON
RES MR1107               ; 厚み検査停止ﾌﾗｸﾞ
CON
ENDS
STG @MR1001
RES MR1100               ; 厚み検査開始ﾌﾗｸﾞ
CON
AND R2004                ; ﾛｰﾀ側　搬送中ﾁｬｯｸ開閉　開限　
AND R2006                ; ｽﾃｰﾀ側　搬送中ﾁｬｯｸ開閉　開限　
AND R2014                ; 搬送中ﾁｬｯｸ上下　下降限
ANB R2304                ; 搬送ｽﾃｰﾀ　中ﾁｬｯｸ前後　前進限
ANB R2306                ; 搬送ﾛｰﾀ　中ﾁｬｯｸ前後　前進限
JMP @MR1002
STG @MR1002
SET MR1111               ; 一時停止禁止
CON
SET MR3502               ; 厚み検査部　変位ｾﾝｻ上下　下降
CON
MPS
AND R2103                ; 厚み検査部　変位ｾﾝｻ上下　下降限
JMP @MR1005
MPP
LDB R2103                ; 厚み検査部　変位ｾﾝｻ上下　下降限
AND R20000               ; 反転PP部　ｽﾃｰﾀ 1個前押え下降SW
ANL
JMP @MR1003
STG @MR1003
RES MR3502               ; 厚み検査部　変位ｾﾝｻ上下　下降
CON
RES MR1111               ; 一時停止禁止
CON
TMR @2 #3
CON
AND @T2
JMP @MR1004
STG @MR1004
AND @MR012
ANB R20000               ; 反転PP部　ｽﾃｰﾀ 1個前押え下降SW
JMP @MR1002
STG @MR1005
TMR @3 #5
CON
AND @T3
ZRES MR31100 MR31103     ; ｽﾃｰﾀ検査OK  ﾛｰﾀｰ検査NG
CON
SET MR1105               ; 厚み検査開始　ｻﾌﾞﾙｰﾁﾝｺｰﾙ!
CON
JMP @MR1006
STG @MR1006
AND MR1106               ; 厚み検査完了
OUT MR511                ; ﾛｷﾞﾝｸﾞﾄﾘｶﾞ
CON
RES MR1106               ; 厚み検査完了
CON
RES MR1111               ; 一時停止禁止
CON
JMP @MR1007
STG @MR1007
MPS
LD MR31100               ; ｽﾃｰﾀ検査OK
OR MR31101               ; ｽﾃｰﾀ検査NG
LD MR31102               ; ﾛｰﾀｰ検査OK
OR MR31103               ; ﾛｰﾀｰ検査NG
ANL
ANL
JMP @MR1100
MPP
LD MR31100               ; ｽﾃｰﾀ検査OK
AND MR31101              ; ｽﾃｰﾀ検査NG
LDB MR31100              ; ｽﾃｰﾀ検査OK
ANB MR31101              ; ｽﾃｰﾀ検査NG
ORL
LD MR31102               ; ﾛｰﾀｰ検査OK
AND MR31103              ; ﾛｰﾀｰ検査NG
ORL
LDB MR31102              ; ﾛｰﾀｰ検査OK
ANB MR31103              ; ﾛｰﾀｰ検査NG
ORL
ANL
SET @MR108
CON
JMP @MR1009
STG @MR1009
AND @MR115
RES @MR115
CON
JMP @MR1010
STG @MR1010
MPS
AND MR1114               ; ﾘﾄﾗｲ要求
ZRES MR31100 MR31103     ; ｽﾃｰﾀ検査OK  ﾛｰﾀｰ検査NG
CON
JMP @MR1000
MPP
ANB MR1114               ; ﾘﾄﾗｲ要求
SET MR31101              ; ｽﾃｰﾀ検査NG
CON
SET MR31103              ; ﾛｰﾀｰ検査NG
CON
RES MR1114               ; ﾘﾄﾗｲ要求
CON
JMP @MR1100
STG @MR1100
MPS
AND MR31101              ; ｽﾃｰﾀ検査NG
@INC DM510               ; ｽﾃ-ﾀ検査NGｶｳﾝﾄ
CON
SET MR1102               ; NG排出要求_ｽﾃｰﾀ
MRD
AND MR31103              ; ﾛｰﾀｰ検査NG
@INC DM511               ; ﾛｰﾀｰ検査NGｶｳﾝﾄ
CON
SET MR1103               ; NG排出要求_ﾛｰﾀ
MRD
AND MR31100              ; ｽﾃｰﾀ検査OK
@LDA #0
CON
@STA DM510               ; ｽﾃ-ﾀ検査NGｶｳﾝﾄ
CON
@INC.D DM7002            ; ｽﾃｰﾀOK品ｶｳﾝﾄ
CON
RES MR1102               ; NG排出要求_ｽﾃｰﾀ
MRD
AND MR31102              ; ﾛｰﾀｰ検査OK
@LDA #0
CON
@STA DM511               ; ﾛｰﾀｰ検査NGｶｳﾝﾄ
CON
@INC.D DM7004            ; ｽﾃｰﾀOK品ｶｳﾝﾄ
CON
RES MR1103               ; NG排出要求_ﾛｰﾀ
MPP
TMR @4 #1
CON
AND @T4
JMP @MR1101
STG @MR1101
MPS
LD>= DM510 #3            ; ｽﾃ-ﾀ検査NGｶｳﾝﾄ
OR>= DM511 #3            ; ﾛｰﾀｰ検査NGｶｳﾝﾄ
ANL
SET MR1104               ; NG3回連続発生
CON
JMP @MR1115
MPP
LD< DM510 #3             ; ｽﾃ-ﾀ検査NGｶｳﾝﾄ
AND< DM511 #3            ; ﾛｰﾀｰ検査NGｶｳﾝﾄ
ANL
JMP @MR1115
STG @MR1115
RES MR3502               ; 厚み検査部　変位ｾﾝｻ上下　下降
CON
AND R2104                ; 厚み検査部　変位ｾﾝｻ上下　上昇限
RES R55005               ; TP_動作中表示
CON
SET R55004               ; TP_停止中表示
CON
RES MR1110               ; 厚み検査動作中
CON
JMP @MR1000
;Err56　　厚み検査部　検査失敗
STG @MR108
ANB R50008               ; 全体ERROR
SET R50008               ; 全体ERROR
CON
SET R51100               ; ﾘﾄﾗｲSW表示
CON
SET R51003               ; 厚み検査/NG排出部
CON
SET R50803               ; ERR51
CON
JMP @MR110
MOV #51 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR110
AND R50008               ; 全体ERROR
JMP @MR111
STG @MR111
ANB R50008               ; 全体ERROR
SET @MR115
CON
ENDS
END
ENDH
