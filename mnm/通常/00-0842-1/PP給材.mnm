DEVICE:51
;MODULE:PP給材
;MODULE_TYPE:0
;非常停止 / Emergency stop
LD R50010                ; 非常停止
OR @MR001
ZRES @MR002 @MR3915
CON
ZRES MR1700 MR1715       ; PP給材動作　ﾜｰｸ搬送中
CON
OUT @MR001
TMR @0 #5
LD @T0
MDSTOP PP給材
LDB R50300               ; 一時停止中
ANB R50008               ; 全体ERROR
OUT @MR012
;回転位置決め前PP給材動作ﾒｲﾝ
LD R50001                ; 自動運転中
AND MR2000               ; AUTO：各ﾓｼﾞｭｰﾙ開始
@SET @MR2000
STG @MR2000
ANB MR1700               ; PP給材動作　ﾜｰｸ搬送中
MPS
LD R1901                 ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
AND R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
ANL
RES MR900                ; ｽﾃｰﾀ　ｽﾄｯﾊﾟｴｽｹｰﾊﾟ動作完了
CON
RES MR901                ; ﾛｰﾀ　ｽﾄｯﾊﾟｴｽｹｰﾊﾟ動作完了
CON
RES MR1701               ; CVより取出し中
CON
SET MR1700               ; PP給材動作　ﾜｰｸ搬送中
CON
JMP @MR2100
MRD
LDB R1901                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
AND R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
LD R1901                 ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
ANB R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
ORL
ANL
TMR #105 #20
CON
AND T105
SET @MR100
CON
JMP @MR2001
MPP
LDB R1900                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開限
ANB R1901                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
ANB R1902                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開限
ANB R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
LD R1900                 ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開限
AND R1902                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開限
ORL
ANL
JMP @MR2005
STG @MR2001
AND @MR107
RES @MR107
CON
JMP @MR2000
STG @MR2005
AND @MR012
MPS
LDB R51200               ; 装置停止要求
AND MR907                ; 排出準備OK　ｽﾃｰﾀ　有り
AND MR906                ; 排出準備OK　ﾛｰﾀ　有り
LD R1800                 ; 平打ち前　ﾛｰﾀ 1個前押え下降限
AND R1802                ; 平打ち前　ｽﾃｰﾀ 1個前押え下降限
OR CR2002                ; 常時ON
ANL
ANL
TMR @1 #0
CON
AND @T1
JMP @MR2006
MPP
AND R51200               ; 装置停止要求
RES MR1700               ; PP給材動作　ﾜｰｸ搬送中
CON
SET MR1705               ; PP給材部停止完了
CON
ENDS
STG @MR2006
AND @MR012
SET MR1701               ; CVより取出し中
CON
RES MR3214               ; 回転位置決め　搬送　位置決め側行
CON
SET MR3215               ; 回転位置決め　搬送ｺﾝﾍﾞｱ側行
CON
AND R1907                ; 回転位置決め　搬送ｺﾝﾍﾞｱ側限
JMP @MR2007
STG @MR2007
AND @MR012
SET MR3208               ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開
CON
SET MR3210               ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開
CON
AND R1900                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開限
ANB R1901                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
AND R1902                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開限
ANB R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
JMP @MR2008
STG @MR2008
AND @MR012
ANB R47100               ; 搬送P&P下降不可
SET MR3212               ; 回転位置決め　ﾁｬｯｸ上下　下降
CON
ANB R1905                ; 回転位置決め　ﾁｬｯｸ上下　上昇限
AND R1904                ; 回転位置決め　ﾁｬｯｸ上下　下降限
JMP @MR2009
STG @MR2009
AND @MR012
RES MR3208               ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開
CON
RES MR3210               ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開
CON
TMR @2 #3
CON
AND @T2
JMP @MR2010
STG @MR2010
AND @MR012
RES MR3212               ; 回転位置決め　ﾁｬｯｸ上下　下降
CON
ANB R1904                ; 回転位置決め　ﾁｬｯｸ上下　下降限
AND R1905                ; 回転位置決め　ﾁｬｯｸ上下　上昇限
LDA #1
CON
STA DM160                ; 位置決めPPﾁｬｯｸ_ｽﾃｰﾀ
CON
STA DM161                ; 位置決めPPﾁｬｯｸ_ﾛｰﾀ
CON
JMP @MR2000
STG @MR2100
AND @MR012
RES MR3215               ; 回転位置決め　搬送ｺﾝﾍﾞｱ側行
CON
SET MR3214               ; 回転位置決め　搬送　位置決め側行
CON
AND R1906                ; 回転位置決め　搬送　位置決め側限
JMP @MR2101
STG @MR2101
MPS
AND R2312                ; PP搬送ﾁｬｯｸ　ﾜｰｸ下方ｽﾞﾚ検出
TMR @5 #2
CON
AND @T5
JMP @MR2200
MPP
ANB R2312                ; PP搬送ﾁｬｯｸ　ﾜｰｸ下方ｽﾞﾚ検出
TMR @6 #10
CON
AND @T6
SET @MR108
CON
JMP @MR2102
STG @MR2102
AND @MR115
RES @MR115
CON
JMP @MR2103
STG @MR2103
MPS
LDB R1900                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開限
ANB R1901                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
ANB R1902                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開限
ANB R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
ANL
JMP @MR2104
MPP
LD R1901                 ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
AND R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
ANL
JMP @MR2101
STG @MR2104
AND @MR012
RES MR3214               ; 回転位置決め　搬送　位置決め側行
CON
SET MR3215               ; 回転位置決め　搬送ｺﾝﾍﾞｱ側行
CON
AND R1907                ; 回転位置決め　搬送ｺﾝﾍﾞｱ側限
LDA #0
CON
STA DM160                ; 位置決めPPﾁｬｯｸ_ｽﾃｰﾀ
CON
STA DM161                ; 位置決めPPﾁｬｯｸ_ﾛｰﾀ
CON
RES MR1700               ; PP給材動作　ﾜｰｸ搬送中
CON
JMP @MR2000
STG @MR2200
AND MR1505               ; 給材要求
RES MR1700               ; PP給材動作　ﾜｰｸ搬送中
CON
SET MR1600               ; 給材動作中
CON
RES R55000               ; TP_停止中表示
CON
SET R55001               ; TP_動作中表示
CON
@INC DM7000              ; 投入数
CON
JMP @MR2201
STG @MR2201
ANB R47100               ; 搬送P&P下降不可
SET MR3300               ; ﾛｰﾀ　回転ﾁｬｯｸ　ｱﾝﾁｬｯｸ
CON
SET MR3302               ; ｽﾃｰﾀ　回転ﾁｬｯｸ　ｱﾝﾁｬｯｸ
CON
TMR @3 #1
CON
AND @T3
JMP @MR2202
STG @MR2202
AND @MR012
ANB R47100               ; 搬送P&P下降不可
SET MR3212               ; 回転位置決め　ﾁｬｯｸ上下　下降
CON
ANB R1905                ; 回転位置決め　ﾁｬｯｸ上下　上昇限
AND R1904                ; 回転位置決め　ﾁｬｯｸ上下　下降限
JMP @MR2203
STG @MR2203
AND @MR012
SET MR3208               ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開
CON
SET MR3210               ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開
CON
AND R1900                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　開限
ANB R1901                ; 回転位置決め　ﾛｰﾀ　ﾁｬｯｸ　閉限
AND R1902                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　開限
ANB R1903                ; 回転位置決め　ｽﾃｰﾀ　ﾁｬｯｸ　閉限
JMP @MR2204
STG @MR2204
AND @MR012
RES MR3300               ; ﾛｰﾀ　回転ﾁｬｯｸ　ｱﾝﾁｬｯｸ
CON
RES MR3302               ; ｽﾃｰﾀ　回転ﾁｬｯｸ　ｱﾝﾁｬｯｸ
CON
TMR @4 #2
CON
AND @T4
JMP @MR2205
STG @MR2205
SET MR1707               ; 定位置ｾﾝｻによる位置決め開始
CON
LDA #0
CON
STA DM160                ; 位置決めPPﾁｬｯｸ_ｽﾃｰﾀ
CON
STA DM161                ; 位置決めPPﾁｬｯｸ_ﾛｰﾀ
CON
JMP @MR2206
STG @MR2206
RES MR3212               ; 回転位置決め　ﾁｬｯｸ上下　下降
CON
ANB R1904                ; 回転位置決め　ﾁｬｯｸ上下　下降限
AND R1905                ; 回転位置決め　ﾁｬｯｸ上下　上昇限
SET MR1610               ; 給材動作完了ﾜｰｸ有り
CON
RES MR1309               ; ﾜｰｸ無し
CON
RES MR1600               ; 給材動作中
CON
LDA #1
CON
STA DM150                ; 位置決め部ｽﾃｰﾀﾜｰｸ有無
CON
STA DM151                ; 位置決め部ﾛｰﾀﾜｰｸ有無
CON
JMP @MR2207
STG @MR2207
AND @MR012
RES MR3214               ; 回転位置決め　搬送　位置決め側行
CON
SET MR3215               ; 回転位置決め　搬送ｺﾝﾍﾞｱ側行
CON
ANB R1906                ; 回転位置決め　搬送　位置決め側限
TMR @7 #2
CON
AND @T7
SET MR1708               ; 停止ｾﾝｻによる位置決め開始
CON
JMP @MR2208
STG @MR2208
AND @MR012
RES MR3214               ; 回転位置決め　搬送　位置決め側行
CON
SET MR3215               ; 回転位置決め　搬送ｺﾝﾍﾞｱ側行
CON
AND R1907                ; 回転位置決め　搬送ｺﾝﾍﾞｱ側限
RES R55001               ; TP_動作中表示
CON
SET R55000               ; TP_停止中表示
CON
JMP @MR2000
;ｴﾗｰ出力
;Err25　　給材PP部　ﾁｬｯｸ　ﾜｰｸ除材要求
STG @MR100
ANB R50008               ; 全体ERROR
SET R50008               ; 全体ERROR
CON
SET R51001               ; 回転位置決め部
CON
SET R50609               ; ERR25
CON
JMP @MR102
MOV #25 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR102
AND R50008               ; 全体ERROR
JMP @MR103
STG @MR103
ANB R50008               ; 全体ERROR
SET @MR107
CON
ENDS
;Err26　　ﾜｰｸﾁｬｯｸ不良　ｽﾞﾚ検出
STG @MR108
ANB R50008               ; 全体ERROR
SET R50008               ; 全体ERROR
CON
SET R51001               ; 回転位置決め部
CON
SET R50610               ; ERR26
CON
JMP @MR110
MOV #26 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR110
AND R50008               ; 全体ERROR
JMP @MR111
STG @MR111
ANB R50008               ; 全体ERROR
SET @MR115
CON
ENDS
END
ENDH
