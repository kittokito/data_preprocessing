DEVICE:53
;MODULE:給材Z軸ax3
;MODULE_TYPE:0
;SCRIPT_TYPE:
;<h1/>設定値制限
;'設定値制限
;
;FM3004.L = LIMIT ( -15000, 0, FM3004.L )		'待機位置_目標値
;FM3016.D = LIMIT ( 1, 1000, FM3016.D )			'待機位置_運転速度
;FM3018.D = LIMIT ( 1, 9999, FM3018.D )			'待機位置_加速時間
;FM3020.D = LIMIT ( 1, 1000, FM3020.D )			'待機位置_減速時間
;
;FM3204.L = LIMIT ( -270000, 0, FM3204.L )		'吸着確認位置_目標値
;FM3216.D = LIMIT ( 1, 2000, FM3216.D )			'吸着確認位置_運転速度
;FM3218.D = LIMIT ( 1, 9999, FM3218.D )			'吸着確認位置_加速時間
;FM3220.D = LIMIT ( 1, 9999, FM3220.D )			'吸着確認位置_減速時間
;
;FM3304.L = LIMIT ( -29500, 0, FM3304.L )		'検査投入位置_目標値
;FM3316.D = LIMIT ( 1, 2000, FM3316.D )			'検査投入位置_運転速度
;FM3318.D = LIMIT ( 1, 9999, FM3318.D )			'検査投入位置_加速時間
;FM3320.D = LIMIT ( 1, 9999, FM3320.D )			'検査投入位置_減速時間
;
;FM3404.L = LIMIT ( -29500, 0, FM3404.L )		'返却位置_目標値
;FM3416.D = LIMIT ( 1, 1000, FM3416.D )			'返却位置_運転速度
;FM3418.D = LIMIT ( 1, 9999, FM3418.D )			'返却位置_加速時間
;FM3420.D = LIMIT ( 1, 1000, FM3420.D )			'返却位置_減速時間
;
;FM3504.L = LIMIT ( -29500, 0, FM3504.L )		'排出位置_目標値
;FM3516.D = LIMIT ( 1, 1000, FM3516.D )			'排出位置_運転速度
;FM3518.D = LIMIT ( 1, 9999, FM3518.D )			'排出位置_加速時間
;FM3520.D = LIMIT ( 1, 1000, FM3520.D )			'排出位置_減速時間
;
;FM3704.L = LIMIT ( -29500, 0, FM3704.L )		'ﾒﾝﾃ位置_目標値
;FM3716.D = LIMIT ( 1, 1000, FM3716.D )			'ﾒﾝﾃ位置_運転速度
;FM3718.D = LIMIT ( 1, 9999, FM3718.D )			'ﾒﾝﾃ位置_加速時間
;FM3720.D = LIMIT ( 1, 1000, FM3720.D )			'ﾒﾝﾃ位置_減速時間
;
;FM3900.L = LIMIT ( -29500, 0, FM3900.L )		'画像基準面設定
LDB CR2002               ; 常時ON
NCJ #1004
;'設定値制限
;
;FM3004.L = LIMIT ( -15000, 0, FM3004.L )		'待機位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -15000 +0 FM3004 @VM0;TP給材Z軸 待機位置 目標座標
LDA.L @VM0
CON
STA.L FM3004             ; TP給材Z軸 待機位置 目標座標
;FM3016.D = LIMIT ( 1, 1000, FM3016.D )			'待機位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3016 @VM2;TP給材Z軸 待機位置 速度
LDA @VM2
CON
EXT
CON
STA.D FM3016             ; TP給材Z軸 待機位置 速度
;FM3018.D = LIMIT ( 1, 9999, FM3018.D )			'待機位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3018 @VM3;TP給材Z軸 待機位置 加速時間
LDA @VM3
CON
EXT
CON
STA.D FM3018             ; TP給材Z軸 待機位置 加速時間
;FM3020.D = LIMIT ( 1, 1000, FM3020.D )			'待機位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3020 @VM4;TP給材Z軸 待機位置 減速時間
LDA @VM4
CON
EXT
CON
STA.D FM3020             ; TP給材Z軸 待機位置 減速時間
;FM3204.L = LIMIT ( -270000, 0, FM3204.L )		'吸着確認位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -270000 +0 FM3204 @VM5;TP給材Z軸 吸着確認 補正後座標
LDA.L @VM5
CON
STA.L FM3204             ; TP給材Z軸 吸着確認 補正後座標
;FM3216.D = LIMIT ( 1, 2000, FM3216.D )			'吸着確認位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #2000 FM3216 @VM7;TP給材Z軸 吸着確認 速度
LDA @VM7
CON
EXT
CON
STA.D FM3216             ; TP給材Z軸 吸着確認 速度
;FM3218.D = LIMIT ( 1, 9999, FM3218.D )			'吸着確認位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3218 @VM8;TP給材Z軸 吸着確認 加速時間
LDA @VM8
CON
EXT
CON
STA.D FM3218             ; TP給材Z軸 吸着確認 加速時間
;FM3220.D = LIMIT ( 1, 9999, FM3220.D )			'吸着確認位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3220 @VM9;TP給材Z軸 吸着確認 減速時間
LDA @VM9
CON
EXT
CON
STA.D FM3220             ; TP給材Z軸 吸着確認 減速時間
;FM3304.L = LIMIT ( -29500, 0, FM3304.L )		'検査投入位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM3304 @VM10;TP給材Z軸 検査投入 目標座標
LDA.L @VM10
CON
STA.L FM3304             ; TP給材Z軸 検査投入 目標座標
;FM3316.D = LIMIT ( 1, 2000, FM3316.D )			'検査投入位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #2000 FM3316 @VM12;TP給材Z軸 検査投入 速度
LDA @VM12
CON
EXT
CON
STA.D FM3316             ; TP給材Z軸 検査投入 速度
;FM3318.D = LIMIT ( 1, 9999, FM3318.D )			'検査投入位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3318 @VM13;TP給材Z軸 検査投入 加速時間
LDA @VM13
CON
EXT
CON
STA.D FM3318             ; TP給材Z軸 検査投入 加速時間
;FM3320.D = LIMIT ( 1, 9999, FM3320.D )			'検査投入位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3320 @VM14;TP給材Z軸 検査投入 減速時間
LDA @VM14
CON
EXT
CON
STA.D FM3320             ; TP給材Z軸 検査投入 減速時間
;FM3404.L = LIMIT ( -29500, 0, FM3404.L )		'返却位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM3404 @VM15;TP給材Z軸 返却位置 目標座標
LDA.L @VM15
CON
STA.L FM3404             ; TP給材Z軸 返却位置 目標座標
;FM3416.D = LIMIT ( 1, 1000, FM3416.D )			'返却位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3416 @VM17;TP給材Z軸 返却位置 速度
LDA @VM17
CON
EXT
CON
STA.D FM3416             ; TP給材Z軸 返却位置 速度
;FM3418.D = LIMIT ( 1, 9999, FM3418.D )			'返却位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3418 @VM18;TP給材Z軸 返却位置 加速時間
LDA @VM18
CON
EXT
CON
STA.D FM3418             ; TP給材Z軸 返却位置 加速時間
;FM3420.D = LIMIT ( 1, 1000, FM3420.D )			'返却位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3420 @VM19;TP給材Z軸 返却位置 減速時間
LDA @VM19
CON
EXT
CON
STA.D FM3420             ; TP給材Z軸 返却位置 減速時間
;FM3504.L = LIMIT ( -29500, 0, FM3504.L )		'排出位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM3504 @VM20;TP給材Z軸 排出位置 目標座標
LDA.L @VM20
CON
STA.L FM3504             ; TP給材Z軸 排出位置 目標座標
;FM3516.D = LIMIT ( 1, 1000, FM3516.D )			'排出位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3516 @VM22
LDA @VM22
CON
EXT
CON
STA.D FM3516
;FM3518.D = LIMIT ( 1, 9999, FM3518.D )			'排出位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3518 @VM23
LDA @VM23
CON
EXT
CON
STA.D FM3518
;FM3520.D = LIMIT ( 1, 1000, FM3520.D )			'排出位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3520 @VM24
LDA @VM24
CON
EXT
CON
STA.D FM3520
;FM3704.L = LIMIT ( -29500, 0, FM3704.L )		'ﾒﾝﾃ位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM3704 @VM25;TP給材Z軸 ﾒﾝﾃﾅﾝｽ位置 目標座標
LDA.L @VM25
CON
STA.L FM3704             ; TP給材Z軸 ﾒﾝﾃﾅﾝｽ位置 目標座標
;FM3716.D = LIMIT ( 1, 1000, FM3716.D )			'ﾒﾝﾃ位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3716 @VM27;TP給材Z軸 ﾒﾝﾃ位置 速度
LDA @VM27
CON
EXT
CON
STA.D FM3716             ; TP給材Z軸 ﾒﾝﾃ位置 速度
;FM3718.D = LIMIT ( 1, 9999, FM3718.D )			'ﾒﾝﾃ位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM3718 @VM28;TP給材Z軸 ﾒﾝﾃ位置 加速時間
LDA @VM28
CON
EXT
CON
STA.D FM3718             ; TP給材Z軸 ﾒﾝﾃ位置 加速時間
;FM3720.D = LIMIT ( 1, 1000, FM3720.D )			'ﾒﾝﾃ位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM3720 @VM29;TP給材Z軸 ﾒﾝﾃ位置 減速時間
LDA @VM29
CON
EXT
CON
STA.D FM3720             ; TP給材Z軸 ﾒﾝﾃ位置 減速時間
;FM3900.L = LIMIT ( -29500, 0, FM3900.L )		'画像基準面設定
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM3900 @VM30;TP_Z軸目標座標(ﾃｰﾌﾞﾙ基準面)
LDA.L @VM30
CON
STA.L FM3900             ; TP_Z軸目標座標(ﾃｰﾌﾞﾙ基準面)
LABEL #1004
;
LD R66004                ; 軸3 軸制御中
ANB MR400                ; 全ﾄﾞｱ閉確認
OUT R65602               ; 軸3 減速停止
LD CR2002                ; 常時ON
OUT R3205                ; 給材Z軸 電源MC
LD CR2002                ; 常時ON
ANB @MR601               ; 給材Z軸 ｻｰﾎﾞOFF
OUT R65713               ; 軸3 ｻｰﾎﾞON
LD @MR601                ; 給材Z軸 ｻｰﾎﾞOFF
OUT R5103                ; 給材Z軸 ﾌﾞﾚｰｷ解除
LD R62800                ; ML16動作可能
AND R66113               ; 軸3 ｻｰﾎﾞﾚﾃﾞｨ
ANB MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
ANB R62802               ; ｴﾗｰ中
OUT MR802                ; 給材Z軸 動作可能
LDP B059                 ; 給材Z軸 ｻｰﾎﾞOFF_SW
AND B01D4                ; ﾏｽﾀｰﾛｸﾞｲﾝ中PL
OUT @MR600               ; 給材Z軸 ｻｰﾎﾞOFF_PLS
LD @MR600                ; 給材Z軸 ｻｰﾎﾞOFF_PLS
ANB @MR601               ; 給材Z軸 ｻｰﾎﾞOFF
LD @MR601                ; 給材Z軸 ｻｰﾎﾞOFF
ANB @MR600               ; 給材Z軸 ｻｰﾎﾞOFF_PLS
ORL
AND MR100                ; 手動ﾓｰﾄﾞ
OUT @MR601               ; 給材Z軸 ｻｰﾎﾞOFF
LD @MR601                ; 給材Z軸 ｻｰﾎﾞOFF
OUT B0159                ; 給材Z軸 ｻｰﾎﾞOFF_PL
;<h1/>原点復帰
LDP B040                 ; 給材Z軸 原点復帰SW
OUT @MR000               ; 手動 給材Z軸 原点復帰
;ｲﾝﾀｰﾛｯｸ
LD MR802                 ; 給材Z軸 動作可能
ANB MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR10202              ; ﾏｸﾛHP 給材Z軸 原点復帰IL
LD @MR000                ; 手動 給材Z軸 原点復帰
AND MR100                ; 手動ﾓｰﾄﾞ
LD MR1400                ; 給材Z軸 原点復帰指令
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
OR @MR005                ; 給材Z軸 原点復帰
ANB MR10209              ; ﾏｸﾛHP 給材Z軸 原点復帰完了
ANB MR10210              ; ﾏｸﾛHP 給材Z軸 原点復帰異常
AND MR10202              ; ﾏｸﾛHP 給材Z軸 原点復帰IL
OUT @MR005               ; 給材Z軸 原点復帰
;ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送
;出力
LD @MR005                ; 給材Z軸 原点復帰
OUT MR10200              ; ﾏｸﾛHP 給材Z軸 原点復帰起動
LD MR004                 ; ﾘｾｯﾄSW
OUT MR10203              ; ﾏｸﾛHP 給材Z軸 原点復帰ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_HP #3 #1 MR10200 DM19020;ﾏｸﾛHP 給材Z軸 原点復帰起動  給材Z軸 ｴﾗｰ状態
LD MR10209               ; ﾏｸﾛHP 給材Z軸 原点復帰完了
OR MR1512                ; 給材Z軸 原点復帰記憶
AND MR802                ; 給材Z軸 動作可能
ANB MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
ANPB @MR005              ; 給材Z軸 原点復帰
OUT MR1512               ; 給材Z軸 原点復帰記憶
LD MR10212               ; ﾏｸﾛHP 給材Z軸 原点復帰要求
OUT R65612               ; 軸3 原点復帰要求
;ﾗﾝﾌﾟ
LD MR10208               ; ﾏｸﾛHP 給材Z軸 原点復帰中
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1500                ; 給材Z軸 原点位置
OUT B0140                ; 給材Z軸 原点復帰PL
;<h1/>手動位置決め
LD MR100                 ; 手動ﾓｰﾄﾞ
ANB @MR305               ; 給材Z軸 位置決め
MPS
ANP B041                 ; 給材Z軸 待機位置SW
DW #1 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B042                 ; 給材Z軸 取出位置SW
DW #2 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B043                 ; 給材Z軸 吸着確認 位置SW
DW #3 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B044                 ; 給材Z軸 検査投入 位置SW
DW #4 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B045                 ; 給材Z軸 返却位置SW
DW #5 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B046                 ; 給材Z軸 排出位置SW
DW #6 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MPP
ANP B048                 ; 給材Z軸 ﾒﾝﾃﾅﾝｽﾎﾟｲﾝﾄSW
DW #8 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
LDPB B041                ; 給材Z軸 待機位置SW
ANPB B042                ; 給材Z軸 取出位置SW
ANPB B043                ; 給材Z軸 吸着確認 位置SW
ANPB B044                ; 給材Z軸 検査投入 位置SW
ANPB B045                ; 給材Z軸 返却位置SW
ANPB B046                ; 給材Z軸 排出位置SW
ANPB B048                ; 給材Z軸 ﾒﾝﾃﾅﾝｽﾎﾟｲﾝﾄSW
INV
ANB @MR305               ; 給材Z軸 位置決め
OUT @MR300               ; 手動 給材Z軸 位置決め
;<h1/>自動位置決め
LD MR101                 ; 自動ﾓｰﾄﾞ
ANB @MR305               ; 給材Z軸 位置決め
MPS
AND MR1401               ; 給材Z軸 待機位置指令
DW #1 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1402               ; 給材Z軸 取出位置指令
DW #2 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1403               ; 給材Z軸 吸着確認 位置指令
DW #3 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1404               ; 給材Z軸 検査投入 位置指令
DW #4 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1405               ; 給材Z軸 返却位置指令
DW #5 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
MPP
AND MR1406               ; 給材Z軸 排出位置指令
DW #6 DM52               ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
LDB MR1401               ; 給材Z軸 待機位置指令
ANB MR1402               ; 給材Z軸 取出位置指令
ANB MR1403               ; 給材Z軸 吸着確認 位置指令
ANB MR1404               ; 給材Z軸 検査投入 位置指令
ANB MR1405               ; 給材Z軸 返却位置指令
ANB MR1406               ; 給材Z軸 排出位置指令
INV
ANB @MR305               ; 給材Z軸 位置決め
OUT @MR302               ; 自.Z軸位置決め
;<h1/>位置決め開始
;ｲﾝﾀｰﾛｯｸ
LD MR802                 ; 給材Z軸 動作可能
AND MR1512               ; 給材Z軸 原点復帰記憶
LD= DM52 #1              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
LD= DM52 #2              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1102               ; 給材X軸 取出位置
AND MR1302               ; 給材Y軸 取出位置
ORL
LD= DM52 #3              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1103               ; 給材X軸 吸着確認位置
AND MR1303               ; 給材Y軸 吸着確認位置
ORL
LD= DM52 #4              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1104               ; 給材X軸 検査投入位置
AND MR1304               ; 給材Y軸 検査投入位置
ORL
LD= DM52 #5              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1105               ; 給材X軸 返却位置
AND MR1305               ; 給材Y軸 返却位置
ORL
LD= DM52 #6              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1106               ; 給材X軸 排出位置
AND MR1306               ; 給材Y軸 排出位置
ORL
LD= DM52 #8              ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR1108               ; 給材X軸 ﾒﾝﾃ位置
AND MR1308               ; 給材Y軸 ﾒﾝﾃﾅﾝｽ位置
ORL
ANL
ANB MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR11202              ; ﾏｸﾛPOS 給材Z軸 位置決めIL
LD @MR300                ; 手動 給材Z軸 位置決め
AND MR100                ; 手動ﾓｰﾄﾞ
LD @MR302                ; 自.Z軸位置決め
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
ANB R66004               ; 軸3 軸制御中
OR @MR305                ; 給材Z軸 位置決め
ANB MR11209              ; ﾏｸﾛPOS 給材Z軸 位置決め完了
ANB MR11210              ; ﾏｸﾛPOS 給材Z軸 位置決め異常
AND MR11202              ; ﾏｸﾛPOS 給材Z軸 位置決めIL
OUT @MR305               ; 給材Z軸 位置決め
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ演算
;'給材Z軸 ﾜｰｸ取出位置演算
;FM3104.L = FM3900.L + FM9008.L + FM9016.L + FM9080.L
;
;'給材Z軸 吸着確認位置演算
;FM3204.L = FM3240.L + FM9080.L
LD CR2002                ; 常時ON
NCJ #1001
;'給材Z軸 ﾜｰｸ取出位置演算
;
;FM3104.L = FM3900.L + FM9008.L + FM9016.L + FM9080.L
;
LD CR2002                ; 常時ON
LDA.L FM3900             ; TP_Z軸目標座標(ﾃｰﾌﾞﾙ基準面)
CON
ADD.L FM9008             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側ﾜｰｸ高Z)
CON
ADD.L FM9016             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側高さZ2)
CON
ADD.L FM9080             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM3104             ; TP給材Z軸 取出位置 目標座標
;'給材Z軸 吸着確認位置演算
;
;FM3204.L = FM3240.L + FM9080.L
LD CR2002                ; 常時ON
LDA.L FM3240             ; TP給材Z軸 吸着確認 目標座標
CON
ADD.L FM9080             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM3204             ; TP給材Z軸 吸着確認 補正後座標
LABEL #1001
;
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送
;P1　給材X軸 待機位置
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #1             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3000 DM11200 #16  ; TP給材Z軸 待機位置 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3016             ; TP給材Z軸 待機位置 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3018 DM11218 #10  ; TP給材Z軸 待機位置 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #2             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3100 DM11200 #16  ; TP給材Z軸 取出位置 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3116             ; TP給材Z軸 取出位置 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3118 DM11218 #10  ; TP給材Z軸 取出位置 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #3             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3200 DM11200 #16  ; TP給材Z軸 吸着確認 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3216             ; TP給材Z軸 吸着確認 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3218 DM11218 #10  ; TP給材Z軸 吸着確認 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #4             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3300 DM11200 #16  ; TP給材Z軸 検査投入 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3316             ; TP給材Z軸 検査投入 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3318 DM11218 #14  ; TP給材Z軸 検査投入 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #5             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3400 DM11200 #16  ; TP給材Z軸 返却位置 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3416             ; TP給材Z軸 返却位置 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3418 DM11218 #10  ; TP給材Z軸 返却位置 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #6             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3500 DM11200 #16  ; 給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3516
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3518 DM11218 #10  ; 給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
AND= DM52 #8             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM3700 DM11200 #16  ; TP給材Z軸 ﾒﾝﾃ位置 動作ﾓｰﾄﾞ  給材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM3716             ; TP給材Z軸 ﾒﾝﾃ位置 速度
CON
MUL.D #1000
CON
STA.D DM11216            ; 給材Z軸 速度
MPP
BMOV FM3718 DM11218 #10  ; TP給材Z軸 ﾒﾝﾃ位置 加速時間  給材Z軸 加速時間
LDP @MR305               ; 給材Z軸 位置決め
MCALL KE_ML_PDAT #3 DM52 #1 DM11200;給材Z軸 ﾎﾟｼﾞｼｮﾝNo  給材Z軸 動作ﾓｰﾄﾞ
;<h1/>位置決め出力
LD @MR305                ; 給材Z軸 位置決め
ANB T124                 ; 給材Z軸ﾏｸﾛﾀﾞﾝﾏﾘ対策
MPS
OUT MR11200              ; ﾏｸﾛPOS 給材Z軸 位置決め起動
MPP
ANB MR11208              ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
TMS #124 #100            ; 給材Z軸ﾏｸﾛﾀﾞﾝﾏﾘ対策
LD MR004                 ; ﾘｾｯﾄSW
OUT MR11203              ; ﾏｸﾛPOS 給材Z軸 位置決め ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_POS #3 #1 MR11200 DM19020;ﾏｸﾛPOS 給材Z軸 位置決め起動  給材Z軸 ｴﾗｰ状態
LD MR11213               ; ﾏｸﾛPOS 給材Z軸 位置決め 制御開始
OUT R60100               ; 軸3 位置決め制御開始
LD MR11214               ; ﾏｸﾛPOS 給材Z軸 位置決め 完了ｸﾘｱ
OUT R60102               ; 軸3 位置決め完了ｸﾘｱ
;ﾗﾝﾌﾟ
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #1             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1501                ; 給材Z軸 待機位置
OUT B0141                ; 給材Z軸 待機位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #2             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1502                ; 給材Z軸 取出位置
OUT B0142                ; 給材Z軸 取出位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #3             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1503                ; 給材Z軸 吸着確認位置
OUT B0143                ; 給材Z軸 吸着確認 位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #4             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1504                ; 給材Z軸 検査投入位置
OUT B0144                ; 給材Z軸 検査投入 位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #5             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1505                ; 給材Z軸 返却位置
OUT B0145                ; 給材Z軸 返却位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #6             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1506                ; 給材Z軸 排出位置
OUT B0146                ; 給材Z軸 排出位置PL
LD MR11208               ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
AND= DM52 #8             ; 給材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1508                ; 給材Z軸 ﾒﾝﾃﾅﾝｽ位置
OUT B0148                ; 給材Z軸 ﾒﾝﾃﾅﾝｽﾎﾟｲﾝﾄPL
;<h1/>位置出力
;軸現在位置が目標位置の±20μm以内で出力
;※位置決範囲を狭くすると出力がﾁｬﾀﾘﾝｸﾞして関係する軸のI/Lが動作するので注意!
;'Z軸位置表示
;FM54.L = DM60410.L			'現在値
;DM458.L = DM60410.L + 20	'位置決め判定上限
;DM460.L = DM60410.L - 20	'位置決め判定下限
LD CR2002                ; 常時ON
NCJ #1000
;'Z軸位置表示
;
;FM54.L = DM60410.L			'現在値
;
LD CR2002                ; 常時ON
MOV.L DM60410 FM54       ; 軸3 現在座標  給材Z軸 現在値
;DM458.L = DM60410.L + 20	'位置決め判定上限
;
LD CR2002                ; 常時ON
LDA.L DM60410            ; 軸3 現在座標
CON
ADD.L +20
CON
STA.L DM458              ; 給材Z軸 位置決範囲+限
;DM460.L = DM60410.L - 20	'位置決め判定下限
LD CR2002                ; 常時ON
LDA.L DM60410            ; 軸3 現在座標
CON
SUB.L +20
CON
STA.L DM460              ; 給材Z軸 位置決範囲-限
LABEL #1000
;
LD MR1512                ; 給材Z軸 原点復帰記憶
ANB @MR305               ; 給材Z軸 位置決め
ANB MR11208              ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
MPS
LD>=.L +20 FM54          ; 給材Z軸 現在値
AND<=.L -20 FM54         ; 給材Z軸 現在値
ANL
OUT MR1500               ; 給材Z軸 原点位置
MRD
LD>=.L DM458 FM3004      ; 給材Z軸 位置決範囲+限  TP給材Z軸 待機位置 目標座標
AND<=.L DM460 FM3004     ; 給材Z軸 位置決範囲-限  TP給材Z軸 待機位置 目標座標
ANL
OUT MR1501               ; 給材Z軸 待機位置
MRD
LD>=.L DM458 FM3104      ; 給材Z軸 位置決範囲+限  TP給材Z軸 取出位置 目標座標
AND<=.L DM460 FM3104     ; 給材Z軸 位置決範囲-限  TP給材Z軸 取出位置 目標座標
ANL
OUT MR1502               ; 給材Z軸 取出位置
MRD
LD>=.L DM458 FM3204      ; 給材Z軸 位置決範囲+限  TP給材Z軸 吸着確認 補正後座標
AND<=.L DM460 FM3204     ; 給材Z軸 位置決範囲-限  TP給材Z軸 吸着確認 補正後座標
ANL
OUT MR1503               ; 給材Z軸 吸着確認位置
MRD
LD>=.L DM458 FM3304      ; 給材Z軸 位置決範囲+限  TP給材Z軸 検査投入 目標座標
AND<=.L DM460 FM3304     ; 給材Z軸 位置決範囲-限  TP給材Z軸 検査投入 目標座標
ANL
OUT MR1504               ; 給材Z軸 検査投入位置
MRD
LD>=.L DM458 FM3404      ; 給材Z軸 位置決範囲+限  TP給材Z軸 返却位置 目標座標
AND<=.L DM460 FM3404     ; 給材Z軸 位置決範囲-限  TP給材Z軸 返却位置 目標座標
ANL
OUT MR1505               ; 給材Z軸 返却位置
MRD
LD>=.L DM458 FM3504      ; 給材Z軸 位置決範囲+限  TP給材Z軸 排出位置 目標座標
AND<=.L DM460 FM3504     ; 給材Z軸 位置決範囲-限  TP給材Z軸 排出位置 目標座標
ANL
OUT MR1506               ; 給材Z軸 排出位置
MPP
LD>=.L DM458 FM3704      ; 給材Z軸 位置決範囲+限  TP給材Z軸 ﾒﾝﾃﾅﾝｽ位置 目標座標
AND<=.L DM460 FM3704     ; 給材Z軸 位置決範囲-限  TP給材Z軸 ﾒﾝﾃﾅﾝｽ位置 目標座標
ANL
OUT MR1508               ; 給材Z軸 ﾒﾝﾃﾅﾝｽ位置
;<h1/>JOG移動
LD B04A                  ; 給材Z軸 JOG正転SW
OUT @MR500               ; 手動 給材Z軸 JOG運転正転
LD B04B                  ; 給材Z軸 JOG逆転SW
OUT @MR501               ; 手動 給材Z軸 JOG運転逆転
;ｲﾝﾀｰﾛｯｸ
LD MR802                 ; 給材Z軸 動作可能
ANB MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
OUT MR12202              ; ﾏｸﾛ 給材Z軸 JOG動作IL
;Z軸JOG運転
LD @MR500                ; 手動 給材Z軸 JOG運転正転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR12202              ; ﾏｸﾛ 給材Z軸 JOG動作IL
ANB MR12210              ; ﾏｸﾛ 給材Z軸 JOG動作異常
OUT @MR505               ; 給材Z軸 JOG運転正転
LD @MR501                ; 手動 給材Z軸 JOG運転逆転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR12202              ; ﾏｸﾛ 給材Z軸 JOG動作IL
ANB MR12210              ; ﾏｸﾛ 給材Z軸 JOG動作異常
OUT @MR506               ; 給材Z軸 JOG運転逆転
;Z軸速度倍率設定
LD CR2002                ; 常時ON
MSTRT JOG_倍率 B05A B015A DM10260;給材Z軸 JOG倍率0.1SW  給材Z軸 JOG倍率0.1PL  給材Z軸 JOG倍率DATA
;動作ﾃﾞｰﾀ転送
LD @MR505                ; 給材Z軸 JOG運転正転
OR @MR506                ; 給材Z軸 JOG運転逆転
MPS
LDA.D #10
CON
MUL.D DM10260            ; 給材Z軸 JOG倍率DATA
CON
STA.D DM10218            ; 給材Z軸 JOG高速速度
MPP
@UWRIT #1 #14268 DM10218 #2;給材Z軸 JOG高速速度
;出力
LD @MR505                ; 給材Z軸 JOG運転正転
OUT MR12200              ; ﾏｸﾛ 給材Z軸 JOG起動＋
LD @MR506                ; 給材Z軸 JOG運転逆転
OUT MR12201              ; ﾏｸﾛ 給材Z軸 JOG起動−
LD MR004                 ; ﾘｾｯﾄSW
OUT MR12203              ; ﾏｸﾛ 給材Z軸 JOG動作 ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_JOG #3 #1 MR12200 DM19020;ﾏｸﾛ 給材Z軸 JOG起動＋  給材Z軸 ｴﾗｰ状態
LD MR12212               ; ﾏｸﾛJOG 給材Z軸 JOG正方向
OUT R65700               ; 軸3 JOG正方向
LD MR12213               ; ﾏｸﾛJOG 給材Z軸 JOG負方向
OUT R65701               ; 軸3 JOG負方向
LD MR12212               ; ﾏｸﾛJOG 給材Z軸 JOG正方向
OR MR12213               ; ﾏｸﾛJOG 給材Z軸 JOG負方向
OUT R65702               ; 軸3 高速JOG
;ﾗﾝﾌﾟ
LD MR12208               ; ﾏｸﾛ 給材Z軸 JOG＋運転中
OUT B014A                ; 給材Z軸 JOG正転PL
LD MR12209               ; ﾏｸﾛ 給材Z軸 JOG−運転中
OUT B014B                ; 給材Z軸 JOG逆転PL
;<h1/>DATA_SET
LD B0E1                  ; 給材 待機位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3004        ; 給材Z軸 現在値  TP給材Z軸 待機位置 目標座標
LD B0E3                  ; 給材吸着 確認位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3240        ; 給材Z軸 現在値  TP給材Z軸 吸着確認 目標座標
LD B0E4                  ; 給材検査 投入位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3304        ; 給材Z軸 現在値  TP給材Z軸 検査投入 目標座標
LD B0E5                  ; 給材 返却位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3404        ; 給材Z軸 現在値  TP給材Z軸 返却位置 目標座標
LD B0E6                  ; 給材 排出位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3504        ; 給材Z軸 現在値  TP給材Z軸 排出位置 目標座標
LD B0E8                  ; 給材 ﾒﾝﾃﾅﾝｽ位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM54 FM3704        ; 給材Z軸 現在値  TP給材Z軸 ﾒﾝﾃﾅﾝｽ位置 目標座標
;<h1/>ｴﾗｰ出力
LD MR10210               ; ﾏｸﾛHP 給材Z軸 原点復帰異常
OR MR11210               ; ﾏｸﾛPOS 給材Z軸 位置決め異常
OR MR12210               ; ﾏｸﾛ 給材Z軸 JOG動作異常
MPS
AND DM19020.0
OUT MR7004               ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
MPP
AND DM19020.1
OUT MR7005               ; ERR05 給材Z軸軸ｴﾗｰ
LD MR10211               ; ﾏｸﾛHP 給材Z軸 ｴﾗｰｸﾘｱ
OR MR11211               ; ﾏｸﾛPOS 給材Z軸 ｴﾗｰｸﾘｱ
OR MR12211               ; ﾏｸﾛJOG 給材Z軸 ｴﾗｰｸﾘｱ
OUT R65600               ; 軸3 軸ｴﾗｰｸﾘｱ
LD MR10213               ; ﾏｸﾛHP 給材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
OR MR11212               ; ﾏｸﾛPOS 給材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ ﾘｾｯﾄ
OR MR12214               ; ﾏｸﾛJOG 給材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ ﾘｾｯﾄ
OUT R65905               ; 軸3 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
;<h1/>まとめ
LD MR7004                ; ERR04 給材Z軸ﾄﾞﾗｲﾊﾞｰ異常
OR MR7005                ; ERR05 給材Z軸軸ｴﾗｰ
OUT MR1513               ; 給材Z軸 全異常
LD MR1500                ; 給材Z軸 原点位置
OR MR1501                ; 給材Z軸 待機位置
OUT MR1514               ; 給材Z軸 全原点
LDB MR10200              ; ﾏｸﾛHP 給材Z軸 原点復帰起動
ANB MR10208              ; ﾏｸﾛHP 給材Z軸 原点復帰中
ANB MR11200              ; ﾏｸﾛPOS 給材Z軸 位置決め起動
ANB MR11208              ; ﾏｸﾛPOS 給材Z軸 位置決め 移動中
ANB MR12200              ; ﾏｸﾛ 給材Z軸 JOG起動＋
ANB MR12201              ; ﾏｸﾛ 給材Z軸 JOG起動−
ANB MR12208              ; ﾏｸﾛ 給材Z軸 JOG＋運転中
ANB MR12209              ; ﾏｸﾛ 給材Z軸 JOG−運転中
OUT MR1515               ; 給材Z軸 全停止
END
ENDH
