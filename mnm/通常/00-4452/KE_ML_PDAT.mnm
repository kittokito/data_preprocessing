DEVICE:53
;MODULE:KE_ML_PDAT
;MODULE_TYPE:1
;SCRIPT_TYPE:
;****各軸ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送****
;軸No　		#1〜＃16
;ﾎﾟｼﾞｼｮﾝNo	1〜800（DM指定)
;ﾕﾆｯﾄ指定　	ﾕﾆｯﾄ構成No(KV-ML16V)
;動作DATA　　32word占有
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+0　 動作ﾓｰﾄﾞ
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+1   連続モード（戻り）
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+2   次ポイント番号
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+3   Mコード番号
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+4   目標座標
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+6   繰り返し相対移動量
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+7   繰り返し相対移動量
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+8　 繰り返し回数
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+9   ドウェルタイム
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+10  補助円弧半径
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+12  停止センサ入力後移動量
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+14  補間相手軸
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+15  補間直線軸（ヘリカル時）
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+16  速度
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+18  加速レート/時間
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+20  減速レート/時間
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+22  トルク制限値
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+23  ゲイン切替
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+24  周回数
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+26  ベジェ加速データ番号
;			先頭ﾜｰﾄﾞｱﾄﾞﾚｽ+27  ベジェ減速データ番号
;'各軸ﾊﾞｯﾌｧﾒﾓﾘNo算出
;@DM0 = #18012+32*(V0-1)+512*(P0-1)		'動作ﾓｰﾄﾞ
;@DM1 = #18013+32*(V0-1)+512*(P0-1)		'連続モード（戻り）
;@DM2 = #18014+32*(V0-1)+512*(P0-1)		'次ポイント番号
;@DM3 = #18015+32*(V0-1)+512*(P0-1)		'Mコード番号
;@DM4 = #18016+32*(V0-1)+512*(P0-1)		'目標座標
;@DM6 = #18018+32*(V0-1)+512*(P0-1)		'繰り返し相対移動量
;@DM7 = #18019+32*(V0-1)+512*(P0-1)		'繰り返し相対移動量
;@DM8 = #18020+32*(V0-1)+512*(P0-1)		'繰り返し回数
;@DM9 = #18021+32*(V0-1)+512*(P0-1)		'ドウェルタイム
;@DM10 = #18022+32*(V0-1)+512*(P0-1)		'補助円弧半径
;@DM12 = #18024+32*(V0-1)+512*(P0-1)		'停止センサ入力後移動量
;@DM14 = #18026+32*(V0-1)+512*(P0-1)		'補間相手軸
;@DM15 = #18027+32*(V0-1)+512*(P0-1)		'補間直線軸（ヘリカル時）
;@DM16 = #18028+32*(V0-1)+512*(P0-1)		'速度
;@DM18 = #18030+32*(V0-1)+512*(P0-1)		'加速レート/時間
;@DM20 = #18032+32*(V0-1)+512*(P0-1)		'減速レート/時間
;@DM22 = #18034+32*(V0-1)+512*(P0-1)		'トルク制限値
;@DM23 = #18035+32*(V0-1)+512*(P0-1)		'ゲイン切替
;@DM24 = #18036+32*(V0-1)+512*(P0-1)		'周回数
;@DM26 = #18038+32*(V0-1)+512*(P0-1)		'ベジェ加速データ番号
;@DM27 = #18039+32*(V0-1)+512*(P0-1)		'ベジェ減速データ番号
LD CR2002                ; 常時ON
NCJ #1000
;'各軸ﾊﾞｯﾌｧﾒﾓﾘNo算出
;
;@DM0 = #18012+32*(V0-1)+512*(P0-1)		'動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM0
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18012
CON
ADD.L @VM0
CON
STA @DM0                 ; 動作ﾓｰﾄﾞ
;@DM1 = #18013+32*(V0-1)+512*(P0-1)		'連続モード（戻り）
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM2
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18013
CON
ADD.L @VM2
CON
STA @DM1                 ; 連続モード（戻り）
;@DM2 = #18014+32*(V0-1)+512*(P0-1)		'次ポイント番号
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM4
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18014
CON
ADD.L @VM4
CON
STA @DM2                 ; 次ポイント番号
;@DM3 = #18015+32*(V0-1)+512*(P0-1)		'Mコード番号
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM6
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18015
CON
ADD.L @VM6
CON
STA @DM3                 ; Mコード番号
;@DM4 = #18016+32*(V0-1)+512*(P0-1)		'目標座標
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM8
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18016
CON
ADD.L @VM8
CON
STA @DM4                 ; 目標座標
;@DM6 = #18018+32*(V0-1)+512*(P0-1)		'繰り返し相対移動量
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM10
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18018
CON
ADD.L @VM10
CON
STA @DM6                 ; 繰り返し相対移動量
;@DM7 = #18019+32*(V0-1)+512*(P0-1)		'繰り返し相対移動量
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM12
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18019
CON
ADD.L @VM12
CON
STA @DM7                 ; 繰り返し相対移動量
;@DM8 = #18020+32*(V0-1)+512*(P0-1)		'繰り返し回数
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM14
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18020
CON
ADD.L @VM14
CON
STA @DM8                 ; 繰り返し回数
;@DM9 = #18021+32*(V0-1)+512*(P0-1)		'ドウェルタイム
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM16
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18021
CON
ADD.L @VM16
CON
STA @DM9                 ; ドウェルタイム
;@DM10 = #18022+32*(V0-1)+512*(P0-1)		'補助円弧半径
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM18
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18022
CON
ADD.L @VM18
CON
STA @DM10                ; 補助円弧半径
;@DM12 = #18024+32*(V0-1)+512*(P0-1)		'停止センサ入力後移動量
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM20
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18024
CON
ADD.L @VM20
CON
STA @DM12                ; 停止センサ入力後移動量
;@DM14 = #18026+32*(V0-1)+512*(P0-1)		'補間相手軸
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM22
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18026
CON
ADD.L @VM22
CON
STA @DM14                ; 補間相手軸
;@DM15 = #18027+32*(V0-1)+512*(P0-1)		'補間直線軸（ヘリカル時）
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM24
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18027
CON
ADD.L @VM24
CON
STA @DM15                ; 補間直線軸（ヘリカル時）
;@DM16 = #18028+32*(V0-1)+512*(P0-1)		'速度
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM26
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18028
CON
ADD.L @VM26
CON
STA @DM16                ; 速度
;@DM18 = #18030+32*(V0-1)+512*(P0-1)		'加速レート/時間
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM28
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18030
CON
ADD.L @VM28
CON
STA @DM18                ; 加速レート/時間
;@DM20 = #18032+32*(V0-1)+512*(P0-1)		'減速レート/時間
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM30
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18032
CON
ADD.L @VM30
CON
STA @DM20                ; 減速レート/時間
;@DM22 = #18034+32*(V0-1)+512*(P0-1)		'トルク制限値
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM32
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18034
CON
ADD.L @VM32
CON
STA @DM22                ; トルク制限値
;@DM23 = #18035+32*(V0-1)+512*(P0-1)		'ゲイン切替
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM34
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18035
CON
ADD.L @VM34
CON
STA @DM23                ; ゲイン切替
;@DM24 = #18036+32*(V0-1)+512*(P0-1)		'周回数
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM36
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18036
CON
ADD.L @VM36
CON
STA @DM24                ; 周回数
;@DM26 = #18038+32*(V0-1)+512*(P0-1)		'ベジェ加速データ番号
;
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM38
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18038
CON
ADD.L @VM38
CON
STA @DM26                ; ベジェ加速データ番号
;@DM27 = #18039+32*(V0-1)+512*(P0-1)		'ベジェ減速データ番号
LD CR2002                ; 常時ON
LDA P0                   ; ﾎﾟｼﾞｼｮﾝ
CON
EXT
CON
SUB.L +1
CON
MUL.L +512
CON
STA.L @VM40
CON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
MUL.L +32
CON
ADD.L +18039
CON
ADD.L @VM40
CON
STA @DM27                ; ベジェ減速データ番号
LABEL #1000
;
LD CR2002                ; 常時ON
UWRIT V1 @DM0 P1:#0 #1   ; ﾕﾆｯﾄ指定  動作ﾓｰﾄﾞ  動作DATA
UWRIT V1 @DM1 P1:#1 #1   ; ﾕﾆｯﾄ指定  連続モード（戻り）  動作DATA
UWRIT V1 @DM2 P1:#2 #1   ; ﾕﾆｯﾄ指定  次ポイント番号  動作DATA
UWRIT V1 @DM3 P1:#3 #1   ; ﾕﾆｯﾄ指定  Mコード番号  動作DATA
UWRIT V1 @DM4 P1:#4 #2   ; ﾕﾆｯﾄ指定  目標座標  動作DATA
UWRIT V1 @DM6 P1:#6 #1   ; ﾕﾆｯﾄ指定  繰り返し相対移動量  動作DATA
UWRIT V1 @DM7 P1:#7 #1   ; ﾕﾆｯﾄ指定  繰り返し相対移動量  動作DATA
UWRIT V1 @DM8 P1:#8 #1   ; ﾕﾆｯﾄ指定  繰り返し回数  動作DATA
UWRIT V1 @DM9 P1:#9 #1   ; ﾕﾆｯﾄ指定  ドウェルタイム  動作DATA
UWRIT V1 @DM10 P1:#10 #2 ; ﾕﾆｯﾄ指定  補助円弧半径  動作DATA
UWRIT V1 @DM12 P1:#12 #2 ; ﾕﾆｯﾄ指定  停止センサ入力後移動量  動作DATA
UWRIT V1 @DM14 P1:#14 #1 ; ﾕﾆｯﾄ指定  補間相手軸  動作DATA
UWRIT V1 @DM15 P1:#15 #1 ; ﾕﾆｯﾄ指定  補間直線軸（ヘリカル時）  動作DATA
UWRIT V1 @DM16 P1:#16 #2 ; ﾕﾆｯﾄ指定  速度  動作DATA
UWRIT V1 @DM18 P1:#18 #2 ; ﾕﾆｯﾄ指定  加速レート/時間  動作DATA
UWRIT V1 @DM20 P1:#20 #2 ; ﾕﾆｯﾄ指定  減速レート/時間  動作DATA
UWRIT V1 @DM22 P1:#22 #1 ; ﾕﾆｯﾄ指定  トルク制限値  動作DATA
UWRIT V1 @DM23 P1:#23 #1 ; ﾕﾆｯﾄ指定  ゲイン切替  動作DATA
UWRIT V1 @DM24 P1:#24 #2 ; ﾕﾆｯﾄ指定  周回数  動作DATA
UWRIT V1 @DM26 P1:#26 #1 ; ﾕﾆｯﾄ指定  ベジェ加速データ番号  動作DATA
UWRIT V1 @DM27 P1:#27 #1 ; ﾕﾆｯﾄ指定  ベジェ減速データ番号  動作DATA
;'各軸ﾊﾞｯﾌｧﾒﾓﾘNo算出
;@DM100 = 28+(V0-1)		'位置決め開始ﾎﾟｲﾝﾄNo
;
LD CR2002                ; 常時ON
NCJ #1001
;'各軸ﾊﾞｯﾌｧﾒﾓﾘNo算出
;
;@DM100 = 28+(V0-1)		'位置決め開始ﾎﾟｲﾝﾄNo
;
LD CR2002                ; 常時ON
LDA V0                   ; 軸No
CON
EXT
CON
SUB.L +1
CON
ADD.L +28
CON
STA @DM100               ; 位置決め開始ﾎﾟｲﾝﾄNo
LABEL #1001
;
LD CR2002                ; 常時ON
UWRIT V1 @DM100 P0 #1    ; ﾕﾆｯﾄ指定  位置決め開始ﾎﾟｲﾝﾄNo  ﾎﾟｼﾞｼｮﾝ
DW #1 @DM90
END
ENDH
