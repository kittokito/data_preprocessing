DEVICE:53
;MODULE:給材θ軸
;MODULE_TYPE:0
;SCRIPT_TYPE:
;<h1/>設定値制限
;'設定値制限
;
;FM4100.L = LIMIT ( -17999, 18000, FM4100.L )	'待機位置_目標値
;FM4102 = LIMIT ( 0, 99, FM4102 )				'待機位置_起動速度
;FM4103 = LIMIT ( 1, 5000, FM4103 )				'待機位置_加減速時間
;FM4104.D = LIMIT ( 18, 2000, FM4104.D )			'待機位置_運転速度
;
;FM4130.L = LIMIT ( -17999, 18000, FM4130.L )	'検査位置_目標値
;
;FM4140.L = LIMIT ( -17999, 18000, FM4140.L )	'返却位置_目標値
;FM4142 = LIMIT ( 0, 99, FM4142 )				'返却位置_起動速度
;FM4143 = LIMIT ( 1, 5000, FM4143 )				'返却位置_加減速時間
;FM4144.D = LIMIT ( 18, 2000, FM4144.D )			'返却位置_運転速度
;
;FM4150.L = LIMIT ( -17999, 18000, FM4150.L )	'排出位置_目標値
;FM4152 = LIMIT ( 0, 99, FM4152 )				'排出位置_起動速度
;FM4153 = LIMIT ( 1, 5000, FM4153 )				'排出位置_加減速時間
;FM4154.D = LIMIT ( 18, 2000, FM4154.D )			'排出位置_運転速度
;
;FM4172 = LIMIT ( 0, 99, FM4172 )				'ﾒﾝﾃ位置_起動速度
;FM4173 = LIMIT ( 1, 5000, FM4173 )				'ﾒﾝﾃ位置_加減速時間
;FM4174.D = LIMIT ( 18, 2000, FM4174.D )			'ﾒﾝﾃ位置_運転速度
;
;FM4190.L = LIMIT ( -17999, 18000, FM4190.L )	'原点補正量
LDB CR2002               ; 常時ON
NCJ #1012
;'設定値制限
;
;FM4100.L = LIMIT ( -17999, 18000, FM4100.L )	'待機位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -17999 +18000 FM4100 @VM0;給材θ軸 待機位置 目標座標
LDA.L @VM0
CON
STA.L FM4100             ; 給材θ軸 待機位置 目標座標
;FM4102 = LIMIT ( 0, 99, FM4102 )				'待機位置_起動速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #0 #99 FM4102 @VM2 ; 給材θ軸 待機位置 起動速度
LDA @VM2
CON
STA FM4102               ; 給材θ軸 待機位置 起動速度
;FM4103 = LIMIT ( 1, 5000, FM4103 )				'待機位置_加減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #5000 FM4103 @VM3;給材θ軸 待機位置 加減速時間
LDA @VM3
CON
STA FM4103               ; 給材θ軸 待機位置 加減速時間
;FM4104.D = LIMIT ( 18, 2000, FM4104.D )			'待機位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #18 #2000 FM4104 @VM4;給材θ軸 待機位置 運転速度
LDA @VM4
CON
EXT
CON
STA.D FM4104             ; 給材θ軸 待機位置 運転速度
;FM4130.L = LIMIT ( -17999, 18000, FM4130.L )	'検査位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -17999 +18000 FM4130 @VM5;給材θ軸 検査投入 目標座標
LDA.L @VM5
CON
STA.L FM4130             ; 給材θ軸 検査投入 目標座標
;FM4140.L = LIMIT ( -17999, 18000, FM4140.L )	'返却位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -17999 +18000 FM4140 @VM7;給材θ軸 返却位置 目標座標
LDA.L @VM7
CON
STA.L FM4140             ; 給材θ軸 返却位置 目標座標
;FM4142 = LIMIT ( 0, 99, FM4142 )				'返却位置_起動速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #0 #99 FM4142 @VM9 ; 給材θ軸 返却位置 起動速度
LDA @VM9
CON
STA FM4142               ; 給材θ軸 返却位置 起動速度
;FM4143 = LIMIT ( 1, 5000, FM4143 )				'返却位置_加減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #5000 FM4143 @VM10;給材θ軸 返却位置 加減速時間
LDA @VM10
CON
STA FM4143               ; 給材θ軸 返却位置 加減速時間
;FM4144.D = LIMIT ( 18, 2000, FM4144.D )			'返却位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #18 #2000 FM4144 @VM11;給材θ軸 返却位置 運転速度
LDA @VM11
CON
EXT
CON
STA.D FM4144             ; 給材θ軸 返却位置 運転速度
;FM4150.L = LIMIT ( -17999, 18000, FM4150.L )	'排出位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -17999 +18000 FM4150 @VM12;給材θ軸 排出位置 目標座標
LDA.L @VM12
CON
STA.L FM4150             ; 給材θ軸 排出位置 目標座標
;FM4152 = LIMIT ( 0, 99, FM4152 )				'排出位置_起動速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #0 #99 FM4152 @VM14
LDA @VM14
CON
STA FM4152
;FM4153 = LIMIT ( 1, 5000, FM4153 )				'排出位置_加減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #5000 FM4153 @VM15
LDA @VM15
CON
STA FM4153
;FM4154.D = LIMIT ( 18, 2000, FM4154.D )			'排出位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #18 #2000 FM4154 @VM16
LDA @VM16
CON
EXT
CON
STA.D FM4154
;FM4172 = LIMIT ( 0, 99, FM4172 )				'ﾒﾝﾃ位置_起動速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #0 #99 FM4172 @VM17; 給材θ軸 ﾒﾝﾃ位置 起動速度
LDA @VM17
CON
STA FM4172               ; 給材θ軸 ﾒﾝﾃ位置 起動速度
;FM4173 = LIMIT ( 1, 5000, FM4173 )				'ﾒﾝﾃ位置_加減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #5000 FM4173 @VM18;給材θ軸 ﾒﾝﾃ位置 加減速時間
LDA @VM18
CON
STA FM4173               ; 給材θ軸 ﾒﾝﾃ位置 加減速時間
;FM4174.D = LIMIT ( 18, 2000, FM4174.D )			'ﾒﾝﾃ位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #18 #2000 FM4174 @VM19;給材θ軸 ﾒﾝﾃ位置 運転速度
LDA @VM19
CON
EXT
CON
STA.D FM4174             ; 給材θ軸 ﾒﾝﾃ位置 運転速度
;FM4190.L = LIMIT ( -17999, 18000, FM4190.L )	'原点補正量
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -17999 +18000 FM4190 @VM20;給材θ軸 原点補正量
LDA.L @VM20
CON
STA.L FM4190             ; 給材θ軸 原点補正量
LABEL #1012
;
;CPU位置決めﾊﾟﾗﾒｰﾀ編集にて設定
;
;入出力設定
;	軸選択			X軸
;	原点ｾﾝｻ			R0000
;	停止ｾﾝｻ			初期値
;	Z相				初期値
;	ﾘﾐｯﾄ(CW)		初期値
;	ﾘﾐｯﾄ(CCW)		初期値
;	出力方式		2ﾊﾟﾙｽ方式
;原点復帰
;	軸選択			X軸
;	起動速度		50
;	加減速時間		10
;	運転速度		50
;	原点復帰方向	CW
;	偏差ｶｳﾝﾀｸﾘｱ		初期値
;	自動ﾎｰﾑﾎﾟｼﾞｼｮﾝ	移動する
;	自動ﾎｰﾑﾎﾟｼﾞｼｮﾝ座標
;	設定値			TPにて入力
;JOG
;	軸選択			X軸
;	起動速度		50
;	加減速時間		10
;	運転速度		50
;	現在値変更		初期値
;	運転速度変更	初期値
LD CR2002                ; 常時ON
MOV #100 CM2006          ; X軸原点復帰起動速度
MOV #10 CM2007           ; X軸原点復帰加減速時間
MOV.D #500 CM2008        ; X軸原点復帰運転速度
MPS
OUT CM2000.1
CON
OUT CM2018.4
MPP
CAL/.L FM4190 +18 CM2026 ; 給材θ軸 原点補正量  X軸ﾎｰﾑﾎﾟｼﾞｼｮﾝ座標設定値
LD CR2002                ; 常時ON
MOV #50 CM2010           ; X軸JOG動作起動速度
MOV #10 CM2011           ; X軸JOG動作加減速時間
MOV.D #50 CM2012         ; X軸JOG動作運転速度
LD CR3009                ; X軸ﾊﾟﾙｽ出力中/緊急停止
ANB MR400                ; 全ﾄﾞｱ閉確認
RES CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
LD CR2002                ; 常時ON
OUT R3206                ; 給材側 θ軸電源CR
;<h1/>原点復帰
LDP B060                 ; 給材θ軸 原点復帰SW
OUT @MR000               ; 手動 給材θ軸 原点復帰
;ｲﾝﾀｰﾛｯｸ
LDB MR7006               ; ERR06 給材θ軸 位置決め異常
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR13002              ; ﾏｸﾛHP 給材θ軸 原点復帰IL
LD @MR000                ; 手動 給材θ軸 原点復帰
AND MR100                ; 手動ﾓｰﾄﾞ
LD MR1600                ; 給材θ軸 原点復帰指令
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
ANB CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
OR @MR005                ; 給材θ軸 原点復帰
ANB MR13009              ; ﾏｸﾛHP 給材θ軸 原点復帰完了
AND MR13002              ; ﾏｸﾛHP 給材θ軸 原点復帰IL
OUT @MR005               ; 給材θ軸 原点復帰
;動作ﾃﾞｰﾀ転送
;CPU位置決めﾊﾟﾗﾒｰﾀより設定
;出力
LD @MR005                ; 給材θ軸 原点復帰
OUT MR13000              ; ﾏｸﾛHP 給材θ軸 原点復帰起動
LD MR004                 ; ﾘｾｯﾄSW
OUT MR13003              ; ﾏｸﾛHP 給材θ軸 原点復帰 ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_CPU_HP_X MR13000 DM19100;ﾏｸﾛHP 給材θ軸 原点復帰起動  給材θ軸 ｴﾗｰ状態
LD MR13009               ; ﾏｸﾛHP 給材θ軸 原点復帰完了
OR MR1712                ; 給材θ軸 原点復帰記憶
AND R3206                ; 給材側 θ軸電源CR
ANB MR7006               ; ERR06 給材θ軸 位置決め異常
ANPB @MR005              ; 給材θ軸 原点復帰
ANFB MR101               ; 自動ﾓｰﾄﾞ
ANFB MR100               ; 手動ﾓｰﾄﾞ
OUT MR1712               ; 給材θ軸 原点復帰記憶
;ﾗﾝﾌﾟ
LD MR13008               ; ﾏｸﾛHP 給材θ軸 原点復帰中
OUT B0160                ; 給材θ軸 原点復帰PL
;<h1/>手動位置決め
LD MR100                 ; 手動ﾓｰﾄﾞ
ANB @MR305               ; 給材θ軸 位置決め
MPS
ANP B061                 ; 給材θ軸 待機位置SW
DW #1 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B062                 ; 給材θ軸 取出位置SW
DW #2 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B063                 ; 給材θ軸 吸着確認 位置SW
DW #3 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B064                 ; 給材θ軸 検査投入 位置SW
DW #4 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B065                 ; 給材θ軸 返却位置SW
DW #5 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B066                 ; 給材θ軸 排出位置SW
DW #6 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B067                 ; 給材θ軸 反転吸着 確認位置SW
DW #7 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MPP
ANP B068                 ; 給材θ軸 ﾒﾝﾃﾅﾝｽ 位置SW
DW #8 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
LDPB B061                ; 給材θ軸 待機位置SW
ANPB B062                ; 給材θ軸 取出位置SW
ANPB B063                ; 給材θ軸 吸着確認 位置SW
ANPB B064                ; 給材θ軸 検査投入 位置SW
ANPB B065                ; 給材θ軸 返却位置SW
ANPB B066                ; 給材θ軸 排出位置SW
ANPB B067                ; 給材θ軸 反転吸着 確認位置SW
ANPB B068                ; 給材θ軸 ﾒﾝﾃﾅﾝｽ 位置SW
INV
ANB @MR305               ; 給材θ軸 位置決め
OUT @MR300               ; 手動 給材θ軸 位置決め
;<h1/>自動位置決め
LD MR101                 ; 自動ﾓｰﾄﾞ
ANB @MR305               ; 給材θ軸 位置決め
MPS
AND MR1601               ; 給材θ軸 待機位置指令
DW #1 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1602               ; 給材θ軸 取出位置指令
DW #2 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1603               ; 給材θ軸 吸着確認 位置指令
DW #3 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1604               ; 給材θ軸 検査投入 位置指令
DW #4 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1605               ; 給材θ軸 返却位置指令
DW #5 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR1606               ; 給材θ軸 排出位置指令
DW #6 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
MPP
AND MR1607               ; 給材θ軸 反転吸着 確認位置指令
DW #7 DM53               ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
LDB MR1601               ; 給材θ軸 待機位置指令
ANB MR1602               ; 給材θ軸 取出位置指令
ANB MR1603               ; 給材θ軸 吸着確認 位置指令
ANB MR1604               ; 給材θ軸 検査投入 位置指令
ANB MR1605               ; 給材θ軸 返却位置指令
ANB MR1606               ; 給材θ軸 排出位置指令
ANB MR1607               ; 給材θ軸 反転吸着 確認位置指令
INV
ANB @MR305               ; 給材θ軸 位置決め
OUT @MR302               ; 自.θ軸位置決め
;<h1/>位置決め開始
;ｲﾝﾀｰﾛｯｸ
LD MR1712                ; 給材θ軸 原点復帰記憶
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR13202              ; ﾏｸﾛPOS 給材θ軸 位置決めIL
LD @MR300                ; 手動 給材θ軸 位置決め
AND MR100                ; 手動ﾓｰﾄﾞ
LD @MR302                ; 自.θ軸位置決め
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
ANB CR3009               ; X軸ﾊﾟﾙｽ出力中/緊急停止
OR @MR305                ; 給材θ軸 位置決め
ANB MR13209              ; ﾏｸﾛPOS 給材θ軸 位置決め完了
ANB MR13210              ; ﾏｸﾛPOS 給材θ軸 位置決め異常
AND MR13202              ; ﾏｸﾛPOS 給材θ軸 位置決めIL
OUT @MR305               ; 給材θ軸 位置決め
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ演算
;'給材θ軸 動作ﾓｰﾄﾞ書込
;
;FM4106 = 1		'給材θ軸待機位置動作ﾓｰﾄﾞ
;FM4116 = 1		'給材θ軸ﾜｰｸ取出位置動作ﾓｰﾄﾞ
;FM4126 = 1		'給材θ軸吸着確認位置動作ﾓｰﾄﾞ
;FM4136 = 1		'給材θ軸検査投入位置動作ﾓｰﾄﾞ
;FM4146 = 1		'給材θ軸返却位置動作ﾓｰﾄﾞ
;FM4156 = 1		'給材θ軸排出位置動作ﾓｰﾄﾞ
;FM4166 = 1		'給材θ軸反転吸着確認位置動作ﾓｰﾄﾞ
;FM4176 = 1		'給材θ軸ﾒﾝﾃﾅﾝｽ位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
NCJ #1000
;'給材θ軸 動作ﾓｰﾄﾞ書込
;
;FM4106 = 1		'給材θ軸待機位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4106            ; 給材θ軸 待機位置 動作ﾓｰﾄﾞ
;FM4116 = 1		'給材θ軸ﾜｰｸ取出位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4116            ; 給材θ軸 取出位置 動作ﾓｰﾄﾞ
;FM4126 = 1		'給材θ軸吸着確認位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4126            ; 給材θ軸 吸着確認 動作ﾓｰﾄﾞ
;FM4136 = 1		'給材θ軸検査投入位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4136            ; 給材θ軸 検査投入 動作ﾓｰﾄﾞ
;FM4146 = 1		'給材θ軸返却位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4146            ; 給材θ軸 返却位置 動作ﾓｰﾄﾞ
;FM4156 = 1		'給材θ軸排出位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4156
;FM4166 = 1		'給材θ軸反転吸着確認位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4166            ; 給材θ軸 反転吸着 動作ﾓｰﾄﾞ
;FM4176 = 1		'給材θ軸ﾒﾝﾃﾅﾝｽ位置動作ﾓｰﾄﾞ
;
LD CR2002                ; 常時ON
MOV #1 FM4176            ; 給材θ軸 ﾒﾝﾃ位置 動作ﾓｰﾄﾞ
LABEL #1000
;
;'給材θ軸 ﾜｰｸ取出位置演算
;
;FM4110.L = DM1020.L+FM9018.L		'θ軸ﾜｰｸ取出位置目標座標へ代入
;IF FM4110.L < -17999 THEN
;	FM4110.L = FM4110.L + 36000
;END IF
;IF FM4110.L > 18000 THEN
;	FM4110.L = FM4110.L - 36000
;END IF
LD CR2002                ; 常時ON
NCJ #1001
;'給材θ軸 ﾜｰｸ取出位置演算
;
;FM4110.L = DM1020.L+FM9018.L		'θ軸ﾜｰｸ取出位置目標座標へ代入
;
LD CR2002                ; 常時ON
LDA.L DM1020             ; 画像給材θ軸 S盤ﾜｰｸ取出し座標
CON
ADD.L FM9018             ; ﾜｰｸﾚｼﾋﾟ基本(ﾊﾟﾚｯﾄ補正値θ軸)
CON
STA.L FM4110             ; 給材θ軸 取出位置 目標座標
;IF FM4110.L < -17999 THEN
;
LD<.L FM4110 -17999      ; 給材θ軸 取出位置 目標座標
NCJ #2000
;	FM4110.L = FM4110.L + 36000
;
LD CR2002                ; 常時ON
LDA.L FM4110             ; 給材θ軸 取出位置 目標座標
CON
ADD.L +36000
CON
STA.L FM4110             ; 給材θ軸 取出位置 目標座標
;END IF
;
LABEL #2000
;IF FM4110.L > 18000 THEN
;
LD>.L FM4110 +18000      ; 給材θ軸 取出位置 目標座標
NCJ #2001
;	FM4110.L = FM4110.L - 36000
;
LD CR2002                ; 常時ON
LDA.L FM4110             ; 給材θ軸 取出位置 目標座標
CON
SUB.L +36000
CON
STA.L FM4110             ; 給材θ軸 取出位置 目標座標
;END IF
LABEL #2001
LABEL #1001
;
;'給材θ軸 検査位置演算
;
;FM4123.D = FM4133.D		'吸着確認位置(θ軸加減速)
;FM4124.D = FM4134.D		'吸着確認位置(θ軸速度)
LD CR2002                ; 常時ON
NCJ #1004
;'給材θ軸 検査位置演算
;
;FM4123.D = FM4133.D		'吸着確認位置(θ軸加減速)
;
LD CR2002                ; 常時ON
MOV.D FM4133 FM4123      ; 給材θ軸 検査投入 加減速時間  給材θ軸 吸着確認 加減速時間
;FM4124.D = FM4134.D		'吸着確認位置(θ軸速度)
LD CR2002                ; 常時ON
MOV.D FM4134 FM4124      ; 給材θ軸 検査投入 運転速度  給材θ軸 吸着確認 運転速度
LABEL #1004
;
;'給材θ軸 反転吸着確認位置演算
;FM4160.L = FM4120.L + 18000
;FM4162 = FM4122			'反転吸着確認位置(θ軸起動速度)
;FM4163 = FM4123         '反転吸着確認位置(θ軸加減速)
;FM4164.D = FM4124.D     '反転吸着確認位置(θ軸速度)
LD CR2002                ; 常時ON
NCJ #1002
;'給材θ軸 反転吸着確認位置演算
;
;FM4160.L = FM4120.L + 18000
;
LD CR2002                ; 常時ON
LDA.L FM4120             ; 給材θ軸 吸着確認 目標座標
CON
ADD.L +18000
CON
STA.L FM4160             ; 給材θ軸 反転吸着 目標座標
;FM4162 = FM4122			'反転吸着確認位置(θ軸起動速度)
;
LD CR2002                ; 常時ON
MOV FM4122 FM4162        ; 給材θ軸 吸着確認 起動速度  給材θ軸 反転吸着 起動速度
;FM4163 = FM4123         '反転吸着確認位置(θ軸加減速)
;
LD CR2002                ; 常時ON
MOV FM4123 FM4163        ; 給材θ軸 吸着確認 加減速時間  給材θ軸 反転吸着 加減速時間
;FM4164.D = FM4124.D     '反転吸着確認位置(θ軸速度)
LD CR2002                ; 常時ON
MOV.D FM4124 FM4164      ; 給材θ軸 吸着確認 運転速度  給材θ軸 反転吸着 運転速度
LABEL #1002
;
;'給材θ軸 ﾒﾝﾃ位置演算
;
;FM4170.L = FM9018.L				'θ軸ﾒﾝﾃ位置目標座標へ代入
;
LD CR2002                ; 常時ON
NCJ #1003
;'給材θ軸 ﾒﾝﾃ位置演算
;
;FM4170.L = FM9018.L				'θ軸ﾒﾝﾃ位置目標座標へ代入
;
LD CR2002                ; 常時ON
MOV.L FM9018 FM4170      ; ﾜｰｸﾚｼﾋﾟ基本(ﾊﾟﾚｯﾄ補正値θ軸)  給材θ軸 ﾒﾝﾃ位置 目標座標
LABEL #1003
;
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送
LD @MR305                ; 給材θ軸 位置決め
MPS
AND= DM53 #1             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4100 DM12100 #8   ; 給材θ軸 待機位置 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #2             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4110 DM12100 #8   ; 給材θ軸 取出位置 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #3             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4120 DM12100 #8   ; 給材θ軸 吸着確認 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #4             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4130 DM12100 #8   ; 給材θ軸 検査投入 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #5             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4140 DM12100 #8   ; 給材θ軸 返却位置 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #6             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4150 DM12100 #8   ; 給材θ軸 排出位置 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MRD
AND= DM53 #7             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4160 DM12100 #8   ; 給材θ軸 反転吸着 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
MPP
AND= DM53 #8             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM4170 DM12100 #8   ; 給材θ軸 ﾒﾝﾃ位置 目標座標  ﾏｸﾛ 給材θ軸 目標値/ 移動量
LD CR2002                ; 常時ON
MCALL OR_CSK_PDT36 #1 DM12100;ﾏｸﾛ 給材θ軸 目標値/ 移動量
;<h1/>位置決め出力
LD @MR305                ; 給材θ軸 位置決め
OUT MR13200              ; ﾏｸﾛPOS 給材θ軸 位置決め起動
LD MR004                 ; ﾘｾｯﾄSW
OUT MR13203              ; ﾏｸﾛPOS 給材θ軸 位置決め ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_CPU_POS_X MR13200 DM19100;ﾏｸﾛPOS 給材θ軸 位置決め起動  給材θ軸 ｴﾗｰ状態
;ﾗﾝﾌﾟ
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #1             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1701                ; 給材θ軸 待機位置
OUT B0161                ; 給材θ軸 待機位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #2             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1702                ; 給材θ軸 取出位置
OUT B0162                ; 給材θ軸 取出位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #3             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1703                ; 給材θ軸 吸着確認位置
OUT B0163                ; 給材θ軸 吸着確認 位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #4             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1704                ; 給材θ軸 検査投入位置
OUT B0164                ; 給材θ軸 検査投入 位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #5             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1705                ; 給材θ軸 返却位置
OUT B0165                ; 給材θ軸 返却位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #6             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1706                ; 給材θ軸 排出位置
OUT B0166                ; 給材θ軸 排出位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #7             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1707                ; 給材θ軸 反転吸着 確認位置
OUT B0167                ; 給材θ軸 反転吸着 確認位置PL
LD MR13208               ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
AND= DM53 #8             ; 給材θ軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR1708                ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置
OUT B0168                ; 給材θ軸 ﾒﾝﾃﾅﾝｽ 位置PL
;<h1/>位置出力
;'θ軸
;DM12110.L = FM4100.L+9		'待機位置+0.18
;DM12112.L = FM4100.L-9		'待機位置-0.18
;
;DM12114.L = FM4110.L+9		'取出位置+0.18
;DM12116.L = FM4110.L-9		'取出位置-0.18
;
;DM12118.L = FM4120.L+9		'吸着確認位置+0.18
;DM12120.L = FM4120.L-9		'吸着確認位置-0.18
;
;DM12122.L = FM4130.L+9		'検査投入位置+0.18
;DM12124.L = FM4130.L-9		'検査投入位置-0.18
;
;DM12126.L = FM4140.L+9		'返却位置+0.18
;DM12128.L = FM4140.L-9		'返却位置-0.18
;
;DM12130.L = FM4150.L+9		'排出位置+0.18
;DM12132.L = FM4150.L-9		'排出位置-0.18
;
;DM12134.L = FM4160.L+9		'反転吸着確認位置+0.18
;DM12136.L = FM4160.L-9		'反転吸着確認位置-0.18
;
;DM12138.L = FM4170.L+9		'ﾒﾝﾃﾅﾝｽ位置+0.18
;DM12140.L = FM4170.L-9		'ﾒﾝﾃﾅﾝｽ位置-0.18
;
;
;FM56.L = CM2020.L*18		'X軸現在値表示
LD CR2002                ; 常時ON
NCJ #1008
;'θ軸
;
;DM12110.L = FM4100.L+9		'待機位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4100             ; 給材θ軸 待機位置 目標座標
CON
ADD.L +9
CON
STA.L DM12110            ; 給材θ軸 待機位置 +0.36
;DM12112.L = FM4100.L-9		'待機位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4100             ; 給材θ軸 待機位置 目標座標
CON
SUB.L +9
CON
STA.L DM12112            ; 給材θ軸 待機位置 -0.36
;DM12114.L = FM4110.L+9		'取出位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4110             ; 給材θ軸 取出位置 目標座標
CON
ADD.L +9
CON
STA.L DM12114            ; 給材θ軸 取出位置 +0.36
;DM12116.L = FM4110.L-9		'取出位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4110             ; 給材θ軸 取出位置 目標座標
CON
SUB.L +9
CON
STA.L DM12116            ; 給材θ軸 取出位置 -0.36
;DM12118.L = FM4120.L+9		'吸着確認位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4120             ; 給材θ軸 吸着確認 目標座標
CON
ADD.L +9
CON
STA.L DM12118            ; 給材θ軸 吸着確認 位置+0.36
;DM12120.L = FM4120.L-9		'吸着確認位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4120             ; 給材θ軸 吸着確認 目標座標
CON
SUB.L +9
CON
STA.L DM12120            ; 給材θ軸 吸着確認 位置-0.36
;DM12122.L = FM4130.L+9		'検査投入位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4130             ; 給材θ軸 検査投入 目標座標
CON
ADD.L +9
CON
STA.L DM12122            ; 給材θ軸 検査投入 位置+0.36
;DM12124.L = FM4130.L-9		'検査投入位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4130             ; 給材θ軸 検査投入 目標座標
CON
SUB.L +9
CON
STA.L DM12124            ; 給材θ軸 検査投入 位置-0.36
;DM12126.L = FM4140.L+9		'返却位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4140             ; 給材θ軸 返却位置 目標座標
CON
ADD.L +9
CON
STA.L DM12126            ; 給材θ軸 返却位置 +0.36
;DM12128.L = FM4140.L-9		'返却位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4140             ; 給材θ軸 返却位置 目標座標
CON
SUB.L +9
CON
STA.L DM12128            ; 給材θ軸 返却位置 -0.36
;DM12130.L = FM4150.L+9		'排出位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4150             ; 給材θ軸 排出位置 目標座標
CON
ADD.L +9
CON
STA.L DM12130            ; 給材θ軸 排出位置 -0.36
;DM12132.L = FM4150.L-9		'排出位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4150             ; 給材θ軸 排出位置 目標座標
CON
SUB.L +9
CON
STA.L DM12132            ; 給材θ軸 排出位置 +0.36
;DM12134.L = FM4160.L+9		'反転吸着確認位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4160             ; 給材θ軸 反転吸着 目標座標
CON
ADD.L +9
CON
STA.L DM12134            ; 給材θ軸 反転吸着 確認位置 +0.36
;DM12136.L = FM4160.L-9		'反転吸着確認位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4160             ; 給材θ軸 反転吸着 目標座標
CON
SUB.L +9
CON
STA.L DM12136            ; 給材θ軸 反転吸着 確認位置 -0.36
;DM12138.L = FM4170.L+9		'ﾒﾝﾃﾅﾝｽ位置+0.18
;
LD CR2002                ; 常時ON
LDA.L FM4170             ; 給材θ軸 ﾒﾝﾃ位置 目標座標
CON
ADD.L +9
CON
STA.L DM12138            ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置 +0.36
;DM12140.L = FM4170.L-9		'ﾒﾝﾃﾅﾝｽ位置-0.18
;
LD CR2002                ; 常時ON
LDA.L FM4170             ; 給材θ軸 ﾒﾝﾃ位置 目標座標
CON
SUB.L +9
CON
STA.L DM12140            ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置 -0.36
;FM56.L = CM2020.L*18		'X軸現在値表示
LD CR2002                ; 常時ON
LDA.L CM2020             ; X軸現在位置
CON
MUL.L +18
CON
STA.L FM56               ; 給材θ軸 現在値表示
LABEL #1008
;
LDB @MR305               ; 給材θ軸 位置決め
ANB MR13208              ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
MPS
LD<=.L DM12112 FM56      ; 給材θ軸 待機位置 -0.36  給材θ軸 現在値表示
AND>=.L DM12110 FM56     ; 給材θ軸 待機位置 +0.36  給材θ軸 現在値表示
ANL
OUT MR1701               ; 給材θ軸 待機位置
MRD
LD<=.L DM12116 FM56      ; 給材θ軸 取出位置 -0.36  給材θ軸 現在値表示
AND>=.L DM12114 FM56     ; 給材θ軸 取出位置 +0.36  給材θ軸 現在値表示
ANL
OUT MR1702               ; 給材θ軸 取出位置
MRD
LD<=.L DM12120 FM56      ; 給材θ軸 吸着確認 位置-0.36  給材θ軸 現在値表示
AND>=.L DM12118 FM56     ; 給材θ軸 吸着確認 位置+0.36  給材θ軸 現在値表示
ANL
OUT MR1703               ; 給材θ軸 吸着確認位置
MRD
LD<=.L DM12124 FM56      ; 給材θ軸 検査投入 位置-0.36  給材θ軸 現在値表示
AND>=.L DM12122 FM56     ; 給材θ軸 検査投入 位置+0.36  給材θ軸 現在値表示
ANL
OUT MR1704               ; 給材θ軸 検査投入位置
MRD
LD<=.L DM12128 FM56      ; 給材θ軸 返却位置 -0.36  給材θ軸 現在値表示
AND>=.L DM12126 FM56     ; 給材θ軸 返却位置 +0.36  給材θ軸 現在値表示
ANL
OUT MR1705               ; 給材θ軸 返却位置
MRD
LD<=.L DM12132 FM56      ; 給材θ軸 排出位置 +0.36  給材θ軸 現在値表示
AND>=.L DM12130 FM56     ; 給材θ軸 排出位置 -0.36  給材θ軸 現在値表示
ANL
OUT MR1706               ; 給材θ軸 排出位置
MRD
LD<=.L DM12136 FM56      ; 給材θ軸 反転吸着 確認位置 -0.36  給材θ軸 現在値表示
AND>=.L DM12134 FM56     ; 給材θ軸 反転吸着 確認位置 +0.36  給材θ軸 現在値表示
ANL
OUT MR1707               ; 給材θ軸 反転吸着 確認位置
MPP
LD<=.L DM12140 FM56      ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置 -0.36  給材θ軸 現在値表示
AND>=.L DM12138 FM56     ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置 +0.36  給材θ軸 現在値表示
ANL
OUT MR1708               ; 給材θ軸 ﾒﾝﾃﾅﾝｽ位置
;<h1/>JOG移動
LD B06B                  ; 給材θ軸 JOG逆転SW
OUT @MR500               ; 手動 給材θ軸 JOG運転正転
LD B06A                  ; 給材θ軸 JOG正転SW
OUT @MR501               ; 手動 給材θ軸 JOG運転逆転
;ｲﾝﾀｰﾛｯｸ
LDB MR7006               ; ERR06 給材θ軸 位置決め異常
AND MR400                ; 全ﾄﾞｱ閉確認
OUT MR13402              ; ﾏｸﾛ 給材θ軸 JOG動作IL
;θ軸JOG運転
LD @MR500                ; 手動 給材θ軸 JOG運転正転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR13402              ; ﾏｸﾛ 給材θ軸 JOG動作IL
ANB MR13410              ; ﾏｸﾛ 給材θ軸 JOG動作異常
OUT @MR505               ; 給材θ軸 JOG運転正転
LD @MR501                ; 手動 給材θ軸 JOG運転逆転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR13402              ; ﾏｸﾛ 給材θ軸 JOG動作IL
ANB MR13410              ; ﾏｸﾛ 給材θ軸 JOG動作異常
OUT @MR506               ; 給材θ軸 JOG運転逆転
;JOG速度倍率設定
LD CR2002                ; 常時ON
MSTRT JOG_倍率 B07A B017A DM10360;給材θ軸 JOG倍率0.1SW  給材θ軸 JOG倍率0.1  給材θ軸 JOG倍率DATA
;動作ﾃﾞｰﾀ転送
;'θ軸JOG_DATA
;FM4010 = 50					'θ軸JOG起動速度
;FM4011 = 10					'θ軸JOG加減速時間
;FM4012.D = 9*DM10360.D		'θ軸JOG運転速度
LD CR2002                ; 常時ON
NCJ #1009
;'θ軸JOG_DATA
;
;FM4010 = 50					'θ軸JOG起動速度
;
LD CR2002                ; 常時ON
MOV #50 FM4010           ; 給材θ軸 JOG起動速度
;FM4011 = 10					'θ軸JOG加減速時間
;
LD CR2002                ; 常時ON
MOV #10 FM4011           ; TP_軸θJOG加減速時間
;FM4012.D = 9*DM10360.D		'θ軸JOG運転速度
LD CR2002                ; 常時ON
LDA.L +9
CON
MUL.L DM10360            ; 給材θ軸 JOG倍率DATA
CON
STA.D FM4012             ; TP_軸θJOG運転速度
LABEL #1009
;
LD @MR505                ; 給材θ軸 JOG運転正転
OR @MR506                ; 給材θ軸 JOG運転逆転
MCALL OR_CSK_JDT36 #1 FM4010;給材θ軸 JOG起動速度
;出力
LD @MR505                ; 給材θ軸 JOG運転正転
OUT MR13400              ; ﾏｸﾛ 給材θ軸 JOG起動＋
LD @MR506                ; 給材θ軸 JOG運転逆転
OUT MR13401              ; ﾏｸﾛ 給材θ軸 JOG起動−
LD MR004                 ; ﾘｾｯﾄSW
OUT MR13403              ; ﾏｸﾛ 給材θ軸 JOG動作 ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_CPU_JOG_X MR13400 DM19100;ﾏｸﾛ 給材θ軸 JOG起動＋  給材θ軸 ｴﾗｰ状態
;ﾗﾝﾌﾟ
LD MR13409               ; ﾏｸﾛ 給材θ軸 JOG−運転中
OUT B016A                ; 給材θ軸 JOG正転PL
LD MR13408               ; ﾏｸﾛ 給材θ軸 JOG＋運転中
OUT B016B                ; 給材θ軸 JOG逆転PL
;<h1/>DATA_SET
LD B0E1                  ; 給材 待機位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4100        ; 給材θ軸 現在値表示  給材θ軸 待機位置 目標座標
LD B0E3                  ; 給材吸着 確認位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4120        ; 給材θ軸 現在値表示  給材θ軸 吸着確認 目標座標
LD B0E4                  ; 給材検査 投入位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4130        ; 給材θ軸 現在値表示  給材θ軸 検査投入 目標座標
LD B0E5                  ; 給材 返却位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4140        ; 給材θ軸 現在値表示  給材θ軸 返却位置 目標座標
LD B0E6                  ; 給材 排出位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4150        ; 給材θ軸 現在値表示  給材θ軸 排出位置 目標座標
LD B0E8                  ; 給材 ﾒﾝﾃﾅﾝｽ位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM56 FM4170        ; 給材θ軸 現在値表示  給材θ軸 ﾒﾝﾃ位置 目標座標
LD B079                  ; 給材θ軸 原点補正量 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MEP
LDA.L CM2026             ; X軸ﾎｰﾑﾎﾟｼﾞｼｮﾝ座標設定値
CON
MUL.L +18
CON
ADD.L FM56               ; 給材θ軸 現在値表示
CON
STA.L FM4190             ; 給材θ軸 原点補正量
;<h1/>ｴﾗｰ出力
LD MR13010               ; ﾏｸﾛHP 給材θ軸 原点復帰異常
OR MR13210               ; ﾏｸﾛPOS 給材θ軸 位置決め異常
OR MR13410               ; ﾏｸﾛ 給材θ軸 JOG動作異常
AND DM19100.0
OUT MR7006               ; ERR06 給材θ軸 位置決め異常
;現在値RESET
LDP MR13009              ; ﾏｸﾛHP 給材θ軸 原点復帰完了
ORP MR1710               ; θ軸現在値RESET
DW.D #0 CM2014           ; X軸現在値変更設定値
CON
OUT CR3011               ; X軸現在値変更要求
;<h1/>まとめ
LD MR7006                ; ERR06 給材θ軸 位置決め異常
OUT MR1713               ; 給材θ軸 全異常
LD MR1701                ; 給材θ軸 待機位置
OUT MR1714               ; 給材θ軸 全原点
LDB MR13000              ; ﾏｸﾛHP 給材θ軸 原点復帰起動
ANB MR13008              ; ﾏｸﾛHP 給材θ軸 原点復帰中
ANB MR13200              ; ﾏｸﾛPOS 給材θ軸 位置決め起動
ANB MR13208              ; ﾏｸﾛPOS 給材θ軸 位置決め 移動中
ANB MR13400              ; ﾏｸﾛ 給材θ軸 JOG起動＋
ANB MR13401              ; ﾏｸﾛ 給材θ軸 JOG起動−
ANB MR13408              ; ﾏｸﾛ 給材θ軸 JOG＋運転中
ANB MR13409              ; ﾏｸﾛ 給材θ軸 JOG−運転中
OUT MR1715               ; 給材θ軸 全停止
END
ENDH
