DEVICE:53
;MODULE:除材Z軸ax6
;MODULE_TYPE:0
;SCRIPT_TYPE:
;<h1/>設定値制限
;'設定値制限
;
;FM13004.L = LIMIT ( -15000, 0, FM13004.L )		'待機位置_目標値
;FM13016.D = LIMIT ( 1, 1000, FM13016.D )			'待機位置_運転速度
;FM13018.D = LIMIT ( 1, 9999, FM13018.D )			'待機位置_加速時間
;FM13020.D = LIMIT ( 1, 1000, FM13020.D )			'待機位置_減速時間
;
;FM13204.L = LIMIT ( -270000, 0, FM13204.L )		'吸着確認位置_目標値
;FM13216.D = LIMIT ( 1, 2000, FM13216.D )			'吸着確認位置_運転速度
;FM13218.D = LIMIT ( 1, 9999, FM13218.D )			'吸着確認位置_加速時間
;FM13220.D = LIMIT ( 1, 9999, FM13220.D )			'吸着確認位置_減速時間
;
;FM13304.L = LIMIT ( -29500, 0, FM13304.L )		'検査投入位置_目標値
;FM13316.D = LIMIT ( 1, 2000, FM13316.D )			'検査投入位置_運転速度
;FM13318.D = LIMIT ( 1, 9999, FM13318.D )			'検査投入位置_加速時間
;FM13320.D = LIMIT ( 1, 9999, FM13320.D )			'検査投入位置_減速時間
;
;FM13404.L = LIMIT ( -29500, 0, FM13404.L )		'返却位置_目標値
;FM13416.D = LIMIT ( 1, 1000, FM13416.D )			'返却位置_運転速度
;FM13418.D = LIMIT ( 1, 9999, FM13418.D )			'返却位置_加速時間
;FM13420.D = LIMIT ( 1, 1000, FM13420.D )			'返却位置_減速時間
;
;FM13704.L = LIMIT ( -29500, 0, FM13704.L )		'ﾒﾝﾃ位置_目標値
;FM13716.D = LIMIT ( 1, 1000, FM13716.D )			'ﾒﾝﾃ位置_運転速度
;FM13718.D = LIMIT ( 1, 9999, FM13718.D )			'ﾒﾝﾃ位置_加速時間
;FM13720.D = LIMIT ( 1, 1000, FM13720.D )			'ﾒﾝﾃ位置_減速時間
;
;FM13900.L = LIMIT ( -29500, 0, FM13900.L )		'画像基準面設定
LDB CR2002               ; 常時ON
NCJ #1000
;'設定値制限
;
;FM13004.L = LIMIT ( -15000, 0, FM13004.L )		'待機位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -15000 +0 FM13004 @VM0;TP除材Z軸 待機位置 目標座標
LDA.L @VM0
CON
STA.L FM13004            ; TP除材Z軸 待機位置 目標座標
;FM13016.D = LIMIT ( 1, 1000, FM13016.D )			'待機位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13016 @VM2;TP除材Z軸 待機位置 速度
LDA @VM2
CON
EXT
CON
STA.D FM13016            ; TP除材Z軸 待機位置 速度
;FM13018.D = LIMIT ( 1, 9999, FM13018.D )			'待機位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13018 @VM3;TP除材Z軸 待機位置 加速時間
LDA @VM3
CON
EXT
CON
STA.D FM13018            ; TP除材Z軸 待機位置 加速時間
;FM13020.D = LIMIT ( 1, 1000, FM13020.D )			'待機位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13020 @VM4;TP除材Z軸 待機位置 減速時間
LDA @VM4
CON
EXT
CON
STA.D FM13020            ; TP除材Z軸 待機位置 減速時間
;FM13204.L = LIMIT ( -270000, 0, FM13204.L )		'吸着確認位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -270000 +0 FM13204 @VM5;TP除材Z軸 吸着確認 目標座標
LDA.L @VM5
CON
STA.L FM13204            ; TP除材Z軸 吸着確認 目標座標
;FM13216.D = LIMIT ( 1, 2000, FM13216.D )			'吸着確認位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #2000 FM13216 @VM7;TP除材Z軸 吸着確認 速度
LDA @VM7
CON
EXT
CON
STA.D FM13216            ; TP除材Z軸 吸着確認 速度
;FM13218.D = LIMIT ( 1, 9999, FM13218.D )			'吸着確認位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13218 @VM8;TP除材Z軸 吸着確認 加速時間
LDA @VM8
CON
EXT
CON
STA.D FM13218            ; TP除材Z軸 吸着確認 加速時間
;FM13220.D = LIMIT ( 1, 9999, FM13220.D )			'吸着確認位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13220 @VM9;TP除材Z軸 吸着確認 減速時間
LDA @VM9
CON
EXT
CON
STA.D FM13220            ; TP除材Z軸 吸着確認 減速時間
;FM13304.L = LIMIT ( -29500, 0, FM13304.L )		'検査投入位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM13304 @VM10;TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
LDA.L @VM10
CON
STA.L FM13304            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
;FM13316.D = LIMIT ( 1, 2000, FM13316.D )			'検査投入位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #2000 FM13316 @VM12;TP除材Z軸 ﾊﾟﾚｯﾄ置 速度
LDA @VM12
CON
EXT
CON
STA.D FM13316            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 速度
;FM13318.D = LIMIT ( 1, 9999, FM13318.D )			'検査投入位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13318 @VM13;TP除材Z軸 ﾊﾟﾚｯﾄ置 加速時間
LDA @VM13
CON
EXT
CON
STA.D FM13318            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 加速時間
;FM13320.D = LIMIT ( 1, 9999, FM13320.D )			'検査投入位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13320 @VM14;TP除材Z軸 ﾊﾟﾚｯﾄ置 減速時間
LDA @VM14
CON
EXT
CON
STA.D FM13320            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 減速時間
;FM13404.L = LIMIT ( -29500, 0, FM13404.L )		'返却位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM13404 @VM15;TP除材Z軸 NG位置 目標座標
LDA.L @VM15
CON
STA.L FM13404            ; TP除材Z軸 NG位置 目標座標
;FM13416.D = LIMIT ( 1, 1000, FM13416.D )			'返却位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13416 @VM17;TP除材Z軸 NG位置 速度
LDA @VM17
CON
EXT
CON
STA.D FM13416            ; TP除材Z軸 NG位置 速度
;FM13418.D = LIMIT ( 1, 9999, FM13418.D )			'返却位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13418 @VM18;TP除材Z軸 NG位置 加速時間
LDA @VM18
CON
EXT
CON
STA.D FM13418            ; TP除材Z軸 NG位置 加速時間
;FM13420.D = LIMIT ( 1, 1000, FM13420.D )			'返却位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13420 @VM19;TP除材Z軸 NG位置 減速時間
LDA @VM19
CON
EXT
CON
STA.D FM13420            ; TP除材Z軸 NG位置 減速時間
;FM13704.L = LIMIT ( -29500, 0, FM13704.L )		'ﾒﾝﾃ位置_目標値
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM13704 @VM20;TP除材Z軸 ﾒﾝﾃ位置 目標座標
LDA.L @VM20
CON
STA.L FM13704            ; TP除材Z軸 ﾒﾝﾃ位置 目標座標
;FM13716.D = LIMIT ( 1, 1000, FM13716.D )			'ﾒﾝﾃ位置_運転速度
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13716 @VM22;TP除材Z軸 ﾒﾝﾃ位置 速度
LDA @VM22
CON
EXT
CON
STA.D FM13716            ; TP除材Z軸 ﾒﾝﾃ位置 速度
;FM13718.D = LIMIT ( 1, 9999, FM13718.D )			'ﾒﾝﾃ位置_加速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #9999 FM13718 @VM23;TP除材Z軸 ﾒﾝﾃ位置 加速時間
LDA @VM23
CON
EXT
CON
STA.D FM13718            ; TP除材Z軸 ﾒﾝﾃ位置 加速時間
;FM13720.D = LIMIT ( 1, 1000, FM13720.D )			'ﾒﾝﾃ位置_減速時間
;
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT #1 #1000 FM13720 @VM24;TP除材Z軸 ﾒﾝﾃ位置 減速時間
LDA @VM24
CON
EXT
CON
STA.D FM13720            ; TP除材Z軸 ﾒﾝﾃ位置 減速時間
;FM13900.L = LIMIT ( -29500, 0, FM13900.L )		'画像基準面設定
LD CR2002                ; 常時ON
LDA.D #0
CON
LIMIT.L -29500 +0 FM13900 @VM25;TP除材Z軸 ﾊﾟﾚｯﾄ台基準面座標
LDA.L @VM25
CON
STA.L FM13900            ; TP除材Z軸 ﾊﾟﾚｯﾄ台基準面座標
LABEL #1000
;
LD R68404                ; 軸6 軸制御中
ANB MR400                ; 全ﾄﾞｱ閉確認
OUT R68002               ; 軸6 減速停止
LD CR2002                ; 常時ON
OUT R3605                ; 除材Z軸 電源MC
LD CR2002                ; 常時ON
ANB @MR601               ; 除材Z軸 ｻｰﾎﾞOFF
OUT R68113               ; 軸6 ｻｰﾎﾞON
LD @MR601                ; 除材Z軸 ｻｰﾎﾞOFF
OUT R5101                ; 除材Z軸 ﾌﾞﾚｰｷ解除
LD R62800                ; ML16動作可能
AND R68513               ; 軸6 ｻｰﾎﾞﾚﾃﾞｨ
ANB MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
ANB R62802               ; ｴﾗｰ中
OUT MR805                ; 除材Z軸 動作可能
LDP B0359                ; 除材Z軸 ｻｰﾎﾞOFF_SW
AND B01D4                ; ﾏｽﾀｰﾛｸﾞｲﾝ中PL
OUT @MR600               ; 除材Z軸 ｻｰﾎﾞOFF_PLS
LD @MR600                ; 除材Z軸 ｻｰﾎﾞOFF_PLS
ANB @MR601               ; 除材Z軸 ｻｰﾎﾞOFF
LD @MR601                ; 除材Z軸 ｻｰﾎﾞOFF
ANB @MR600               ; 除材Z軸 ｻｰﾎﾞOFF_PLS
ORL
AND MR100                ; 手動ﾓｰﾄﾞ
OUT @MR601               ; 除材Z軸 ｻｰﾎﾞOFF
LD @MR601                ; 除材Z軸 ｻｰﾎﾞOFF
OUT B0459                ; 除材Z軸 ｻｰﾎﾞOFF_PL
;<h1/>原点復帰
LDP B0340                ; 除材Z軸 原点復帰SW
OUT @MR000               ; 手動 除材Z軸 原点復帰
;ｲﾝﾀｰﾛｯｸ
LD MR805                 ; 除材Z軸 動作可能
ANB MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR10502              ; ﾏｸﾛHP 除材Z軸 原点復帰IL
LD @MR000                ; 手動 除材Z軸 原点復帰
AND MR100                ; 手動ﾓｰﾄﾞ
LD MR6400                ; 除材Z軸 原点復帰指令
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
OR @MR005                ; 除材Z軸 原点復帰
ANB MR10509              ; ﾏｸﾛHP 除材Z軸 原点復帰完了
ANB MR10510              ; ﾏｸﾛHP 除材Z軸 原点復帰異常
AND MR10502              ; ﾏｸﾛHP 除材Z軸 原点復帰IL
OUT @MR005               ; 除材Z軸 原点復帰
;ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送
;出力
LD @MR005                ; 除材Z軸 原点復帰
OUT MR10500              ; ﾏｸﾛHP 除材Z軸 原点復帰起動
LD MR004                 ; ﾘｾｯﾄSW
OUT MR10503              ; ﾏｸﾛHP 除材Z軸 原点復帰ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_HP #6 #1 MR10500 DM19050;ﾏｸﾛHP 除材Z軸 原点復帰起動  除材Z軸 ｴﾗｰ状態
LD MR10509               ; ﾏｸﾛHP 除材Z軸 原点復帰完了
OR MR6512                ; 除材Z軸 原点復帰記憶
AND MR805                ; 除材Z軸 動作可能
ANB MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
ANPB @MR005              ; 除材Z軸 原点復帰
OUT MR6512               ; 除材Z軸 原点復帰記憶
LD MR10512               ; ﾏｸﾛHP 除材Z軸 原点復帰要求
OUT R68012               ; 軸6 原点復帰要求
;ﾗﾝﾌﾟ
LD MR10508               ; ﾏｸﾛHP 除材Z軸 原点復帰中
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6500                ; 除材Z軸 原点位置
OUT B0440                ; 除材Z軸 原点復帰PL
;<h1/>手動位置決め
LD MR100                 ; 手動ﾓｰﾄﾞ
ANB @MR305               ; 除材Z軸 位置決め
MPS
ANP B0341                ; 除材Z軸 待機位置SW
DW #1 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B0342                ; 除材Z軸 除材反転 取出位置SW
DW #2 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B0343                ; 除材Z軸 吸着確認 位置SW
DW #3 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B0344                ; 除材Z軸 ﾊﾟﾚｯﾄ置 位置SW
DW #4 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
ANP B0345                ; 除材Z軸 NG位置SW
DW #5 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MPP
ANP B0348                ; 除材Z軸 ﾒﾝﾃﾅﾝｽﾎﾟｲﾝﾄSW
DW #8 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
LDPB B0341               ; 除材Z軸 待機位置SW
ANPB B0342               ; 除材Z軸 除材反転 取出位置SW
ANPB B0343               ; 除材Z軸 吸着確認 位置SW
ANPB B0344               ; 除材Z軸 ﾊﾟﾚｯﾄ置 位置SW
ANPB B0345               ; 除材Z軸 NG位置SW
ANPB B0348               ; 除材Z軸 ﾒﾝﾃﾅﾝｽﾎﾟｲﾝﾄSW
INV
ANB @MR305               ; 除材Z軸 位置決め
OUT @MR300               ; 手.Z軸位置決め
;<h1/>自動位置決め
LD MR101                 ; 自動ﾓｰﾄﾞ
ANB @MR305               ; 除材Z軸 位置決め
MPS
AND MR6401               ; 除材Z軸 待機位置指令
DW #1 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR6402               ; 除材Z軸 除材反転 取出位置指令
DW #2 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR6403               ; 除材Z軸 吸着確認 位置指令
DW #3 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MRD
AND MR6404               ; 除材Z軸 ﾊﾟﾚｯﾄ置 位置指令
DW #4 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
MPP
AND MR6405               ; 除材Z軸 NG位置指令
DW #5 DM56               ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
LDB MR6401               ; 除材Z軸 待機位置指令
ANB MR6402               ; 除材Z軸 除材反転 取出位置指令
ANB MR6403               ; 除材Z軸 吸着確認 位置指令
ANB MR6404               ; 除材Z軸 ﾊﾟﾚｯﾄ置 位置指令
ANB MR6405               ; 除材Z軸 NG位置指令
INV
ANB @MR305               ; 除材Z軸 位置決め
OUT @MR302               ; 自.Z軸位置決め
;<h1/>ｲﾝﾀｰﾛｯｸ
LD MR805                 ; 除材Z軸 動作可能
AND MR6512               ; 除材Z軸 原点復帰記憶
LD= DM56 #1              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
LD= DM56 #2              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR6102               ; 除材X軸 除材反転 取出位置
AND MR6302               ; 除材Y軸 除材反転 取出位置
LD R3405                 ; 除材移動 後退端
AND R3409                ; 除材反転 ﾕﾆｯﾄ開端
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
ORL
LD= DM56 #3              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR6103               ; 除材X軸 吸着確認位置
AND MR6303               ; 除材Y軸 吸着確認位置
ORL
LD= DM56 #4              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR6104               ; 除材X軸 ﾊﾟﾚｯﾄ置位置
AND MR6304               ; 除材Y軸 ﾊﾟﾚｯﾄ置位置
ORL
LD= DM56 #5              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR6105               ; 除材X軸 NG排出位置
AND MR6305               ; 除材Y軸 NG位置
ORL
LD= DM56 #8              ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND MR6108               ; 除材X軸 ﾒﾝﾃﾅﾝｽ位置
AND MR6308               ; 除材Y軸 ﾒﾝﾃﾅﾝｽ位置
ORL
ANL
ANB MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
LD MR100                 ; 手動ﾓｰﾄﾞ
OR MR101                 ; 自動ﾓｰﾄﾞ
ANL
OUT MR11502              ; ﾏｸﾛPOS 除材Z軸 位置決めIL
;<h1/>位置決め開始
LDB R68404               ; 軸6 軸制御中
LD @MR300                ; 手.Z軸位置決め
AND MR100                ; 手動ﾓｰﾄﾞ
LD @MR302                ; 自.Z軸位置決め
ANB MR11500              ; ﾏｸﾛPOS 除材Z軸 位置決め起動
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
ANL
OR @MR305                ; 除材Z軸 位置決め
ANB MR11509              ; ﾏｸﾛPOS 除材Z軸 位置決め完了
ANB MR11510              ; ﾏｸﾛPOS 除材Z軸 位置決め異常
AND MR11502              ; ﾏｸﾛPOS 除材Z軸 位置決めIL
OUT @MR305               ; 除材Z軸 位置決め
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ演算
;'除材Z軸 除材反転取出位置演算
;FM13104.L = FM13800.L + FM9008.L + FM9516.L + FM9580.L
;
;'除材Z軸 吸着確認位置演算
;FM13204.L = FM13240.L + FM9580.L
LD CR2002                ; 常時ON
NCJ #1001
;'除材Z軸 除材反転取出位置演算
;
;FM13104.L = FM13800.L + FM9008.L + FM9516.L + FM9580.L
;
LD CR2002                ; 常時ON
LDA.L FM13800            ; TP除材Z軸 除材反転 基準面座標
CON
ADD.L FM9008             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側ﾜｰｸ高Z)
CON
ADD.L FM9516             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側高さZ2)
CON
ADD.L FM9580             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM13104            ; TP除材Z軸 取出位置 目標座標
;'除材Z軸 吸着確認位置演算
;
;FM13204.L = FM13240.L + FM9580.L
LD CR2002                ; 常時ON
LDA.L FM13240
CON
ADD.L FM9580             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM13204            ; TP除材Z軸 吸着確認 目標座標
LABEL #1001
;
;'Z軸ﾊﾟﾚｯﾄ1置位置演算
;
;FM13304.L = FM13900.L + FM9008.L + FM9514.L + FM9118.L + FM9580.L
;'Z軸ﾊﾟﾚｯﾄ置位置目標座標へ代入
LD B0410                 ; 手動 ﾊﾟﾚｯﾄ1選択PL
AND MR100                ; 手動ﾓｰﾄﾞ
LDB MR3315               ; ﾊﾟﾚｯﾄ2整列
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
NCJ #1003
;'Z軸ﾊﾟﾚｯﾄ1置位置演算
;
;FM13304.L = FM13900.L + FM9008.L + FM9514.L + FM9118.L + FM9580.L
;
LD CR2002                ; 常時ON
LDA.L FM13900            ; TP除材Z軸 ﾊﾟﾚｯﾄ台基準面座標
CON
ADD.L FM9008             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側ﾜｰｸ高Z)
CON
ADD.L FM9514             ; ﾜｰｸﾚｼﾋﾟ基本(ﾊﾟﾚｯﾄ補正値Z1軸)
CON
ADD.L FM9118             ; ﾊﾟﾚｯﾄﾚｼﾋﾟ(厚み)
CON
ADD.L FM9580             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM13304            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
;'Z軸ﾊﾟﾚｯﾄ置位置目標座標へ代入
LABEL #1003
;
;'Z軸ﾊﾟﾚｯﾄ2置位置演算
;
;FM13304.L = FM13940.L + FM9008.L + FM9514.L + FM9118.L + FM9580.L
;'Z軸ﾊﾟﾚｯﾄ置位置目標座標へ代入
LD B0411                 ; 手動 ﾊﾟﾚｯﾄ2選択PL
AND MR100                ; 手動ﾓｰﾄﾞ
LD MR3315                ; ﾊﾟﾚｯﾄ2整列
AND MR101                ; 自動ﾓｰﾄﾞ
ORL
NCJ #1004
;'Z軸ﾊﾟﾚｯﾄ2置位置演算
;
;FM13304.L = FM13940.L + FM9008.L + FM9514.L + FM9118.L + FM9580.L
;
LD CR2002                ; 常時ON
LDA.L FM13940
CON
ADD.L FM9008             ; ﾜｰｸﾚｼﾋﾟ基本(ﾃｰﾌﾞﾙ側ﾜｰｸ高Z)
CON
ADD.L FM9514             ; ﾜｰｸﾚｼﾋﾟ基本(ﾊﾟﾚｯﾄ補正値Z1軸)
CON
ADD.L FM9118             ; ﾊﾟﾚｯﾄﾚｼﾋﾟ(厚み)
CON
ADD.L FM9580             ; ﾜｰｸﾚｼﾋﾟその他(吸着ﾍｯﾄﾞ補正)
CON
STA.L FM13304            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
;'Z軸ﾊﾟﾚｯﾄ置位置目標座標へ代入
LABEL #1004
;
;<h1/>ﾎﾟｲﾝﾄﾊﾟﾗﾒｰﾀ転送
;P1　給材X軸 待機位置
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #1             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13000 DM11500 #16 ; TP除材Z軸 待機位置 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13016            ; TP除材Z軸 待機位置 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13018 DM11518 #10 ; TP除材Z軸 待機位置 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #2             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13100 DM11500 #16 ; TP除材Z軸 取出位置 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13116            ; TP除材Z軸 取出位置 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13118 DM11518 #10 ; TP除材Z軸 取出位置 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #3             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13200 DM11500 #16 ; TP除材Z軸 吸着確認 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13216            ; TP除材Z軸 吸着確認 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13218 DM11518 #10 ; TP除材Z軸 吸着確認 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #4             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13300 DM11500 #16 ; TP除材Z軸 ﾊﾟﾚｯﾄ置 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13316            ; TP除材Z軸 ﾊﾟﾚｯﾄ置 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13318 DM11518 #10 ; TP除材Z軸 ﾊﾟﾚｯﾄ置 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #5             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13400 DM11500 #16 ; TP除材Z軸 NG位置 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13416            ; TP除材Z軸 NG位置 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13418 DM11518 #10 ; TP除材Z軸 NG位置 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
AND= DM56 #8             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
BMOV FM13700 DM11500 #16 ; TP除材Z軸 ﾒﾝﾃ位置 動作ﾓｰﾄﾞ  除材Z軸 動作ﾓｰﾄﾞ
MPS
LDA.D FM13716            ; TP除材Z軸 ﾒﾝﾃ位置 速度
CON
MUL.D #1000
CON
STA.D DM11516            ; 除材Z軸 速度
MPP
BMOV FM13718 DM11518 #10 ; TP除材Z軸 ﾒﾝﾃ位置 加速時間  除材Z軸 加速時間
LDP @MR305               ; 除材Z軸 位置決め
MCALL KE_ML_PDAT #6 DM56 #1 DM11500;除材Z軸 ﾎﾟｼﾞｼｮﾝNo  除材Z軸 動作ﾓｰﾄﾞ
;<h1/>位置決め出力
LD @MR305                ; 除材Z軸 位置決め
ANB T125                 ; 除材Z軸ﾏｸﾛﾀﾞﾝﾏﾘ対策
MPS
OUT MR11500              ; ﾏｸﾛPOS 除材Z軸 位置決め起動
MPP
ANB MR11508              ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
TMS #125 #100            ; 除材Z軸ﾏｸﾛﾀﾞﾝﾏﾘ対策
LD MR004                 ; ﾘｾｯﾄSW
OUT MR11503              ; ﾏｸﾛPOS 除材Z軸 位置決めﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_POS #6 #1 MR11500 DM19050;ﾏｸﾛPOS 除材Z軸 位置決め起動  除材Z軸 ｴﾗｰ状態
LD MR11513               ; ﾏｸﾛPOS 除材Z軸 位置決め 制御開始
OUT R60208               ; 軸6 位置決め制御開始
LD MR11514               ; ﾏｸﾛPOS 除材Z軸 位置決め 完了ｸﾘｱ
OUT R60210               ; 軸6 位置決め 完了ｸﾘｱ
;ﾗﾝﾌﾟ
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #1             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6501                ; 除材Z軸 待機位置
OUT B0441                ; 除材Z軸 待機位置PL
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #2             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6502                ; 除材Z軸 除材反転 取出位置
OUT B0442                ; 除材Z軸 除材反転 取出位置PL
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #3             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6503                ; 除材Z軸 吸着確認位置
OUT B0443                ; 除材Z軸 吸着確認 位置PL
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #4             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6504                ; 除材Z軸 ﾊﾟﾚｯﾄ置位置
OUT B0444                ; 除材Z軸 ﾊﾟﾚｯﾄ置 位置PL
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #5             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6505                ; 除材Z軸 NG位置
OUT B0445                ; 除材Z軸 NG位置PL
LD MR11508               ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
AND= DM56 #9             ; 除材Z軸 ﾎﾟｼﾞｼｮﾝNo
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OR MR6508                ; 除材Z軸 ﾒﾝﾃﾅﾝｽ位置
OUT B0448                ; 除材Z軸 ﾒﾝﾃﾅﾝｽ位置PL
;<h1/>位置出力
;軸現在位置が目標位置の±20μm以内で出力
;※位置決範囲を狭くすると出力がﾁｬﾀﾘﾝｸﾞして関係する軸のI/Lが動作するので注意!
;'Z軸位置表示
;FM64.L = DM60590.L			'現在値
;DM478.L = DM60590.L + 20	'位置決め判定上限
;DM480.L = DM60590.L - 20	'位置決め判定下限
LD CR2002                ; 常時ON
NCJ #1002
;'Z軸位置表示
;
;FM64.L = DM60590.L			'現在値
;
LD CR2002                ; 常時ON
MOV.L DM60590 FM64       ; 軸6 現在座標  除材Z軸 現在値表示
;DM478.L = DM60590.L + 20	'位置決め判定上限
;
LD CR2002                ; 常時ON
LDA.L DM60590            ; 軸6 現在座標
CON
ADD.L +20
CON
STA.L DM478              ; 除材Z軸 位置決+限
;DM480.L = DM60590.L - 20	'位置決め判定下限
LD CR2002                ; 常時ON
LDA.L DM60590            ; 軸6 現在座標
CON
SUB.L +20
CON
STA.L DM480              ; 除材Z軸 位置決-限
LABEL #1002
;
LD MR6512                ; 除材Z軸 原点復帰記憶
ANB @MR305               ; 除材Z軸 位置決め
ANB MR11508              ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
MPS
LD>=.L +20 FM64          ; 除材Z軸 現在値表示
AND<=.L -20 FM64         ; 除材Z軸 現在値表示
ANL
OUT MR6500               ; 除材Z軸 原点位置
MRD
LD>=.L DM478 FM13004     ; 除材Z軸 位置決+限  TP除材Z軸 待機位置 目標座標
AND<=.L DM480 FM13004    ; 除材Z軸 位置決-限  TP除材Z軸 待機位置 目標座標
ANL
OUT MR6501               ; 除材Z軸 待機位置
MRD
LD>=.L DM478 FM13104     ; 除材Z軸 位置決+限  TP除材Z軸 取出位置 目標座標
AND<=.L DM480 FM13104    ; 除材Z軸 位置決-限  TP除材Z軸 取出位置 目標座標
ANL
OUT MR6502               ; 除材Z軸 除材反転 取出位置
MRD
LD>=.L DM478 FM13204     ; 除材Z軸 位置決+限  TP除材Z軸 吸着確認 目標座標
AND<=.L DM480 FM13204    ; 除材Z軸 位置決-限  TP除材Z軸 吸着確認 目標座標
ANL
OUT MR6503               ; 除材Z軸 吸着確認位置
MRD
LD>=.L DM478 FM13304     ; 除材Z軸 位置決+限  TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
AND<=.L DM480 FM13304    ; 除材Z軸 位置決-限  TP除材Z軸 ﾊﾟﾚｯﾄ置 目標座標
ANL
OUT MR6504               ; 除材Z軸 ﾊﾟﾚｯﾄ置位置
MRD
LD>=.L DM478 FM13404     ; 除材Z軸 位置決+限  TP除材Z軸 NG位置 目標座標
AND<=.L DM480 FM13404    ; 除材Z軸 位置決-限  TP除材Z軸 NG位置 目標座標
ANL
OUT MR6505               ; 除材Z軸 NG位置
MPP
AND=.L FM13704 FM64      ; TP除材Z軸 ﾒﾝﾃ位置 目標座標  除材Z軸 現在値表示
OUT MR6508               ; 除材Z軸 ﾒﾝﾃﾅﾝｽ位置
;<h1/>JOG移動
LD B034A                 ; 除材Z軸 JOG正転SW
OUT @MR500               ; 手.Z軸JOG運転正転
LD B034B                 ; 除材Z軸 JOG逆転SW
OUT @MR501               ; 手.Z軸JOG運転逆転
;ｲﾝﾀｰﾛｯｸ
LD MR805                 ; 除材Z軸 動作可能
ANB MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
ANB MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
AND MR400                ; 全ﾄﾞｱ閉確認
OUT MR12502              ; ﾏｸﾛ 除材Z軸 JOG動作IL
;Z軸JOG運転
LD @MR500                ; 手.Z軸JOG運転正転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR12502              ; ﾏｸﾛ 除材Z軸 JOG動作IL
ANB MR12510              ; ﾏｸﾛ 除材Z軸 JOG動作異常
OUT @MR505               ; 除材Z軸 JOG運転正転
LD @MR501                ; 手.Z軸JOG運転逆転
AND MR100                ; 手動ﾓｰﾄﾞ
AND MR12502              ; ﾏｸﾛ 除材Z軸 JOG動作IL
ANB MR12510              ; ﾏｸﾛ 除材Z軸 JOG動作異常
OUT @MR506               ; 除材Z軸 JOG運転逆転
;JOG速度倍率設定
LD CR2002                ; 常時ON
MSTRT JOG_倍率 B035A B045A DM10660;除材Z軸 JOG倍率0.1SW  除材Z軸 JOG倍率0.1PL  除材Z軸 JOG倍率DATA
;動作ﾃﾞｰﾀ転送
LD @MR505                ; 除材Z軸 JOG運転正転
OR @MR506                ; 除材Z軸 JOG運転逆転
MPS
LDA.D #10
CON
MUL.D DM10660            ; 除材Z軸 JOG倍率DATA
CON
STA.D DM10618            ; 除材Z軸 JOG高速速度
MPP
@UWRIT #1 #14418 DM10618 #2;除材Z軸 JOG高速速度
;出力
LD @MR505                ; 除材Z軸 JOG運転正転
OUT MR12500              ; ﾏｸﾛ 除材Z軸 JOG起動＋
LD @MR506                ; 除材Z軸 JOG運転逆転
OUT MR12501              ; ﾏｸﾛ 除材Z軸 JOG起動−
LD MR004                 ; ﾘｾｯﾄSW
OUT MR12503              ; ﾏｸﾛ 除材Z軸 JOG動作 ﾘｾｯﾄSW
LD CR2002                ; 常時ON
MSTRT KE_ML_JOG #6 #1 MR12500 DM19050;ﾏｸﾛ 除材Z軸 JOG起動＋  除材Z軸 ｴﾗｰ状態
LD MR12512               ; ﾏｸﾛJOG 除材Z軸 JOG正方向
OUT R68100               ; 軸6 JOG正方向
LD MR12513               ; ﾏｸﾛJOG 除材Z軸 JOG負方向
OUT R68101               ; 軸6 JOG負方向
LD MR12512               ; ﾏｸﾛJOG 除材Z軸 JOG正方向
OR MR12513               ; ﾏｸﾛJOG 除材Z軸 JOG負方向
OUT R68102               ; 軸6 高速JOG
;ﾗﾝﾌﾟ
LD MR12508               ; ﾏｸﾛ 除材Z軸 JOG＋運転中
OUT B044A                ; 除材Z軸 JOG正転PL
LD MR12509               ; ﾏｸﾛ 除材Z軸 JOG−運転中
OUT B044B                ; 除材Z軸 JOG逆転PL
;<h1/>DATA_SET
LD B03E1                 ; 除材 待機位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM64 FM13004       ; 除材Z軸 現在値表示  TP除材Z軸 待機位置 目標座標
LD B03E3                 ; 除材 吸着確認 位置SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM64 FM13204       ; 除材Z軸 現在値表示  TP除材Z軸 吸着確認 目標座標
LD B03E5                 ; 除材 NG排出位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM64 FM13404       ; 除材Z軸 現在値表示  TP除材Z軸 NG位置 目標座標
LD B03E8                 ; 除材 ﾒﾝﾃﾅﾝｽ位置 SET_SW
AND MR100                ; 手動ﾓｰﾄﾞ
MOV.L FM64 FM13704       ; 除材Z軸 現在値表示  TP除材Z軸 ﾒﾝﾃ位置 目標座標
;<h1/>ｴﾗｰ出力
LD MR10510               ; ﾏｸﾛHP 除材Z軸 原点復帰異常
OR MR11510               ; ﾏｸﾛPOS 除材Z軸 位置決め異常
OR MR12510               ; ﾏｸﾛ 除材Z軸 JOG動作異常
MPS
AND DM19050.0
OUT MR7104               ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
MPP
AND DM19050.1
OUT MR7105               ; ERR15 除材Z軸軸ｴﾗｰ
LD MR10511               ; ﾏｸﾛHP 除材Z軸 ｴﾗｰｸﾘｱ
OR MR11511               ; ﾏｸﾛPOS 除材Z軸 ｴﾗｰｸﾘｱ
OR MR12511               ; ﾏｸﾛJOG 除材Z軸 ｴﾗｰｸﾘｱ
OUT R68000               ; 軸6 軸ｴﾗｰｸﾘｱ
LD MR10513               ; ﾏｸﾛHP 除材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
OR MR11512               ; ﾏｸﾛPOS 除材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ ﾘｾｯﾄ
OR MR12514               ; ﾏｸﾛJOG 除材Z軸 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ ﾘｾｯﾄ
OUT R68305               ; 軸6 ﾄﾞﾗｲﾊﾞ ｱﾗｰﾑﾘｾｯﾄ
;<h1/>まとめ
LD MR7104                ; ERR14 除材Z軸ﾄﾞﾗｲﾊﾞｰ異常
OR MR7105                ; ERR15 除材Z軸軸ｴﾗｰ
OUT MR6513               ; 除材Z軸 全異常
LD MR6500                ; 除材Z軸 原点位置
OR MR6501                ; 除材Z軸 待機位置
OUT MR6514               ; 除材Z軸 全原点
LDB MR10500              ; ﾏｸﾛHP 除材Z軸 原点復帰起動
ANB MR10508              ; ﾏｸﾛHP 除材Z軸 原点復帰中
ANB MR11500              ; ﾏｸﾛPOS 除材Z軸 位置決め起動
ANB MR11508              ; ﾏｸﾛPOS 除材Z軸 位置決め 移動中
ANB MR12500              ; ﾏｸﾛ 除材Z軸 JOG起動＋
ANB MR12501              ; ﾏｸﾛ 除材Z軸 JOG起動−
ANB MR12508              ; ﾏｸﾛ 除材Z軸 JOG＋運転中
ANB MR12509              ; ﾏｸﾛ 除材Z軸 JOG−運転中
OUT MR6515               ; 除材Z軸 全停止
END
ENDH
