DEVICE:53
;MODULE:Panel_Moni
;MODULE_TYPE:0
;SCRIPT_TYPE:
LD R50001                ; 自動中
OR LR200                 ; 自動ﾓｰﾄﾞ　   選択
AND R51100               ; 原点復帰完了
LD R50002                ; ステップ動作中
ANB R50001               ; 自動中
AND R51100               ; 原点復帰完了
ORL
LDB R51100               ; 原点復帰完了
ANB R50003               ; 原点復帰中
AND R49913               ; 原点復帰待ち  ﾀｯﾁﾊﾟﾈﾙ
ORL
OUT MR1010               ; 画面切替ｲﾝﾀｰﾛｯｸ
LDP T200                 ; 動作中遅延
ORP R51100               ; 原点復帰完了
LDB R51100               ; 原点復帰完了
ANB R50003               ; 原点復帰中
ANB R50007               ; 手動制御中
LDF R50006               ; 異常発生中
ORF R50901               ; ｼﾘﾝﾀﾞｰｴﾗｰ
ANL
ORL
MOV #2 DM408             ; 切替ﾍﾟｰｼﾞ№
LD R40004                ; 原点復帰完了解除
RES R51100               ; 原点復帰完了
CON
RES MR50007              ; 原点復帰　完了
LDB R50004               ; 動作中
ANB R40006               ; 停止中表示
SET R50005               ; 停止中
LD R50004                ; 動作中
RES R50005               ; 停止中
LD R50000                ; 即停止
OR R50900                ; TRAP
ANB R50004               ; 動作中
OUT R40006               ; 停止中表示
LD R50001                ; 自動中
OUT R40007               ; ﾊﾟﾈﾙ用自動動作中表示
;即停止　で、非常停止画面を表示
;Ｅｍｅｒｇｅｎｃｙ  ｓｃｒｅｅｎ  ｉｓ  ｄｉｓｐｌａｙｅｄ   ａｔ ｔｈｅ  ｔｉｍｅ  ｏｆ  ｃｏｎｔｒｏｌ ｓｔｏｐ.
LD R50000                ; 即停止
MOV #100 DM408           ; 切替ﾍﾟｰｼﾞ№
;原点復帰完了で、メイン画面に変わる。
;ＭＡＩＮ ｓｃｒｅｅｎ ｉｓ ｄｉｓｐｌａｙｅｄ ａｆｔｅｒ ｒｅｔｕｒｎ ｈｏｍｅ ｐｏｓｉｔｉｏｎ ｆｉｎｉｓｈ
;自動中は、メイン画面にＳＴＡＴＵＳに、自動中表示
;Ｄｉｓｐｌａｙｓ ｏｆ ＡＵＴＯ，ｄｕｒｉｎｇ ａｕｔｏ ｍｏｄｅ ｏｐｅｒａｔｉｏｎ
;異　常
;Ｅｒｒｏｒ
;
LD CR2002                ; 常時ON
ANB R50001               ; 自動中
ANB R50002               ; ステップ動作中
ANB R50006               ; 異常発生中
ANB R50103               ; 警報ｾｯﾄﾌﾗｸﾞ
ANB R51300               ; ｴﾗｰﾘｾｯﾄsw ON
ANB R50901               ; ｼﾘﾝﾀﾞｰｴﾗｰ
MOV DM400 DM420          ; 現在表示中   画面  表示画面一時保管
MOV DM3100 DM422         ; 背面表示画面一時保管
LD R55000                ; 即停止/TRAP 入力無し
LD T200                  ; 動作中遅延
OR R49915                ; 表示用　　 TRAP
ANL
LD R50006                ; 異常発生中
OR R50103                ; 警報ｾｯﾄﾌﾗｸﾞ
OR R50901                ; ｼﾘﾝﾀﾞｰｴﾗｰ
OR R50902                ; Trapしない   異常
OR R49915                ; 表示用　　 TRAP
ANL
MOV #111 DM408           ; 切替ﾍﾟｰｼﾞ№
MOV #1020 DM3101
LD CR2002                ; 常時ON
ANP R51300               ; ｴﾗｰﾘｾｯﾄsw ON
MOV DM420 DM408          ; 表示画面一時保管  切替ﾍﾟｰｼﾞ№
MOV DM422 DM3101         ; 背面表示画面一時保管
LDP R50003               ; 原点復帰中
LD R50003                ; 原点復帰中
LDF R50006               ; 異常発生中
ORF R49110               ; ｾﾝｻｴﾗｰ
ANL
ORL
AND CR2003               ; 常時OFF
@MOV #101 DM408          ; 切替ﾍﾟｰｼﾞ№
LD R55000                ; 即停止/TRAP 入力無し
AND T200                 ; 動作中遅延
ANB R50006               ; 異常発生中
ANB R50103               ; 警報ｾｯﾄﾌﾗｸﾞ
ANB R50901               ; ｼﾘﾝﾀﾞｰｴﾗｰ
ANB R50902               ; Trapしない   異常
ANB R49915               ; 表示用　　 TRAP
ANB R51101               ; 原点復帰
ANB R52101
MPS
LDB R50007               ; 手動制御中
AND R51100               ; 原点復帰完了
LD CR2003                ; 常時OFF
OR R50001                ; 自動中
ANL
ANL
@MOV #2 DM408            ; 切替ﾍﾟｰｼﾞ№
MPP
AND R50007               ; 手動制御中
@MOV #21 DM408           ; 切替ﾍﾟｰｼﾞ№
LD R50901                ; ｼﾘﾝﾀﾞｰｴﾗｰ
OUT R50200               ; ｼﾘﾝﾀﾞｰｴﾗｰ  ｳｨﾝﾄﾞｳ表示
LD<> #90 DM500           ; 給材Z軸現在位置
AND<> #91 DM500          ; 給材Z軸現在位置
AND<> #92 DM500          ; 給材Z軸現在位置
AND<> #93 DM500          ; 給材Z軸現在位置
AND<> #94 DM500          ; 給材Z軸現在位置
OUB R55200               ; Retry/Removeｳｨﾝﾄﾞｳ表示
;エラータイトル表示
;DM510 = DM460/16
;DM511 = DM460-(DM510*16)
;Z5 = DM510
;BSET (DM2500:Z5,DM511)
LD R50006                ; 異常発生中
OR R49110                ; ｾﾝｻｴﾗｰ
NCJ #1000
;DM510 = DM460/16
;
LD CR2002                ; 常時ON
LDA DM460                ; ｴﾗｰ内容表示
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
STA DM510                ; ｴﾗｰNo.表示用(ﾌﾗｸﾞｱﾄﾞﾚｽﾄ)
;DM511 = DM460-(DM510*16)
;
LD CR2002                ; 常時ON
LDA DM510                ; ｴﾗｰNo.表示用(ﾌﾗｸﾞｱﾄﾞﾚｽﾄ)
CON
EXT
CON
MUL.L +16
CON
STA.L @VM0
CON
LDA DM460                ; ｴﾗｰ内容表示
CON
EXT
CON
SUB.L @VM0
CON
STA DM511                ; ｴﾗｰNo.表示用(ﾌﾗｸﾞﾋﾟｯﾄ)
;Z5 = DM510
;
LD CR2002                ; 常時ON
LDA DM510                ; ｴﾗｰNo.表示用(ﾌﾗｸﾞｱﾄﾞﾚｽﾄ)
CON
EXT
CON
STA.L Z5
;BSET (DM2500:Z5,DM511)
LD CR2002                ; 常時ON
BSET DM2500:Z5 DM511     ; ｴﾗｰNo.表示用(ﾌﾗｸﾞﾋﾟｯﾄ)
LABEL #1000
;
LDB R50006               ; 異常発生中
ANB R49110               ; ｾﾝｻｴﾗｰ
ZRES DM2500 DM2531       ; 31.
;パラメーター選択画面
;Ｐａｒａｍｅｔｅｒ  Ｓｅｌｅｃｔｉｏｎ 
LD R40000                ; SET UP SW
AND R40005               ; SET UP 　　表示許可
@MOV #12 DM408           ; 切替ﾍﾟｰｼﾞ№
LD R50005                ; 停止中
OUT R40005               ; SET UP 　　表示許可
LD R50007                ; 手動制御中
@RES R51100              ; 原点復帰完了
LD R40002                ; SET UP戻SW
MPS
AND R51100               ; 原点復帰完了
@MOV #2 DM408            ; 切替ﾍﾟｰｼﾞ№
MPP
ANB R51100               ; 原点復帰完了
MOV #2 DM408             ; 切替ﾍﾟｰｼﾞ№
;設定選択画面
;
LD R50800                ; TP 設定SW
AND R51100               ; 原点復帰完了
MPS
AND R50001               ; 自動中
@MOV #11 DM408           ; 切替ﾍﾟｰｼﾞ№
MPP
LDB R50001               ; 自動中
ANB MR1010               ; 画面切替ｲﾝﾀｰﾛｯｸ
ANL
@MOV #12 DM408           ; 切替ﾍﾟｰｼﾞ№
;STEP動作選択画面
;STEP Operation Selection 
LDB CR2002               ; 常時ON
AND LR201                ; 手動ﾓｰﾄﾞ　   選択
LDF R51900               ; ｽﾃｯﾌﾟ選択0
ORF R51901               ; ｽﾃｯﾌﾟ選択1
ORF R51902               ; ｽﾃｯﾌﾟ選択2
ORF R51903               ; ｽﾃｯﾌﾟ選択3
ANL
AND R50005               ; 停止中
AND R51100               ; 原点復帰完了
AND= DM400 #16           ; 現在表示中   画面
@MOV #2 DM408            ; 切替ﾍﾟｰｼﾞ№
SET R55210               ; ステップ動作中FLG（TP切替用）
LD R55210                ; ステップ動作中FLG（TP切替用）
ANB R50002               ; ステップ動作中
AND= DM400 #2            ; 現在表示中   画面
@MOV #16 DM408           ; 切替ﾍﾟｰｼﾞ№
RES R55210               ; ステップ動作中FLG（TP切替用）
;パネル表示下
LD R61900                ; 給材_ｽﾃｯﾌﾟ選択中PL(TP)
AND R50002               ; ステップ動作中
ANB R50411               ; TP 警告ﾒｯｾｰｼﾞ表示
MOV #3000 DM450          ; ﾒｯｾｰｼﾞNo.
LD R61901                ; 除材_ｽﾃｯﾌﾟ選択中PL(TP)
AND R50002               ; ステップ動作中
ANB R50411               ; TP 警告ﾒｯｾｰｼﾞ表示
MOV #3001 DM450          ; ﾒｯｾｰｼﾞNo.
LD R61902                ; 貼付_ｽﾃｯﾌﾟ選択中PL(TP)
AND R50002               ; ステップ動作中
ANB R50411               ; TP 警告ﾒｯｾｰｼﾞ表示
MOV #3002 DM450          ; ﾒｯｾｰｼﾞNo.
LD R61903                ; ﾃｰﾌﾟ送り_ｽﾃｯﾌﾟ選択中PL(TP)
AND R50002               ; ステップ動作中
ANB R50411               ; TP 警告ﾒｯｾｰｼﾞ表示
MOV #3003 DM450          ; ﾒｯｾｰｼﾞNo.
LD MR401                 ; ACF残量検出
ANB CR2002               ; 常時ON
MOV #356 DM450           ; ﾒｯｾｰｼﾞNo.
LDB R50002               ; ステップ動作中
ANB MR401                ; ACF残量検出
ANB R52010               ; ﾓｰﾄﾞSW(TP)
ANB R52010               ; ﾓｰﾄﾞSW(TP)
ANB R50411               ; TP 警告ﾒｯｾｰｼﾞ表示
MOV #0 DM450             ; ﾒｯｾｰｼﾞNo.
LDB R205                 ; 背面表示無効
ANB R215                 ; 背面表示で使用
MOV #100 DM515           ; 背面表示下
LD R205                  ; 背面表示無効
AND R51100               ; 原点復帰完了
LD= DM3100 #1000
OR= DM3100 #1001
ANL
ANB R215                 ; 背面表示で使用
MOV #101 DM515           ; 背面表示下
LD<> DM3100 #1000
MEP
MOV #0 DM515             ; 背面表示下
;パネル表示下：IAI RB 全ｻｰﾎﾞｵﾝ待ちです
LD= DM400 #2             ; 現在表示中   画面
OR= DM400 #3             ; 現在表示中   画面
ANB R51100               ; 原点復帰完了
ANB R51102               ; 原点復帰中
LDB R29113               ; 軸1 ｻｰﾎﾞON
ORB R29913               ; 軸2 ｻｰﾎﾞON
ORB R30713               ; 軸3 ｻｰﾎﾞON
ORB R31513               ; 軸4 ｻｰﾎﾞON
ANL
MOV #3005 DM450          ; ﾒｯｾｰｼﾞNo.
LD= DM400 #2             ; 現在表示中   画面
OR= DM400 #3             ; 現在表示中   画面
ANB R51100               ; 原点復帰完了
ANB R51102               ; 原点復帰中
AND R29113               ; 軸1 ｻｰﾎﾞON
AND R29913               ; 軸2 ｻｰﾎﾞON
AND R30713               ; 軸3 ｻｰﾎﾞON
AND R31513               ; 軸4 ｻｰﾎﾞON
MOV #0 DM450             ; ﾒｯｾｰｼﾞNo.
;パネル表示言語選択
;Ｐａｎｅｌ  Ｌａｎｇｕｅｇｅ  Ｓｅｌｅｃｔｉｏｎ
;0:Japanese     1:English     2:Indonesian
;生産ｶｳﾝﾀﾘｾｯﾄ / product counter reset
LDP R40008               ; 生産ｶｳﾝﾀﾘｾｯﾄ
DW #0 DM201              ; 取出ｶｳﾝﾀ
CON
DW #0 DM200              ; 投入ｶｳﾝﾀ
;エラー
;ＴＲＡＰしないで、異常信号のみ出力
LD CR2003                ; 常時OFF
AND R50503               ; 真空吸着ｴﾗｰ表示中
OR R50606                ; Trapしない   異常
OUT R50902               ; Trapしない   異常
LD R50901                ; ｼﾘﾝﾀﾞｰｴﾗｰ
OR R50902                ; Trapしない   異常
OUT R55100               ; ERROR
END
ENDH
