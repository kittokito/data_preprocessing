DEVICE:53
;MODULE:R_Main
;MODULE_TYPE:0
;SCRIPT_TYPE:
;ｲﾆｼｬﾗｲｽﾞ/Initialize
LD CR2008                ; 運転開始時1ｽｷｬﾝON
ORP MR900                ; 重度異常：電源再投入必要
ZRES @MR000 @MR5015      ; R冶具名ｴﾗｰ
;電源ON wait/Power ON wait
LD CR2002                ; 常時ON
TMR @30 #30              ; 電源ON wait
;電源投入時の初期画面表示/Initial screen display at power on
;EM30026=1:原点復帰要求/Home position return request
LDP @T30                 ; 電源ON wait
ORF MR30103              ; (R_TP)手動ﾊﾞﾙﾌﾞON/OFF
RES MR311                ; R_原点復帰完了
CON
DW #1 EM30026            ; (R TP)初期画面_ｺﾒﾝﾄ表示用
CON
SET @MR100               ; 原点復帰要求
LD= EM29996 #801         ; (R_TP)現在表示中画面No.
OUT MR30103              ; (R_TP)手動ﾊﾞﾙﾌﾞON/OFF
;<h1/>■機種別設定値をDM1000以降へ転送/Transfer model-specific setting value to DM 1000 or later
;d1000～対応機種の設定値を現在設定に書き込む
;d1000 ~ Write the setting value of the corresponding model to the current setting
LDB MR310                ; R_原点復帰中
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
LDA EM30011              ; (R_TP)部品選択
CON
STA ZF5                  ; R現在部品番号(1～25）
LD CR2002                ; 常時ON
MPS
LDA ZF5                  ; R現在部品番号(1～25）
CON
SUB #1
CON
MUL #350
CON
STA Z1
CON
BMOV DM1000:Z1 ZF650 #350; 部品1入口側 接続設定1  R現設定_入口側 接続設定1
MPP
LDA ZF5                  ; R現在部品番号(1～25）
CON
SUB #1
CON
STA Z1
CON
BMOV EM30400:Z1 ZF610 #10; 部品1_部品名  R現在機種名
;<h1/>■原点復帰動作/Starting return home position
;@MR100～315
;TP画面0：初期画面/TP screen 0: initial screen
;EM30026=2:原点復帰中/Returning to home position
STG @MR100               ; 原点復帰要求
ANB MR903                ; R_ｴﾗｰ処理中
DW #0 EM29997            ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
CON
OUT @MR400               ; 動作開始要求1
CON
ANP R2008                ; ｽﾀｰﾄSW_R 
SET MR310                ; R_原点復帰中
CON
DW #2 EM30026            ; (R TP)初期画面_ｺﾒﾝﾄ表示用
CON
JMP @MR101
;ｴｱｵﾍﾟﾊﾞﾙﾌﾞ大気開放/Air opener valve open to atmosphere
STG @MR101
FMOV #1 DM19800 #20      ; R上流側流路ﾊﾞﾙﾌﾞ1 (0=閉/1=開)
FMOV #1 DM19830 #20      ; R下流側流路ﾊﾞﾙﾌﾞ1 (0=閉/1=開
SET MR401                ; R_上下流_ﾊﾞﾙﾌﾞ一括切替(OFF全閉
CON
SET MR403                ; R大気開放中
CON
MPS
SET MR8704               ; R上流側流路切替ﾊﾞﾙﾌﾞ 23(ON=開)
CON
SET MR8705               ; R上流側流路切替ﾊﾞﾙﾌﾞ 24(ON=開)
CON
SET MR8706               ; R上流側流路切替ﾊﾞﾙﾌﾞ 25(ON=開)
CON
SET MR8707               ; R上流側流路切替ﾊﾞﾙﾌﾞ 26(ON=開)
CON
SET MR8708               ; R上流側流路切替ﾊﾞﾙﾌﾞ 27(ON=開)
MPP
TMR @0 #5                ; ﾊﾞﾙﾌﾞ開閉ｳｪｲﾄ
CON
AND @T0                  ; ﾊﾞﾙﾌﾞ開閉ｳｪｲﾄ
JMP @MR102
;ｴｱｵﾍﾟﾊﾞﾙﾌﾞ大気開放終了/End:Air opener valve open to atmosphere
STG @MR102
TMR @1 #30               ; 大気開放時間
CON
AND @T1                  ; 大気開放時間
FMOV #0 DM19800 #20      ; R上流側流路ﾊﾞﾙﾌﾞ1 (0=閉/1=開)
FMOV #0 DM19830 #20      ; R下流側流路ﾊﾞﾙﾌﾞ1 (0=閉/1=開
RES MR401                ; R_上下流_ﾊﾞﾙﾌﾞ一括切替(OFF全閉
CON
RES MR403                ; R大気開放中
CON
RES MR8704               ; R上流側流路切替ﾊﾞﾙﾌﾞ 23(ON=開)
CON
RES MR8705               ; R上流側流路切替ﾊﾞﾙﾌﾞ 24(ON=開)
CON
RES MR8706               ; R上流側流路切替ﾊﾞﾙﾌﾞ 25(ON=開)
CON
RES MR8707               ; R上流側流路切替ﾊﾞﾙﾌﾞ 26(ON=開)
CON
JMP @MR103
;ｼﾘﾝﾀﾞ原点復帰/Cylinder homing
;ﾏｰｷﾝｸﾞﾍﾟﾝ後退/Marking pen back
STG @MR103
ANB MR903                ; R_ｴﾗｰ処理中
RES MR9000               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR前進
CON
SET MR9001               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR後退
CON
JMP @MR104
STG @MR104
ANB MR903                ; R_ｴﾗｰ処理中
JMP @MR105
;TP画面500：ﾒｲﾝ画面:TP screen 500: main screen
STG @MR105
ANB MR903                ; R_ｴﾗｰ処理中
DW #500 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
CON
JMP @MR106
;終了/End
STG @MR106
RES MR310                ; R_原点復帰中
CON
SET MR311                ; R_原点復帰完了
CON
ENDS
;<h1/>■自動動作/Automatic operation
;@MR500～1915
LD= EM29996 #500         ; (R_TP)現在表示中画面No.
AND MR29900              ; (R_TP)自動選択中
AND MR311                ; R_原点復帰完了
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
ANB MR903                ; R_ｴﾗｰ処理中
AND R002                 ; R_上ｶﾊﾞｰ閉
AND R003                 ; R_下ｶﾊﾞｰ閉
AND R2015                ; 冶具確認ON有_R
MPS
OUT @MR401               ; 動作開始要求2
MPP
ANP R2008                ; ｽﾀｰﾄSW_R 
SET MR312                ; R_自動運転中
CON
SET @MR500
;ｻｲｸﾙﾀｲﾑ測定開始/Start cycle time
STG @MR500
SET MR201                ; Rｻｲｸﾙﾀｲﾑ測定ﾌﾗｸﾞ
CON
JMP @MR600
;状態LP初期化/State LP initialization
;※↓ここから/ﾒﾝﾃ_装置ﾘｰｸ検査でも使用
;※ ↓ Used from here / / Maintenance _ equipment leak test
STG @MR600
SET MR509                ; R検査ﾌﾗｸﾞ初期化
CON
JMP @MR601
STG @MR601
ANB MR509                ; R検査ﾌﾗｸﾞ初期化
JMP @MR700
;<h1/> ﾒﾓﾘｰｶｰﾄﾞの空き容量確認/Free space confirmation of memory card
;ZF504：ﾒﾓﾘｰｶｰﾄﾞ書き込み
;0bit目 結果書き込み無効
;1bit目 測定書き込み無効
;
;ZF504: Memory card write
;0 bit Result write invalid
;1st bit Measurement write invalid
STG @MR700
MPS
LDB ZF504.0              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
ORB ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANL
JMP @MR701
MPP
LD ZF504.0               ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
AND ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANL
JMP @MR800
;結果または測定ﾃﾞｰﾀ書き込み有りの場合、空き容量確認
;If there is a result or measured data written, check the free space
LDP @MR701
MSTRT MEM_FREE_6 DM500 DM502 @MR010 @DM10;ﾒﾓﾘｰｶｰﾄﾞ指定空き容量(下位)  ﾒﾓﾘｰｶｰﾄﾞ空き容量(下位)  ﾒﾓﾘｰｶｰﾄﾞ空き容量NG  ﾒﾓﾘｰｶｰﾄﾞNG情報
STG @MR701
ANF _MEM_FREE_6
MPS
ANB @MR010               ; ﾒﾓﾘｰｶｰﾄﾞ空き容量NG
JMP @MR800
MPP
AND @MR010               ; ﾒﾓﾘｰｶｰﾄﾞ空き容量NG
JMP @MR702
;ﾒﾓﾘｶｰﾄﾞｴﾗｰ/Memory card error
STG @MR702
ANB MR903                ; R_ｴﾗｰ処理中
JMP @MR703
;
;select case @DM10
;case 1
;	set( MR32100.b )	'ｶｰﾄﾞ未挿入
;case 6
;	set( MR32101.b )	'ﾌｧｲﾙ書込みｴﾗｰ
;case 8
;	set( MR32102.b )	'容量不足
;case 10
;	set( MR32103.b )	'空き容量不足
;case else
;	set( MR32104.b )	'その他
;end select
;
LD @MR703
NCJ #1000
;select case @DM10
;
LD CR2002                ; 常時ON
MOV @DM10 @VM0           ; ﾒﾓﾘｰｶｰﾄﾞNG情報
;case 1
;
LD= @VM0 #1
NCJ #2000
;	set( MR32100.b )	'ｶｰﾄﾞ未挿入
;
LD CR2002                ; 常時ON
SET MR32100              ; ﾒﾓﾘｰｶｰﾄﾞ未挿入
LD CR2002                ; 常時ON
CJ #2001
LABEL #2000
;case 6
;
LD= @VM0 #6
NCJ #2002
;	set( MR32101.b )	'ﾌｧｲﾙ書込みｴﾗｰ
;
LD CR2002                ; 常時ON
SET MR32101              ; ﾌｧｲﾙ書込みｴﾗｰ
LD CR2002                ; 常時ON
CJ #2003
LABEL #2002
;case 8
;
LD= @VM0 #8
NCJ #2004
;	set( MR32102.b )	'容量不足
;
LD CR2002                ; 常時ON
SET MR32102              ; ﾒﾓﾘｰｶｰﾄﾞ容量不足
LD CR2002                ; 常時ON
CJ #2005
LABEL #2004
;case 10
;
LD= @VM0 #10
NCJ #2006
;	set( MR32103.b )	'空き容量不足
;
LD CR2002                ; 常時ON
SET MR32103              ; ﾒﾓﾘｰｶｰﾄﾞ空き容量不足
LD CR2002                ; 常時ON
CJ #2007
LABEL #2006
;case else
;
;	set( MR32104.b )	'その他
;
LD CR2002                ; 常時ON
SET MR32104
;end select
;
LABEL #2007
LABEL #2005
LABEL #2003
LABEL #2001
LABEL #1000
;
STG @MR703
MOV @DM10 ZF148          ; ﾒﾓﾘｰｶｰﾄﾞNG情報  Rｴﾗｰ詳細
SET MR112                ; ﾒﾓﾘｶｰﾄﾞｴﾗｰ
CON
JMP @MR704
STG @MR704
ANB MR112                ; ﾒﾓﾘｶｰﾄﾞｴﾗｰ
JMP @MR1900              ; AUTO終了
;<h1/> 検査冶具ﾊﾞｰｺｰﾄﾞ読取/Inspection jig Bar code reading
STG @MR800
ANB MR903                ; R_ｴﾗｰ処理中
MPS
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
AND LR1912               ; R_MCﾘｰｸﾊﾞｰｺｰﾄﾞ無効
ANL
JMP @MR1500
MPP
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ORB LR1912               ; R_MCﾘｰｸﾊﾞｰｺｰﾄﾞ無効
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
SET MR20400              ; 冶具R_BCR_読取開始
CON
JMP @MR801
STG @MR801
AND MR20401              ; 冶具R_BCR_読取完了
RES MR20401              ; 冶具R_BCR_読取完了
CON
JMP @MR802
STG @MR802
MPS
ANB MR20414              ; 冶具R_BCR_読取ﾀｲﾑｱｳﾄ
MPS
ANB MR20415              ; 冶具R_BCR_読取通信異常
JMP @MR900
MPP
AND MR20415              ; 冶具R_BCR_読取通信異常
JMP @MR805
MPP
AND MR20414              ; 冶具R_BCR_読取ﾀｲﾑｱｳﾄ
JMP @MR803
;Err34冶具ﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ/Err 34 jig bar code reading timeout
STG @MR803
RES MR20414              ; 冶具R_BCR_読取ﾀｲﾑｱｳﾄ
CON
ANB MR903                ; R_ｴﾗｰ処理中
DW #34 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33201              ; R_Err34冶具ﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR804
STG @MR804
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33201              ; R_Err34冶具ﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ
CON
JMP @MR1900              ; AUTO終了
;Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常/Err 31 jig bar code reading communication error
STG @MR805
RES MR20415              ; 冶具R_BCR_読取通信異常
CON
ANB MR903                ; R_ｴﾗｰ処理中
DW #31 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33114              ; R_Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR806
STG @MR806
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33114              ; R_Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常
CON
JMP @MR1900              ; AUTO終了
;<h1/> 検査冶具ﾊﾞｰｺｰﾄﾞ確認/Check jig barcode confirmation
;冶具名が空白ならNG処理
;If the Jig name are blank, NG processing
;If DM20176.T = "" then
;	SET(@MR000)'冶具名空白ｴﾗｰSET/Jig name blank error SET
;Else
;	RES(@MR000)'冶具名空白OK/Jig name Blank OK
;End If
;
;SET(@MR901)'冶具名空白ﾁｪｯｸ完了/Jig name blank check completed
LDP @MR900
NCJ #1006
;If DM20176.T = "" then
;
LD CR2002                ; 常時ON
ADRSET VM2 VM0
MOV #0 VM2
MOV.D VM0 @VM1
SMOV "" *@VM1
LD CR2002                ; 常時ON
SCMP DM20176 *@VM1       ; N-L20[3]ﾃﾞｰﾀ(0000)
LD CR2010                ; 演算結果がｾﾞﾛ
NCJ #2008
;	SET(@MR000)'冶具名空白ｴﾗｰSET/Jig name blank error SET
;
LD CR2002                ; 常時ON
SET @MR000               ; R冶具名ｴﾗｰ
;Else
;
LD CR2002                ; 常時ON
CJ #2009
LABEL #2008
;	RES(@MR000)'冶具名空白OK/Jig name Blank OK
;
LD CR2002                ; 常時ON
RES @MR000               ; R冶具名ｴﾗｰ
;End If
;
LABEL #2009
;SET(@MR901)'冶具名空白ﾁｪｯｸ完了/Jig name blank check completed
LD CR2002                ; 常時ON
SET @MR901               ; 冶具名空白ﾁｪｯｸ完了
LABEL #1006
;
STG @MR900
AND @MR901               ; 冶具名空白ﾁｪｯｸ完了
RES @MR901               ; 冶具名空白ﾁｪｯｸ完了
CON
MPS
ANB @MR000               ; R冶具名ｴﾗｰ
JMP @MR904
MPP
AND @MR000               ; R冶具名ｴﾗｰ
JMP @MR902
;Err15冶具名ｴﾗｰ/Err 15 Jig name error
STG @MR902
ANB MR903                ; R_ｴﾗｰ処理中
DW #15 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33014              ; R_Err15冶具名ｴﾗｰ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR903
;TP画面608：冶具ﾊﾞｰｺｰﾄﾞｴﾗｰ詳細/TP screen 608: Jig bar code error details
STG @MR903
MPS
LD MR33014               ; R_Err15冶具名ｴﾗｰ
ANP MR30200              ; (R_TP)BzRstSw
ANL
DW #608 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
MPP
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33014              ; R_Err15冶具名ｴﾗｰ
CON
JMP @MR1900              ; AUTO終了
;自動運転orﾒﾝﾃ装置ﾘｰｸ検査？
;Automatic operation or Maintenance device leak inspection?
STG @MR904
MPS
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
JMP @MR1200
MPP
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
JMP @MR910
;<h1/>  AUTO：読み込んだﾊﾞｰｺｰﾄﾞに該当する部品があるかﾁｪｯｸ
;  AUTO: Check if there is a parts corresponding to the bar code read
;'無効化中  部品名と一致させる場合
;
;' 部品名を確認/Confirm Parts name
;' 部品名1:EM30400 部品名2:EM30410 以降10ﾜｰﾄﾞ刻み機種25まで
;'Parts name 1: EM30400 Parts name 2: EM 30410 or later 10 word increments Up to 25
;RES(@MR907) '部品一致有りﾌﾗｸﾞｸﾘｱ
;
;For @DM4 = 0 To 24 STEP 1 
; If EM30400.T:(@DM4*10) = DM20176.T then
;	SET(@MR907) '部品一致有りﾌﾗｸﾞSET/Parts type match flag SET
;	ZF5=(@DM4 + 1) '現在部品番号書込み/Current Parts number write
; End If
;NEXT
;
;SET(@MR906)'部品名一致ﾁｪｯｸ完了/Parts name match check completed
LDP @MR910
AND CR2003               ; 常時OFF
NCJ #1004
;'無効化中  部品名と一致させる場合
;
;' 部品名を確認/Confirm Parts name
;
;' 部品名1:EM30400 部品名2:EM30410 以降10ﾜｰﾄﾞ刻み機種25まで
;
;'Parts name 1: EM30400 Parts name 2: EM 30410 or later 10 word increments Up to 25
;
;RES(@MR907) '部品一致有りﾌﾗｸﾞｸﾘｱ
;
LD CR2002                ; 常時ON
RES @MR907               ; 一致
;For @DM4 = 0 To 24 STEP 1 
;
LD CR2002                ; 常時ON
MOV #0 @DM4              ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LABEL #2010
LD> @DM4 #24             ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CJ #2011
; If EM30400.T:(@DM4*10) = DM20176.T then
;
LD CR2002                ; 常時ON
LDA @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CON
EXT
CON
MUL.L +10
CON
STA.L Z12
CON
SCMP EM30400:Z12 DM20176 ; 部品1_部品名  N-L20[3]ﾃﾞｰﾀ(0000)
LD CR2010                ; 演算結果がｾﾞﾛ
NCJ #2012
;	SET(@MR907) '部品一致有りﾌﾗｸﾞSET/Parts type match flag SET
;
LD CR2002                ; 常時ON
SET @MR907               ; 一致
;	ZF5=(@DM4 + 1) '現在部品番号書込み/Current Parts number write
;
LD CR2002                ; 常時ON
LDA @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CON
EXT
CON
ADD.L +1
CON
STA ZF5                  ; R現在部品番号(1～25）
; End If
;
LABEL #2012
;NEXT
;
LD CR2002                ; 常時ON
INC @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LDB CR2009               ; 演算結果が負
CJ #2010
LABEL #2011
;SET(@MR906)'部品名一致ﾁｪｯｸ完了/Parts name match check completed
LD CR2002                ; 常時ON
SET @MR906               ; ﾁｪｯｸ完了
LABEL #1004
;
;' ﾊﾞｰｺｰﾄﾞを確認/Confirm Bar code
;RES(@MR907) 'ﾊﾞｰｺｰﾄﾞ一致有りﾌﾗｸﾞｸﾘｱ
;
;For @DM4 = 0 To 24 STEP 1 
; If EM33000.T:(@DM4*100) = DM20176.T then
;	SET(@MR907) 'ﾊﾞｰｺｰﾄﾞ一致有りﾌﾗｸﾞSET/Bar code match flag SET
;	ZF5=(@DM4 + 1) '現在部品番号書込み/Current Parts number write
; End If
;NEXT
;
;SET(@MR906)'ﾊﾞｰｺｰﾄﾞ一致ﾁｪｯｸ完了/Bar code match check completed
LDP @MR910
NCJ #1002
;' ﾊﾞｰｺｰﾄﾞを確認/Confirm Bar code
;
;RES(@MR907) 'ﾊﾞｰｺｰﾄﾞ一致有りﾌﾗｸﾞｸﾘｱ
;
LD CR2002                ; 常時ON
RES @MR907               ; 一致
;For @DM4 = 0 To 24 STEP 1 
;
LD CR2002                ; 常時ON
MOV #0 @DM4              ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LABEL #2013
LD> @DM4 #24             ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CJ #2014
; If EM33000.T:(@DM4*100) = DM20176.T then
;
LD CR2002                ; 常時ON
LDA @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CON
EXT
CON
MUL.L +100
CON
STA.L Z12
CON
SCMP EM33000:Z12 DM20176 ; 部品1_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ  N-L20[3]ﾃﾞｰﾀ(0000)
LD CR2010                ; 演算結果がｾﾞﾛ
NCJ #2015
;	SET(@MR907) 'ﾊﾞｰｺｰﾄﾞ一致有りﾌﾗｸﾞSET/Bar code match flag SET
;
LD CR2002                ; 常時ON
SET @MR907               ; 一致
;	ZF5=(@DM4 + 1) '現在部品番号書込み/Current Parts number write
;
LD CR2002                ; 常時ON
LDA @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CON
EXT
CON
ADD.L +1
CON
STA ZF5                  ; R現在部品番号(1～25）
; End If
;
LABEL #2015
;NEXT
;
LD CR2002                ; 常時ON
INC @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LDB CR2009               ; 演算結果が負
CJ #2013
LABEL #2014
;SET(@MR906)'ﾊﾞｰｺｰﾄﾞ一致ﾁｪｯｸ完了/Bar code match check completed
LD CR2002                ; 常時ON
SET @MR906               ; ﾁｪｯｸ完了
LABEL #1002
;
STG @MR910
AND @MR906               ; ﾁｪｯｸ完了
RES @MR906               ; ﾁｪｯｸ完了
CON
MPS
AND @MR907               ; 一致
LDA ZF5                  ; R現在部品番号(1～25）
CON
STA EM30011              ; (R_TP)部品選択
CON
JMP @MR1400
MPP
ANB @MR907               ; 一致
JMP @MR912
;Err14部品名ｴﾗｰ/Err 14 parts name error
STG @MR912
ANB MR903                ; R_ｴﾗｰ処理中
DW #14 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33013              ; R_Err14部品名ｴﾗｰ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR913
;TP画面608：冶具ﾊﾞｰｺｰﾄﾞｴﾗｰ詳細/TP screen 608: Jig bar code error details
STG @MR913
MPS
LD MR33013               ; R_Err14部品名ｴﾗｰ
ANP MR30200              ; (R_TP)BzRstSw
ANL
DW #608 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
MPP
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33013              ; R_Err14部品名ｴﾗｰ
CON
JMP @MR1900              ; AUTO終了
;<h1/>  ﾒﾝﾃ：装置ﾘｰｸ検査の場合、装置ﾘｰｸ検査用冶具ﾊﾞｰｺｰﾄﾞと一致しているか？
;  Maintenance: In the case of equipment leak inspection, is it consistent with the tool leak inspection jig bar code?
;' 読み取ったﾊﾞｰｺｰﾄﾞを確認/Confirm the bar code read
;RES(@MR1202) '装置ﾘｰｸﾊﾞｰｺｰﾄﾞOKﾌﾗｸﾞｸﾘｱ/Device Leak Barcode OK Flag Clear
;
;For @DM4 = 0 To 9 STEP 1 
; If DM20176.T = EM32900.T then
;	SET(@MR1202) '装置ﾘｰｸﾊﾞｰｺｰﾄﾞOKﾌﾗｸﾞSET/Leakage barcode OK flag SET
; End If
;NEXT
;
;SET(@MR1201)'装置ﾘｰｸBCRﾁｪｯｸ完了/Device Leak BCR Check Completed
LDP @MR1200
NCJ #1012
;' 読み取ったﾊﾞｰｺｰﾄﾞを確認/Confirm the bar code read
;
;RES(@MR1202) '装置ﾘｰｸﾊﾞｰｺｰﾄﾞOKﾌﾗｸﾞｸﾘｱ/Device Leak Barcode OK Flag Clear
;
LD CR2002                ; 常時ON
RES @MR1202              ; 装置ﾘｰｸﾊﾞｰｺｰﾄﾞOK
;For @DM4 = 0 To 9 STEP 1 
;
LD CR2002                ; 常時ON
MOV #0 @DM4              ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LABEL #2016
LD> @DM4 #9              ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
CJ #2017
; If DM20176.T = EM32900.T then
;
LD CR2002                ; 常時ON
SCMP DM20176 EM32900     ; N-L20[3]ﾃﾞｰﾀ(0000)  冶具_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ
LD CR2010                ; 演算結果がｾﾞﾛ
NCJ #2018
;	SET(@MR1202) '装置ﾘｰｸﾊﾞｰｺｰﾄﾞOKﾌﾗｸﾞSET/Leakage barcode OK flag SET
;
LD CR2002                ; 常時ON
SET @MR1202              ; 装置ﾘｰｸﾊﾞｰｺｰﾄﾞOK
; End If
;
LABEL #2018
;NEXT
;
LD CR2002                ; 常時ON
INC @DM4                 ; 冶具ﾊﾞｰｺｰﾄﾞﾁｪｯｸ用
LDB CR2009               ; 演算結果が負
CJ #2016
LABEL #2017
;SET(@MR1201)'装置ﾘｰｸBCRﾁｪｯｸ完了/Device Leak BCR Check Completed
LD CR2002                ; 常時ON
SET @MR1201              ; 装置ﾘｰｸBCRﾁｪｯｸ完了
LABEL #1012
;
STG @MR1200
AND @MR1201              ; 装置ﾘｰｸBCRﾁｪｯｸ完了
RES @MR1201              ; 装置ﾘｰｸBCRﾁｪｯｸ完了
CON
MPS
AND @MR1202              ; 装置ﾘｰｸﾊﾞｰｺｰﾄﾞOK
JMP @MR1400
MPP
ANB @MR1202              ; 装置ﾘｰｸﾊﾞｰｺｰﾄﾞOK
JMP @MR1203
;Err16装置ﾘｰｸ検査ﾊﾞｰｺｰﾄﾞｴﾗｰ/Err 16 device leak check bar code error
STG @MR1203
ANB MR903                ; R_ｴﾗｰ処理中
DW #16 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33015              ; R_Err16装置ﾘｰｸ検査ﾊﾞｰｺｰﾄﾞｴﾗｰ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR1204
STG @MR1204
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33015              ; R_Err16装置ﾘｰｸ検査ﾊﾞｰｺｰﾄﾞｴﾗｰ
CON
JMP @MR1900              ; AUTO終了
;<h1/>  AUTO：切替えた機種部品の装置ﾘｰｸ検査はOKか？/AUTO: Is the equipment leak check of the switched model parts OK?
;自動運転orﾒﾝﾃ装置ﾘｰｸ検査？/Automatic operation or Maintenance device leak inspection?
STG @MR1400
TMS @2 #2                ; 切替えwait
CON
AND @T2                  ; 切替えwait
MPS
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
JMP @MR1600
MPP
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
JMP @MR1401
;LR0～：機種1部品1～装置ﾘｰｸ検査OK/LR 0 ~ 113: Model1part1～ Equipment leak test OK
STG @MR1401
LDA EM30010              ; TP)機種選択番号(1-10)
CON
SUB #1
CON
MUL #25
CON
ADD ZF5                  ; R現在部品番号(1～25）
CON
SUB #1
CON
STA Z1
CON
MPS
AND LR2000:Z1            ; R機種1部品1装置ﾘｰｸ検査OK
JMP @MR1500
MPP
ANB LR2000:Z1            ; R機種1部品1装置ﾘｰｸ検査OK
JMP @MR1402
;Err10選択機種装置ﾘｰｸ検査NG/Err 10 selected model Equipment leak check NG
STG @MR1402
ANB MR903                ; R_ｴﾗｰ処理中
DW #10 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33009              ; R_Err10選択機種装置ﾘｰｸ検査NG
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR1403
STG @MR1403
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33009              ; R_Err10選択機種装置ﾘｰｸ検査NG
CON
JMP @MR1900              ; AUTO終了
;<h1/> 部品ﾊﾞｰｺｰﾄﾞ読み込み/Part bar code reading
;読取必要な機種のみ/Only the models that need reading
STG @MR1500
MPS
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
JMP @MR1600
MPP
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
MPS
ANB ZF824.0
JMP @MR1600
MPP
AND ZF824.0
SET MR20100              ; ﾜｰｸRBCR_読取開始
CON
JMP @MR1501
STG @MR1501
MPS
LDB MR20101              ; ﾜｰｸRBCR_読取完了
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
ANL
OUT MR601                ; TP製品ﾊﾞｰｺｰﾄﾞ読取要求中表示(R)
MPP
AND MR20101              ; ﾜｰｸRBCR_読取完了
RES MR20101              ; ﾜｰｸRBCR_読取完了
CON
JMP @MR1502
STG @MR1502
MPS
ANB MR20114              ; ﾜｰｸRBCR_読取ﾀｲﾑｱｳﾄ
MPS
ANB MR20115              ; ﾜｰｸRBCR_読取通信異常
JMP @MR1507
MPP
AND MR20115              ; ﾜｰｸRBCR_読取通信異常
JMP @MR1505
MPP
AND MR20114              ; ﾜｰｸRBCR_読取ﾀｲﾑｱｳﾄ
JMP @MR1503
;Err33ﾜｰｸﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ/Err33 product bar code reading timeout
STG @MR1503
RES MR20114              ; ﾜｰｸRBCR_読取ﾀｲﾑｱｳﾄ
CON
ANB MR903                ; R_ｴﾗｰ処理中
DW #33 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33200              ; R_Err33ﾜｰｸﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR1504
STG @MR1504
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33200              ; R_Err33ﾜｰｸﾊﾞｰｺｰﾄﾞ読取ﾀｲﾑｱｳﾄ
CON
JMP @MR1900              ; AUTO終了
;Err30ﾜｰｸﾊﾞｰｺｰﾄﾞ読取通信異常/Err33 product Bar code reading communication error
STG @MR1505
RES MR20115              ; ﾜｰｸRBCR_読取通信異常
CON
ANB MR903                ; R_ｴﾗｰ処理中
DW #30 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33113              ; R_Err30ﾜｰｸﾊﾞｰｺｰﾄﾞ読取通信異常
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR1506
STG @MR1506
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33113              ; R_Err30ﾜｰｸﾊﾞｰｺｰﾄﾞ読取通信異常
CON
JMP @MR1900              ; AUTO終了
;ﾜｰｸﾊﾞｰｺｰﾄﾞ記録/Product bar code record
STG @MR1507
BMOV DM20246 ZF1950 DM20245;N-L20[4]ﾃﾞｰﾀ(0000)  Rﾜｰｸ名  N-L20[4]ﾃﾞｰﾀｻｲｽﾞ
JMP @MR1508
;ﾜｰｸ名ﾁｪｯｸ/Check:product name 
STG @MR1508
MPS
AND CR2002               ; 常時ON
JMP @MR1600
MPP
AND CR2003               ; 常時OFF
JMP @MR1509
;Err27ﾜｰｸﾊﾞｰｺｰﾄﾞ異常/Err 27 Product bar code error
STG @MR1509
ANB MR903                ; R_ｴﾗｰ処理中
DW #27 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33110              ; R_Err27ﾜｰｸﾊﾞｰｺｰﾄﾞ異常
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR1510
;TP画面607：ﾜｰｸﾊﾞｰｺｰﾄﾞｴﾗｰ詳細/TP screen 607: product bar code error details
STG @MR1510
MPS
LD MR33110               ; R_Err27ﾜｰｸﾊﾞｰｺｰﾄﾞ異常
ANP MR30200              ; (R_TP)BzRstSw
ANL
DW #607 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
MPP
ANB MR903                ; R_ｴﾗｰ処理中
RES MR33110              ; R_Err27ﾜｰｸﾊﾞｰｺｰﾄﾞ異常
CON
JMP @MR1900              ; AUTO終了
;<h1/> 検査前ﾁｪｯｸ/Before inspectionCheck
STG @MR1600
ANB MR903                ; R_ｴﾗｰ処理中
JMP @MR1609
; ﾚﾊﾞｰﾁｪｯｸ/Lever check
STG @MR1609
MPS
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
JMP @MR1700              ; 検査ﾓｼﾞｭｰﾙ起動
MPP
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
SET MR500                ; R状態監視中
MPS
LDB MR903                ; R_ｴﾗｰ処理中
AND MR504                ; RﾚﾊﾞｰｾﾝｻOK
ANL
JMP @MR1610
MPP
LD MR903                 ; R_ｴﾗｰ処理中
AND MR33105              ; R_Err22ﾚﾊﾞｰ（ﾄｸﾞﾙｸﾗﾝﾌﾟ)状態異常
ANL
JMP @MR1900              ; AUTO終了
;ﾏｰｷﾝｸﾞﾍﾟﾝﾁｪｯｸ/Marking pen check 
STG @MR1610
MPS
LDB MR903                ; R_ｴﾗｰ処理中
AND MR506                ; RﾏｰｷﾝｸﾞﾍﾟﾝOK
ANL
JMP @MR1700              ; 検査ﾓｼﾞｭｰﾙ起動
MPP
LD MR903                 ; R_ｴﾗｰ処理中
AND MR33106              ; R_Err23ﾏｰｷﾝｸﾞﾍﾟﾝ状態異常
ANL
JMP @MR1900              ; AUTO終了
;<h1/> 検査ﾓｼﾞｭｰﾙ起動/Activation of inspection module
;※MCﾘｰｸ方法変更
;→待機ﾓｼﾞｭｰﾙ「MC_Leak_NEW」を呼び出す
;
;詳細
;従来：自動時と同様の回路設定でMCﾘｰｸ
;
;変更：→「MC_Leak_NEW」
;①上流-下流を1対1で接続した冶具(A)にて1回路ずつﾘｰｸ検査
;各回路の結果として記録
;②上流を封止した冶具(B)にて1回路ずつﾘｰｸ検査
;各回路の結果として記録
;
;①②を複合して補正値として利用する
;* MC leak method change
;→ Call standby module "MC_Leak_NEW"
;
;Details
;Conventional: MC leak with the same circuit setting as in automatic operation
;
;Change: → "MC_Leak_NEW"
;① Leak inspection for one circuit at a jig (A) connected upstream - downstream one - to - one
;Record as a result of each circuit
;② Leak inspection by one circuit at jig (B) sealed upstream
;Record as a result of each circuit
;
;Combine ① and use it as a correction value
STG @MR1700              ; 検査ﾓｼﾞｭｰﾙ起動
MPS
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ORB LR1915               ; New MC leak
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
MDSTRT R_Inspection
MRD
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
AND LR1915               ; New MC leak
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
MDSTRT R_MC_Leak_NEW
MRD
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR205                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正中
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
MPS
LDA EM30010              ; TP)機種選択番号(1-10)
CON
SUB #1
CON
MUL #25
CON
ADD ZF5                  ; R現在部品番号(1～25）
CON
SUB #1
CON
STA Z1
MPP
@INC DM200:Z1            ; 機種1部品1ﾜｰｸNo
MPP
JMP @MR1701
STG @MR1701
MPS
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ORB LR1915               ; New MC leak
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANF _R_Inspection
ANL
JMP @MR1800
MPP
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
AND LR1915               ; New MC leak
ANF _R_MC_Leak_NEW
ANL
JMP @MR1800
;<h1/> ﾃﾞｰﾀ記録/Data recording
;ZF504：ﾒﾓﾘｰｶｰﾄﾞ書き込み
;0bit目 結果書き込み無効
;1bit目 測定書き込み無効
;
;ZF504: Memory card write
;0 bit Result write invalid
;1st bit Measurement write invalid
STG @MR1800
MPS
LDB ZF504.0              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
ORB ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANB MR903                ; R_ｴﾗｰ処理中
ANL
JMP @MR1801
MPP
LD ZF504.0               ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
AND ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANL
JMP @MR1900              ; AUTO終了
;書込み準備/Preparation for writing
STG @MR1801
ANB MR903                ; R_ｴﾗｰ処理中
AND T0                   ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）OFF
SET MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
JMP @MR1802
LD @MR1802
FMOV #0 EM2000 #260      ; 結果書込1
LD @MR1802
DW #2 DM9                ; 1=L 2=R
MPS
AND MR312                ; R_自動運転中
MOV ZF3 EM2000           ; R現在機種部品ﾜｰｸNo  結果書込1
BMOV ZF1950 EM1980 #10   ; Rﾜｰｸ名  書込ﾜｰｸ名
MRD
ANB MR312                ; R_自動運転中
MOV #0 EM2000            ; 結果書込1
FMOV #0 EM1980 #10       ; 書込ﾜｰｸ名
MRD
BMOV CM700 EM2001 #6     ; ｶﾚﾝﾀﾞﾀｲﾏ（年）  結果書込2
MPP
BMOV EM2 EM2007 #2       ; RｴﾗｰNo.記憶  結果書込8
;<h1/>自動運転orMCﾘｰｸ個別測定無効時/Automatic operation or MC Leak When individual measurement is invalid
;誤配管検査記録/Incorrect piping inspection record
LD @MR1802
LDB LR1915               ; New MC leak
ORB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANL
BMOV ZF840 EM2010 #2     ; R現設定_誤配管検査_判定値上  結果書込11
BMOV ZF1000 EM2012 #20   ; R誤配管検査回路1結果  結果書込13
BMOV ZF770 EM2032 #20    ; R現設定_誤配管検査1 設定番号  結果書込33
BMOV ZF1020 EM2052 #100  ; R誤配管検査回路1-1流量値  結果書込53
;ﾘｰｸ検査記録/Leak inspection record
;通常検査/Normal inspection
LD @MR1802
ANB LR1915               ; New MC leak
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
BMOV ZF856 EM2152 #6     ; R現設定_ﾘｰｸ検査1判定値(ﾘｰｸ量)  結果書込153
BMOV ZF1120 EM2158 #6    ; Rﾘｰｸ検査部位1結果(0未1-2中3良4不  結果書込159
BMOV ZF862 EM2164 #6     ; R現設定_Lﾘｰｸ検査1補正量  結果書込165
BMOV ZF790 EM2170 #5     ; R現設定_ﾘｰｸ検査1 設定番号1  結果書込171
BMOV ZF830 EM2175 #1     ; R現設定_ﾘｰｸ検査1 設定番号6  結果書込176
BMOV ZF795 EM2176 #5     ; R現設定_ﾘｰｸ検査2 設定番号1  結果書込177
BMOV ZF831 EM2181 #1     ; R現設定_ﾘｰｸ検査2 設定番号6  結果書込182
BMOV ZF800 EM2182 #5     ; R現設定_ﾘｰｸ検査3 設定番号1  結果書込183
BMOV ZF832 EM2187 #1     ; R現設定_ﾘｰｸ検査3 設定番号6  結果書込188
BMOV ZF805 EM2188 #5     ; R現設定_ﾘｰｸ検査4 設定番号1  結果書込189
BMOV ZF833 EM2193 #1     ; R現設定_ﾘｰｸ検査4 設定番号6  結果書込194
BMOV ZF810 EM2194 #5     ; R現設定_ﾘｰｸ検査5 設定番号1  結果書込195
BMOV ZF834 EM2199 #1     ; R現設定_ﾘｰｸ検査5 設定番号6  結果書込200
BMOV ZF815 EM2200 #5     ; R現設定_ﾘｰｸ検査6 設定番号1  結果書込201
BMOV ZF835 EM2205 #1     ; R現設定_ﾘｰｸ検査6 設定番号6  結果書込206
BMOV ZF874 EM2206 #6     ; R現設定_ﾘｰｸ検査1検査圧力設定値  結果書込207
BMOV ZF1138 EM2212 #6    ; Rﾘｰｸ検査1 ﾘｰｸ量(補正前)  結果書込213
BMOV ZF1144 EM2218 #6    ; Rﾘｰｸ検査1 ﾘｰｸ量(補正後)  結果書込219
;装置ﾘｰｸ/Device leak
LD @MR1802
ANB LR1915               ; New MC leak
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
BMOV EM1156 EM2010 #6    ; MCﾘｰｸ検査1 判定値(ﾘｰｸ量)  結果書込11
BMOV EM1200 EM2016 #6    ; R_MCﾘｰｸ1結果(0未1-2中3良4不  結果書込17
BMOV ZF790 EM2022 #30    ; R現設定_ﾘｰｸ検査1 設定番号1  結果書込23
BMOV EM1206 EM2052 #6    ; R_MCﾘｰｸ結果 基準圧1  結果書込53
BMOV EM1218 EM2058 #6    ; R_MCﾘｰｸ結果 ﾘｰｸ量1  結果書込59
;逆止弁検査記録/reverse valve inspection record
;'本装置は無し
;'No Equipment
LD CR2003                ; 常時OFF
NCJ #1005
;'本装置は無し
;
;'No Equipment
LABEL #1005
;
;漏液ｾﾝｻ検査記録/reverse valve inspection record
LD @MR1802
LDB LR1915               ; New MC leak
ORB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANL
LDA ZF1174               ; R漏液ｾﾝｻ検査結果(0未1-2中3良4不
CON
STA EM2218               ; 結果書込219
;閉塞有無検査/Check for obstruction
LD @MR1802
LDB LR1915               ; New MC leak
ORB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANL
BMOV ZF965 EM2219 #14    ; R現設定_閉塞検査1_判定値上  結果書込220
BMOV ZF1175 EM2223 #7    ; R閉塞検査1結果(0未1-2中3良4不  結果書込224
BMOV ZF1182 EM2240 #7    ; R閉塞検査1流量値  結果書込241
;<h1/>MCﾘｰｸ個別測定有効時/When MC leak individual measurement is enabled
LD @MR1802
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
AND LR1915               ; New MC leak
MOV ZF874 EM2010         ; R現設定_ﾘｰｸ検査1検査圧力設定値  結果書込11
BMOV EM950 EM2011 #20    ; RMCﾘｰｸ検査 判定値(ﾘｰｸ量)1-1  結果書込12
BMOV EM1290 EM2031 #20   ; RMCﾘｰｸ結果(回路1-1) 結果  結果書込32
BMOV EM1250 EM2051 #20   ; RMCﾘｰｸ結果(回路1-1) ﾘｰｸ量  結果書込52
BMOV EM970 EM2071 #20    ; RMCﾘｰｸ検査 判定値(ﾘｰｸ量)U1  結果書込72
BMOV EM1310 EM2091 #20   ; RMCﾘｰｸ結果(回路1上流封止) 結果  結果書込92
BMOV EM1070 EM2111 #20   ; MCﾘｰｸ結果(回路1上流封止) ﾘｰｸ量  結果書込112
MPS
BMOV EM1330 EM2131 #20   ; RMCﾘｰｸ結果(回路1下流算出) ﾘｰｸ量  結果書込132
MPP
AND LR1910               ; R_MCﾘｰｸ共通経路測定有効
MOV EM1372 EM2151        ; R_MCﾘｰｸ検査共通回路判定値(ﾘｰｸ量)  結果書込152
MOV EM1371 EM2152        ; R_MCﾘｰｸ結果(共通回路) 結果  結果書込153
MOV EM1370 EM2153        ; R_MCﾘｰｸ結果(共通回路) ﾘｰｸ量  結果書込154
;ﾃﾞｰﾀ移行STG/Data migration STG
STG @MR1802
JMP @MR1803
;"MemoryCard_Access"ﾓｼﾞｭｰﾙ実行/"MemoryCard_Access" module execution
;"MemoryCard_AccessMC"ﾓｼﾞｭｰﾙ実行
;Module execution
STG @MR1803
MPS
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
OR MR209                 ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANL
MDSTRT MemoryCard_Access
MRD
LDB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANL
MPS
AND LR1915               ; New MC leak
SET MR703                ; MC2write_result
MPP
MDSTRT MemoryCard_AccessMC
MPP
JMP @MR1804
;<<書込ﾓｼﾞｭｰﾙ停止処理>>/<< Write module stop process >>
;<<書込ﾓｼﾞｭｰﾙ停止処理>><< Write module stop process >>
STG @MR1804
LDB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
AND _MemoryCard_Access
LD MR107                 ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
AND _MemoryCard_AccessMC
ORL
ANL
ANF MR111                ; ﾒﾓﾘｶｰﾄﾞ書込中
MPS
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
MDSTOP MemoryCard_Access
MRD
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
MPS
MDSTOP MemoryCard_AccessMC
MPP
AND LR1915               ; New MC leak
RES MR703                ; MC2write_result
MPP
RES MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
JMP @MR1900              ; AUTO終了
;<h1/> 自動運転終了/Automatic operation End
;ﾍﾟｰｼﾞ520検査結果
;ﾍﾟｰｼﾞ500ﾒｲﾝ画面
;
;Page 520 Inspection result
;Page 500 Main screen
;※装置ﾘｰｸ検査で自動回路使用していた場合は、戻す
;※ If you are using the automatic circuit in equipment leak check, return
STG @MR1900              ; AUTO終了
RES MR500                ; R状態監視中
CON
MPS
AND MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
JMP @MR2200              ; 装置ﾘｰｸ検査_自動回路より戻り
MPP
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
MPS
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
JMP @MR1913
MPP
AND MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
JMP @MR2501
STG @MR1913
RES MR201                ; Rｻｲｸﾙﾀｲﾑ測定ﾌﾗｸﾞ
CON
RES MR312                ; R_自動運転中
CON
JMP @MR1915
STG @MR1915
MPS
AND= EM29996 #520        ; (R_TP)現在表示中画面No.
TMR @52 #50
CON
AND @T52
MOV #500 EM29997         ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
MPP
AND= EM29996 #500        ; (R_TP)現在表示中画面No.
ENDS
;<h1/>■ﾒﾝﾃ動作/Maintenance action
;<h1/> 装置ﾘｰｸ検査/ M/C leak inspection mode
;ﾒｲﾝ画面→調整→装置ﾘｰｸ検査/Main screen → Adjustment → Device leak inspection
;EM30031:(TP)装置ﾘｰｸ検査表示用/For equipment leak inspection display
;0：装置ﾘｰｸ治具をｾｯﾄし、ｽﾀｰﾄSWを押して下さい。
;   Set the sealing jig and press start SW.
LD MR29902               ; (R_TP)調整選択中
AND MR30403              ; (R_TP)装置ﾘｰｸ検査ﾓｰﾄﾞ
ANB MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
ANB MR30405              ; (R_TP)ﾘｰｸﾃｽﾀｰ公正ﾓｰﾄﾞ
ANB MR30406              ; (TP)ﾘｰｸﾃｽﾀｰNG調整ﾓｰﾄﾞ
AND MR311                ; R_原点復帰完了
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
ANB MR903                ; R_ｴﾗｰ処理中
ANB MR111                ; ﾒﾓﾘｶｰﾄﾞ書込中
MPS
DW #0 EM30031            ; (R_TP)装置ﾘｰｸ検査表示用
MPP
LD R2015                 ; 冶具確認ON有_R
LD= EM29996 #812         ; (R_TP)現在表示中画面No.
OR= EM29996 #821         ; (R_TP)現在表示中画面No.
ANL
ANL
OUT @MR403               ; 動作開始要求4
CON
ANP R2008                ; ｽﾀｰﾄSW_R 
SET @MR2100
;装置体ﾘｰｸ検査結果ｸﾘｱ/Clear device leak check result
;EM30031:(TP)装置ﾘｰｸ検査表示用/For equipment leak inspection display
;1：準備中
;   In preparation
STG @MR2100
DW #1 EM30031            ; (R_TP)装置ﾘｰｸ検査表示用
CON
SET MR313                ; R_ﾒﾝﾃ動作中
CON
SET MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
CON
DW #0 EM554              ; RM/Cﾘｰｸ 状態LP(0未1-2中3良4不
CON
JMP @MR2101
;自動運転回路へ/To the automatic operation circuit
STG @MR2101
JMP @MR600
;自動運転回路より戻り/Return from automatic operation circuit
STG @MR2200              ; 装置ﾘｰｸ検査_自動回路より戻り
JMP @MR2201
;補正値書込み/Write correction value
STG @MR2201
MPS
ANB LR1914               ; R補正値書込み有効
JMP @MR2214
MPP
AND LR1914               ; R補正値書込み有効
MPS
AND<> EM554 #3           ; RM/Cﾘｰｸ 状態LP(0未1-2中3良4不
JMP @MR2214
MPP
AND= EM554 #3            ; RM/Cﾘｰｸ 状態LP(0未1-2中3良4不
MPS
AND LR1915               ; New MC leak
JMP @MR2203
MPP
ANB LR1915               ; New MC leak
JMP @MR2202
LD @MR2202
LDA EM30011              ; (R_TP)部品選択
CON
SUB #1
CON
MUL #350
CON
STA Z1
CON
MPS
LDA EM1218               ; R_MCﾘｰｸ結果 ﾘｰｸ量1
CON
STA DM1218:Z1            ; 部品1_Rﾘｰｸ検査1補正量
MRD
LDA EM1219               ; R_MCﾘｰｸ結果 ﾘｰｸ量2
CON
STA DM1219:Z1            ; 部品1_Rﾘｰｸ検査2補正量
MRD
LDA EM1220               ; R_MCﾘｰｸ結果 ﾘｰｸ量3
CON
STA DM1220:Z1            ; 部品1_Rﾘｰｸ検査3補正量
MRD
LDA EM1221               ; R_MCﾘｰｸ結果 ﾘｰｸ量4
CON
STA DM1221:Z1            ; 部品1_Rﾘｰｸ検査4補正量
MRD
LDA EM1222               ; R_MCﾘｰｸ結果 ﾘｰｸ量5
CON
STA DM1222:Z1            ; 部品1_Rﾘｰｸ検査5補正量
MPP
LDA EM1223               ; R_MCﾘｰｸ結果 ﾘｰｸ量6
CON
STA DM1223:Z1            ; 部品1_Rﾘｰｸ検査6補正量
STG @MR2202
JMP @MR2212
;<h1/> -MCﾘｰｸ個別測定有効時/When MC leak individual measurement is enabled
STG @MR2203
MDSTRT R_MC_Offset
JMP @MR2204
STG @MR2204
ANF _R_MC_Offset
JMP @MR2212
;<h1/> -書込み/writing
STG @MR2212
ANB MR903                ; R_ｴﾗｰ処理中
AND T0                   ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）OFF
DW #2 DM9                ; 1=L 2=R
CON
SET MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
SET R45010               ; Memory書き込み開始
CON
JMP @MR2213
STG @MR2213
AND R45011               ; Memory書き込み完了
RES MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
RES R45010               ; Memory書き込み開始
CON
JMP @MR2214
;end
STG @MR2214
JMP @MR2215
STG @MR2215
RES MR107                ; Rﾒﾝﾃ_装置ﾘｰｸ検査中
CON
RES MR313                ; R_ﾒﾝﾃ動作中
CON
ENDS
;<h1/> ﾘｰｸﾃｽﾀｰ公正/Leak tester fair
LD MR29902               ; (R_TP)調整選択中
ANB MR30403              ; (R_TP)装置ﾘｰｸ検査ﾓｰﾄﾞ
ANB MR205                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正中
AND MR30405              ; (R_TP)ﾘｰｸﾃｽﾀｰ公正ﾓｰﾄﾞ
ANB MR30406              ; (TP)ﾘｰｸﾃｽﾀｰNG調整ﾓｰﾄﾞ
AND MR311                ; R_原点復帰完了
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
ANB MR903                ; R_ｴﾗｰ処理中
ANB MR111                ; ﾒﾓﾘｶｰﾄﾞ書込中
MPS
OUT @MR405               ; 動作開始要求6
MPP
ANP R2008                ; ｽﾀｰﾄSW_R 
SET @MR2300
STG @MR2300
DW.S +0 DM33             ; ﾘｰｸﾃｽﾀ公正結果R
CON
RES MR207                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正OKﾗﾝﾌﾟ
CON
SET MR313                ; R_ﾒﾝﾃ動作中
CON
SET MR205                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正中
CON
SET MR6609               ; ﾘｰｸﾃｽﾀｰR CAL
CON
JMP @MR2301
;回路ﾊﾞﾙﾌﾞ開閉処理/Circuit valve opening / closing process
;23：ﾘｰｸﾃｽﾀ入口
;24：ﾘｰｸﾃｽﾀ出口
;25：流量ｾﾝｻ入口
;26：流量ｾﾝｻ出口
;27：上流大気開放
;23: Leak tester entrance
;24: Leak tester exit
;25: Flow sensor inlet
;26: Flow sensor outlet
;27: Upstream air release
STG @MR2301
SET MR8704               ; R上流側流路切替ﾊﾞﾙﾌﾞ 23(ON=開)
CON
RES MR8705               ; R上流側流路切替ﾊﾞﾙﾌﾞ 24(ON=開)
CON
RES MR8706               ; R上流側流路切替ﾊﾞﾙﾌﾞ 25(ON=開)
CON
RES MR8707               ; R上流側流路切替ﾊﾞﾙﾌﾞ 26(ON=開)
CON
RES MR8708               ; R上流側流路切替ﾊﾞﾙﾌﾞ 27(ON=開)
CON
RES MR401                ; R_上下流_ﾊﾞﾙﾌﾞ一括切替(OFF全閉
CON
JMP @MR2302
;ﾘｰｸﾃｽﾀ-実行要求
STG @MR2302
SET MR20600              ; Rﾘｰｸﾃｽﾀ-実行要求
CON
JMP @MR2303
;完了待ち/Wait for completion
STG @MR2303
AND MR20601              ; Rﾘｰｸﾃｽﾀ-実行完了
RES MR20601              ; Rﾘｰｸﾃｽﾀ-実行完了
CON
JMP @MR2304
STG @MR2304
MPS
ANB MR20602              ; Rﾘｰｸﾃｽﾀｰ処理異常有
JMP @MR2400
MPP
AND MR20602              ; Rﾘｰｸﾃｽﾀｰ処理異常有
RES MR20602              ; Rﾘｰｸﾃｽﾀｰ処理異常有
CON
JMP @MR2302
STG @MR2400
RES MR8704               ; R上流側流路切替ﾊﾞﾙﾌﾞ 23(ON=開)
CON
RES MR6609               ; ﾘｰｸﾃｽﾀｰR CAL
CON
JMP @MR2401
STG @MR2401
MPS
LD>.S DM33 DM37          ; ﾘｰｸﾃｽﾀ公正結果R  ﾘｰｸﾃｽﾀ公正結果下限R
AND<.S DM33 DM36         ; ﾘｰｸﾃｽﾀ公正結果R  ﾘｰｸﾃｽﾀ公正結果上限R
ANL
SET MR207                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正OKﾗﾝﾌﾟ
MPP
JMP @MR2402
;<h1/> ﾃﾞｰﾀ記録/Data recording
;ZF410：ﾒﾓﾘｰｶｰﾄﾞ書き込み
;0bit目 結果書き込み無効
;1bit目 測定書き込み無効
;
;ZF410: Memory card write
;0 bit Result write invalid
;1st bit Measurement write invalid
STG @MR2402
MPS
LDB ZF504.0              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
ORB ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANB MR903                ; R_ｴﾗｰ処理中
ANL
JMP @MR2403
MPP
LD ZF504.0               ; R ﾒﾓﾘｰｶｰﾄﾞ書込_結果ﾃﾞｰﾀ無効(=ON
AND ZF504.1              ; R ﾒﾓﾘｰｶｰﾄﾞ書込_測定ﾃﾞｰﾀ無効(=ON
ANL
JMP @MR2415
;<h1/>測定ﾃﾞｰﾀ書き込み/Write measurement data
STG @MR2403
ANB MR902                ; ｴﾗｰ
AND T0                   ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）OFF
SET MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
JMP @MR2404
LD @MR2404
FMOV #0 EM2000 #260      ; 結果書込1
LD @MR2404
MPS
DW #2 DM9                ; 1=L 2=R
CON
BMOV CM700 EM2000 #6     ; ｶﾚﾝﾀﾞﾀｲﾏ（年）  結果書込1
MRD
FMOV #0 EM1980 #10       ; 書込ﾜｰｸ名
MRD
BMOV DM36 EM2006 #2      ; ﾘｰｸﾃｽﾀ公正結果上限R  結果書込7
MRD
AND MR207                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正OKﾗﾝﾌﾟ
MOV #3 EM2008            ; 結果書込9
MRD
ANB MR207                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正OKﾗﾝﾌﾟ
MOV #4 EM2008            ; 結果書込9
MPP
MOV DM33 EM2009          ; ﾘｰｸﾃｽﾀ公正結果R  結果書込10
STG @MR2404
JMP @MR2405
;"MemoryCard_Access"ﾓｼﾞｭｰﾙ実行/"MemoryCard_Access" module execution
STG @MR2405
MDSTRT MemoryCard_Access
JMP @MR2406
STG @MR2406
AND _MemoryCard_Access
ANF MR111                ; ﾒﾓﾘｶｰﾄﾞ書込中
MDSTOP MemoryCard_Access
RES MR109                ; ﾒﾓﾘｶｰﾄﾞ書込中(排他ﾌﾗｸﾞ）
CON
JMP @MR2415
;End
STG @MR2415
RES MR205                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀ公正中
CON
RES MR313                ; R_ﾒﾝﾃ動作中
CON
ENDS
;<h1/> ﾘｰｸﾃｽﾀｰNG調整/Leak tester NG adjustment
LD MR29902               ; (R_TP)調整選択中
ANB MR30403              ; (R_TP)装置ﾘｰｸ検査ﾓｰﾄﾞ
ANB MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
ANB MR30405              ; (R_TP)ﾘｰｸﾃｽﾀｰ公正ﾓｰﾄﾞ
AND MR30407              ; (R_TP)ﾘｰｸﾃｽﾀｰNG調整ﾓｰﾄﾞ
AND MR311                ; R_原点復帰完了
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
ANB MR903                ; R_ｴﾗｰ処理中
ANB MR111                ; ﾒﾓﾘｶｰﾄﾞ書込中
MPS
OUT @MR406               ; 動作開始要求7
MPP
ANP R2008                ; ｽﾀｰﾄSW_R 
SET @MR2500
;自動運転回路へ/To the automatic operation circuit
STG @MR2500
SET MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
CON
SET MR6609               ; ﾘｰｸﾃｽﾀｰR CAL
CON
JMP @MR600
;自動運転回路より戻り/Return from automatic operation circuit
STG @MR2501
JMP @MR2502
STG @MR2502
RES MR6609               ; ﾘｰｸﾃｽﾀｰR CAL
CON
RES MR209                ; Rﾒﾝﾃ_ﾘｰｸﾃｽﾀNG調整中
CON
RES MR313                ; R_ﾒﾝﾃ動作中
CON
ENDS
;<h1/>手動操作/ manual operation
LD R46506                ; R_TP_Cy_SW7
AND R2015                ; 冶具確認ON有_R
SET MR9000               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR前進
CON
RES MR9001               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR後退
LD R46507                ; R_TP_Cy_SW8
AND R2015                ; 冶具確認ON有_R
RES MR9000               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR前進
CON
SET MR9001               ; ﾏｰｷﾝｸﾞ ﾍﾟﾝR後退
;<h1/>■設定/Configuration
;@MR3000～3415
;<h1/> ﾊﾞｰｺｰﾄﾞ自動登録/Automatic barcode registration
LDP MR30109              ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録SW
LDA EM29932              ; Rﾊﾞｰｺｰﾄﾞ_ﾃﾞｰﾀｵﾌｾｯﾄ用
CON
STA Z1
CON
FMOV #0 EM33000:Z1 #100  ; 部品1_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ
;EM33000.T:EM29932= ZF40000.T
LDP MR30109              ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録SW
NCJ #1007
;EM33000.T:EM29932= ZF40000.T
LD CR2002                ; 常時ON
LDA EM29932              ; Rﾊﾞｰｺｰﾄﾞ_ﾃﾞｰﾀｵﾌｾｯﾄ用
CON
EXT
CON
STA.L Z11
CON
SMOV ZF40000 EM33000:Z11 ; ｷｰ入力_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ  部品1_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ
LABEL #1007
;
;ﾒｲﾝ画面→設定→ﾊﾟﾗﾒｰﾀ→部品別ﾊﾟﾗﾒｰﾀ設定→部品名→ﾊﾞｰｺｰﾄﾞ登録設定
;Main screen → Settings → Parameters → Parameter setting by component → Part name → Bar code registration setting
;EM30028:(TP)ﾊﾞｰｺｰﾄﾞ登録表示用
;0：登録を行う検査冶具をｾｯﾄしてください。
;EM 30028: (TP) For bar code registration display
;0: Please set the inspection jig to be registered.
LDP MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
DW #0 EM30030            ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録表示用
;EM30030:(TP)ﾊﾞｰｺｰﾄﾞ登録表示用/For bar code registration display
;1：ｽﾀｰﾄSWを押して下さい。ﾊﾞｰｺｰﾄﾞ読取を行います。
;   Please push start SW.The barcode reading is performed.
LD MR314                 ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
AND MR311                ; R_原点復帰完了
ANB MR312                ; R_自動運転中
ANB MR313                ; R_ﾒﾝﾃ動作中
ANB MR903                ; R_ｴﾗｰ処理中
ANB MR315                ; R_設定：ﾊﾞｰｺｰﾄﾞ登録中
AND R2015                ; 冶具確認ON有_R
MPS
DW #1 EM30030            ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録表示用
CON
OUT @MR404               ; 動作開始要求5
MPP
ANP R2008                ; ｽﾀｰﾄSW_R 
SET @MR3000
;EM30030:(TP)ﾊﾞｰｺｰﾄﾞ登録表示用/For bar code registration display
;2：読取中
;   Under reading
STG @MR3000
DW #2 EM30030            ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録表示用
CON
SET MR315                ; R_設定：ﾊﾞｰｺｰﾄﾞ登録中
CON
JMP @MR3001
;読取開始要求/Read start request
STG @MR3001
ANB MR903                ; R_ｴﾗｰ処理中
MPS
AND MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
SET MR20400              ; 冶具R_BCR_読取開始
CON
JMP @MR3002
MPP
ANB MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
JMP @MR3015
STG @MR3002
AND MR20401              ; 冶具R_BCR_読取完了
RES MR20401              ; 冶具R_BCR_読取完了
CON
JMP @MR3003
STG @MR3003
MPS
ANB MR20415              ; 冶具R_BCR_読取通信異常
MPS
AND MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
JMP @MR3006
MPP
ANB MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
JMP @MR3015
MPP
AND MR20415              ; 冶具R_BCR_読取通信異常
JMP @MR3004
;Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常/Err 31 jig bar code reading communication error
STG @MR3004
RES MR20415              ; 冶具R_BCR_読取通信異常
CON
ANB MR903                ; R_ｴﾗｰ処理中
DW #31 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33114              ; R_Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR3005
STG @MR3005
ANB MR903                ; R_ｴﾗｰ処理中
DW #820 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
CON
RES MR33114              ; R_Err31冶具ﾊﾞｰｺｰﾄﾞ読取通信異常
CON
JMP @MR3015
;<h1/> 検査冶具ﾊﾞｰｺｰﾄﾞ確認/Check jig barcode confirmation
;冶具名が空白ならNG処理
;If the Jig name are blank, NG processing
;If DM20176.T = "" then
;	SET(@MR000)'冶具名空白ｴﾗｰSET/Jig name blank error SET
;Else
;	RES(@MR000)'冶具名空白OK/Jig name Blank OK
;End If
;
;SET(@MR901)'冶具名空白ﾁｪｯｸ完了/Jig name blank check completed
LDP @MR3006
NCJ #1003
;If DM20176.T = "" then
;
LD CR2002                ; 常時ON
ADRSET VM2 VM0
MOV #0 VM2
MOV.D VM0 @VM3
SMOV "" *@VM3
LD CR2002                ; 常時ON
SCMP DM20176 *@VM3       ; N-L20[3]ﾃﾞｰﾀ(0000)
LD CR2010                ; 演算結果がｾﾞﾛ
NCJ #2019
;	SET(@MR000)'冶具名空白ｴﾗｰSET/Jig name blank error SET
;
LD CR2002                ; 常時ON
SET @MR000               ; R冶具名ｴﾗｰ
;Else
;
LD CR2002                ; 常時ON
CJ #2020
LABEL #2019
;	RES(@MR000)'冶具名空白OK/Jig name Blank OK
;
LD CR2002                ; 常時ON
RES @MR000               ; R冶具名ｴﾗｰ
;End If
;
LABEL #2020
;SET(@MR901)'冶具名空白ﾁｪｯｸ完了/Jig name blank check completed
LD CR2002                ; 常時ON
SET @MR901               ; 冶具名空白ﾁｪｯｸ完了
LABEL #1003
;
STG @MR3006
AND @MR901               ; 冶具名空白ﾁｪｯｸ完了
RES @MR901               ; 冶具名空白ﾁｪｯｸ完了
CON
MPS
ANB @MR000               ; R冶具名ｴﾗｰ
JMP @MR3009
MPP
AND @MR000               ; R冶具名ｴﾗｰ
JMP @MR3007
;Err15冶具名ｴﾗｰ/Err 15 Jig name error
STG @MR3007
ANB MR903                ; R_ｴﾗｰ処理中
DW #15 ZF149             ; Rｴﾗｰ画面詳細ﾒｯｾｰｼﾞ
CON
SET MR33014              ; R_Err15冶具名ｴﾗｰ
CON
SET MR903                ; R_ｴﾗｰ処理中
CON
JMP @MR3008
;TP画面608：冶具ﾊﾞｰｺｰﾄﾞｴﾗｰ詳細/TP screen 608: Jig bar code error details
STG @MR3008
MPS
LD MR33014               ; R_Err15冶具名ｴﾗｰ
ANP MR30200              ; (R_TP)BzRstSw
ANL
DW #608 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
MPP
ANB MR903                ; R_ｴﾗｰ処理中
DW #820 EM29997          ; (R_TP)ﾍﾟｰｼﾞ画面切替用No.
CON
RES MR33014              ; R_Err15冶具名ｴﾗｰ
CON
JMP @MR3015
;右端の半角ｽﾍﾟｰｽ・ﾀﾌﾞを削除/Delete single-byte space / tab at right end 
;For @EM0 = 0 To 9 Step 1
;
;	DM20176.T:(@EM0 * 10) = RTRIM(DM20176.T:(@EM0 * 10))
;
;Next
LD @MR3009
NCJ #1001
;For @EM0 = 0 To 9 Step 1
;
LD CR2002                ; 常時ON
MOV #0 @EM0
LABEL #2021
LD> @EM0 #9
CJ #2022
;	DM20176.T:(@EM0 * 10) = RTRIM(DM20176.T:(@EM0 * 10))
;
LD CR2002                ; 常時ON
LDA @EM0
CON
EXT
CON
MUL.L +10
CON
STA.L Z11
CON
LDA @EM0
CON
EXT
CON
MUL.L +10
CON
STA.L Z12
LD CR2002                ; 常時ON
ADRSET VM2 VM0
MOV #0 VM2
MOV.D VM0 @VM6
LD CR2002                ; 常時ON
MOV #0 @VM5
BSET @VM5 #1
LD CR2002                ; 常時ON
STRIM DM20176:Z12 @VM5 *@VM6;N-L20[3]ﾃﾞｰﾀ(0000)
LD CR2002                ; 常時ON
SMOV *@VM6 DM20176:Z11   ; N-L20[3]ﾃﾞｰﾀ(0000)
;Next
LD CR2002                ; 常時ON
INC @EM0
LDB CR2009               ; 演算結果が負
CJ #2021
LABEL #2022
LABEL #1001
;
;ZF40000.T = DM20176.T
LD @MR3009
NCJ #1008
;ZF40000.T = DM20176.T
LD CR2002                ; 常時ON
SMOV DM20176 ZF40000     ; N-L20[3]ﾃﾞｰﾀ(0000)  ｷｰ入力_ﾊﾞｰｺｰﾄﾞﾃﾞｰﾀ
LABEL #1008
;
;EM30030:(TP)ﾊﾞｰｺｰﾄﾞ登録表示用
;3：上記のデータを確認し、[戻るSW］を押して下さい。
;   Confirm the data mentioned above,[Back SW] push.
STG @MR3009
DW #3 EM30030            ; (R_TP)ﾊﾞｰｺｰﾄﾞ登録表示用
CON
JMP @MR3015
;終了/End
STG @MR3015
RES MR314                ; R_TPよりﾊﾞｰｺｰﾄﾞ登録許可
CON
RES MR315                ; R_設定：ﾊﾞｰｺｰﾄﾞ登録中
CON
ENDS
;<h1/>■動作開始要求中：ｽﾀｰﾄSW点滅/During operation start request: Start SW blink
LDB @MR400               ; 動作開始要求1
ANB @MR401               ; 動作開始要求2
ANB @MR402               ; 動作開始要求3
ANB @MR403               ; 動作開始要求4
ANB @MR404               ; 動作開始要求5
ANB @MR405               ; 動作開始要求6
ANB @MR406               ; 動作開始要求7
ANB @MR407               ; 動作開始要求8
ANB @MR408               ; 動作開始要求9
ANB @MR409               ; 動作開始要求10
ANB @MR410               ; 動作開始要求11
ANB @MR411               ; 動作開始要求12
ANB @MR412               ; 動作開始要求13
ANB @MR413               ; 動作開始要求14
ANB @MR414               ; 動作開始要求15
ANB @MR415               ; 動作開始要求16
INV
OUT MR009                ; RｽﾀｰﾄSW点滅要求
;<h1/>■ｻﾌﾞﾙｰﾁﾝ/Subroutine
END
ENDH
