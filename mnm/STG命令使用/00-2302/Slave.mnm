DEVICE:51
;MODULE:Slave
;MODULE_TYPE:0
LD R50000                ; 即停止
OR R50900                ; TRAP
OR R50914                ; HOMEsw ON
ZRES @MR000 @MR915       ; MAIN PAUSE条件確認へ
LD R55000                ; 即停止/TRAP 入力無し
AND T200                 ; 動作中遅延
ANB R49908               ; HOME開始sw(ﾀｯﾁﾊﾟﾈﾙ)
TMR @0 #10               ; 遅延
CON
AND @T0                  ; 遅延
AND CR2003               ; 常時OFF
MPS
@SET @MR000              ; MAIN PAUSE条件確認へ
MPP
AND=.D @MR000 #0         ; MAIN PAUSE条件確認へ
MPS
ANB R50301               ; Pause
@SET @MR000              ; MAIN PAUSE条件確認へ
MPP
AND R50301               ; Pause
MPS
ANB MR3001               ; ｶﾊﾞｰﾛｯｸ解除
@SET @MR001              ; 001
MPP
AND MR3001               ; ｶﾊﾞｰﾛｯｸ解除
@SET @MR101              ; 101
LD=.D @MR000 #0          ; MAIN PAUSE条件確認へ
OR R53002                ; 仮 異常検出FLG１
ANB T250
OUT R53002               ; 仮 異常検出FLG１
TMR #250 #20
LDP R53002               ; 仮 異常検出FLG１
INC DM900                ; 暫定　異常発生カウンタ
;<h1/>■■■■■ MAIN部 PAUSE / MAIN PAUSE ■■■■■
;***** Pause 判断 / Pause Judge  *****
;
STG @MR000               ; MAIN PAUSE条件確認へ
MPS
LD R50001                ; 自動中
OR R50002                ; 手動中
OR R51101                ; 原点復帰
AND R51201               ; ｴﾘｱｾﾝｻｰ有効FLG
ANB R49812               ; ｴﾘｱｾﾝｻ 　全OK
ANL
SET R50212               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
SET R49008               ; ｴﾘｱｾﾝｻ遮光
CON
SET R50301               ; Pause
CON
JMP @MR001               ; 001
MPP
ANP R50105               ; PAUSE sw
SET R50212               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
SET R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
SET R50301               ; Pause
CON
JMP @MR001               ; 001
;***** Pack 判断 / Pack Judge  *****
;
LDB R50612               ; Pack (MAIN)
OUB R50308               ; PACK中
LD R49812                ; ｴﾘｱｾﾝｻ 　全OK
AND R51001               ; ｽﾀｰﾄsw ON
OUT @MR400               ; PAUSE中止
STG @MR001               ; 001
MPS
ANB R50308               ; PACK中
JMP @MR100
MPP
LD R50308                ; PACK中
AND @MR400               ; PAUSE中止
ANL
RES R50212               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
RES R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
RES R49008               ; ｴﾘｱｾﾝｻ遮光
CON
RES R50301               ; Pause
CON
JMP @MR000               ; MAIN PAUSE条件確認へ
;***** PAUSE 処理 / pause routine  *****
;
STG @MR100
MPS
ANB R49008               ; ｴﾘｱｾﾝｻ遮光
SET MR50300              ; Pause
CON
SET MR3001               ; ｶﾊﾞｰﾛｯｸ解除
CON
JMP @MR101               ; 101
MPP
AND R49008               ; ｴﾘｱｾﾝｻ遮光
JMP @MR101               ; 101
;***** ｶﾊﾞｰ閉 条件待ち / Cover close  Judge  *****
;
STG @MR101               ; 101
MPS
ANP R51001               ; ｽﾀｰﾄsw ON
JMP @MR102               ; 102
MPP
ANP R50105               ; PAUSE sw
SET R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
SET MR3001               ; ｶﾊﾞｰﾛｯｸ解除
;***** Pause 条件復帰待ち / Pause Clear  Judge  *****
;
STG @MR102               ; 102
SET R50309               ; ERR Rset under input
CON
RES MR3001               ; ｶﾊﾞｰﾛｯｸ解除
CON
JMP @MR103               ; 103
STG @MR103               ; 103
TMR @1 #5                ; ｶﾊﾞｰ閉   確認遅延
CON
AND @T1                  ; ｶﾊﾞｰ閉   確認遅延
MPS
AND R49811               ; 安全ｶﾊﾞｰ  全OK
MPS
LD R51201                ; ｴﾘｱｾﾝｻｰ有効FLG
ANB R49812               ; ｴﾘｱｾﾝｻ 　全OK
ANL
RES R50309               ; ERR Rset under input
CON
SET R49008               ; ｴﾘｱｾﾝｻ遮光
CON
JMP @MR100
MPP
LD R49812                ; ｴﾘｱｾﾝｻ 　全OK
ORB R51201               ; ｴﾘｱｾﾝｻｰ有効FLG
ANL
JMP @MR104               ; 104
MPP
ANB R49811               ; 安全ｶﾊﾞｰ  全OK
SET MR3001               ; ｶﾊﾞｰﾛｯｸ解除
CON
JMP @MR101               ; 101
STG @MR104               ; 104
RES MR3001               ; ｶﾊﾞｰﾛｯｸ解除
CON
RES R49008               ; ｴﾘｱｾﾝｻ遮光
CON
JMP @MR105               ; 105
STG @MR105               ; 105
RES MR50300              ; Pause
CON
RES R50309               ; ERR Rset under input
CON
RES R50212               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
RES R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
RES R49008               ; ｴﾘｱｾﾝｻ遮光
CON
RES R50301               ; Pause
CON
JMP @MR000               ; MAIN PAUSE条件確認へ
END
ENDH
