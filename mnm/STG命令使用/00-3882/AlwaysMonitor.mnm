DEVICE:53
;MODULE:AlwaysMonitor
;MODULE_TYPE:0
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	AlwaysMonitor
;ModuleType	:	Sub Module
;Function	:	常時監視
;---------------------------------------
;Device net nodo check
BLDB DM10014 #0          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BAND DM10014 #1          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BAND DM10014 #2          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BAND DM10014 #3          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BAND DM10014 #4          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BAND DM10014 #5          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #6          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #7          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #8          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #9          ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #10         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #11         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #12         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #13         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #14         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10014 #15         ; 正常通信ﾉｰﾄﾞ一覧(0-15)
BANB DM10015 #0          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #1          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #2          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #3          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BAND DM10015 #4          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BAND DM10015 #5          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BAND DM10015 #6          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #7          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #8          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #9          ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #10         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #11         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #12         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #13         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #14         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10015 #15         ; 正常通信ﾉｰﾄﾞ一覧(16-31)
BANB DM10016 #0          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #1          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #2          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #3          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #4          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #5          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #6          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #7          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BAND DM10016 #8          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BAND DM10016 #9          ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BAND DM10016 #10         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #11         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #12         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #13         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #14         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10016 #15         ; 正常通信ﾉｰﾄﾞ一覧(32-47)
BANB DM10017 #0          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #1          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #2          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #3          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #4          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #5          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #6          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #7          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #8          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #9          ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #10         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #11         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BAND DM10017 #12         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #13         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #14         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
BANB DM10017 #15         ; 正常通信ﾉｰﾄﾞ一覧(48-63)
TMR #500 #10             ; device net ﾉｰﾄﾞ確認
;<使用方法>
;常時監視が必要な物は本ﾓｼﾞｭｰﾙ内に記述して下さい
;・ﾋｰﾀｰ過昇温検知による非常停止
;・ﾁｬﾝﾊﾞｰ排気量低下によるｴﾗｰ出力
;など
;<h1/>常時監視異常
; ｴｱｰ元圧低下
LD CR2007                ; 運転開始時1ｽｷｬﾝOFF
ANB R44302               ; *Group1　ｴｱｰ元圧検出
MEP
LDF R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R44302               ; *Group1　ｴｱｰ元圧検出
ORL
MSTRT F_ERROR_DISP #2
;巻出側 ﾄﾙｸﾓｰﾀ過昇
LDB R1012                ; 巻出側 ﾄﾙｸﾓｰﾀ過昇
MSTRT F_ERROR_DISP #5
;巻取側 ﾄﾙｸﾓｰﾀ過昇
LDB R1013                ; 巻取側 ﾄﾙｸﾓｰﾀ過昇
MSTRT F_ERROR_DISP #6
;ﾌｰﾌﾟ送りﾓｰﾀ過昇
LDB R1108                ; ﾌｰﾌﾟ送りﾓｰﾀ過昇
MSTRT F_ERROR_DISP #7
;巻出側 ﾄﾙｸﾓｰﾀｱﾗｰﾑ
LDB R1110                ; 巻出側 ﾄﾙｸﾓｰﾀｱﾗｰﾑ
MSTRT F_ERROR_DISP #8
;巻取側 ﾄﾙｸﾓｰﾀｱﾗｰﾑ
LDB R1111                ; 巻取側 ﾄﾙｸﾓｰﾀｱﾗｰﾑ
MSTRT F_ERROR_DISP #9
; RB4 BUSYﾌﾗｸﾞ異常停止
LDB DM10525.9            ; RB4 RB_BUSY (RB動作中)
ANB DM10525.13           ; RB4 RB_COMP (RB動作完了)
LD DM10525.9             ; RB4 RB_BUSY (RB動作中)
AND DM10525.13           ; RB4 RB_COMP (RB動作完了)
ORL
AND MR23504              ; RB4 ｺﾝﾄﾛｰﾗ起動完了
AND MR23505              ; D-NET通信状態OK
TMR @9 #1
CON
AND @T9
MSTRT F_ERROR_DISP #14
;<h1/>ｴﾘｱｾﾝｻ異常
LDB R4006                ; 給材側ｴﾘｱｾﾝｻ(L-On)
AND MR9901               ; 給材ｶﾊﾞｰ 開
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
MSTRT F_ERROR_DISP #10
LDB R4007                ; 除材側ｴﾘｱｾﾝｻ(L-On)
AND MR9905               ; 除材ｶﾊﾞｰ 開
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
MSTRT F_ERROR_DISP #11
;<h1/>RB干渉監視
LDB R35202               ; During RB3 MOVE
ANB R35206               ; During RB3 PUSH
ANB R35210               ; During RB3 HOME
INV
AND= EM1072 #41          ; RB4 動作ｺﾏﾝﾄﾞ
LDB R4705                ; ﾌﾟﾚｽ部ﾌﾞﾛｰ 後退限
LD= EM1072 #60           ; RB4 動作ｺﾏﾝﾄﾞ
OR= EM1072 #61           ; RB4 動作ｺﾏﾝﾄﾞ
ANL
ORL
LDB R4700                ; ﾌｨﾙﾀ ﾌﾟﾚｽ切断 上限
AND= EM1072 #61          ; RB4 動作ｺﾏﾝﾄﾞ
AND CR2003               ; 常時OFF
ORL
MSTRT F_ERROR_DISP #15
LD T500                  ; device net ﾉｰﾄﾞ確認
MC
;真空圧低下異常
LDB R4009                ; 元真空検出
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #6 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
;ﾌﾟﾚｽ用圧力低下異常
LDB R4010                ; ﾌﾟﾚｽ用 圧力検出
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #7 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
;ﾌｰﾌﾟ押さえ検出異常
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R39004               ; ｴﾗｰ中
ANB R4607                ; ﾌｰﾌﾟ押さえ 確認
SET R49904               ; TASK4 ｴﾗｰ中
CON
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #103 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
;ﾌｰﾌﾟ終わり検出異常
LDB LR103                ; _割り込みSW4　ON/OFF状態
ANB R4600                ; ﾌｰﾌﾟｴﾝﾄﾞ検出
ANB R4601                ; ﾌｰﾌﾟ つなぎ目 検出
ANB R39004               ; ｴﾗｰ中
AND DM10014.5
SET R49905               ; ﾌｰﾌﾟ終わり検出異常
CON
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #96 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R44200               ; _Grp1 ﾎﾟｰｽﾞ要求
LD R4600                 ; ﾌｰﾌﾟｴﾝﾄﾞ検出
OR R4601                 ; ﾌｰﾌﾟ つなぎ目 検出
ANL
MEP
RES R49905               ; ﾌｰﾌﾟ終わり検出異常
CON
SET MR2100               ; 巻出側 ﾄﾙｸﾓｰﾀｰ CW
CON
SET MR2104               ; 巻取側 ﾄﾙｸﾓｰﾀｰ CW
LDP R49905               ; ﾌｰﾌﾟ終わり検出異常
MCALL HOLD_REQUEST #1
MCALL MODE_INDI #1
LDF R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R49905               ; ﾌｰﾌﾟ終わり検出異常
RES MR2100               ; 巻出側 ﾄﾙｸﾓｰﾀｰ CW
CON
RES MR2104               ; 巻取側 ﾄﾙｸﾓｰﾀｰ CW
MCR
;機種確認
LDP R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
ORP R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LDP R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB LR103                ; _割り込みSW4　ON/OFF状態
ORL
ANB MR9002               ; 型確認OK
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #90 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDP R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
ORP R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LDP R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB LR103                ; _割り込みSW4　ON/OFF状態
ORL
ANB MR9003               ; RB4ﾊﾝﾄﾞ 確認OK
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #91 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
;<h1/>エアークリーンUT異常
LD CR2002                ; 常時ON
TMR @10 #100
CON
AND @T10
OUT MR100                ; エラー監視条件_ON監視
LD MR100                 ; エラー監視条件_ON監視
MC
LDB R1008                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1 ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #2 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1008 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R1009                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1 ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1009 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R1010                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2 ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #4 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1010 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R1011                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2 ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #5 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #1011 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
MCR
STG @MR500
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
ENDS
MPP
AND R49904               ; TASK4 ｴﾗｰ中
RES R49904               ; TASK4 ｴﾗｰ中
;<h1/>▽_異常処理
STG @MR100
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #6 @DM0
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102
CON
SET @MR101
CON
ENDS
;<h1/>Warning表示
;給材ﾄﾚｲ要求
LD MR12015               ; ﾄﾚｲ給材要求
AND=.D DM9000 #0         ; _WARNING1表示状態
@SET @MR300
STG @MR300
MPS
MSTRT WARNING_DISP #1 #1 #1 #1
MPP
BAND.D DM9000 #1         ; _WARNING1表示状態
JMP @MR301
STG @MR301
BANB.D DM9000 #1         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR12015              ; ﾄﾚｲ給材要求
BAND.D DM9000 #1         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #1
;除材ﾄﾚｲ満杯
LD MR14010               ; 除材ﾄﾚｲ満杯
AND=.D DM9000 #0         ; _WARNING1表示状態
@SET @MR304
STG @MR304
MPS
MSTRT WARNING_DISP #1 #2 #1 #1
MPP
BAND.D DM9000 #2         ; _WARNING1表示状態
JMP @MR305
STG @MR305
BANB.D DM9000 #2         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR14010              ; 除材ﾄﾚｲ満杯
BAND.D DM9000 #2         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #2
;仮置ﾄﾚｲ満杯
LD MR12100               ; 仮置ﾄﾚｰ満杯
AND=.D DM9000 #0         ; _WARNING1表示状態
ANB MR12101              ; 仮置ﾄﾚｰ無
ANB MR12102              ; 仮置ﾄﾚｰ機種不一致
ANB MR12103              ; 仮置ﾄﾚｰ 逆入れ
@SET @MR308
STG @MR308
MPS
MSTRT WARNING_DISP #1 #3 #1 #1
MPP
BAND.D DM9000 #3         ; _WARNING1表示状態
JMP @MR309
STG @MR309
BANB.D DM9000 #3         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR12100              ; 仮置ﾄﾚｰ満杯
BAND.D DM9000 #3         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #3
;仮置ﾄﾚｲ無
LD MR12101               ; 仮置ﾄﾚｰ無
AND=.D DM9000 #0         ; _WARNING1表示状態
@SET @MR310
STG @MR310
MPS
MSTRT WARNING_DISP #1 #4 #1 #1
MPP
BAND.D DM9000 #4         ; _WARNING1表示状態
JMP @MR311
STG @MR311
BANB.D DM9000 #4         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR12101              ; 仮置ﾄﾚｰ無
BAND.D DM9000 #4         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #4
;仮置ﾄﾚｲ機種不一致
LD MR12102               ; 仮置ﾄﾚｰ機種不一致
AND=.D DM9000 #0         ; _WARNING1表示状態
@SET @MR312
STG @MR312
MPS
MSTRT WARNING_DISP #1 #5 #1 #1
MPP
BAND.D DM9000 #5         ; _WARNING1表示状態
JMP @MR313
STG @MR313
BANB.D DM9000 #5         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR12102              ; 仮置ﾄﾚｰ機種不一致
BAND.D DM9000 #5         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #5
;仮置ﾄﾚｲ逆入れ
LD MR12103               ; 仮置ﾄﾚｰ 逆入れ
AND=.D DM9000 #0         ; _WARNING1表示状態
@SET @MR314
STG @MR314
MPS
MSTRT WARNING_DISP #1 #6 #1 #1
MPP
BAND.D DM9000 #6         ; _WARNING1表示状態
JMP @MR315
STG @MR315
BANB.D DM9000 #6         ; _WARNING1表示状態
ENDS
LDP R53608               ; _WARN画面消去
ORB MR12103              ; 仮置ﾄﾚｰ 逆入れ
BAND.D DM9000 #6         ; _WARNING1表示状態
MSTRT WARNING_DEL #1 #6
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR12100              ; 仮置ﾄﾚｰ満杯
CON
RES MR12101              ; 仮置ﾄﾚｰ無
CON
RES MR12102              ; 仮置ﾄﾚｰ機種不一致
CON
RES MR12103              ; 仮置ﾄﾚｰ 逆入れ
END
ENDH
