DEVICE:53
;MODULE:BARCODE_FW
;MODULE_TYPE:0
LD R50010                ; Emergency　Stop
OR @MR001                ; 次ｽﾃｯﾌﾟへ
ZRES @MR000 @MR1614      ; 次ｽﾃｯﾌﾟへ  照合終了処理
CON
ANB @T0
OUT @MR001               ; 次ｽﾃｯﾌﾟへ
TMR @0 #5
;ﾃﾞﾊﾞｯｸﾞ用BCR読み込み / BCR Read forDebug
STG @MR000               ; 次ｽﾃｯﾌﾟへ
DW #0 DM0                ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
CON
JMP @MR002               ; 次ｽﾃｯﾌﾟへ
STG @MR002               ; 次ｽﾃｯﾌﾟへ
AND R30301               ; Port2 受信完了
@INC DM0                 ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
CON
JMP @MR003
STG @MR003
SFIND DM30602 DM1240 DM1241 #0;Port2 受信ﾃﾞｰﾀ1  検索用SP  SP位置
MPS
AND= DM0 #1              ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
SMID DM30602 DM257 #0 DM1241;Port2 受信ﾃﾞｰﾀ1  Y InkCode1  SP位置
MRD
AND= DM0 #2              ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
SMID DM30602 DM241 #0 DM1241;Port2 受信ﾃﾞｰﾀ1  M InkCode1  SP位置
MRD
AND= DM0 #3              ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
SMID DM30602 DM225 #0 DM1241;Port2 受信ﾃﾞｰﾀ1  C InkCode1  SP位置
MRD
AND= DM0 #4              ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
SMID DM30602 DM273 #0 DM1241;Port2 受信ﾃﾞｰﾀ1  BK InkCode1  SP位置
MPP
JMP @MR004
STG @MR004
RES R30301               ; Port2 受信完了
CON
MPS
AND< DM0 #4              ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
JMP @MR002               ; 次ｽﾃｯﾌﾟへ
MPP
AND>= DM0 #4             ; OFFﾗｲﾝ用ﾃﾞｰﾀ読込回数
JMP @MR005
STG @MR005
SET R51202               ; Model No 比較要求
CON
TMR @2 #2                ; Wait Time
CON
AND @T2                  ; Wait Time
JMP @MR006
STG @MR006
RES R51202               ; Model No 比較要求
CON
ENDS
;<h1/>照合要求確認
LDB MR1205               ; Y 照合中  
ANB MR1405               ; M 照合中  
ANB MR1605               ; C 照合中  
ANB MR1805               ; B 照合中  
INV
OUT MR1102               ; BCR照合中
OUT MR12112              ; 照合要求画面表示
LD CR2008                ; 運転開始時1ｽｷｬﾝON
ORF @MR001               ; 次ｽﾃｯﾌﾟへ
SET @MR900               ; 照合要求待ち YELLOW
STG @MR900               ; 照合要求待ち YELLOW
ANB MR1102               ; BCR照合中
MPS
LD MR1200                ; Y 照合要求(HOME)
OR MR1201                ; Y 照合要求(KD交換1)
OR MR1202                ; Y 照合要求(KD交換2)
ANL
ZRES MR1306 MR1307       ; (Y)ｻﾌﾞﾀﾝｸ照合完了  (Y)KDﾄﾞﾗﾑ照合完了
CON
ZRES @MR100 @MR415       ; CELL選択中
CON
SET MR1205               ; Y 照合中  
CON
ZRES MR1206 MR1207       ; Y 照合異常  Y 照合OK  
CON
JMP @MR1000              ; 照合 YELLOW
MPP
LDB MR1200               ; Y 照合要求(HOME)
ANB MR1201               ; Y 照合要求(KD交換1)
ANB MR1202               ; Y 照合要求(KD交換2)
ANL
JMP @MR901               ; 照合要求待ち Magenta
STG @MR901               ; 照合要求待ち Magenta
ANB MR1102               ; BCR照合中
MPS
LD MR1400                ; M 照合要求(HOME)
OR MR1401                ; M 照合要求(KD交換1)
OR MR1402                ; M 照合要求(KD交換2)
ANL
ZRES MR1506 MR1507       ; (M)ｻﾌﾞﾀﾝｸ照合完了  (M)KDﾄﾞﾗﾑ照合完了
CON
ZRES @MR100 @MR415       ; CELL選択中
CON
SET MR1405               ; M 照合中  
CON
ZRES MR1406 MR1407       ; M 照合異常  M 照合OK  
CON
JMP @MR1200              ; 照合 MAGENTA
MPP
LDB MR1400               ; M 照合要求(HOME)
ANB MR1401               ; M 照合要求(KD交換1)
ANB MR1402               ; M 照合要求(KD交換2)
ANL
JMP @MR902               ; 照合要求待ち CYAN
STG @MR902               ; 照合要求待ち CYAN
ANB MR1102               ; BCR照合中
MPS
LD MR1600                ; C 照合要求(HOME)
OR MR1601                ; C 照合要求(KD交換1)
OR MR1602                ; C 照合要求(KD交換2)
ANL
ZRES MR1706 MR1707       ; (C)ｻﾌﾞﾀﾝｸ照合完了  (C)KDﾄﾞﾗﾑ照合完了
CON
ZRES @MR100 @MR415       ; CELL選択中
CON
SET MR1605               ; C 照合中  
CON
ZRES MR1606 MR1607       ; C 照合異常  C 照合OK  
CON
JMP @MR1400              ; 照合 CYAN
MPP
LDB MR1600               ; C 照合要求(HOME)
ANB MR1601               ; C 照合要求(KD交換1)
ANB MR1602               ; C 照合要求(KD交換2)
ANL
JMP @MR903               ; 照合要求待ち BLACK
STG @MR903               ; 照合要求待ち BLACK
ANB MR1102               ; BCR照合中
MPS
LD MR1800                ; B 照合要求(HOME)
OR MR1801                ; B 照合要求(KD交換1)
OR MR1802                ; B 照合要求(KD交換2)
ANL
ZRES MR1906 MR1907       ; (B)ｻﾌﾞﾀﾝｸ照合完了  (B)KDﾄﾞﾗﾑ照合完了
CON
ZRES @MR100 @MR415       ; CELL選択中
CON
SET MR1805               ; B 照合中  
CON
ZRES MR1806 MR1807       ; B 照合異常  B 照合OK  
CON
JMP @MR1600              ; 照合 BLACK
MPP
LDB MR1800               ; B 照合要求(HOME)
ANB MR1801               ; B 照合要求(KD交換1)
ANB MR1802               ; B 照合要求(KD交換2)
ANL
JMP @MR900               ; 照合要求待ち YELLOW
;<h1/> 1)YELLOW
;BCR照合 / BARCODE Forwarding
STG @MR1000              ; 照合 YELLOW
MPS
SET MR2011               ; Rainbow lamp Red
CON
SET MR2012               ; Rainbow lamp Green
CON
JMP @MR1001              ; 次ｽﾃｯﾌﾟへ
MPP
FMOV #0 DM1250 #7        ; ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
STG @MR1001              ; 次ｽﾃｯﾌﾟへ
SET @MR300               ; BCR読み込み
CON
JMP @MR1002              ; 次ｽﾃｯﾌﾟへ
STG @MR1002              ; 次ｽﾃｯﾌﾟへ
MPS
AND @MR301               ; BCR読み込み完了
MPS
RES @MR301               ; BCR読み込み完了
CON
JMP @MR1003              ; 次ｽﾃｯﾌﾟへ
MPP
BMOV DM1300 DM1320 DM1298; 読込 Code 先頭  読込 YELLOW Code 先頭  読取Code 桁数
MPP
AND @MR303               ; BCR読み込み異常
RES @MR303               ; BCR読み込み異常
CON
JMP @MR1000              ; 照合 YELLOW
;照合判定 / Judge
STG @MR1003              ; 次ｽﾃｯﾌﾟへ
MPS
SCMP DM257 DM1250        ; Y InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
AND MR1200               ; Y 照合要求(HOME)
MPS
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
SET MR1306               ; (Y)ｻﾌﾞﾀﾝｸ照合完了
CON
JMP @MR1004              ; 照合箇所ﾁｪｯｸ
MPP
AND MR1106               ; KDﾄﾞﾗﾑ読み込み
MPS
SET MR1307               ; (Y)KDﾄﾞﾗﾑ照合完了
CON
JMP @MR1004              ; 照合箇所ﾁｪｯｸ
MPP
BMOV DM1320 DM1340 DM1298; 読込 YELLOW Code 先頭  前回 YELLOW Code 先頭  読取Code 桁数
MRD
AND MR1201               ; Y 照合要求(KD交換1)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1008              ; 交換1 ｺｰﾄﾞ非同一確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1013              ; 照合NG
MPP
AND MR1202               ; Y 照合要求(KD交換2)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1009              ; 交換2 ｺｰﾄﾞ一致確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1013              ; 照合NG
MPP
SCMP DM1250 DM257        ; ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ  Y InkCode1
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1013              ; 照合NG
;初回照合時　ｻﾌﾞﾀﾝｸ・KDﾄﾞﾗﾑ照合完了ﾁｪｯｸ
STG @MR1004              ; 照合箇所ﾁｪｯｸ
MPS
LD MR1306                ; (Y)ｻﾌﾞﾀﾝｸ照合完了
AND MR1307               ; (Y)KDﾄﾞﾗﾑ照合完了
ANL
SET MR1207               ; Y 照合OK  
CON
JMP @MR1014              ; 照合終了処理
MPP
LDB MR1306               ; (Y)ｻﾌﾞﾀﾝｸ照合完了
ORB MR1307               ; (Y)KDﾄﾞﾗﾑ照合完了
ANL
JMP @MR1000              ; 照合 YELLOW
;交換開始時　前回と不一致確認
STG @MR1008              ; 交換1 ｺｰﾄﾞ非同一確認
SCMP DM1320 DM1340       ; 読込 YELLOW Code 先頭  前回 YELLOW Code 先頭
CON
MPS
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1012              ; 照合OK
MPP
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1013              ; 照合NG
;交換終了時　交換開始時と一致確認
STG @MR1009              ; 交換2 ｺｰﾄﾞ一致確認
SCMP DM1320 DM1340       ; 読込 YELLOW Code 先頭  前回 YELLOW Code 先頭
CON
MPS
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1012              ; 照合OK
MPP
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1013              ; 照合NG
;照合OK処理
STG @MR1012              ; 照合OK
MPS
SET MR1207               ; Y 照合OK  
CON
JMP @MR1014              ; 照合終了処理
MPP
BMOV DM1320 DM1340 DM1298; 読込 YELLOW Code 先頭  前回 YELLOW Code 先頭  読取Code 桁数
;照合異常処理
STG @MR1013              ; 照合NG
SET MR1206               ; Y 照合異常
CON
JMP @MR1014              ; 照合終了処理
;終了処理
STG @MR1014              ; 照合終了処理
RES MR2011               ; Rainbow lamp Red
CON
RES MR2012               ; Rainbow lamp Green
CON
SET MR1204               ; Y 照合完了
CON
RES MR1205               ; Y 照合中  
CON
JMP @MR1015
STG @MR1015
ANB MR1200               ; Y 照合要求(HOME)
ANB MR1201               ; Y 照合要求(KD交換1)
ANB MR1202               ; Y 照合要求(KD交換2)
JMP @MR900               ; 照合要求待ち YELLOW
;<h1/> 2)MAGENTA
;BCR照合 / BARCODE Forwarding
STG @MR1200              ; 照合 MAGENTA
MPS
SET MR2011               ; Rainbow lamp Red
CON
JMP @MR1201              ; 次ｽﾃｯﾌﾟへ
MPP
FMOV #0 DM1250 #7        ; ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
STG @MR1201              ; 次ｽﾃｯﾌﾟへ
SET @MR300               ; BCR読み込み
CON
JMP @MR1202              ; 次ｽﾃｯﾌﾟへ
STG @MR1202              ; 次ｽﾃｯﾌﾟへ
MPS
AND @MR301               ; BCR読み込み完了
MPS
RES @MR301               ; BCR読み込み完了
CON
JMP @MR1203              ; 次ｽﾃｯﾌﾟへ
MPP
BMOV DM1300 DM1360 DM1298; 読込 Code 先頭  読込 MAGENTA Code 先頭  読取Code 桁数
MPP
AND @MR303               ; BCR読み込み異常
RES @MR303               ; BCR読み込み異常
CON
JMP @MR1200              ; 照合 MAGENTA
;照合判定 / Judge
STG @MR1203              ; 次ｽﾃｯﾌﾟへ
MPS
SCMP DM241 DM1250        ; M InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
AND MR1400               ; M 照合要求(HOME)
MPS
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
SET MR1506               ; (M)ｻﾌﾞﾀﾝｸ照合完了
CON
JMP @MR1204              ; 照合箇所ﾁｪｯｸ
MPP
AND MR1106               ; KDﾄﾞﾗﾑ読み込み
MPS
SET MR1507               ; (M)KDﾄﾞﾗﾑ照合完了
CON
JMP @MR1204              ; 照合箇所ﾁｪｯｸ
MPP
BMOV DM1360 DM1380 DM1298; 読込 MAGENTA Code 先頭  前回 MAGENTA Code 先頭  読取Code 桁数
MRD
AND MR1401               ; M 照合要求(KD交換1)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1208              ; 交換1 ｺｰﾄﾞ非同一確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1213              ; 照合NG
MPP
AND MR1402               ; M 照合要求(KD交換2)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1209              ; 交換2 ｺｰﾄﾞ一致確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1213              ; 照合NG
MPP
SCMP DM241 DM1250        ; M InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1213              ; 照合NG
;初回照合時　ｻﾌﾞﾀﾝｸ・KDﾄﾞﾗﾑ照合完了ﾁｪｯｸ
STG @MR1204              ; 照合箇所ﾁｪｯｸ
MPS
LD MR1506                ; (M)ｻﾌﾞﾀﾝｸ照合完了
AND MR1507               ; (M)KDﾄﾞﾗﾑ照合完了
ANL
SET MR1407               ; M 照合OK  
CON
JMP @MR1214              ; 照合終了処理
MPP
LDB MR1506               ; (M)ｻﾌﾞﾀﾝｸ照合完了
ORB MR1507               ; (M)KDﾄﾞﾗﾑ照合完了
ANL
JMP @MR1200              ; 照合 MAGENTA
;交換開始時　前回と不一致確認
STG @MR1208              ; 交換1 ｺｰﾄﾞ非同一確認
SCMP DM1360 DM1380       ; 読込 MAGENTA Code 先頭  前回 MAGENTA Code 先頭
CON
MPS
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1212              ; 照合OK
MPP
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1213              ; 照合NG
;交換終了時　交換開始時と一致確認
STG @MR1209              ; 交換2 ｺｰﾄﾞ一致確認
SCMP DM1360 DM1380       ; 読込 MAGENTA Code 先頭  前回 MAGENTA Code 先頭
CON
MPS
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1212              ; 照合OK
MPP
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1213              ; 照合NG
;照合OK処理
STG @MR1212              ; 照合OK
MPS
SET MR1407               ; M 照合OK  
CON
JMP @MR1214              ; 照合終了処理
MPP
BMOV DM1360 DM1380 DM1298; 読込 MAGENTA Code 先頭  前回 MAGENTA Code 先頭  読取Code 桁数
;照合異常処理
STG @MR1213              ; 照合NG
SET MR1406               ; M 照合異常
CON
JMP @MR1214              ; 照合終了処理
;終了処理
STG @MR1214              ; 照合終了処理
RES MR2011               ; Rainbow lamp Red
CON
SET MR1404               ; M 照合完了
CON
RES MR1405               ; M 照合中  
CON
JMP @MR1215
STG @MR1215
ANB MR1400               ; M 照合要求(HOME)
ANB MR1401               ; M 照合要求(KD交換1)
ANB MR1402               ; M 照合要求(KD交換2)
JMP @MR900               ; 照合要求待ち YELLOW
;<h1/> 3)CYAN
;BCR照合 / BARCODE Forwarding
STG @MR1400              ; 照合 CYAN
MPS
SET MR2013               ; Rainbow lamp Blue
CON
JMP @MR1401              ; 次ｽﾃｯﾌﾟへ
MPP
FMOV #0 DM1250 #7        ; ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
STG @MR1401              ; 次ｽﾃｯﾌﾟへ
SET @MR300               ; BCR読み込み
CON
JMP @MR1402              ; 次ｽﾃｯﾌﾟへ
STG @MR1402              ; 次ｽﾃｯﾌﾟへ
MPS
AND @MR301               ; BCR読み込み完了
MPS
RES @MR301               ; BCR読み込み完了
CON
JMP @MR1403              ; 次ｽﾃｯﾌﾟへ
MPP
BMOV DM1300 DM1400 DM1298; 読込 Code 先頭  読込 CYAN Code 先頭  読取Code 桁数
MPP
AND @MR303               ; BCR読み込み異常
RES @MR303               ; BCR読み込み異常
CON
JMP @MR1400              ; 照合 CYAN
;照合判定 / Judge
STG @MR1403              ; 次ｽﾃｯﾌﾟへ
MPS
SCMP DM225 DM1250        ; C InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
AND MR1600               ; C 照合要求(HOME)
MPS
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
SET MR1706               ; (C)ｻﾌﾞﾀﾝｸ照合完了
CON
JMP @MR1404              ; 照合箇所ﾁｪｯｸ
MPP
AND MR1106               ; KDﾄﾞﾗﾑ読み込み
MPS
SET MR1707               ; (C)KDﾄﾞﾗﾑ照合完了
CON
JMP @MR1404              ; 照合箇所ﾁｪｯｸ
MPP
BMOV DM1400 DM1420 DM1298; 読込 CYAN Code 先頭  前回 CYAN Code 先頭  読取Code 桁数
MRD
AND MR1601               ; C 照合要求(KD交換1)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1408              ; 交換1 ｺｰﾄﾞ非同一確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1413              ; 照合NG
MPP
AND MR1602               ; C 照合要求(KD交換2)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1409              ; 交換2 ｺｰﾄﾞ一致確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1413              ; 照合NG
MPP
SCMP DM225 DM1250        ; C InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1413              ; 照合NG
;初回照合時　ｻﾌﾞﾀﾝｸ・KDﾄﾞﾗﾑ照合完了ﾁｪｯｸ
STG @MR1404              ; 照合箇所ﾁｪｯｸ
MPS
LD MR1706                ; (C)ｻﾌﾞﾀﾝｸ照合完了
AND MR1707               ; (C)KDﾄﾞﾗﾑ照合完了
ANL
SET MR1607               ; C 照合OK  
CON
JMP @MR1414              ; 照合終了処理
MPP
LDB MR1706               ; (C)ｻﾌﾞﾀﾝｸ照合完了
ORB MR1707               ; (C)KDﾄﾞﾗﾑ照合完了
ANL
JMP @MR1400              ; 照合 CYAN
;交換開始時　前回と不一致確認
STG @MR1408              ; 交換1 ｺｰﾄﾞ非同一確認
SCMP DM1400 DM1420       ; 読込 CYAN Code 先頭  前回 CYAN Code 先頭
CON
MPS
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1412              ; 照合OK
MPP
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1413              ; 照合NG
;交換終了時　交換開始時と一致確認
STG @MR1409              ; 交換2 ｺｰﾄﾞ一致確認
SCMP DM1400 DM1420       ; 読込 CYAN Code 先頭  前回 CYAN Code 先頭
CON
MPS
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1412              ; 照合OK
MPP
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1413              ; 照合NG
;照合OK処理
STG @MR1412              ; 照合OK
MPS
SET MR1607               ; C 照合OK  
CON
JMP @MR1414              ; 照合終了処理
MPP
BMOV DM1400 DM1420 DM1298; 読込 CYAN Code 先頭  前回 CYAN Code 先頭  読取Code 桁数
;照合異常処理
STG @MR1413              ; 照合NG
SET MR1606               ; C 照合異常
CON
JMP @MR1414              ; 照合終了処理
;終了処理
STG @MR1414              ; 照合終了処理
RES MR2013               ; Rainbow lamp Blue
CON
SET MR1604               ; C 照合完了
CON
RES MR1605               ; C 照合中  
CON
JMP @MR1415
STG @MR1415
ANB MR1600               ; C 照合要求(HOME)
ANB MR1601               ; C 照合要求(KD交換1)
ANB MR1602               ; C 照合要求(KD交換2)
JMP @MR900               ; 照合要求待ち YELLOW
;<h1/> 4)BLACK
;BCR照合 / BARCODE Forwarding
STG @MR1600              ; 照合 BLACK
MPS
SET MR2011               ; Rainbow lamp Red
CON
SET MR2012               ; Rainbow lamp Green
CON
SET MR2013               ; Rainbow lamp Blue
CON
JMP @MR1601              ; 次ｽﾃｯﾌﾟへ
MPP
FMOV #0 DM1250 #7        ; ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
STG @MR1601              ; 次ｽﾃｯﾌﾟへ
SET @MR300               ; BCR読み込み
CON
JMP @MR1602              ; 次ｽﾃｯﾌﾟへ
STG @MR1602              ; 次ｽﾃｯﾌﾟへ
MPS
AND @MR301               ; BCR読み込み完了
MPS
RES @MR301               ; BCR読み込み完了
CON
JMP @MR1603              ; 次ｽﾃｯﾌﾟへ
MPP
BMOV DM1300 DM1440 DM1298; 読込 Code 先頭  読込 BLACK Code 先頭  読取Code 桁数
MPP
AND @MR303               ; BCR読み込み異常
RES @MR303               ; BCR読み込み異常
CON
JMP @MR1600              ; 照合 BLACK
;照合判定 / Judge
STG @MR1603              ; 次ｽﾃｯﾌﾟへ
MPS
SCMP DM273 DM1250        ; BK InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
AND MR1800               ; B 照合要求(HOME)
MPS
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
SET MR1906               ; (B)ｻﾌﾞﾀﾝｸ照合完了
CON
JMP @MR1604              ; 照合箇所ﾁｪｯｸ
MPP
AND MR1106               ; KDﾄﾞﾗﾑ読み込み
MPS
SET MR1907               ; (B)KDﾄﾞﾗﾑ照合完了
CON
JMP @MR1604              ; 照合箇所ﾁｪｯｸ
MPP
BMOV DM1440 DM1460 DM1298; 読込 BLACK Code 先頭  前回 BLACK Code 先頭  読取Code 桁数
MRD
AND MR1801               ; B 照合要求(KD交換1)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1608              ; 交換1 ｺｰﾄﾞ非同一確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1613              ; 照合NG
MPP
AND MR1802               ; B 照合要求(KD交換2)
MPS
ANB MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1609              ; 交換2 ｺｰﾄﾞ一致確認
MPP
AND MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
JMP @MR1613              ; 照合NG
MPP
SCMP DM273 DM1250        ; BK InkCode1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1613              ; 照合NG
;初回照合時　ｻﾌﾞﾀﾝｸ・KDﾄﾞﾗﾑ照合完了ﾁｪｯｸ
STG @MR1604              ; 照合箇所ﾁｪｯｸ
MPS
LD MR1906                ; (B)ｻﾌﾞﾀﾝｸ照合完了
AND MR1907               ; (B)KDﾄﾞﾗﾑ照合完了
ANL
SET MR1807               ; B 照合OK  
CON
JMP @MR1614              ; 照合終了処理
MPP
LDB MR1906               ; (B)ｻﾌﾞﾀﾝｸ照合完了
ORB MR1907               ; (B)KDﾄﾞﾗﾑ照合完了
ANL
JMP @MR1600              ; 照合 BLACK
;交換開始時　前回と不一致確認
STG @MR1608              ; 交換1 ｺｰﾄﾞ非同一確認
SCMP DM1440 DM1460       ; 読込 BLACK Code 先頭  前回 BLACK Code 先頭
CON
MPS
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1612              ; 照合OK
MPP
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1613              ; 照合NG
;交換終了時　交換開始時と一致確認
STG @MR1609              ; 交換2 ｺｰﾄﾞ一致確認
SCMP DM1440 DM1460       ; 読込 BLACK Code 先頭  前回 BLACK Code 先頭
CON
MPS
AND CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1612              ; 照合OK
MPP
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR1613              ; 照合NG
;照合OK処理
STG @MR1612              ; 照合OK
MPS
SET MR1807               ; B 照合OK  
CON
JMP @MR1614              ; 照合終了処理
MPP
BMOV DM1440 DM1460 DM1298; 読込 BLACK Code 先頭  前回 BLACK Code 先頭  読取Code 桁数
;照合異常処理
STG @MR1613              ; 照合NG
SET MR1806               ; B 照合異常
CON
JMP @MR1614              ; 照合終了処理
;終了処理
STG @MR1614              ; 照合終了処理
RES MR2011               ; Rainbow lamp Red
CON
RES MR2012               ; Rainbow lamp Green
CON
RES MR2013               ; Rainbow lamp Blue
CON
SET MR1804               ; B 照合完了  
CON
RES MR1805               ; B 照合中  
CON
JMP @MR1615
STG @MR1615
ANB MR1800               ; B 照合要求(HOME)
ANB MR1801               ; B 照合要求(KD交換1)
ANB MR1802               ; B 照合要求(KD交換2)
JMP @MR900               ; 照合要求待ち YELLOW
;<h1/>BCR読み込み / BCR Read
STG @MR300               ; BCR読み込み
RES R30301               ; Port2 受信完了
CON
ANB R30301               ; Port2 受信完了
JMP @MR304               ; 次ｽﾃｯﾌﾟへ
STG @MR304               ; 次ｽﾃｯﾌﾟへ
AND R30301               ; Port2 受信完了
RES R30301               ; Port2 受信完了
CON
SET @MR302               ; BCR読み込み中
CON
JMP @MR305               ; 次ｽﾃｯﾌﾟへ
STG @MR305               ; 次ｽﾃｯﾌﾟへ
LDA DM30601              ; Port2 受信ﾃﾞｰﾀ長
CON
MPS
CMP #18
CON
AND CR2010               ; 演算結果がｾﾞﾛ
RES MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
CON
SET MR1106               ; KDﾄﾞﾗﾑ読み込み
CON
JMP @MR307               ; 次ｽﾃｯﾌﾟへ
MPP
CMP #18
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
JMP @MR306               ; 次ｽﾃｯﾌﾟへ
STG @MR306               ; 次ｽﾃｯﾌﾟへ
LDA DM30601              ; Port2 受信ﾃﾞｰﾀ長
CON
MPS
CMP #10
CON
AND CR2010               ; 演算結果がｾﾞﾛ
RES MR1106               ; KDﾄﾞﾗﾑ読み込み
CON
SET MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
CON
JMP @MR307               ; 次ｽﾃｯﾌﾟへ
MPP
CMP #10
CON
ANB CR2010               ; 演算結果がｾﾞﾛ
RES MR1105               ; ｻﾌﾞﾀﾝｸ読み込み
CON
RES MR1106               ; KDﾄﾞﾗﾑ読み込み
CON
JMP @MR400               ; BCR入力ﾐｽ表示へ
STG @MR307               ; 次ｽﾃｯﾌﾟへ
JMP @MR308               ; 次ｽﾃｯﾌﾟへ
SFIND DM30602 DM1240 DM1241 #0;Port2 受信ﾃﾞｰﾀ1  検索用SP  SP位置
SMID DM30602 DM1250 #0 DM1241;Port2 受信ﾃﾞｰﾀ1  ﾀﾝｸBCR入力ﾃﾞｰﾀﾊﾞｯﾌｧ  SP位置
MOV DM30601 DM1298       ; Port2 受信ﾃﾞｰﾀ長  読取Code 桁数
BMOV DM30602 DM1300 DM1298;Port2 受信ﾃﾞｰﾀ1  読込 Code 先頭  読取Code 桁数
STG @MR308               ; 次ｽﾃｯﾌﾟへ
SET @MR301               ; BCR読み込み完了
CON
RES @MR302               ; BCR読み込み中
CON
ENDS
STG @MR400               ; BCR入力ﾐｽ表示へ
OUT MR1100               ; BCR入力ﾐｽ出力時間
MPS
TMR #100 #9999           ; 入力ﾐｽ出力時間
MPP
AND T100                 ; 入力ﾐｽ出力時間
RES R30301               ; Port2 受信完了
CON
JMP @MR401               ; BCR入力ﾐｽ
STG @MR401               ; BCR入力ﾐｽ
SET @MR303               ; BCR読み込み異常
CON
RES @MR302               ; BCR読み込み中
CON
ENDS
;***** MODEL NO 比較  / MODEL NO comparision  ******
LD MR1101                ; 機種変更
MPS
AND= DM287 #1            ; ModelIdentficationNumber
RES MR1209               ; (Y) 照合要求FLG
CON
RES MR1409               ; (M) 照合要求FLG
CON
RES MR1609               ; (C) 照合要求FLG
CON
SET MR1809               ; (B) 照合要求FLG
MRD
AND= DM287 #2            ; ModelIdentficationNumber
SET MR1209               ; (Y) 照合要求FLG
CON
SET MR1409               ; (M) 照合要求FLG
CON
SET MR1609               ; (C) 照合要求FLG
CON
RES MR1809               ; (B) 照合要求FLG
MPP
AND= DM287 #3            ; ModelIdentficationNumber
SET MR1209               ; (Y) 照合要求FLG
CON
SET MR1409               ; (M) 照合要求FLG
CON
SET MR1609               ; (C) 照合要求FLG
CON
SET MR1809               ; (B) 照合要求FLG
LD CR2008                ; 運転開始時1ｽｷｬﾝON
ORP R50003               ; HOME
LD= DM287 #1             ; ModelIdentficationNumber
ANF MR1809               ; (B) 照合要求FLG
ORL
LD= DM287 #2             ; ModelIdentficationNumber
ANB MR1209               ; (Y) 照合要求FLG
ANB MR1409               ; (M) 照合要求FLG
ANB MR1609               ; (C) 照合要求FLG
MEF
ORL
LD= DM287 #3             ; ModelIdentficationNumber
ANB MR1209               ; (Y) 照合要求FLG
ANB MR1409               ; (M) 照合要求FLG
ANB MR1609               ; (C) 照合要求FLG
ANB MR1809               ; (B) 照合要求FLG
MEF
ORL
ORF MR1101               ; 機種変更
MOV DM200 DM1480         ; Model No  Host MODEL NO STR
MOV DM287 DM1482         ; ModelIdentficationNumber  ModelIdentficationNumber STR
LDB MR1211               ; (Y) KDﾄﾞﾗﾑ攪拌中
ANB MR1212               ; (Y) ｻﾌﾞﾀﾝｸ攪拌中
ANB MR1411               ; (M) KDﾄﾞﾗﾑ攪拌中
ANB MR1412               ; (M) ｻﾌﾞﾀﾝｸ攪拌中
ANB MR1611               ; (C) KDﾄﾞﾗﾑ攪拌中
ANB MR1612               ; (C) ｻﾌﾞﾀﾝｸ攪拌中
ANB MR1811               ; (B) KDﾄﾞﾗﾑ攪拌中
ANB MR1812               ; (B) ｻﾌﾞﾀﾝｸ攪拌中
ANB R50004               ; TASKDO
AND R50007               ; 原点復帰　完了
LD<> DM200 DM1480        ; Model No  Host MODEL NO STR
OR<> DM287 DM1482        ; ModelIdentficationNumber  ModelIdentficationNumber STR
ANL
TMR @31 #10              ; ﾀｲﾐﾝｸﾞ
CON
AND @T31                 ; ﾀｲﾐﾝｸﾞ
DIFU MR1101              ; 機種変更
;***** ｻﾃﾗｲﾄ各種設定ﾒﾆｭｰ 選択画面表示  / Satellite setting menu selection  ******
;
LD R41005                ; 各種設定ﾒﾆｭｰ起動SW
TMR @5 #30               ; ﾀﾝｸ入力ｴﾗｰ出力
CON
AND @T5                  ; ﾀﾝｸ入力ｴﾗｰ出力
ANB R41008               ; 各種設定ﾒﾆｭｰ画面表示
SET R41008               ; 各種設定ﾒﾆｭｰ画面表示
LDF R41013               ; 各種設定ﾒﾆｭｰ画面表示閉
RES R41008               ; 各種設定ﾒﾆｭｰ画面表示
END
ENDH
