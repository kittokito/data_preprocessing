DEVICE:53
;MODULE:Prameter
;MODULE_TYPE:0
;SCRIPT_TYPE:
LD CR2003                ; 常時OFF
AND= DM4000 #3           ; TP 現在表示中画面
@DW #1 LR41100           ; AUTO-0    Normal
CON
@DW #1 LR44100           ; AUTO PARA01 memory
CON
@DW #0 DM5060            ; ﾊﾟﾗﾒｰﾀNo 格納
CON
@DW #7 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
;AUTO_PARAMETER_CONTROL
;***** AUTO Parameter Control *****
LD CR2002                ; 常時ON
LD= DM4000 #321          ; TP 現在表示中画面
OR= DM4000 #322          ; TP 現在表示中画面
ANL
AND<> #0 R41100          ; ｱﾗｰﾑ ﾘｰｸSW有効
SET R41707               ; Parameter変更有り
CON
@MOV R41100 LR41100      ; ｱﾗｰﾑ ﾘｰｸSW有効  AUTO-0    Normal
@MOV R41100 R44100       ; ｱﾗｰﾑ ﾘｰｸSW有効  AUTO PARA01
LDP R41708               ; TPﾖﾘ AUTO Parameter 決定SW
MPS
AND R41707               ; Parameter変更有り
@LDA R44100              ; AUTO PARA01
CON
@DMX
CON
@STA DM5060              ; ﾊﾟﾗﾒｰﾀNo 格納
CON
@DW #7 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
RES R41707               ; Parameter変更有り
CON
@MOV R44100 LR44100      ; AUTO PARA01  AUTO PARA01 memory
MPP
ANB R41707               ; Parameter変更有り
@LDA LR44100             ; AUTO PARA01 memory
CON
@STA R44100              ; AUTO PARA01
CON
@LDA R44100              ; AUTO PARA01
CON
@DMX
CON
@STA DM5060              ; ﾊﾟﾗﾒｰﾀNo 格納
CON
@DW #7 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
@MOV R44100 LR44100      ; AUTO PARA01  AUTO PARA01 memory
LDP R41709               ; TPﾖﾘ AUTO Parameter 戻る SW
RES R41707               ; Parameter変更有り
CON
@MOV LR44100 LR41100     ; AUTO PARA01 memory  AUTO-0    Normal
;***** STEP Parameter Control *****
LD<> R40100 #0           ; STEP selection -0
@MOV R40100 LR40100      ; STEP selection -0  STEP ST1 選択 flag
LDP R41713               ; STEP Stage選択 戻る SW
@MOV LR43100 LR40100     ; STEP ST1選択 memory  STEP ST1 選択 flag
LDP R41714               ; STEP Parameter 決定SW
@MOV LR40100 LR43100     ; STEP ST1 選択 flag  STEP ST1選択 memory
;**** Step-parameter ****    変数宣言 Zs:Offset STEP Parameter
LD<> LR40100 #0          ; STEP ST1 選択 flag
ENCO LR40100 #15         ; STEP ST1 選択 flag
CON
ADD #1
CON
STA DM5048               ; Setting Offset Step Parameter
;IF LR40100:(Zs-1) = On THEN
;	IF DM4000 >= 401 + (Zs*10) AND DM4000 < 403 + (Zs*10) AND R40200.U:((Zs-1)*16) <> 0 THEN
;		SET(R41707)
;		LR40100.U:(Zs*16) = R40100.U:(Zs*16)
;		R43100.U:(Zs*16) =R40100.U:(Zs*16)
;	END IF
;	
;	IF DM4000 = 439 AND R41300.U <> 0 THEN
;		SET(R41707)
;		LR41300.U = R41300.U
;	END IF
;	
;END IF 
LD CR2002                ; 常時ON
NCJ #1000
;IF LR40100:(Zs-1) = On THEN
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
SUB.L +1
CON
STA.L Z12
LD LR40100:Z12           ; STEP ST1 選択 flag
NCJ #2000
;	IF DM4000 >= 401 + (Zs*10) AND DM4000 < 403 + (Zs*10) AND R40200.U:((Zs-1)*16) <> 0 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +10
CON
ADD.L +401
CON
STA.L @VM0
CON
LDA DM4000               ; TP 現在表示中画面
CON
EXT
CON
CMP.L @VM0
LDB CR2009               ; 演算結果が負
OUT @VB00
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +10
CON
ADD.L +403
CON
STA.L @VM2
CON
LDA DM4000               ; TP 現在表示中画面
CON
EXT
CON
CMP.L @VM2
LD CR2009                ; 演算結果が負
AND @VB00
OUT @VB01
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
SUB.L +1
CON
MUL.L +16
CON
STA.L Z12
LD<> R40200:Z12 #0       ; ST1 STEP-01 SW
AND @VB01
NCJ #2001
;		SET(R41707)
;
LD CR2002                ; 常時ON
SET R41707               ; Parameter変更有り
;		LR40100.U:(Zs*16) = R40100.U:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
MOV R40100:Z12 LR40100:Z11;STEP selection -0  STEP ST1 選択 flag
;		R43100.U:(Zs*16) =R40100.U:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
MOV R40100:Z12 R43100:Z11; STEP selection -0  STEP INDEX-0確定
;	END IF
;
LABEL #2001
;	IF DM4000 = 439 AND R41300.U <> 0 THEN
;
LD= DM4000 #439          ; TP 現在表示中画面
OUT @VB02
LD<> R41300 #0           ; INK ALL SELECT SW
AND @VB02
NCJ #2002
;		SET(R41707)
;
LD CR2002                ; 常時ON
SET R41707               ; Parameter変更有り
;		LR41300.U = R41300.U
;
LD CR2002                ; 常時ON
MOV R41300 LR41300       ; INK ALL SELECT SW  INK ALL SELECT 
;	END IF
;
LABEL #2002
;END IF 
LABEL #2000
LABEL #1000
;
;DM5060 =DMX(R43100.U:(Zs*16))
;LR43100.U:(Zs*16) = R43100.U:(Zs*16)
;
;LR44300.U = R41300.U
;
;RES(R41707)
LDP R41714               ; STEP Parameter 決定SW
DW #10 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
AND R41707               ; Parameter変更有り
NCJ #1001
;DM5060 =DMX(R43100.U:(Zs*16))
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
LDA R43100:Z12           ; STEP INDEX-0確定
CON
DMX
CON
STA DM5060               ; ﾊﾟﾗﾒｰﾀNo 格納
;LR43100.U:(Zs*16) = R43100.U:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
MOV R43100:Z12 LR43100:Z11;STEP INDEX-0確定  STEP ST1選択 memory
;LR44300.U = R41300.U
;
LD CR2002                ; 常時ON
MOV R41300 LR44300       ; INK ALL SELECT SW  INK select 1 memory
;RES(R41707)
LD CR2002                ; 常時ON
RES R41707               ; Parameter変更有り
LABEL #1001
;
;
;LR43000.U = 1
;R43000.U = LR43100.U:(Zs * 16) or LR43000.U
;
;R43100:(Zs * 16) = LR43100:(Zs * 16)
;DM5060 =DMX(R43000.U)
;LR43100:(Zs * 16) = R43100:(Zs * 16)
;
;LR44300.U = R41300.U
LDP R41714               ; STEP Parameter 決定SW
ORP R45002               ; STEP 動作中
DW #10 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
ANB R41707               ; Parameter変更有り
NCJ #1002
;LR43000.U = 1
;
LD CR2002                ; 常時ON
MOV #1 LR43000
;R43000.U = LR43100.U:(Zs * 16) or LR43000.U
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
LDA LR43100:Z12          ; STEP ST1選択 memory
CON
ORA LR43000
CON
STA R43000               ; AUTO PARA  -0確認
;R43100:(Zs * 16) = LR43100:(Zs * 16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
LD LR43100:Z12           ; STEP ST1選択 memory
OUT R43100:Z11           ; STEP INDEX-0確定
;DM5060 =DMX(R43000.U)
;
LD CR2002                ; 常時ON
LDA R43000               ; AUTO PARA  -0確認
CON
DMX
CON
STA DM5060               ; ﾊﾟﾗﾒｰﾀNo 格納
;LR43100:(Zs * 16) = R43100:(Zs * 16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
LD R43100:Z12            ; STEP INDEX-0確定
OUT LR43100:Z11          ; STEP ST1選択 memory
;LR44300.U = R41300.U
LD CR2002                ; 常時ON
MOV R41300 LR44300       ; INK ALL SELECT SW  INK select 1 memory
LABEL #1002
;
;IF LR40100:(Zs-1) = On THEN
;	LR40100.U:(Zs*16) = LR43100.U:(Zs*16)
;END IF
;
;R41300.U = LR44300.U
LDP R41715               ; STEP Parameter 戻る SW
RES R41707               ; Parameter変更有り
CON
NCJ #1003
;IF LR40100:(Zs-1) = On THEN
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
SUB.L +1
CON
STA.L Z12
LD LR40100:Z12           ; STEP ST1 選択 flag
NCJ #2003
;	LR40100.U:(Zs*16) = LR43100.U:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
MOV LR43100:Z12 LR40100:Z11;STEP ST1選択 memory  STEP ST1 選択 flag
;END IF
;
LABEL #2003
;R41300.U = LR44300.U
LD CR2002                ; 常時ON
MOV LR44300 R41300       ; INK select 1 memory  INK ALL SELECT SW
LABEL #1003
;
;***** Touch Panel Prameter部への表示ﾃﾞｰﾀｾｯﾄ *****
LD CR2002                ; 常時ON
ANB R50008               ; Error
LDA DM5060               ; ﾊﾟﾗﾒｰﾀNo 格納
CON
ADD #1
CON
MUL #3
CON
SUB #2
CON
STA DM5062               ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄ表示行
LD= DM4000 #4            ; TP 現在表示中画面
AND<> DM5071 #2          ; TP Mode切替
@LDA LR44100             ; AUTO PARA01 memory
CON
STA R44100               ; AUTO PARA01
CON
@LDA R44100              ; AUTO PARA01
CON
@DMX
CON
@STA DM5060              ; ﾊﾟﾗﾒｰﾀNo 格納
CON
@DW #7 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
@MOV R44100 LR41100      ; AUTO PARA01  AUTO-0    Normal
LD= DM4000 #5            ; TP 現在表示中画面
@LDA LR44100             ; AUTO PARA01 memory
CON
STA R44100               ; AUTO PARA01
CON
@LDA R44100              ; AUTO PARA01
CON
@DMX
CON
@STA DM5060              ; ﾊﾟﾗﾒｰﾀNo 格納
CON
@DW #7 DM5061            ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
CON
@MOV R44100 LR41100      ; AUTO PARA01  AUTO-0    Normal
;R43100.U = LR43100.U
;IF LR40100:(Zs-1) = On THEN
;	R43100.U:(Zs*16) = LR43100.U:(Zs*16)
;	DM5060 = DMX(R43100.U:(Zs*16))
;	DM5061 = 10 + (Zs-1)
;	LR40100:(Zs*16) = R43100:(Zs*16)
;END IF
LD= DM4000 #4            ; TP 現在表示中画面
AND= DM5071 #2           ; TP Mode切替
TMH @5 #5
CON
AND @T5
NCJ #1004
;R43100.U = LR43100.U
;
LD CR2002                ; 常時ON
MOV LR43100 R43100       ; STEP ST1選択 memory  STEP INDEX-0確定
;IF LR40100:(Zs-1) = On THEN
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
SUB.L +1
CON
STA.L Z12
LD LR40100:Z12           ; STEP ST1 選択 flag
NCJ #2004
;	R43100.U:(Zs*16) = LR43100.U:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
MOV LR43100:Z12 R43100:Z11;STEP ST1選択 memory  STEP INDEX-0確定
;	DM5060 = DMX(R43100.U:(Zs*16))
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
CON
LDA R43100:Z12           ; STEP INDEX-0確定
CON
DMX
CON
STA DM5060               ; ﾊﾟﾗﾒｰﾀNo 格納
;	DM5061 = 10 + (Zs-1)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
SUB.L +1
CON
ADD.L +10
CON
STA DM5061               ; ﾊﾟﾗﾒｰﾀ ﾃｷｽﾄNo.
;	LR40100:(Zs*16) = R43100:(Zs*16)
;
LD CR2002                ; 常時ON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z11
CON
LDA.S DM5048             ; Setting Offset Step Parameter
CON
EXT.S
CON
MUL.L +16
CON
STA.L Z12
LD R43100:Z12            ; STEP INDEX-0確定
OUT LR40100:Z11          ; STEP ST1 選択 flag
;END IF
LABEL #2004
LABEL #1004
;
;***** Action Parameter Control *****
LD R41400                ; Action PARA 表示用隠しSW1
AND R41401               ; Action PARA 表示用隠しSW2
OR R41402                ; Action PARA SW表示
AND= DM4000 #9           ; TP 現在表示中画面
OUT R41402               ; Action PARA SW表示
LD<>.D LR41400 #0        ; Action Parameter 00
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OUT R41403               ; Action PARA 使用中
;タイマー可変管理
LD R41500                ; Timer Setting 変更用隠しSW1
AND R41501               ; Timer Setting 変更用隠しSW2
OR R41502                ; Timer変更可能
AND= DM4000 #350         ; TP 現在表示中画面
OUT R41502               ; Timer変更可能
;変更値入力後決定にてTimer値変更
;DM5044 = DM5040
;FM0:DM5044 =DM5050 'ﾀｲﾏｰ変更値を各番号へ格納
;RES (R41503)
;
LD R41503                ; Timer値入力完了
ANP R41504               ; Timer値変更決定SW
NCJ #1005
;DM5044 = DM5040
;
LD CR2002                ; 常時ON
MOV DM5040 DM5044        ; Timer Counter Data No.
;FM0:DM5044 =DM5050 'ﾀｲﾏｰ変更値を各番号へ格納
;
LD CR2002                ; 常時ON
LDA DM5044
CON
EXT
CON
STA.L Z11
CON
MOV DM5050 FM0:Z11       ; 変更値格納ｱﾄﾞﾚｽ  ST1 TIM0
;RES (R41503)
;
LD CR2002                ; 常時ON
RES R41503               ; Timer値入力完了
LABEL #1005
;
;ｾｷｭﾘﾃｨﾚﾍﾞﾙにより選択できるTimer番号を制御　　変数宣言：Zt(DM5048) 'Offset use for Station SW  
LD CR2002                ; 常時ON
AND>= R41600 #256        ; Data Setting 変更用隠しSW1
ENCO R41608 #8           ; T&C&D ST1 SW
CON
ADD #1
CON
STA DM5047               ; Setting Offset
LD<> DM5047 DM5049       ; Setting Offset
MOV DM5047 DM5049        ; Setting Offset
MPS
LDA DM5047               ; Setting Offset
CON
@MUL #20
CON
STA TM1
MPP
LDA DM5040               ; Timer Counter Data No.
CON
@ADD TM1
CON
STA DM5040               ; Timer Counter Data No.
LD R41712                ; Setting Station 切替
@SET R41612              ; T&C&D ST5 SW
CON
ZRES R41608 R41611       ; T&C&D ST1 SW  T&C&D ST4 SW
LDB R41712               ; Setting Station 切替
@SET R41608              ; T&C&D ST1 SW
CON
ZRES R41612 R41615       ; T&C&D ST5 SW  T&C&D ST8 SW
;IF DM5040 >= 40 * Zt  THEN
;	DM5040 = 40 * Zt - 20
;ELSE IF DM5040 < 40 * Zt - 20 THEN
;	DM5040 = 39 + (Zt * 40) - 20
;END IF
LD R41505                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
AND= DM4000 #350         ; TP 現在表示中画面
NCJ #1006
;IF DM5040 >= 40 * Zt  THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
STA.L @VM4
CON
LDA DM5040               ; Timer Counter Data No.
CON
EXT
CON
CMP.L @VM4
LDB CR2009               ; 演算結果が負
NCJ #2005
;	DM5040 = 40 * Zt - 20
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +20
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2006
LABEL #2005
;ELSE IF DM5040 < 40 * Zt - 20 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +20
CON
STA.L @VM6
CON
LDA DM5040               ; Timer Counter Data No.
CON
EXT
CON
CMP.L @VM6
LD CR2009                ; 演算結果が負
NCJ #2007
;	DM5040 = 39 + (Zt * 40) - 20
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +39
CON
SUB.L +20
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2007
LABEL #2006
LABEL #1006
;
;IF DM5040.S >= 40 * Zt -20 THEN
;	DM5040 = 0 + (40 * Zt) - 40
;ELSE IF DM5040.S < (40 * Zt) - 40 THEN
;	DM5040 = 9 + (40 * Zt) - 40
;END IF
LD R41506                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
AND= DM4000 #350         ; TP 現在表示中画面
NCJ #1007
;IF DM5040.S >= 40 * Zt -20 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +20
CON
STA.L @VM8
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM8
LDB CR2009               ; 演算結果が負
NCJ #2008
;	DM5040 = 0 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2009
LABEL #2008
;ELSE IF DM5040.S < (40 * Zt) - 40 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +40
CON
STA.L @VM10
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM10
LD CR2009                ; 演算結果が負
NCJ #2010
;	DM5040 = 9 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +9
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2010
LABEL #2009
LABEL #1007
;
;IF DM5040.S >= 40 * Zt THEN
;	DM5040 = 0 + (40 * Zt) - 40
;ELSE IF DM5040.S < 0 + (40 * Zt) - 40 THEN
;	DM5040 = 39 + (40 * Zt) - 40
;END IF
LD R41507                ; 表示モード
AND= DM4000 #350         ; TP 現在表示中画面
NCJ #1008
;IF DM5040.S >= 40 * Zt THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
STA.L @VM12
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM12
LDB CR2009               ; 演算結果が負
NCJ #2011
;	DM5040 = 0 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2012
LABEL #2011
;ELSE IF DM5040.S < 0 + (40 * Zt) - 40 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA.L @VM14
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM14
LD CR2009                ; 演算結果が負
NCJ #2013
;	DM5040 = 39 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +39
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2013
LABEL #2012
LABEL #1008
;
;Timer値　DM -> T へ格納
LD CR2002                ; 常時ON
MOV.S +0 Z1
FOR #320
LD CR2002                ; 常時ON
MPS
LDA FM0:Z1               ; ST1 TIM0
CON
EXT
CON
STA.D T0:Z1
MPP
INC Z1
NEXT
;カウンタ可変管理
LD R41508                ; Counter Setting 変更用隠しSW1
AND R41509               ; Counter Setting 変更用隠しSW2
OR R41510                ; Counter変更可能
AND= DM4000 #352         ; TP 現在表示中画面
OUT R41510               ; Counter変更可能
;変更値入力後決定にてCounter値変更
;DM5044 = DM5040
;FM320:DM5044 =DM5050 'ｶｳﾝﾀｰｰ変更値を各番号へ格納
;RES (R41511)
;
LD R41511                ; Counter値入力完了
ANP R41512               ; Counter値変更決定SW
NCJ #1009
;DM5044 = DM5040
;
LD CR2002                ; 常時ON
MOV DM5040 DM5044        ; Timer Counter Data No.
;FM320:DM5044 =DM5050 'ｶｳﾝﾀｰｰ変更値を各番号へ格納
;
LD CR2002                ; 常時ON
LDA DM5044
CON
EXT
CON
STA.L Z11
CON
MOV DM5050 FM320:Z11     ; 変更値格納ｱﾄﾞﾚｽ  ST1 Counter 00
;RES (R41511)
;
LD CR2002                ; 常時ON
RES R41511               ; Counter値入力完了
LABEL #1009
;
;ｾｷｭﾘﾃｨﾚﾍﾞﾙにより選択できるCounter番号を制御　　変数宣言：Zt(DM5048) 'Offset use for Station SW 
;IF DM5040 >= 40 * Zt  THEN
;	DM5040 = 40 * Zt - 20
;ELSE IF DM5040 < 40 * Zt - 20 THEN
;	DM5040 = 39 + (Zt * 40) - 40
;END IF
LD R41505                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
AND= DM4000 #352         ; TP 現在表示中画面
NCJ #1010
;IF DM5040 >= 40 * Zt  THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
STA.L @VM16
CON
LDA DM5040               ; Timer Counter Data No.
CON
EXT
CON
CMP.L @VM16
LDB CR2009               ; 演算結果が負
NCJ #2014
;	DM5040 = 40 * Zt - 20
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +20
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2015
LABEL #2014
;ELSE IF DM5040 < 40 * Zt - 20 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +20
CON
STA.L @VM18
CON
LDA DM5040               ; Timer Counter Data No.
CON
EXT
CON
CMP.L @VM18
LD CR2009                ; 演算結果が負
NCJ #2016
;	DM5040 = 39 + (Zt * 40) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +39
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2016
LABEL #2015
LABEL #1010
;
;IF DM5040.S >= 40 * Zt -10 THEN
;	DM5040 = 0 + (40 * Zt) - 40
;ELSE IF DM5040.S < (40 * Zt) - 40 THEN
;	DM5040 = 9 + (40 * Zt) - 40
;END IF
LD R41506                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
AND= DM4000 #352         ; TP 現在表示中画面
NCJ #1011
;IF DM5040.S >= 40 * Zt -10 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +10
CON
STA.L @VM20
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM20
LDB CR2009               ; 演算結果が負
NCJ #2017
;	DM5040 = 0 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2018
LABEL #2017
;ELSE IF DM5040.S < (40 * Zt) - 40 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
SUB.L +40
CON
STA.L @VM22
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM22
LD CR2009                ; 演算結果が負
NCJ #2019
;	DM5040 = 9 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +9
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2019
LABEL #2018
LABEL #1011
;
;IF DM5040.S >= 40 * Zt THEN
;	DM5040 = 0 + (40 * Zt) - 40
;ELSE IF DM5040.S < 0 + (40 * Zt) - 40 THEN
;	DM5040 = 39 + (40 * Zt) - 40
;END IF
LD R41507                ; 表示モード
AND= DM4000 #352         ; TP 現在表示中画面
NCJ #1012
;IF DM5040.S >= 40 * Zt THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
STA.L @VM24
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM24
LDB CR2009               ; 演算結果が負
NCJ #2020
;	DM5040 = 0 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2021
LABEL #2020
;ELSE IF DM5040.S < 0 + (40 * Zt) - 40 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +0
CON
SUB.L +40
CON
STA.L @VM26
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM26
LD CR2009                ; 演算結果が負
NCJ #2022
;	DM5040 = 39 + (40 * Zt) - 40
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +40
CON
ADD.L +39
CON
SUB.L +40
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2022
LABEL #2021
LABEL #1012
;
;Counter値　DM -> C へ格納
LD CR2002                ; 常時ON
MOV.S +320 Z2
FOR #320
LD CR2002                ; 常時ON
MPS
LDA FM0:Z2               ; ST1 TIM0
CON
EXT
CON
STA.L C0:Z2              ; ﾌｨﾙﾑ捨て出し回数
MPP
INC Z2
NEXT
;データ可変管理
LD R41600                ; Data Setting 変更用隠しSW1
AND R41601               ; Data Setting 変更用隠しSW2
OR R41602                ; Data変更可能
AND= DM4000 #354         ; TP 現在表示中画面
OUT R41602               ; Data変更可能
;連続捨て出し回数入力制限(n<=3)
;変更値入力後決定にてData値変更
;DM500:DM5040 =DM5050 'ﾃﾞｰﾀ変更値を各番号へ格納
;RES (R41603)
;
LD R41603                ; Data値入力完了
ANP R41604               ; Data値変更決定SW
NCJ #1013
;DM500:DM5040 =DM5050 'ﾃﾞｰﾀ変更値を各番号へ格納
;
LD CR2002                ; 常時ON
LDA DM5040               ; Timer Counter Data No.
CON
EXT
CON
STA.L Z11
CON
MOV DM5050 DM500:Z11     ; 変更値格納ｱﾄﾞﾚｽ  ｴﾗｰ内容表示
;RES (R41603)
;
LD CR2002                ; 常時ON
RES R41603               ; Data値入力完了
LABEL #1013
;
;選択できるData番号を制御
;IF DM5040.S >= 10 * Zt THEN
;	DM5040 = 0 + (Zt * 10) - 10
;ELSE IF DM5040.S < 0 + (Zt * 10) - 10 THEN
;	DM5040 = 9 + (Zt * 10) - 10
;END IF
LD R41505                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
OR R41506                ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
OR R41507                ; 表示モード
AND= DM4000 #354         ; TP 現在表示中画面
NCJ #1014
;IF DM5040.S >= 10 * Zt THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +10
CON
STA.L @VM28
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM28
LDB CR2009               ; 演算結果が負
NCJ #2023
;	DM5040 = 0 + (Zt * 10) - 10
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +10
CON
ADD.L +0
CON
SUB.L +10
CON
STA DM5040               ; Timer Counter Data No.
LD CR2002                ; 常時ON
CJ #2024
LABEL #2023
;ELSE IF DM5040.S < 0 + (Zt * 10) - 10 THEN
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +10
CON
ADD.L +0
CON
SUB.L +10
CON
STA.L @VM30
CON
LDA.S DM5040             ; Timer Counter Data No.
CON
EXT.S
CON
CMP.L @VM30
LD CR2009                ; 演算結果が負
NCJ #2025
;	DM5040 = 9 + (Zt * 10) - 10
;
LD CR2002                ; 常時ON
LDA.S DM5047             ; Setting Offset
CON
EXT.S
CON
MUL.L +10
CON
ADD.L +9
CON
SUB.L +10
CON
STA DM5040               ; Timer Counter Data No.
;END IF
LABEL #2025
LABEL #2024
LABEL #1014
;
;設定画面を抜けたらビットクリア
LDB R41502               ; Timer変更可能
ANB R41510               ; Counter変更可能
ANB R41602               ; Data変更可能
AND<> DM4000 #350        ; TP 現在表示中画面
AND<> DM4000 #352        ; TP 現在表示中画面
AND<> DM4000 #354        ; TP 現在表示中画面
AND<> DM4000 #356        ; TP 現在表示中画面
AND<> DM4000 #901        ; TP 現在表示中画面
AND<> DM4000 #800        ; TP 現在表示中画面
AND<> DM4000 #355        ; TP 現在表示中画面
ZRES R42500 R42508       ; 天秤設定 Toki BK選択  天秤設定 下限選択
CON
@RES R41702              ; Balancer Setting
CON
@ZRES DM5051 DM5059      ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ  IND3 UT4 to panel
CON
@ZRES R41500 R41608      ; Timer Setting 変更用隠しSW1  T&C&D ST1 SW
CON
@RES R42000              ; ON/OFFLine切替選択
CON
@RES R42002              ; Flow Mater Setting
CON
@RES R42003              ; TP ﾊﾞｲﾊﾟｽ設定
;Timer,Counter,Dataでの表示するﾃｷｽﾄ番号を指定
LD= DM4000 #350          ; TP 現在表示中画面
@MOV #1 DM5041           ; Timer Counter Data ﾃｷｽﾄNo.
LD= DM4000 #352          ; TP 現在表示中画面
@MOV #2 DM5041           ; Timer Counter Data ﾃｷｽﾄNo.
LD= DM4000 #354          ; TP 現在表示中画面
@MOV #3 DM5041           ; Timer Counter Data ﾃｷｽﾄNo.
;Timer,Counter,Data設定画面に表示させる Station(ST)-Name
LD CR2002                ; 常時ON
AND>= R41600 #256        ; Data Setting 変更用隠しSW1
@DW #5 DM5045            ; Station ﾃｷｽﾄNo.
CON
MOV DM5047 DM5046        ; Setting Offset  Station ﾃｷｽﾄ表示行
;Timer,Counter,Data設定画面に表示させる Timer(TM)-Name
;IF DM4000 = #350 THEN
;	DM5043 = DM5040
;	DM5042 = DM5043 + 1
;ELSE IF DM4000 = #352 THEN
;	DM5043 = DM5040
;	DM5042 = DM5043 + 1
;ELSE IF DM4000 = #354 THEN
;	DM5043 = DM5040
;	DM5042 = DM5043 + 1
;END IF
LD CR2002                ; 常時ON
NCJ #1015
;IF DM4000 = #350 THEN
;
LD= DM4000 #350          ; TP 現在表示中画面
NCJ #2026
;	DM5043 = DM5040
;
LD CR2002                ; 常時ON
MOV DM5040 DM5043        ; Timer Counter Data No.  設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
;	DM5042 = DM5043 + 1
;
LD CR2002                ; 常時ON
LDA DM5043               ; 設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L +1
CON
STA DM5042               ; Timer Counter Data ﾃｷｽﾄ表示行
LD CR2002                ; 常時ON
CJ #2027
LABEL #2026
;ELSE IF DM4000 = #352 THEN
;
LD= DM4000 #352          ; TP 現在表示中画面
NCJ #2028
;	DM5043 = DM5040
;
LD CR2002                ; 常時ON
MOV DM5040 DM5043        ; Timer Counter Data No.  設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
;	DM5042 = DM5043 + 1
;
LD CR2002                ; 常時ON
LDA DM5043               ; 設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L +1
CON
STA DM5042               ; Timer Counter Data ﾃｷｽﾄ表示行
LD CR2002                ; 常時ON
CJ #2029
LABEL #2028
;ELSE IF DM4000 = #354 THEN
;
LD= DM4000 #354          ; TP 現在表示中画面
NCJ #2030
;	DM5043 = DM5040
;
LD CR2002                ; 常時ON
MOV DM5040 DM5043        ; Timer Counter Data No.  設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
;	DM5042 = DM5043 + 1
;
LD CR2002                ; 常時ON
LDA DM5043               ; 設定値表示用ｵﾌｾｯﾄｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L +1
CON
STA DM5042               ; Timer Counter Data ﾃｷｽﾄ表示行
;END IF
LABEL #2030
LABEL #2029
LABEL #2027
LABEL #1015
;
;Timer,Counter,Data Password処理
;SELECT CASE DM5056
;CASE 0 
;	DM5051 = DM5055	'入力された値を格納
;	DM5052 = $2A00 'ｱｽﾀﾘｽｸ表示
;	DM5056 = DM5056 + 1
;CASE 1 
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;	DM5052 = DM5052 + $002A	'ｱｽﾀﾘｽｸ表示
;	DM5056 = DM5056 + 1
;CASE 2
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;'    DM5052.L = RLA(DM5052.L,16)		   '*右ﾛｰﾃｰﾄ
;    DM5053 = DM5053 + $2A00 
;	DM5056 = DM5056 + 1				   '
;CASE 3
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;	DM5053 = DM5053 + $002A	'ｱｽﾀﾘｽｸ表示
;	DM5056 = DM5056 + 1
;CASE ELSE
;	DM5053 = $0000
;	DM5052 = $4E47
;	DM5051 = 0
;END SELECT	
;DM5055 = 0
;
LDP R41514               ; Password Input
NCJ #1016
;SELECT CASE DM5056
;
LD CR2002                ; 常時ON
MOV DM5056 @VM32         ; Temporaly address
;CASE 0 
;
LD= @VM32 #0
NCJ #2031
;	DM5051 = DM5055	'入力された値を格納
;
LD CR2002                ; 常時ON
MOV DM5055 DM5051        ; Temporaly address  ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
;	DM5052 = $2A00 'ｱｽﾀﾘｽｸ表示
;
LD CR2002                ; 常時ON
MOV $2A00 DM5052         ; [*]格納ｱﾄﾞﾚｽ
;	DM5056 = DM5056 + 1
;
LD CR2002                ; 常時ON
LDA DM5056               ; Temporaly address
CON
EXT
CON
ADD.L +1
CON
STA DM5056               ; Temporaly address
LD CR2002                ; 常時ON
CJ #2032
LABEL #2031
;CASE 1 
;
LD= @VM32 #1
NCJ #2033
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;
LD CR2002                ; 常時ON
LDA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
EXT
CON
MUL.L +10
CON
STA.L @VM33
CON
LDA DM5055               ; Temporaly address
CON
EXT
CON
ADD.L @VM33
CON
STA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
;	DM5052 = DM5052 + $002A	'ｱｽﾀﾘｽｸ表示
;
LD CR2002                ; 常時ON
LDA DM5052               ; [*]格納ｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L $0000002A
CON
STA DM5052               ; [*]格納ｱﾄﾞﾚｽ
;	DM5056 = DM5056 + 1
;
LD CR2002                ; 常時ON
LDA DM5056               ; Temporaly address
CON
EXT
CON
ADD.L +1
CON
STA DM5056               ; Temporaly address
LD CR2002                ; 常時ON
CJ #2034
LABEL #2033
;CASE 2
;
LD= @VM32 #2
NCJ #2035
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;
LD CR2002                ; 常時ON
LDA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
EXT
CON
MUL.L +10
CON
STA.L @VM35
CON
LDA DM5055               ; Temporaly address
CON
EXT
CON
ADD.L @VM35
CON
STA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
;'    DM5052.L = RLA(DM5052.L,16)		   '*右ﾛｰﾃｰﾄ
;
;    DM5053 = DM5053 + $2A00 
;
LD CR2002                ; 常時ON
LDA DM5053               ; [*]格納ｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L $00002A00
CON
STA DM5053               ; [*]格納ｱﾄﾞﾚｽ
;	DM5056 = DM5056 + 1				   '
;
LD CR2002                ; 常時ON
LDA DM5056               ; Temporaly address
CON
EXT
CON
ADD.L +1
CON
STA DM5056               ; Temporaly address
LD CR2002                ; 常時ON
CJ #2036
LABEL #2035
;CASE 3
;
LD= @VM32 #3
NCJ #2037
;	DM5051 = DM5051 * 10 + DM5055 '入力された値を格納BIN 左ｼﾌﾄ
;
LD CR2002                ; 常時ON
LDA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
EXT
CON
MUL.L +10
CON
STA.L @VM37
CON
LDA DM5055               ; Temporaly address
CON
EXT
CON
ADD.L @VM37
CON
STA DM5051               ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
;	DM5053 = DM5053 + $002A	'ｱｽﾀﾘｽｸ表示
;
LD CR2002                ; 常時ON
LDA DM5053               ; [*]格納ｱﾄﾞﾚｽ
CON
EXT
CON
ADD.L $0000002A
CON
STA DM5053               ; [*]格納ｱﾄﾞﾚｽ
;	DM5056 = DM5056 + 1
;
LD CR2002                ; 常時ON
LDA DM5056               ; Temporaly address
CON
EXT
CON
ADD.L +1
CON
STA DM5056               ; Temporaly address
LD CR2002                ; 常時ON
CJ #2038
LABEL #2037
;CASE ELSE
;
;	DM5053 = $0000
;
LD CR2002                ; 常時ON
MOV $0000 DM5053         ; [*]格納ｱﾄﾞﾚｽ
;	DM5052 = $4E47
;
LD CR2002                ; 常時ON
MOV $4E47 DM5052         ; [*]格納ｱﾄﾞﾚｽ
;	DM5051 = 0
;
LD CR2002                ; 常時ON
MOV #0 DM5051            ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
;END SELECT	
;
LABEL #2038
LABEL #2036
LABEL #2034
LABEL #2032
;DM5055 = 0
;
LD CR2002                ; 常時ON
MOV #0 DM5055            ; Temporaly address
LABEL #1016
;
LD R41515                ; Password Input OK
MPS
AND R41605               ; Timer Setting Select
MPS
AND= #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #350 DM4008           ; TP 切り替え画面No
CON
SET R41505               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
MRD
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #350 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
LD<> #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
ANL
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MRD
AND R41606               ; Counter Setting Select
MPS
AND= #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #352 DM4008           ; TP 切り替え画面No
CON
SET R41505               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
MRD
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #352 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
LD<> #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
ANL
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MRD
AND R41607               ; Data Setting Select
MPS
AND= #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #354 DM4008           ; TP 切り替え画面No
CON
SET R41505               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ1
MRD
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #354 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
LD<> #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
ANL
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MRD
AND R41702               ; Balancer Setting
MPS
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #355 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
LD<> #123 DM5051         ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
ANL
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MRD
AND R42003               ; TP ﾊﾞｲﾊﾟｽ設定
MPS
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #331 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MRD
AND R42000               ; ON/OFFLine切替選択
MPS
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #356 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
MPP
AND R42002               ; Flow Mater Setting
MPS
AND= #6069 DM5051        ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #901 DM4008           ; TP 切り替え画面No
CON
SET R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
MPP
AND<> #6069 DM5051       ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
DW #0 DM5051             ; ﾊﾟｽﾜｰﾄﾞ格納ｱﾄﾞﾚｽ
CON
DW $4E47 DM5052          ; [*]格納ｱﾄﾞﾚｽ
CON
DW $0000 DM5053          ; [*]格納ｱﾄﾞﾚｽ
LDP R42000               ; ON/OFFLine切替選択
MOV DM4000 DM480         ; TP 現在表示中画面  戻り先画面番号
LDP R42004               ; ON/OFF LINE切替 戻り
MOV DM480 DM4008         ; 戻り先画面番号  TP 切り替え画面No
;
LD CR2008                ; 運転開始時1ｽｷｬﾝON
DW #1 DM5100             ; RBﾃｷｽﾄNo
CON
DW #1 DM5101             ; AxisﾃｷｽﾄNo
CON
DW #1 DM5102             ; PointﾃｷｽﾄNo
LD CR2002                ; 常時ON
DW #30 DM5103            ; RB No
LD CR2002                ; 常時ON
STA DM5101               ; AxisﾃｷｽﾄNo
CON
ADD #30
CON
STA DM5104               ; Axis No
LD CR2002                ; 常時ON
STA DM5100               ; RBﾃｷｽﾄNo
CON
ADD #40
CON
STA DM5105               ; Point ﾃｷｽﾄNo
;OFF Line時　ﾊﾟﾗﾒｰﾀ設定
;Prameter in OFF LINE
;
;OFF LINE（LDP MR003)から常時へ変更
;OFFLINE時ﾌｧｲﾘﾝｸﾞﾃﾞｰﾀ→PLC機種ﾃﾞｰﾀへ以降
LD>= DM5025 #300         ; F-DATA     ﾌﾞﾛｯｸ番号
DW #0 DM5025             ; F-DATA     ﾌﾞﾛｯｸ番号
LD<> DM5025 DM5026       ; F-DATA     ﾌﾞﾛｯｸ番号  F-DATA ﾌﾞﾛｯｸ比較
MPS
LDA DM5025               ; F-DATA     ﾌﾞﾛｯｸ番号
CON
STA DM5026               ; F-DATA ﾌﾞﾛｯｸ比較
MPP
DW #1 DM5023             ; F-DATA     転送設定
LD R42001                ; F-DATA転送完了Bit
DW #0 DM5023             ; F-DATA     転送設定
RES R42001               ; F-DATA転送完了Bit
;Balancer 設定
;初期処理
LD= DM4000 #355          ; TP 現在表示中画面
MPS
AND= DM287 #1            ; ModelIdentficationNumber
@SET R42500              ; 天秤設定 Toki BK選択
CON
@RES R42501              ; 天秤設定 Toki CL選択
CON
@RES R42502              ; 天秤設定 Toki2 4CL選択
MRD
AND= DM287 #2            ; ModelIdentficationNumber
@RES R42500              ; 天秤設定 Toki BK選択
CON
@SET R42501              ; 天秤設定 Toki CL選択
CON
@RES R42502              ; 天秤設定 Toki2 4CL選択
MPP
AND= DM287 #3            ; ModelIdentficationNumber
@RES R42500              ; 天秤設定 Toki BK選択
CON
@RES R42501              ; 天秤設定 Toki CL選択
CON
@SET R42502              ; 天秤設定 Toki2 4CL選択
;重量表示
LD R42500                ; 天秤設定 Toki BK選択
MOV.D FM500 DM5120       ; BK重量上限  選択機種 重量上限表示
MOV.D FM502 DM5122       ; BK重量下限  選択機種 重量下限表示
LD R42501                ; 天秤設定 Toki CL選択
MOV.D FM504 DM5120       ; 3CL重量上限  選択機種 重量上限表示
MOV.D FM506 DM5122       ; 3CL重量下限  選択機種 重量下限表示
LD R42502                ; 天秤設定 Toki2 4CL選択
MOV.D FM508 DM5120       ; 4CL重量上限  選択機種 重量上限表示
MOV.D FM510 DM5122       ; 4CL重量下限  選択機種 重量下限表示
;可変許可管理
LD R42503                ; 天秤設定 隠しSW1
AND R42504               ; 天秤設定 隠しSW2
OR R42505                ; 天秤設定 重量変更可能
AND= DM4000 #355         ; TP 現在表示中画面
OUT R42505               ; 天秤設定 重量変更可能
;重量設定
;IF R42500=1 THEN		'Toki BK
;	IF R42507 = 1 THEN	'Upper
;		FM500.D = DM5124.D
;	END IF
;	IF R42508 = 1 THEN	'Lower
;		FM502.D = DM5124.D
;	END IF
;END IF
;
;IF R42501=1 THEN		'Toki CL
;	IF R42507 = 1 THEN	'Upper
;		FM504.D = DM5124.D
;	END IF
;	IF R42508 = 1 THEN	'Lower
;		FM506.D = DM5124.D
;	END IF
;END IF
;
;IF R42502=1 THEN		'Toki2 4CL
;	IF R42507 = 1 THEN	'Upper
;		FM508.D = DM5124.D
;	END IF
;	IF R42508 = 1 THEN	'Lower
;		FM510.D = DM5124.D
;	END IF
;END IF
LD R42505                ; 天秤設定 重量変更可能
AND R41506               ; ｾｷｭﾘﾃｨﾚﾍﾞﾙ2
ANP R42506               ; 天秤設定 決定SW
NCJ #1017
;IF R42500=1 THEN		'Toki BK
;
LD R42500                ; 天秤設定 Toki BK選択
NCJ #2039
;	IF R42507 = 1 THEN	'Upper
;
LD R42507                ; 天秤設定 上限選択
NCJ #2040
;		FM500.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM500       ; 重量変更値  BK重量上限
;	END IF
;
LABEL #2040
;	IF R42508 = 1 THEN	'Lower
;
LD R42508                ; 天秤設定 下限選択
NCJ #2041
;		FM502.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM502       ; 重量変更値  BK重量下限
;	END IF
;
LABEL #2041
;END IF
;
LABEL #2039
;IF R42501=1 THEN		'Toki CL
;
LD R42501                ; 天秤設定 Toki CL選択
NCJ #2042
;	IF R42507 = 1 THEN	'Upper
;
LD R42507                ; 天秤設定 上限選択
NCJ #2043
;		FM504.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM504       ; 重量変更値  3CL重量上限
;	END IF
;
LABEL #2043
;	IF R42508 = 1 THEN	'Lower
;
LD R42508                ; 天秤設定 下限選択
NCJ #2044
;		FM506.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM506       ; 重量変更値  3CL重量下限
;	END IF
;
LABEL #2044
;END IF
;
LABEL #2042
;IF R42502=1 THEN		'Toki2 4CL
;
LD R42502                ; 天秤設定 Toki2 4CL選択
NCJ #2045
;	IF R42507 = 1 THEN	'Upper
;
LD R42507                ; 天秤設定 上限選択
NCJ #2046
;		FM508.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM508       ; 重量変更値  4CL重量上限
;	END IF
;
LABEL #2046
;	IF R42508 = 1 THEN	'Lower
;
LD R42508                ; 天秤設定 下限選択
NCJ #2047
;		FM510.D = DM5124.D
;
LD CR2002                ; 常時ON
MOV.D DM5124 FM510       ; 重量変更値  4CL重量下限
;	END IF
;
LABEL #2047
;END IF
LABEL #2045
LABEL #1017
;
END
ENDH
