DEVICE:53
;MODULE:BringDown_Standby
;MODULE_TYPE:0
;OneSystem UserOpen Module
;
;-----------------------------------------
;ModuleName	:	BringDown_Standby
;ModuleType	:	UserOpen Module
;Function	:	User Open Function
;-----------------------------------------
;
;Copylight(C) 2011 SEIKO EPSON Corp. All rights reserved.
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @R000 @R115
;<h1/>CHK_Start/Auto動作可否判断
;[作成上の注意点]
;・ﾕｰｻﾞｰｵｰﾌﾟﾝｴﾘｱ以外は修正しないで下さい。
;・ﾒｲﾝﾓｼﾞｭｰﾙと同様、安全ｶﾊﾞｰ、非常停止などの影響を受けます。
;・動作記述をする事ができます。
;・STG〜JMP命令は@R(ﾛｰｶﾙﾘﾚｰ)を使用して下さい。
;・ﾕｰｻﾞｰ処理終了後、条件に応じて以下の対応をする事。
;	→AUTO動作を開始する場合は@R014へJMP
;	→AUTO動作を開始しない場合は@R015へJMP
STG R40401               ; _AUTOﾓｰﾄﾞ移行ﾕｰｻﾞｰSTG
JMP @R000
;//User Open Area Header
STG @R000
MPS
AND CR2002               ; 常時ON
JMP @R010
MPP
AND CR2003               ; 常時OFF
JMP @R015
;//User Open Area Footer
;<h1/>2015/2/　GAGA対応
;違う転写ﾌﾟﾚｰﾄがｾｯﾄされている時はｴﾗｰにする
;GAGA:B3122=ON、B3123=OFF
; BIJ:B3122=ON、B3123=ON
STG @R010
MPS
ANB T10                  ; ﾀｲﾑｱｯﾌﾟ
MPS
SCMP DM164 "GAGA"        ; _機種共通ﾃﾞｰﾀ33
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
LDB B3122                ; 転写ﾌﾟﾚｰﾄ識別1
AND B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R014
MPP
LD B3122                 ; 転写ﾌﾟﾚｰﾄ識別1
ORB B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R011
MRD
SCMP DM164 "BIJ"         ; _機種共通ﾃﾞｰﾀ33
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
LD B3122                 ; 転写ﾌﾟﾚｰﾄ識別1
AND B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R014
MPP
LDB B3122                ; 転写ﾌﾟﾚｰﾄ識別1
ORB B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R011
MPP
SCMP DM164 "T3S"         ; _機種共通ﾃﾞｰﾀ33
CON
AND CR2010               ; 演算結果がｾﾞﾛ
MPS
LD B3122                 ; 転写ﾌﾟﾚｰﾄ識別1
AND B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R014
MPP
LDB B3122                ; 転写ﾌﾟﾚｰﾄ識別1
ORB B3123                ; 転写ﾌﾟﾚｰﾄ識別2
ANL
JMP @R011
MPP
TMR #10 #50              ; ﾀｲﾑｱｯﾌﾟ
CON
AND T10                  ; ﾀｲﾑｱｯﾌﾟ
JMP @R011
;Err114
STG @R011
ANB R39004               ; ｴﾗｰ中
DW #114 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET R39004               ; ｴﾗｰ中
CON
DW $8000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; Task0 ERROR
CON
JMP @R012
STG @R012
AND @MR101               ; Task0 ｴﾗｰ完了
RES @MR101               ; Task0 ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @R015
MEP
MCALL MODE_INDI #1
STG @R014
SET R40402               ; _AUTOﾓｰﾄﾞ移行OK
CON
ENDS
STG @R015
SET R40403               ; _AUTOﾓｰﾄﾞ移行NG
CON
ENDS
;<h1/>ModeOut_Handle/ﾓｰﾄﾞOUT直後起動
;[作成上の注意点]
;・ﾒｲﾝﾓｼﾞｭｰﾙ停止後、定停止中になる直前に起動します。
;・ﾕｰｻﾞｰｵｰﾌﾟﾝｴﾘｱ以外は修正しないで下さい。
;・ﾒｲﾝﾓｼﾞｭｰﾙと同様、安全ｶﾊﾞｰ、非常停止などの影響を受けます。
;・STG〜JMP命令は@R(ﾛｰｶﾙﾘﾚｰ)を使用して下さい。
;・動作記述をする事ができます。
LD R40407                ; _ﾓｰﾄﾞOUTﾕｰｻﾞｰSTG
SET @R100
;//User Open Area Header
STG @R100
JMP @R115
;//User Open Area Footer
STG @R115
RES R40407               ; _ﾓｰﾄﾞOUTﾕｰｻﾞｰSTG
CON
ENDS
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Task0 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task0 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task0 ERROR Busy
CON
SET @MR101               ; Task0 ｴﾗｰ完了
CON
ENDS
END
ENDH
