DEVICE:53
;MODULE:Group1_Task4
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task4
;ModuleType	:	Main Module
;Line		:	
;Cell		:	
;Function	:	CAV搬送RB
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000～@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100～@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000～@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000～@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000～@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000～@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500～@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ　※状況により増設してください。
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG～JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @MR100 @MR6415
LD= DM60000 MyTask       ; TaskNo /ERROR_DISP  自ﾀｽｸ番号
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM632.U,EM633.U,@MR000.U,@MR3000.U
;
;FOR EM632 = EM632 TO 160 STEP 16
;	IF @MR3000:EM632 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM632 < 160 THEN
;	EM633 = (EM632 / 16) * 100 + DMX(@MR3000:EM632) + #3000
;END IF		
;		
;EM632 = EM632 + 16		
;IF EM632 > 160 THEN		
;	EM632 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM632.U,EM633.U,@MR000.U,@MR3000.U
;
;FOR EM632 = EM632 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM632 EM632          ; Task4 Main1@MR  Task4 Main1@MR
LABEL #2000
LD> EM632 #160           ; Task4 Main1@MR
CJ #2001
;	IF @MR3000:EM632 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
ADD #16
CON
STA EM632                ; Task4 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM632 < 160 THEN
;
LD< EM632 #160           ; Task4 Main1@MR
NCJ #2004
;	EM633 = (EM632 / 16) * 100 + DMX(@MR3000:EM632) + #3000
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12
CON
DMX
CON
STA @VM0
CON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM633                ; Task4 Main1@MR
;END IF		
;
LABEL #2004
;EM632 = EM632 + 16		
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM632                ; Task4 Main1@MR
;IF EM632 > 160 THEN		
;
LD> EM632 #160           ; Task4 Main1@MR
NCJ #2005
;	EM632 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM632             ; Task4 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM634.U,EM635.U,@MR4000.U
;
;FOR EM634 = EM634 TO 80 STEP 16
;	IF @MR4000:EM634 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM634 < 80 THEN
;	EM635 = (EM634 / 16) * 100 + DMX(@MR4000:EM634) + #4000
;END IF
;
;EM634 = EM634 + 16		
;
;IF EM634 > 80 THEN
;	EM634 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM634.U,EM635.U,@MR4000.U
;
;FOR EM634 = EM634 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM634 EM634          ; Task4 Main2@MR  Task4 Main2@MR
LABEL #2006
LD> EM634 #80            ; Task4 Main2@MR
CJ #2007
;	IF @MR4000:EM634 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
ADD #16
CON
STA EM634                ; Task4 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM634 < 80 THEN
;
LD< EM634 #80            ; Task4 Main2@MR
NCJ #2010
;	EM635 = (EM634 / 16) * 100 + DMX(@MR4000:EM634) + #4000
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12
CON
DMX
CON
STA @VM3
CON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM635                ; Task4 Main2@MR
;END IF
;
LABEL #2010
;EM634 = EM634 + 16		
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM634                ; Task4 Main2@MR
;IF EM634 > 80 THEN
;
LD> EM634 #80            ; Task4 Main2@MR
NCJ #2011
;	EM634 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM634             ; Task4 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM636.U,EM637.U,@MR4500.U
;	
;FOR EM636 = EM636 TO 320 STEP 16
;	IF @MR4500:EM636 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM636 < 320 THEN
;	EM637 = (EM636 / 16) * 100 + DMX(@MR4500:EM636) + #4500
;END IF
;		
;EM636 = EM636 + 16	
;
;IF EM636 > 320 THEN
;   EM636 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM636.U,EM637.U,@MR4500.U
;
;FOR EM636 = EM636 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM636 EM636          ; Task4 Sub@MR  Task4 Sub@MR
LABEL #2012
LD> EM636 #320           ; Task4 Sub@MR
CJ #2013
;	IF @MR4500:EM636 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
ADD #16
CON
STA EM636                ; Task4 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM636 < 320 THEN
;
LD< EM636 #320           ; Task4 Sub@MR
NCJ #2016
;	EM637 = (EM636 / 16) * 100 + DMX(@MR4500:EM636) + #4500
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12
CON
DMX
CON
STA @VM6
CON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM637                ; Task4 Sub@MR
;END IF
;
LABEL #2016
;EM636 = EM636 + 16	
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM636                ; Task4 Sub@MR
;IF EM636 > 320 THEN
;
LD> EM636 #320           ; Task4 Sub@MR
NCJ #2017
;   EM636 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM636             ; Task4 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR804                ; _Grp1_Task4_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR404                ; _Grp1_Task4_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5204               ; _Grp1_Task4_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5404               ; _Grp1_Task4_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5604               ; _Grp1_Task4_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR604                ; _Grp1_Task4_Fin.STG
MPS
LDB R41204               ; TASK4 PAUSE 要求
ANB @MR001
ANL
RES R41004               ; _Grp1_Task4_起動中ﾌﾗｸﾞ
CON
ENDS
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/>HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5204               ; _Grp1_Task4_HOME.STG
JMP @MR1000
STG @MR1000
SET @MR1002
CON
JMP @MR1005
STG @MR1005
RES DM11350.0            ; Start
CON
RES DM11350.8            ; SetMotorsOn
CON
RES DM11350.9            ; SetMotorsOff
CON
SET MR507                ; SCARA RB 非常停止
CON
JMP @MR1006
STG @MR1006
SET DM11350.4            ; Stop
CON
ANB DM11150.1            ; Running
RES DM11350.4            ; Stop
CON
JMP @MR1007
STG @MR1007
MPS
AND DM11150.0            ; Ready
SET DM11350.7            ; Rest
CON
JMP @MR1008
MPP
ANB DM11150.0            ; Ready
TMR @13 #300
CON
AND @T13
JMP @MR1012
STG @MR1008
MPS
ANB DM11150.4            ; EstopOn
RES DM11350.7            ; Rest
CON
JMP @MR1010
MPP
AND DM11150.4            ; EstopOn
TMR @14 #300
CON
AND @T14
RES DM11350.7            ; Rest
CON
JMP @MR1012
;                  ↓PAUSEして非常停止したらどうなる？？？
STG @MR1010
MPS
LDB DM11150.3            ; Error
ANB DM11150.6            ; SEroor
ANL
SET DM11350.8            ; SetMotorsOn
CON
AND DM11150.8            ; MotorsOn
RES DM11350.7            ; Rest
CON
JMP @MR1011
MPP
TMR @49 #100
CON
AND @T49
RES DM11350.8            ; SetMotorsOn
CON
RES DM11350.7            ; Rest
CON
JMP @MR1012
STG @MR1011
SET DM11350.0            ; Start
CON
MPS
AND DM11150.1            ; Running
SET DM11350.6            ; Continue
CON
ANB DM11150.2            ; Paused
RES DM11350.6            ; Continue
CON
JMP @MR1100
MPP
ANB DM11150.1            ; Running
MPS
LD DM11150.3             ; Error
OR DM11150.6             ; SEroor
ANL
RES DM11350.8            ; SetMotorsOn
CON
SET DM11350.9            ; SetMotorsOff
CON
RES DM11350.0            ; Start
CON
JMP @MR1012
MPP
TMR @46 #100
CON
AND @T46
RES DM11350.8            ; SetMotorsOn
CON
SET DM11350.9            ; SetMotorsOff
CON
RES DM11350.0            ; Start
CON
JMP @MR1012
;*** Err 143 CAV搬送RBｺﾝﾄﾛｰﾗ異常
STG @MR1012
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #143 @DM1
CON
DW #4007 @DM2
CON
DW $1000 @DM9
CON
SET @MR100
CON
JMP @MR1013
STG @MR1013
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1005
;***
;原点復帰ﾒｲﾝ
;ｶﾒﾗ照明上昇
STG @MR1100
MPS
ANB R41204               ; TASK4 PAUSE 要求
RES MR1113               ; 画像照明ON
CON
JMP @MR1101
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR1101
RES MR7500               ; CAV搬送RB 照明下降
CON
SET MR7501               ; CAV搬送RB 照明上昇
CON
MPS
LDB MR4401               ; CAV搬送RB 照明 上昇端異常
ANB R4400                ; CAV搬送RB 照明 下降端
AND R4401                ; CAV搬送RB 照明 上昇端
ANL
JMP @MR1102
MPP
LD MR4401                ; CAV搬送RB 照明 上昇端異常
AND R41204               ; TASK4 PAUSE 要求
ANL
SET @MR1900
;CAV搬送RB待機位置へ
STG @MR1102
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #1 @DM24
CON
SET @MR5600
CON
JMP @MR1103
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR1103
AND @MR5601
RES @MR5601
CON
JMP @MR1200
;ﾍｯﾄﾞﾜｰｸ残確認
STG @MR1200
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
RES MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
CON
TMR @47 #10
CON
AND @T47
JMP @MR1201
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR1201
MPS
LD R4315                 ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
ANB R7100                ; ﾏｸﾞﾈｯﾄ1 励磁
ANB R7101                ; ﾏｸﾞﾈｯﾄ1 強励磁
ANB LR10103              ; CAV_RB ﾜｰｸ記憶
ANL
JMP @MR1215
MPP
LDB R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
OR R7100                 ; ﾏｸﾞﾈｯﾄ1 励磁
OR R7101                 ; ﾏｸﾞﾈｯﾄ1 強励磁
OR LR10103               ; CAV_RB ﾜｰｸ記憶
ANL
JMP @MR1202
;*** Err 141 CAV搬送RBﾜｰｸ残
STG @MR1202
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #141 @DM1
CON
DW #4315 @DM2
CON
DW $4006 @DM9
CON
SET @MR100
CON
JMP @MR1203
STG @MR1203
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105
JMP @MR1204
MPP
AND @MR108
JMP @MR1205
STG @MR1204
RES MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
SET MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
CON
RES LR10103              ; CAV_RB ﾜｰｸ記憶
CON
JMP @MR1200
STG @MR1205
SET MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
RES MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
CON
JMP @MR1206
STG @MR1206
MPS
AND R4314                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT1
SET LR10103              ; CAV_RB ﾜｰｸ記憶
CON
JMP @MR1510
MPP
ANB R4314                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT1
JMP @MR1207
;*** Err 142 CAV搬送RBﾍｯﾄﾞ 吸着異常
STG @MR1207
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #142 @DM1
CON
DW #4314 @DM2
CON
DW $2400 @DM9
CON
SET @MR100
CON
JMP @MR1208
STG @MR1208
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105
JMP @MR1206
MPP
AND @MR106
JMP @MR1209
STG @MR1209
MPS
AND R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
RES LR10103              ; CAV_RB ﾜｰｸ記憶
CON
JMP @MR1215
MPP
ANB R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
JMP @MR1202
;***
STG @MR1215
MPS
ANB R41204               ; TASK4 PAUSE 要求
RES MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
SET MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
CON
RES MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
SET MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
CON
JMP @MR1510
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;★
STG @MR1510
AND @MR801
RES @MR801
CON
SET MR10008              ; Task4 HOME完了
CON
JMP @MR1515
STG @MR1515
MPS
LDB R41204               ; TASK4 PAUSE 要求
ANB @MR001
ANL
RES @MR1002
CON
JMP LR604                ; _Grp1_Task4_Fin.STG
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/>AUTO/自動動作
STG LR5404               ; _Grp1_Task4_AUTO.STG
JMP @MR3000
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1～32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000
MPS
ANB R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
MPS
ANB R57304               ; Task4 停止要求
SET @MR3002
CON
JMP @MR3003
MPP
AND R57304               ; Task4 停止要求
JMP @MR3910
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR3915
STG @MR3003
AND @MR801
RES @MR801
CON
JMP @MR3004
;仕掛ﾜｰｸﾁｪｯｸ
STG @MR3004
MPS
AND LR10103              ; CAV_RB ﾜｰｸ記憶
JMP @MR3400
MPP
ANB LR10103              ; CAV_RB ﾜｰｸ記憶
JMP @MR3100
;<h1/> CAV取出し
STG @MR3100
MPS
ANB R41204               ; TASK4 PAUSE 要求
MPS
ANB R57304               ; Task4 停止要求
MPS
LDB MR20300              ; Task3→4 CAV搬送RB 退避要求
AND MR20208              ; Task3→4 取出し要求
ANL
JMP @MR3107
MPP
AND MR20300              ; Task3→4 CAV搬送RB 退避要求
JMP @MR3101
MPP
AND R57304               ; Task4 停止要求
JMP @MR3910
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;ﾘﾝｸﾞ交換時 待機位置移動
STG @MR3101
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET @MR5400
CON
JMP @MR3102
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR3102
AND @MR5401
RES @MR5401
CON
MPS
ANB @MR5403
JMP @MR3100
MPP
AND @MR5403
JMP @MR3103
STG @MR3103
RES @MR5403
CON
JMP @MR3910
;CAV取出し
STG @MR3107
MPS
ANB R41204               ; TASK4 PAUSE 要求
INC.D DM5022             ; _生産ｶｳﾝﾀ2 INPUT
CON
SET @MR4500
CON
JMP @MR3108
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR3108
AND @MR4501
RES @MR4501
CON
MPS
LDB @MR4503
ANB @MR4504
ANL
JMP @MR3400
MRD
AND @MR4503
DEC.L DM22220            ; 残CAV数_装置_1ﾛｯﾄ_通信用
CON
DEC.L DM20012            ; 残CAV数概算値
CON
INC.D DM5026             ; _生産ｶｳﾝﾀ4 NG
CON
JMP @MR3109
MPP
AND @MR4504
DEC.D DM5022             ; _生産ｶｳﾝﾀ2 INPUT
CON
JMP @MR3110
STG @MR3109
RES @MR4503
CON
JMP @MR3100
STG @MR3110
RES @MR4504
CON
JMP @MR3910
;<h1/> 反転搬送へ給材
;反転 給材要求確認
STG @MR3400
MPS
LDB R41204               ; TASK4 PAUSE 要求
AND MR20400              ; Task5→4 給材要求
ANL
JMP @MR3401
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;反転搬送へ給材
STG @MR3401
SET @MR4900
CON
JMP @MR3402
STG @MR3402
AND @MR4901
RES @MR4901
CON
JMP @MR3700
;次移動判断  CAV取り出し不可なら待機位置へ
STG @MR3700
MPS
AND MR20208              ; Task3→4 取出し要求
JMP @MR3100
MPP
ANB MR20208              ; Task3→4 取出し要求
JMP @MR3701
;待機位置移動
STG @MR3701
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #2 @DM24
CON
SET @MR5600
CON
JMP @MR3702
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR3702
AND @MR5601
RES @MR5601
CON
JMP @MR3100
;★待機位置移動
STG @MR3910
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #2 @DM24
CON
SET @MR5600
CON
JMP @MR3911
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR3911
AND @MR5601
RES @MR5601
CON
JMP @MR3915
;<h1/>Auto終了処理
STG @MR3915
MPS
LDB R41204               ; TASK4 PAUSE 要求
ANB @MR001
ANB @MR4002
ANL
RES @MR3002
CON
JMP LR604                ; _Grp1_Task4_Fin.STG
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000
SET @MR4002
CON
JMP @MR4003
STG @MR4003
JMP @MR4415
STG @MR4415
SET @MR4001
CON
RES @MR4002
CON
ENDS
;<h1/>MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1～32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5604               ; _Grp1_Task4_MAINTE.STG
JMP @MR2000
STG @MR2000
SET @MR2002
CON
JMP @MR2003
STG @MR2003
MPS
LD= DM4110 #6            ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #11           ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2004
MPP
LD<> DM4110 #6           ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #11         ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2915
;ｽﾃｯﾌﾟor通常　か選択
STG @MR2004
LD= DM4110 #6            ; _Group1　ﾒﾝﾃ動作番号
AND MR11006              ; Mainte_Select_06
LD= DM4110 #11           ; _Group1　ﾒﾝﾃ動作番号
AND MR11011              ; Mainte_Select_11
ORL
ANL
JMP @MR2100
;<h1/>  STEP6 CAV取出し → 反転搬送  移載
;<h1/>  STEP11 CAV取出し
STG @MR2100
SET @MR4500
CON
JMP @MR2101
STG @MR2101
AND @MR4501
RES @MR4501
CON
MPS
LDB @MR4503
ANB @MR4504
ANL
MPS
AND= DM4110 #6           ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2102
MPP
AND= DM4110 #11          ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2104
MPP
LD @MR4503
OR @MR4504
ANL
RES @MR4503
CON
RES @MR4504
CON
JMP @MR2914
STG @MR2102
SET @MR4900
CON
JMP @MR2103
STG @MR2103
AND @MR4901
RES @MR4901
CON
JMP @MR2104
STG @MR2104
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #2 @DM24
CON
SET @MR5600
CON
JMP @MR2105
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR2105
AND @MR5601
RES @MR5601
CON
JMP @MR2914
;Maintenance 終了
STG @MR2914
MCALL MODE_INDI #2
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
JMP @MR2915
STG @MR2915
MPS
LD R41204                ; TASK4 PAUSE 要求
ANB @MR001
ANL
SET @MR1900
MPP
ANB R41204               ; TASK4 PAUSE 要求
RES @MR2002
CON
JMP LR604                ; _Grp1_Task4_Fin.STG
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;<h1/> CAV取出し動作   @MR4500
STG @MR4500
SET @MR4502
CON
JMP @MR4508
;取出し要求待ち  （反転給材要求待ち）
STG @MR4508
MPS
ANB R41204               ; TASK4 PAUSE 要求
MPS
LDB R57304               ; Task4 停止要求
AND MR20208              ; Task3→4 取出し要求
ANL
SET MR20213              ; Task4→3 取り出し動作中
CON
JMP @MR4509
MPP
AND R57304               ; Task4 停止要求
JMP @MR4815
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4509
MPS
AND MR20209              ; Task3→4 取出し動作受動中
JMP @MR4600
MPP
LDB MR20209              ; Task3→4 取出し動作受動中
ANB MR20208              ; Task3→4 取出し要求
ANL
RES MR20213              ; Task4→3 取り出し動作中
CON
JMP @MR4508
;ｱﾗｲﾒﾝﾄ計測位置移動
STG @MR4600
MPS
ANB R41204               ; TASK4 PAUSE 要求
MPS
DW #3 @DM24
CON
SET @MR5600
CON
JMP @MR4601
MPP
MOV DM20030 DM11360      ; CAV取出しﾎﾟｼﾞｼｮﾝNo.  取出しポジションNo.（1～60）
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4601
AND @MR5601
DW #1 @DM12
CON
RES @MR5601
CON
JMP @MR4602
;ｱﾗｲﾒﾝﾄ計測
STG @MR4602
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #4 @DM24
CON
SET @MR5600
CON
JMP @MR4603
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4603
AND @MR5601
RES @MR5601
CON
MPS
LD DM11155.10            ; 画像OK
ANB DM11155.11           ; 画像NG
ANB DM11155.12           ; 機種NG
ANL
JMP @MR4700
MPP
LDB DM11155.10           ; 画像OK
LD DM11155.11            ; 画像NG
OR DM11155.12            ; 機種NG
ANL
ANL
JMP @MR4604
;ｱﾗｲﾒﾝﾄﾘﾄﾗｲ判断
STG @MR4604
MPS
AND< @DM12 DM7086        ; 基礎ﾃﾞｰﾀ44 ｱﾗｲﾒﾝﾄﾘﾄﾗｲ回数
JMP @MR4605
MPP
AND>= @DM12 DM7086       ; 基礎ﾃﾞｰﾀ44 ｱﾗｲﾒﾝﾄﾘﾄﾗｲ回数
JMP @MR4606
STG @MR4605
INC @DM12
CON
JMP @MR4602
STG @MR4606
MPS
AND DM11155.11           ; 画像NG
JMP @MR4607
MPP
AND DM11155.12           ; 機種NG
JMP @MR4609
;*** Err 145 CAV取出し ｱﾗｲﾒﾝﾄ計測NG
STG @MR4607
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #145 @DM1
CON
DW #4314 @DM2
CON
DW $290C @DM9
CON
SET @MR100
CON
JMP @MR4608
STG @MR4608
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105
JMP @MR4602
MRD
AND @MR106
SET @MR4503
CON
JMP @MR4813
MPP
AND @MR108
SET @MR4503
CON
SET MR20214              ; Task4→3 ﾘﾝｸﾞ交換選択
CON
JMP @MR4611
;*** Err 146 CAV取出し ｱﾗｲﾒﾝﾄ機種NG
STG @MR4609
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #146 @DM1
CON
DW #4314 @DM2
CON
DW $290C @DM9
CON
SET @MR100
CON
JMP @MR4610
STG @MR4610
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105
JMP @MR4600
MRD
AND @MR106
SET @MR4503
CON
JMP @MR4813
MPP
AND @MR108
SET @MR4503
CON
SET MR20214              ; Task4→3 ﾘﾝｸﾞ交換選択
CON
JMP @MR4611
;***待機位置移動
STG @MR4611
LDA DM20012              ; 残CAV数概算値
CON
SUB DM7022               ; 装置基礎ﾃﾞｰﾀ12 CAV数/ﾘﾝｸﾞ
CON
ADD DM20030              ; CAV取出しﾎﾟｼﾞｼｮﾝNo.
CON
STA DM20012              ; 残CAV数概算値
CON
JMP @MR4612
STG @MR4612
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #2 @DM24
CON
SET @MR5600
CON
JMP @MR4613
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4613
AND @MR5601
RES @MR5601
CON
JMP @MR4813
;***
;取出し位置移動
LD CR2002                ; 常時ON
MPS
LDA DM20016              ; PZT CAV要求個数
CON
SUB DM20018              ; 内部留保CAV個数
CON
STA @DM10
MRD
AND= @DM10 #1
TMR @23 #20
MPP
LD>= @DM10 #2
OR @T23
OR DM2000.2              ; 下流 OFF-LINE
ANL
OUT MR20509              ; CAV取出し可能
STG @MR4700
MPS
ANB R57304               ; Task4 停止要求
MPS
ANB R41204               ; TASK4 PAUSE 要求
MPS
LD MR20208               ; Task3→4 取出し要求
AND MR20400              ; Task5→4 給材要求
AND MR20509              ; CAV取出し可能
ANL
JMP @MR4701
MPP
ANB MR20208              ; Task3→4 取出し要求
SET @MR4504
CON
JMP @MR4813
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
MPP
AND R57304               ; Task4 停止要求
SET @MR4504
CON
JMP @MR4813
STG @MR4701
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #5 @DM24
CON
SET @MR5600
CON
JMP @MR4702
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4702
AND @MR5601
RES @MR5601
CON
JMP @MR4703
;CAV吸着
STG @MR4703
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET LR10103              ; CAV_RB ﾜｰｸ記憶
CON
MPS
SET MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
RES MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
MRD
SET MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
RES MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
MPP
JMP @MR4704
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4704
MPS
TMH @10 #30
CON
AND @T10
JMP @MR4705
MPP
AND= DM20030 #1          ; CAV取出しﾎﾟｼﾞｼｮﾝNo.
TMH @11 #800
CON
AND @T11
ANB CR2002               ; 常時ON
JMP @MR4705
;Z軸上昇
STG @MR4705
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #6 @DM24
CON
SET @MR5600
CON
JMP @MR4706
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4706
AND @MR5601
RES @MR5601
CON
JMP @MR4707
;引き剥がしｳｪｲﾄ？
STG @MR4707
TMH @20 #10
CON
AND @T20
JMP @MR4800
;CAV確認
STG @MR4800
MPS
ANB R41204               ; TASK4 PAUSE 要求
MPS
AND R4314                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT1
JMP @MR4812
MPP
ANB R4314                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT1
TMR @22 #30
CON
AND @T22
JMP @MR4801
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;*** Err 142 CAV搬送RBﾍｯﾄﾞ 吸着異常
STG @MR4801
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #142 @DM1
CON
DW #4314 @DM2
CON
DW $D40A @DM9
CON
SET @MR100
CON
JMP @MR4802
STG @MR4802
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105
JMP @MR4800
MRD
AND @MR106
RES @MR802
CON
JMP @MR4803
MPP
AND @MR108
SET @MR802
CON
JMP @MR4803
STG @MR4803
RES MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
SET MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
CON
MPS
AND R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
RES LR10103              ; CAV_RB ﾜｰｸ記憶
CON
JMP @MR4806
MPP
ANB R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
TMR @15 #30
CON
AND @T15
JMP @MR4804
;*** Err 144 CAV搬送RBﾜｰｸ残
STG @MR4804
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #144 @DM1
CON
DW #4315 @DM2
CON
DW $4000 @DM9
CON
SET @MR100
CON
JMP @MR4805
STG @MR4805
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR4803
;***
STG @MR4806
RES MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
SET MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
CON
MPS
ANB @MR802
SET @MR4503
CON
JMP @MR4813
MPP
AND @MR802
JMP @MR4600
;***再取出し選択
STG @MR4807
RES @MR802
CON
JMP @MR4700
;***
;ﾏｸﾞﾈｯﾄOFF
STG @MR4812
MPS
JMP @MR4813
MPP
ANB MR21000              ; 仮 NAT
SET MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
RES MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
;Task3とH/S
STG @MR4813
RES MR20213              ; Task4→3 取り出し動作中
CON
SET MR20212              ; Task4→3 取出し動作完了
CON
JMP @MR4814
STG @MR4814
ANB MR20208              ; Task3→4 取出し要求
ANB MR20209              ; Task3→4 取出し動作受動中
RES MR20215              ; Task4→3 取り出し動作中断
CON
RES MR20212              ; Task4→3 取出し動作完了
CON
JMP @MR4815
;終了
STG @MR4815
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET @MR4501
CON
RES @MR4502
CON
ENDS
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/> 反転搬送へ給材   @MR4900
STG @MR4900
SET @MR4902
CON
JMP @MR4905
;反転 給材要求確認
STG @MR4905
MPS
LDB R41204               ; TASK4 PAUSE 要求
AND MR20400              ; Task5→4 給材要求
ANL
JMP @MR4909
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;反転上空位置移動
STG @MR4906
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #10 @DM24
CON
SET @MR5600
CON
JMP @MR4907
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4907
AND @MR5601
RES @MR5601
CON
JMP @MR4909
;Task5 給材要求待ち
STG @MR4909
MPS
LDB R41204               ; TASK4 PAUSE 要求
AND MR20400              ; Task5→4 給材要求
ANL
SET MR20405              ; Task4→5 給材動作中
CON
JMP @MR4910
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4910
MPS
AND MR20401              ; Task5→4 給材動作受動中
JMP @MR4911
MPP
LDB MR20401              ; Task5→4 給材動作受動中
ANB MR20400              ; Task5→4 給材要求
ANL
RES MR20405              ; Task4→5 給材動作中
CON
JMP @MR4905
;反転受渡し位置移動
STG @MR4911
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #11 @DM24
CON
SET @MR5600
CON
JMP @MR4912
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR4912
AND @MR5601
RES @MR5601
CON
JMP @MR5000
;反転搬送へ吸着要求
STG @MR5000
MPS
SET MR20406              ; Task4→5   CAV固定要求
CON
JMP @MR5001
MPP
RES MR7100               ; ﾏｸﾞﾈｯﾄ1 励磁
CON
RES MR7101               ; ﾏｸﾞﾈｯﾄ1 強励磁
CON
SET MR7102               ; ﾏｸﾞﾈｯﾄ1 励磁OFF
STG @MR5001
MPS
LDB R41204               ; TASK4 PAUSE 要求
AND MR20402              ; Task5→4 CAV固定完了
ANL
JMP @MR5002
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;CAVﾘﾘｰｽ
STG @MR5002
MPS
RES MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
SET MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
SET MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
MPP
JMP @MR5003
STG @MR5003
ANB R1013                ; 電磁ﾏｸﾞﾈｯﾄ 励磁中
ANB R1014                ; 電磁ﾏｸﾞﾈｯﾄ 消磁中
MPS
AND R4510                ; CAV反転 吸着確認 OUT1
JMP @MR5004
MPP
ANB R4510                ; CAV反転 吸着確認 OUT1
TMR @16 #100
CON
AND @T16
JMP @MR5004
;Z軸上昇
STG @MR5004
DW #14 @DM24
CON
SET @MR5600
CON
JMP @MR5005
STG @MR5005
AND @MR5601
RES @MR5601
CON
JMP @MR5100
;CAV残確認
STG @MR5100
SET MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
RES MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
CON
TMH @12 #30
CON
AND @T12
JMP @MR5101
STG @MR5101
MPS
AND R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
RES LR10103              ; CAV_RB ﾜｰｸ記憶
CON
JMP @MR5104
MPP
ANB R4315                ; CAV搬送RB 吸着ﾍｯﾄﾞ吸着圧 OUT2
TMR @21 #30
CON
AND @T21
SET MR20407              ; Task4→5 給材動作ｴﾗｰ
CON
JMP @MR5102
;*** Err 144 CAV搬送RBﾜｰｸ残
STG @MR5102
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #144 @DM1
CON
DW #4315 @DM2
CON
DW $4000 @DM9
CON
SET @MR100
CON
JMP @MR5103
STG @MR5103
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5101
;***
;Task5 H/S
STG @MR5104
RES MR7200               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着ON
CON
SET MR7201               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着OFF
CON
RES MR7202               ; CAV搬送RB 吸着ﾍｯﾄﾞ 吸着破壊ON
CON
JMP @MR5105
STG @MR5105
RES MR20406              ; Task4→5   CAV固定要求
CON
RES MR20405              ; Task4→5 給材動作中
CON
SET MR20404              ; Task4→5 給材動作完了
CON
JMP @MR5106
STG @MR5106
MPS
LDB R41204               ; TASK4 PAUSE 要求
ANB MR20400              ; Task5→4 給材要求
ANB MR20401              ; Task5→4 給材動作受動中
ANB MR20402              ; Task5→4 CAV固定完了
ANL
RES MR20407              ; Task4→5 給材動作ｴﾗｰ
CON
RES MR20404              ; Task4→5 給材動作完了
CON
JMP @MR5108
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;終了
STG @MR5108
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET @MR4901
CON
RES @MR4902
CON
ENDS
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/> 待機位置逃げ   @MR5400
STG @MR5400
SET @MR5402
CON
JMP @MR5405
;Task3 H/S ①
STG @MR5405
MPS
LDB R57304               ; Task4 停止要求
AND MR20300              ; Task3→4 CAV搬送RB 退避要求
ANL
SET MR20305              ; Task4→3 CAV搬送RB 退避中
CON
JMP @MR5406
MPP
AND R57304               ; Task4 停止要求
SET @MR5403
CON
JMP @MR5411
STG @MR5406
MPS
AND MR20301              ; Task3→4 RB退避動作受動中
JMP @MR5407
MPP
LDB MR20301              ; Task3→4 RB退避動作受動中
ANB MR20300              ; Task3→4 CAV搬送RB 退避要求
ANL
RES MR20305              ; Task4→3 CAV搬送RB 退避中
CON
JMP @MR5405
;待機位置移動
STG @MR5407
MPS
ANB R41204               ; TASK4 PAUSE 要求
DW #2 @DM24
CON
SET @MR5600
CON
JMP @MR5408
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
STG @MR5408
AND @MR5601
RES @MR5601
CON
JMP @MR5409
;Task3 H/S ②
STG @MR5409
RES MR20305              ; Task4→3 CAV搬送RB 退避中
CON
SET MR20304              ; Task4→3 CAV搬送RB 退避完了
CON
JMP @MR5410
STG @MR5410
ANB MR20300              ; Task3→4 CAV搬送RB 退避要求
ANB MR20301              ; Task3→4 RB退避動作受動中
RES MR20304              ; Task4→3 CAV搬送RB 退避完了
CON
JMP @MR5411
;終了
STG @MR5411
MPS
ANB R41204               ; TASK4 PAUSE 要求
SET @MR5401
CON
RES @MR5402
CON
ENDS
MPP
AND R41204               ; TASK4 PAUSE 要求
SET @MR1900
;<h1/>  RC700 CAV搬送RB 移動   @MR5600
STG @MR5600
SET @MR5602
CON
JMP @MR5605
STG @MR5605
MPS
SET DM11350.7            ; Rest
CON
ANB DM11150.3            ; Error
ANB DM11150.6            ; SEroor
RES DM11350.7            ; Rest
CON
JMP @MR5606
MPP
TMR @17 #20
CON
AND @T17
JMP @MR5610
STG @MR5606
RES DM11350.9            ; SetMotorsOff
CON
SET DM11350.8            ; SetMotorsOn
CON
MPS
AND DM11150.8            ; MotorsOn
RES DM11350.8            ; SetMotorsOn
CON
JMP @MR5607
MPP
ANB DM11150.8            ; MotorsOn
TMR @18 #20
CON
AND @T18
JMP @MR5610
STG @MR5607
SET DM11350.0            ; Start
CON
MPS
AND DM11150.1            ; Running
RES DM11350.0            ; Start
CON
JMP @MR5608
MPP
ANB DM11150.1            ; Running
TMR @19 #20
CON
AND @T19
JMP @MR5610
STG @MR5608
DW #0 @DM26
CON
JMP @MR5609
LD @MR5609
MSTRT RC7_MOVE_1 @DM24 DM11150 DM11350 @DM26;CAV RB I/F IN1  CAV RB I/F OUT1
STG @MR5609
MPS
AND= @DM26 #20
JMP @MR5615
MPP
LD<> @DM26 #20
AND<> @DM26 #0
ANL
JMP @MR5610
;*** Err 143 CAV搬送RBｺﾝﾄﾛｰﾗ異常
STG @MR5610
RES DM11350.7            ; Rest
CON
RES DM11350.8            ; SetMotorsOn
CON
SET DM11350.9            ; SetMotorsOff
CON
RES DM11350.0            ; Start
CON
JMP @MR5611
STG @MR5611
SET @MR1900
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #143 @DM1
CON
DW #4007 @DM2
CON
DW $1000 @DM9
CON
SET @MR100
CON
JMP @MR5612
STG @MR5612
SET @MR1900
CON
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5600
;***
;終了処理
STG @MR5615
ANB _RC7_MOVE_1
SET @MR5601
CON
RES @MR5602
CON
ENDS
;<h1/>I/F
LD<> DM4110 #25          ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #26         ; _Group1　ﾒﾝﾃ動作番号
OR R46111                ; _AUTOﾓｰﾄﾞ選択中
MPS
AND DM11155.2            ; 照明ON要求
SET MR1113               ; 画像照明ON
MRD
ANB DM11155.2            ; 照明ON要求
RES MR1113               ; 画像照明ON
MRD
AND DM11155.3            ; 照明下降要求
RES MR7501               ; CAV搬送RB 照明上昇
CON
SET MR7500               ; CAV搬送RB 照明下降
MPP
ANB DM11155.3            ; 照明下降要求
RES MR7500               ; CAV搬送RB 照明下降
CON
SET MR7501               ; CAV搬送RB 照明上昇
;-----------------------------------------------------------
;DM11356 = DM5260													'CAV RB 品種番号
;DM11359 = DM7084													'CAV RB 反転ﾍｯﾄﾞへの挿入速度切替高さ(mm)
;IF MR001 AND DM7000.D>= 1 AND DM7000.D <=100 THEN 
;  DM11357.U = INT(FLOAT(DM7080.D) * (FLOAT(DM7000.D) / 100))		'CAV RB 通常速度(1～100)
;  DM11358.U = INT(FLOAT(DM7082.D) * (FLOAT(DM7000.D) / 100))		'CAV RB 挿入速度(1～100)
;ELSE
;  DM11357.U = DM7080.D												'CAV RB 通常速度(1～100)
;  DM11358.U = DM7082.D												'CAV RB 挿入速度(1～100)
;END IF
;DM11356 = DM5260													'CAV RB 品種番号
;
LD CR2002                ; 常時ON
MOV DM5260 DM11356       ; 選択中ｺｰﾄﾞ  品種番号
;DM11359 = DM7084													'CAV RB 反転ﾍｯﾄﾞへの挿入速度切替高さ(mm)
;
LD CR2002                ; 常時ON
MOV DM7084 DM11359       ; 基礎ﾃﾞｰﾀ43 CAV RB 切替高さ(mm)  速度切換高さ
;IF MR001 AND DM7000.D>= 1 AND DM7000.D <=100 THEN 
;
LD>=.D DM7000 #1         ; 装置基礎ﾃﾞｰﾀ1 RB速度OVERRIDE
AND MR001                ; 速度低速設定
OUT @VB00
LD<=.D DM7000 #100       ; 装置基礎ﾃﾞｰﾀ1 RB速度OVERRIDE
AND @VB00
NCJ #2018
;  DM11357.U = INT(FLOAT(DM7080.D) * (FLOAT(DM7000.D) / 100))		'CAV RB 通常速度(1～100)
;
LD CR2002                ; 常時ON
LDA.D DM7000             ; 装置基礎ﾃﾞｰﾀ1 RB速度OVERRIDE
CON
FLOAT.D
CON
DIV.F +100
CON
STA.F @VM9
CON
LDA.D DM7080             ; 基礎ﾃﾞｰﾀ41 CAV RB 通常速度(%)
CON
FLOAT.D
CON
MUL.F @VM9
CON
INTG.L
CON
STA DM11357              ; 通常スピード
;  DM11358.U = INT(FLOAT(DM7082.D) * (FLOAT(DM7000.D) / 100))		'CAV RB 挿入速度(1～100)
;
LD CR2002                ; 常時ON
LDA.D DM7000             ; 装置基礎ﾃﾞｰﾀ1 RB速度OVERRIDE
CON
FLOAT.D
CON
DIV.F +100
CON
STA.F @VM11
CON
LDA.D DM7082             ; 基礎ﾃﾞｰﾀ42 CAV RB 挿入速度(%)
CON
FLOAT.D
CON
MUL.F @VM11
CON
INTG.L
CON
STA DM11358              ; 挿入スピード
;ELSE
;
LD CR2002                ; 常時ON
CJ #2019
LABEL #2018
;  DM11357.U = DM7080.D												'CAV RB 通常速度(1～100)
;
LD CR2002                ; 常時ON
MOV DM7080 DM11357       ; 基礎ﾃﾞｰﾀ41 CAV RB 通常速度(%)  通常スピード
;  DM11358.U = DM7082.D												'CAV RB 挿入速度(1～100)
;
LD CR2002                ; 常時ON
MOV DM7082 DM11358       ; 基礎ﾃﾞｰﾀ42 CAV RB 挿入速度(%)  挿入スピード
;END IF
LABEL #2019
;
;CAV_RB 取出し位置ﾃﾞｰﾀ設定
;DM20031 = $1803					'移動するPOINT No.を指定します。
;DM20032 = $1805					'上位8ﾊﾞｲﾄ:X軸  下位8ﾊﾞｲﾄ:Y軸
;DM20033 = $1703					'ex) "0515"はX軸=P5,Y軸=P15となります。
;DM20034 = $1705
;DM20035 = $1602
;DM20036 = $1604
;DM20037 = $1606
;DM20038 = $1502
;DM20039 = $1504
;DM20040 = $1506
;DM20041 = $1401
;DM20042 = $1403
;DM20043 = $1405
;DM20044 = $1407
;DM20045 = $1301
;DM20046 = $1303
;DM20047 = $1305
;DM20048 = $1307
;DM20049 = $1201
;DM20050 = $1203
;DM20051 = $1205
;DM20052 = $1206
;DM20053 = $1101
;DM20054 = $1103
;DM20055 = $1105
;DM20056 = $1107
;DM20057 = $1001
;DM20058 = $1003
;DM20059 = $1005
;DM20060 = $1007
;DM20061 = $0901
;DM20062 = $0903
;DM20063 = $0905
;DM20064 = $0907
;DM20065 = $0801
;DM20066 = $0803
;DM20067 = $0805
;DM20068 = $0807
;DM20069 = $0701
;DM20070 = $0703
;DM20071 = $0705
;DM20072 = $0707
;DM20073 = $0601
;DM20074 = $0603
;DM20075 = $0605
;DM20076 = $0607
;DM20077 = $0501
;DM20078 = $0503
;DM20079 = $0505
;DM20080 = $0507
;DM20081 = $0402
;DM20082 = $0404
;DM20083 = $0406
;DM20084 = $0302
;DM20085 = $0304
;DM20086 = $0306
;DM20087 = $0203
;DM20088 = $0205
;DM20089 = $0103
;DM20090 = $0105
;
;set(@MR801)
LD @MR3003
OR @MR1510
NCJ #1003
;DM20031 = $1803					'移動するPOINT No.を指定します。
;
LD CR2002                ; 常時ON
MOV $1803 DM20031        ; No.1 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20032 = $1805					'上位8ﾊﾞｲﾄ:X軸  下位8ﾊﾞｲﾄ:Y軸
;
LD CR2002                ; 常時ON
MOV $1805 DM20032        ; No.2 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20033 = $1703					'ex) "0515"はX軸=P5,Y軸=P15となります。
;
LD CR2002                ; 常時ON
MOV $1703 DM20033        ; No.3 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20034 = $1705
;
LD CR2002                ; 常時ON
MOV $1705 DM20034        ; No.4 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20035 = $1602
;
LD CR2002                ; 常時ON
MOV $1602 DM20035        ; No.5 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20036 = $1604
;
LD CR2002                ; 常時ON
MOV $1604 DM20036        ; No.6 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20037 = $1606
;
LD CR2002                ; 常時ON
MOV $1606 DM20037        ; No.7 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20038 = $1502
;
LD CR2002                ; 常時ON
MOV $1502 DM20038        ; No.8 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20039 = $1504
;
LD CR2002                ; 常時ON
MOV $1504 DM20039        ; No.9 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20040 = $1506
;
LD CR2002                ; 常時ON
MOV $1506 DM20040        ; No.10 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20041 = $1401
;
LD CR2002                ; 常時ON
MOV $1401 DM20041        ; No.11 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20042 = $1403
;
LD CR2002                ; 常時ON
MOV $1403 DM20042        ; No.12 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20043 = $1405
;
LD CR2002                ; 常時ON
MOV $1405 DM20043        ; No.13 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20044 = $1407
;
LD CR2002                ; 常時ON
MOV $1407 DM20044        ; No.14 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20045 = $1301
;
LD CR2002                ; 常時ON
MOV $1301 DM20045        ; No.15 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20046 = $1303
;
LD CR2002                ; 常時ON
MOV $1303 DM20046        ; No.16 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20047 = $1305
;
LD CR2002                ; 常時ON
MOV $1305 DM20047        ; No.17 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20048 = $1307
;
LD CR2002                ; 常時ON
MOV $1307 DM20048        ; No.18 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20049 = $1201
;
LD CR2002                ; 常時ON
MOV $1201 DM20049        ; No.19 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20050 = $1203
;
LD CR2002                ; 常時ON
MOV $1203 DM20050        ; No.20 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20051 = $1205
;
LD CR2002                ; 常時ON
MOV $1205 DM20051        ; No.21 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20052 = $1206
;
LD CR2002                ; 常時ON
MOV $1206 DM20052        ; No.22 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20053 = $1101
;
LD CR2002                ; 常時ON
MOV $1101 DM20053        ; No.23 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20054 = $1103
;
LD CR2002                ; 常時ON
MOV $1103 DM20054        ; No.24 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20055 = $1105
;
LD CR2002                ; 常時ON
MOV $1105 DM20055        ; No.25 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20056 = $1107
;
LD CR2002                ; 常時ON
MOV $1107 DM20056        ; No.26 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20057 = $1001
;
LD CR2002                ; 常時ON
MOV $1001 DM20057        ; No.27 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20058 = $1003
;
LD CR2002                ; 常時ON
MOV $1003 DM20058        ; No.28 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20059 = $1005
;
LD CR2002                ; 常時ON
MOV $1005 DM20059        ; No.29 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20060 = $1007
;
LD CR2002                ; 常時ON
MOV $1007 DM20060        ; No.30 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20061 = $0901
;
LD CR2002                ; 常時ON
MOV $0901 DM20061        ; No.31 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20062 = $0903
;
LD CR2002                ; 常時ON
MOV $0903 DM20062        ; No.32 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20063 = $0905
;
LD CR2002                ; 常時ON
MOV $0905 DM20063        ; No.33 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20064 = $0907
;
LD CR2002                ; 常時ON
MOV $0907 DM20064        ; No.34 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20065 = $0801
;
LD CR2002                ; 常時ON
MOV $0801 DM20065        ; No.35 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20066 = $0803
;
LD CR2002                ; 常時ON
MOV $0803 DM20066        ; No.36 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20067 = $0805
;
LD CR2002                ; 常時ON
MOV $0805 DM20067        ; No.37 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20068 = $0807
;
LD CR2002                ; 常時ON
MOV $0807 DM20068        ; No.38 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20069 = $0701
;
LD CR2002                ; 常時ON
MOV $0701 DM20069        ; No.39 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20070 = $0703
;
LD CR2002                ; 常時ON
MOV $0703 DM20070        ; No.40 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20071 = $0705
;
LD CR2002                ; 常時ON
MOV $0705 DM20071        ; No.41 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20072 = $0707
;
LD CR2002                ; 常時ON
MOV $0707 DM20072        ; No.42 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20073 = $0601
;
LD CR2002                ; 常時ON
MOV $0601 DM20073        ; No.43 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20074 = $0603
;
LD CR2002                ; 常時ON
MOV $0603 DM20074        ; No.44 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20075 = $0605
;
LD CR2002                ; 常時ON
MOV $0605 DM20075        ; No.45 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20076 = $0607
;
LD CR2002                ; 常時ON
MOV $0607 DM20076        ; No.46 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20077 = $0501
;
LD CR2002                ; 常時ON
MOV $0501 DM20077        ; No.47 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20078 = $0503
;
LD CR2002                ; 常時ON
MOV $0503 DM20078        ; No.48 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20079 = $0505
;
LD CR2002                ; 常時ON
MOV $0505 DM20079        ; No.49 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20080 = $0507
;
LD CR2002                ; 常時ON
MOV $0507 DM20080        ; No.50 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20081 = $0402
;
LD CR2002                ; 常時ON
MOV $0402 DM20081        ; No.51 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20082 = $0404
;
LD CR2002                ; 常時ON
MOV $0404 DM20082        ; No.52 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20083 = $0406
;
LD CR2002                ; 常時ON
MOV $0406 DM20083        ; No.53 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20084 = $0302
;
LD CR2002                ; 常時ON
MOV $0302 DM20084        ; No.54 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20085 = $0304
;
LD CR2002                ; 常時ON
MOV $0304 DM20085        ; No.55 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20086 = $0306
;
LD CR2002                ; 常時ON
MOV $0306 DM20086        ; No.56 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20087 = $0203
;
LD CR2002                ; 常時ON
MOV $0203 DM20087        ; No.57 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20088 = $0205
;
LD CR2002                ; 常時ON
MOV $0205 DM20088        ; No.58 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20089 = $0103
;
LD CR2002                ; 常時ON
MOV $0103 DM20089        ; No.59 取出しﾎﾟｼﾞｼｮﾝNO.
;DM20090 = $0105
;
LD CR2002                ; 常時ON
MOV $0105 DM20090        ; No.60 取出しﾎﾟｼﾞｼｮﾝNO.
;set(@MR801)
LD CR2002                ; 常時ON
SET @MR801
LABEL #1003
;
;<h1/>-----------------------------------------------------------
;<h1/>*ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108
CON
DISN @DM9 @DM3 #4
MRD
DW MyTask @DM0           ; 自ﾀｽｸ番号
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102
CON
SET @MR101
CON
ENDS
;<h1/>*Select_Y_N 
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307
CON
DW MyTask @DM20          ; 自ﾀｽｸ番号
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302
CON
SET @MR301
CON
ENDS
;<h1/>*TIMEUP ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW MyTask @DM40          ; 自ﾀｽｸ番号
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402
CON
SET @MR401
CON
ENDS
;<h1/>*Select_ACT 
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208
CON
DW MyTask @DM30          ; 自ﾀｽｸ番号
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202
CON
SET @MR201
CON
ENDS
;<h1/>HALT
LD R41204                ; TASK4 PAUSE 要求
AND @MR1900
LD @MR1901
ORB @MR4002
ANL
TMR @40 #5
CON
AND @T40
SET R42604               ; Grp1_Task4_ﾎﾟｰｽﾞ許可
LD R42604                ; Grp1_Task4_ﾎﾟｰｽﾞ許可
ORB R41204               ; TASK4 PAUSE 要求
ANB @MR001
RES @MR1900
CON
RES @MR1901
END
ENDH
