DEVICE:53
;MODULE:TASK4
;MODULE_TYPE:0
;SCRIPT_TYPE:
;***************************************
; 非常停止
; Emergency Stop 
;***************************************
LD R40013                ; 非常停止
OR @MR000                ; Emergency STOP
ZRES @MR100 @MR9915      ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
CON
OUT @MR000               ; Emergency STOP
TMR @39 #5               ; ｳｴｲﾄﾀｲﾏｰ39
LD @T39                  ; ｳｴｲﾄﾀｲﾏｰ39
MDSTOP TASK4
;動作ﾊﾟﾗﾒｰﾀ
;Operation Parameter
LD= DM1402 #1            ; AUTO_PARAMETER
OUT @MR013               ; TASK4 AUTO Parameter OK
;重量ﾃﾞｰﾀ / Ink weight data geting    【unit : mg】
;'重量規格値を算出  単位はmg
;DM2830.D = 1000										'Blackの警告幅  上下限からこの幅以内だと警告発生
;DM2832.D = 1000										'Colorの警告幅
;
;DM2814.L =	FM500.L									'Black上限異常値
;DM2816.L =	FM502.L									'Black下限異常値
;DM2818.L =	FM504.L									'Color上限異常値
;DM2820.L =	FM506.L									'Color下限異常値
;
;DM2822.L =	FM500.L - DM2830 						'Black上限警報値
;DM2824.L =	FM502.L + DM2830						'Black下限警報値
;DM2826.L =	FM504.L - DM2832						'Color上限警報値
;DM2828.L =	FM506.L + DM2832						'Color下限警報値	
;'重量規格値を算出  単位はmg
;
;DM2830.D = 1000										'Blackの警告幅  上下限からこの幅以内だと警告発生
;
LD CR2002                ; 常時ON
MOV.D #1000 DM2830       ; BK警告ﾚﾝｼﾞ
;DM2832.D = 1000										'Colorの警告幅
;
LD CR2002                ; 常時ON
MOV.D #1000 DM2832       ; CL警告ﾚﾝｼﾞ
;DM2814.L =	FM500.L									'Black上限異常値
;
LD CR2002                ; 常時ON
MOV.L FM500 DM2814       ; BK重量上限異常値
;DM2816.L =	FM502.L									'Black下限異常値
;
LD CR2002                ; 常時ON
MOV.L FM502 DM2816       ; BK重量下限異常値
;DM2818.L =	FM504.L									'Color上限異常値
;
LD CR2002                ; 常時ON
MOV.L FM504 DM2818       ; CL重量上限異常値
;DM2820.L =	FM506.L									'Color下限異常値
;
LD CR2002                ; 常時ON
MOV.L FM506 DM2820       ; CL重量下限異常値
;DM2822.L =	FM500.L - DM2830 						'Black上限警報値
;
LD CR2002                ; 常時ON
LDA DM2830               ; BK警告ﾚﾝｼﾞ
CON
EXT
CON
STA.L @VM0
CON
LDA.L FM500
CON
SUB.L @VM0
CON
STA.L DM2822             ; BK重量上限警告値
;DM2824.L =	FM502.L + DM2830						'Black下限警報値
;
LD CR2002                ; 常時ON
LDA DM2830               ; BK警告ﾚﾝｼﾞ
CON
EXT
CON
ADD.L FM502
CON
STA.L DM2824             ; BK重量下限警告値
;DM2826.L =	FM504.L - DM2832						'Color上限警報値
;
LD CR2002                ; 常時ON
LDA DM2832               ; CL警告ﾚﾝｼﾞ
CON
EXT
CON
STA.L @VM2
CON
LDA.L FM504
CON
SUB.L @VM2
CON
STA.L DM2826             ; CL重量上限警告値
;DM2828.L =	FM506.L + DM2832						'Color下限警報値	
LD CR2002                ; 常時ON
LDA DM2832               ; CL警告ﾚﾝｼﾞ
CON
EXT
CON
ADD.L FM506
CON
STA.L DM2828             ; CL重量下限警告値
;
;***************************************
; ﾎﾟｰｽﾞ ･ ｴﾗｰ 監視
; Pause ･ Error Check 
;***************************************
LDB R40005               ; ﾎﾟｰｽﾞ中
ANB R41003               ; TASK4 ERROR中
MPS
OUT @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPP
AND R1007                ; NG BOX 扉 Close
OUT @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
;Flags.
LD R4010                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
MPS
AND R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
OUT @MR001               ; 4ST ﾜｰｸ有
MPP
ANB R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
OUT @MR002               ; 4ST ﾜｰｸ無
LDB R6813                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
AND R6812                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
MPS
AND R4700                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉端
TMH @2 #30               ; ｳｴｲﾄﾀｲﾏｰ02
CON
AND @T2                  ; ｳｴｲﾄﾀｲﾏｰ02
OUT @MR003               ; ﾊﾝﾄﾞ　ﾜｰｸ有
MPP
ANB R4700                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉端
TMH @3 #200              ; ｳｴｲﾄﾀｲﾏｰ03
CON
AND @T3                  ; ｳｴｲﾄﾀｲﾏｰ03
OUT @MR004               ; ﾊﾝﾄﾞ　ﾜｰｸ無
LD R1007                 ; NG BOX 扉 Close
AND R4800                ; 4ST NG BOX 有確認
AND R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
OUT @MR005               ; NG排出可能
LDB MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
AND MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
ANB R4702                ; 4ST 除材ﾊﾝﾄﾞ 下降端
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
ANB MR6802               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進
AND MR6803               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退
ANB R4710                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進端
AND R4711                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退端
AND R42009               ; MAIN COVER
AND R18501               ; MSEP通信可能
AND= R54000 #0           ; RB1 MOVE
OUT @MR009               ; RB1 動作可能
;<h1/>原点復帰動作
;HOME RETURN OPERATION 
STG R41203               ; TASK4原点復帰起動
SET R40303               ; TASK4動作中
CON
AND R40400               ; 動作開始
JMP @MR1000              ; TASK4 原点復帰開始
;CSIC書き込み 後退 / CSIC head back
;良品排出　後退 / OK cartridge ejector back
;不良品排出　後退 / NG cartridge ejector back
STG @MR1000              ; TASK4 原点復帰開始
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
DW #0 DM1367             ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
CON
RES MR6800               ; 4ST IC書込 書込ﾍｯﾄﾞ 前進
CON
RES MR6806               ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
RES MR6808               ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
ANB R4712                ; 4ST IC書込 書込ﾍｯﾄﾞ 前進端
AND R4713                ; 4ST IC書込 書込ﾍｯﾄﾞ 後退端
ANB R4706                ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進端
AND R4707                ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 後退端
ANB R4704                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進端
AND R4705                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 後退端
JMP @MR1001
;CSIC　ｶｰﾄﾘｯｼﾞ押さえ　上昇 / CSIC Cartridge clamper up
STG @MR1001
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6804               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 下降
CON
ANB R4708                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 下降端
AND R4709                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 上昇端
JMP @MR1002
;CSIC　ｶｰﾄﾘｯｼﾞ押さえ　後退 / CSIC Cartridge clamper back
STG @MR1002
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6802               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進
CON
SET MR6803               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退
CON
ANB R4710                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進端
AND R4711                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退端
JMP @MR1003
;4ST治具 開放 /  4ST Jig Open
STG @MR1003
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6604               ; 4ST 治具  Close
CON
RES MR6602               ; 4ST 治具  Open 
CON
ANB R4114                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 閉じ圧確認
ANB R4115                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 開き圧確認
JMP @MR1004
;除材ﾊﾝﾄﾞ 上昇 /  Cartridge ejector up
STG @MR1004
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
ANB R4702                ; 4ST 除材ﾊﾝﾄﾞ 下降端
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
JMP @MR1005
;天秤上在荷判断 / Cartridge remain on Balancer check
STG @MR1005
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
CON
JMP @MR1100              ; 在荷確認
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR1006
;***　天秤上ﾜｰｸ残 / Cartridge remain on Balancer
STG @MR1006
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR1105
;***
;ﾊﾝﾄﾞ在荷判断 / Cartridge remain in chuck check
STG @MR1100              ; 在荷確認
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
SET MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
MPS
AND @MR004               ; ﾊﾝﾄﾞ　ﾜｰｸ無
JMP @MR1101              ; 除材ﾁｬｯｸ開
MPP
AND @MR003               ; ﾊﾝﾄﾞ　ﾜｰｸ有
SET @MR108               ; Err93 除材ﾊﾝﾄﾞﾜｰｸ残
CON
JMP @MR1102              ; ERR ﾜｰｸ残
STG @MR1101              ; 除材ﾁｬｯｸ開
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
ANB R4700                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉端
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR1103              ; RB1 HOME
;*** ﾊﾝﾄﾞ　ﾜｰｸ残 / Cartridge remain in Ejector RB hand
STG @MR1102              ; ERR ﾜｰｸ残
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR111               ; Err93 TASK4 Err3解除完了
RES @MR111               ; Err93 TASK4 Err3解除完了
CON
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR1100              ; 在荷確認
MPP
AND= DM1207 #4           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR1103              ; RB1 HOME
;***
;(RB1)除材RB 原点復帰 / Cartrige ejector RB HOME
STG @MR1103              ; RB1 HOME
AND R2200                ; RB Power ON
TMR @31 #20              ; ｳｴｲﾄﾀｲﾏｰ31
CON
AND @T31                 ; ｳｴｲﾄﾀｲﾏｰ31
JMP @MR1104
STG @MR1104
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
BSET DM10715 #4          ; RB1 OUT STATUS
CON
BAND DM10515 #4          ; RB1 STATUS
JMP @MR1105
STG @MR1105
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
SET R54008               ; RB1 HOME
CON
JMP @MR1106
STG @MR1106
AND R54009               ; RB1 HOME END
RES R54009               ; RB1 HOME END
CON
JMP @MR1108              ; 除材ﾊﾝﾄﾞ 待機位置
;(RB1)除材RB 待機位置移動 / Cartrige ejector RB move to  waiting position
STG @MR1108              ; 除材ﾊﾝﾄﾞ 待機位置
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
DW #3 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR1109
STG @MR1109
AND R54001               ; RB1 MOVE END
RES R54001               ; RB1 MOVE END
CON
JMP @MR1110
;除材ﾊﾝﾄﾞ開  /  Remove chuck open
STG @MR1110
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
ANB R4700                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉端
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR1200
;NG Bpx 確認  / NG box check
STG @MR1200
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND R4800                ; 4ST NG BOX 有確認
MPS
AND R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
JMP @MR1203              ; 除材ﾊﾝﾄﾞ　開
MPP
ANB R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
SET @MR112               ; Err94 NG box 満杯
CON
JMP @MR1201
MPP
ANB R4800                ; 4ST NG BOX 有確認
SET @MR200               ; Err95 NG box無し
CON
JMP @MR1202
;*** NG box 満杯 / NG box full
STG @MR1201
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR115               ; Err94 TASK4 Err4解除完了
RES @MR115               ; Err94 TASK4 Err4解除完了
CON
JMP @MR1203              ; 除材ﾊﾝﾄﾞ　開
;*** NG box 無し / No NG box
STG @MR1202
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR203               ; Err95 TASK4 Err5解除完了
RES @MR203               ; Err95 TASK4 Err5解除完了
CON
JMP @MR1203              ; 除材ﾊﾝﾄﾞ　開
;***
;除材ﾁｬｯｸ 開  /  Ejector hand open
STG @MR1203              ; 除材ﾊﾝﾄﾞ　開
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
ANB R4700                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉端
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR1300              ; CSICﾃﾞｰﾀｾｯﾄ
;CSICﾃﾞｰﾀｾｯﾄ
;CSIC data setup
STG @MR1300              ; CSICﾃﾞｰﾀｾｯﾄ
MPS
LD LR003                 ; AP03_CSIC無し
OR LR015                 ; AP15_CSICﾕﾆｯﾄ無し
ANL
JMP @MR1313
MPP
LDB LR003                ; AP03_CSIC無し
ANB LR015                ; AP15_CSICﾕﾆｯﾄ無し
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANL
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
ANB @MR4002              ; CSIC PC機種切替Sub中
ANB @MR4001              ; CSIC PC機種切替Sub完了
SET @MR4000              ; CSIC機種切替
CON
JMP @MR1301
STG @MR1301
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4001              ; CSIC PC機種切替Sub完了
MPS
AND @MR4003              ; CSIC機種切替OK
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
JMP @MR1303              ; OK
MPP
ANB @MR4003              ; CSIC機種切替OK
SET @MR204               ; Err96 CSIC data set ERR
CON
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
JMP @MR1302              ; NG
STG @MR1302              ; NG
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR207               ; Err96 TASK4 Err6解除完了
RES @MR207               ; Err96 TASK4 Err6解除完了
CON
JMP @MR1300              ; CSICﾃﾞｰﾀｾｯﾄ
STG @MR1303              ; OK
RES @MR4003              ; CSIC機種切替OK
CON
JMP @MR1313
;
STG @MR1313
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
RES @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
CON
JMP @MR1315
MPP
TMR @12 #50              ; ｳｴｲﾄﾀｲﾏｰ12
CON
AND @T12                 ; ｳｴｲﾄﾀｲﾏｰ12
ZRES @MR4600 @MR4615     ; 天秤ｾﾞﾛﾘｾｯﾄ
CON
ZRES R30300 R30302       ; Port2 通信許可  Port2 受信ﾃﾞｰﾀ読出完了
CON
SET @MR400               ; Err103 天秤 通信異常
CON
JMP @MR1314
DIFU @MR101              ; ｼｰｹﾝｽｸﾘｱPLS.1
STG @MR1314
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err103 TASK4 Err13解除完了
SET @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
CON
RES @MR403               ; Err103 TASK4 Err13解除完了
CON
JMP @MR1313
STG @MR1315
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R42303               ; ST4 1ｻｲｸﾙ終了
CON
RES R40303               ; TASK4動作中
CON
ENDS
;<h1/>自動運転
;AUTO OERATION
STG R41303               ; TASK4 AUTO起動
SET R40303               ; TASK4動作中
CON
AND R40400               ; 動作開始
JMP @MR1500              ; TASK4 AUTO開始
; 動作パラメーター確認
; Operating Parameter Check
STG @MR1500              ; TASK4 AUTO開始
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR013               ; TASK4 AUTO Parameter OK
JMP @MR1501
MPP
ANB @MR013               ; TASK4 AUTO Parameter OK
JMP @MR2900              ; AUTO終了処理
STG @MR1501
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR2800              ; Main4起動
CON
SET @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
CON
JMP @MR1510              ; 天秤上ﾜｰｸ確認
;CSICﾃﾞｰﾀｾｯﾄ
;CSIC data setup
STG @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
MPS
LD LR003                 ; AP03_CSIC無し
OR LR015                 ; AP15_CSICﾕﾆｯﾄ無し
ANL
JMP @MR1508              ; ﾃﾞｰﾀｾｯﾄ完了
MPP
LDB LR003                ; AP03_CSIC無し
ANB LR015                ; AP15_CSICﾕﾆｯﾄ無し
ANL
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
ANB @MR4002              ; CSIC PC機種切替Sub中
ANB @MR4001              ; CSIC PC機種切替Sub完了
SET @MR4000              ; CSIC機種切替
CON
JMP @MR1503
STG @MR1503
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR4001              ; CSIC PC機種切替Sub完了
MPS
AND @MR4003              ; CSIC機種切替OK
RES @MR4004              ; CSIC PC機種切替ﾘﾄﾗｲ
CON
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
JMP @MR1508              ; ﾃﾞｰﾀｾｯﾄ完了
MPP
ANB @MR4003              ; CSIC機種切替OK
SET @MR204               ; Err96 CSIC data set ERR
CON
RES @MR4001              ; CSIC PC機種切替Sub完了
CON
JMP @MR1504              ; Err 96
MPP
LDB @MR4001              ; CSIC PC機種切替Sub完了
ANB @MR4002              ; CSIC PC機種切替Sub中
ANB @MR4000              ; CSIC機種切替
ANL
TMR @10 #200             ; ｳｴｲﾄﾀｲﾏｰ10
CON
AND @T10                 ; ｳｴｲﾄﾀｲﾏｰ10
MPS
ANB @MR4004              ; CSIC PC機種切替ﾘﾄﾗｲ
JMP @MR1505              ; ﾘﾄﾗｲ
MPP
AND @MR4004              ; CSIC PC機種切替ﾘﾄﾗｲ
JMP @MR1506              ; ﾀｲﾑｱｳﾄ
STG @MR1504              ; Err 96
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR207               ; Err96 TASK4 Err6解除完了
RES @MR207               ; Err96 TASK4 Err6解除完了
CON
JMP @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
STG @MR1505              ; ﾘﾄﾗｲ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR4004              ; CSIC PC機種切替ﾘﾄﾗｲ
CON
JMP @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
STG @MR1506              ; ﾀｲﾑｱｳﾄ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR208               ; Err97 CSIC data set time out
CON
JMP @MR1507
STG @MR1507
AND @MR211               ; Err97 TASK4 Err7解除完了
RES @MR4004              ; CSIC PC機種切替ﾘﾄﾗｲ
CON
RES @MR211               ; Err97 TASK4 Err7解除完了
CON
JMP @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
STG @MR1508              ; ﾃﾞｰﾀｾｯﾄ完了
RES @MR4003              ; CSIC機種切替OK
CON
SET @MR800               ; CSICﾃﾞｰﾀｾｯﾄ完了
CON
ENDS
;天秤上ﾜｰｸ残確認  /  Cartridge remain check on Blancer
STG @MR1510              ; 天秤上ﾜｰｸ確認
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR1513
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR1511
STG @MR1511
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR4901              ; 天秤上NGﾜｰｸ排出完了
ANB @MR4902              ; 天秤上NGﾜｰｸ排出中
SET @MR4900              ; 天秤上NGﾜｰｸ排出
CON
JMP @MR1512
STG @MR1512
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4901              ; 天秤上NGﾜｰｸ排出完了
RES @MR4901              ; 天秤上NGﾜｰｸ排出完了
CON
JMP @MR1510              ; 天秤上ﾜｰｸ確認
STG @MR1513
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6806               ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
RES MR6808               ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
AND R4707                ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 後退端
AND R4705                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 後退端
SET @MR2000              ; Main2起動
CON
SET @MR2500              ; Main3起動
CON
JMP @MR1600              ; ｻｲｸﾙ先頭
;<h1/>　Main1
;Waiting Start signal from Index / Indexより開始指示待ち 
STG @MR1600              ; ｻｲｸﾙ先頭
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R40315                ; TASK16動作中
AND R42205               ; Indexより動作開始指示
ANL
SET R40503               ; 処理時間4計測開始
CON
JMP @MR1601              ; ﾜｰｸﾁｪｯｸ
MPP
LDB R40315               ; TASK16動作中
AND R40011               ; HOLD
ANL
JMP @MR2900              ; AUTO終了処理
;Case Check / ﾜｰｸﾁｪｯｸ
STG @MR1601              ; ﾜｰｸﾁｪｯｸ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4010                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
MPS
AND R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
MPS
LD= DM1354 #0            ; NGﾜｰｸﾌﾗｸﾞ ST4
ANB LR003                ; AP03_CSIC無し
OR= DM1405 #5            ; STEP Action selection
ANL
JMP @MR1700              ; CSIC書き込み処理
MPP
LD<> DM1354 #0           ; NGﾜｰｸﾌﾗｸﾞ ST4
OR LR003                 ; AP03_CSIC無し
AND<> DM1405 #5          ; STEP Action selection
ANL
JMP @MR1800              ; ｶｰﾄﾘｯｼﾞ除材処理
MPP
ANB R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
JMP @MR1808              ; ｻｲｸﾙ終了へ
MPP
LDB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
ORB R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
SET @MR300               ; Err99 4STﾜｰｸ浮き
CON
JMP @MR1602
;***** ﾜｰｸ浮きの時 / When Work flotage check  *****
STG @MR1602
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR303               ; Err99 TASK4 Err9解除完了
RES @MR303               ; Err99 TASK4 Err9解除完了
CON
JMP @MR1601              ; ﾜｰｸﾁｪｯｸ
;4ST 治具ｸﾗﾝﾌﾟ　 / 4ST Jig close
STG @MR1700              ; CSIC書き込み処理
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6602               ; 4ST 治具  Open 
CON
SET MR6604               ; 4ST 治具  Close
CON
ANB R4115                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 開き圧確認
AND R4114                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 閉じ圧確認
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR1701              ; 浮きﾁｪｯｸ
;ｸﾗﾝﾌﾟ後ｶｰﾄﾘｯｼﾞ浮きﾁｪｯｸ / Cartridge floating check
STG @MR1701              ; 浮きﾁｪｯｸ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4010                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
JMP @MR1703              ; CSIC書込み
MPP
LDB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
ORB R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
SET @MR300               ; Err99 4STﾜｰｸ浮き
CON
JMP @MR1702
;***** ﾜｰｸ浮きの時 / When Work flotage check  *****
STG @MR1702
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR303               ; Err99 TASK4 Err9解除完了
RES @MR303               ; Err99 TASK4 Err9解除完了
CON
JMP @MR1701              ; 浮きﾁｪｯｸ
;***
;CSIC 書き込み  /  CSIC write
STG @MR1703              ; CSIC書込み
MPS
AND LR003                ; AP03_CSIC無し
JMP @MR1704
MPP
LDB LR003                ; AP03_CSIC無し
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR800               ; CSICﾃﾞｰﾀｾｯﾄ完了
ANL
JMP @MR1704
STG @MR1704
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR4102              ; IC書き込み中
ANB @MR4101              ; IC書き込み　完了
SET @MR4100              ; IC書き込み
CON
JMP @MR1705
STG @MR1705
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR4102              ; IC書き込み中
AND @MR4101              ; IC書き込み　完了
MPS
AND @MR4103              ; CSIC書込みOK
JMP @MR1707
MPP
ANB @MR4103              ; CSIC書込みOK
SET @MR212               ; Err98 CSIC Data write ERR
CON
JMP @MR1706              ; NG
;*** CSIC書き込みｴﾗｰ  /  CSIC write error
STG @MR1706              ; NG
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR215               ; Err98 TASK4 Err8解除完了
DW #41 DM1354            ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
RES @MR215               ; Err98 TASK4 Err8解除完了
CON
JMP @MR1707
;***
STG @MR1707
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR4101              ; IC書き込み　完了
CON
RES @MR4103              ; CSIC書込みOK
CON
MPS
LDB R40002               ; ﾒﾝﾃﾅﾝｽ動作中
OR<> DM1405 #5           ; STEP Action selection
ANL
JMP @MR1800              ; ｶｰﾄﾘｯｼﾞ除材処理
MPP
LD R40002                ; ﾒﾝﾃﾅﾝｽ動作中
AND= DM1405 #5           ; STEP Action selection
ANL
JMP @MR1808              ; ｻｲｸﾙ終了へ
;ｶｰﾄﾘｯｼﾞ除材  /  Cartridge remove
;4ST 治具ｸﾗﾝﾌﾟ　解除 / 4ST Jig open
STG @MR1800              ; ｶｰﾄﾘｯｼﾞ除材処理
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6604               ; 4ST 治具  Close
CON
RES MR6602               ; 4ST 治具  Open 
CON
ANB R4114                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 閉じ圧確認
ANB R4115                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 開き圧確認
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR1801
STG @MR1801
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4709                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 上昇端
AND R4711                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退端
AND R4713                ; 4ST IC書込 書込ﾍｯﾄﾞ 後退端
SET @MR9000              ; M1→M2   除材要求
CON
JMP @MR1802
STG @MR1802
MPS
AND @MR9005              ; M2→M1   治具開要求
JMP @MR1803
MPP
AND @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
JMP @MR1900              ; 除材NG
STG @MR1803
RES MR6604               ; 4ST 治具  Close
CON
SET MR6602               ; 4ST 治具  Open 
CON
ANB R4114                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 閉じ圧確認
AND R4115                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 開き圧確認
TMH @5 #30               ; ｳｴｲﾄﾀｲﾏｰ05
CON
AND @T5                  ; ｳｴｲﾄﾀｲﾏｰ05
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR1804
STG @MR1804
SET @MR9006              ; M1→M2   治具開完了
CON
ANB @MR9004              ; M2→M1   除材中
MPS
AND @MR9001              ; M2→M1   除材完了
JMP @MR1805              ; 除材OK
MPP
AND @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
JMP @MR1900              ; 除材NG
;除材OK  /  Remove OK
STG @MR1805              ; 除材OK
RES @MR9000              ; M1→M2   除材要求
CON
RES @MR9006              ; M1→M2   治具開完了
CON
ANB @MR9001              ; M2→M1   除材完了
ANB @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
ANB @MR9005              ; M2→M1   治具開要求
JMP @MR1806
;ﾜｰｸ残確認  /  Cartridge remain check
STG @MR1806
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R18815               ; RB1 CSICｶｰﾄﾘｯｼﾞ押さえ干渉外
MPS
LDB R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
AND R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
JMP @MR1808              ; ｻｲｸﾙ終了へ
MPP
LD R4009                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
ORB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
ORB R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
SET @MR304               ; Err100 4STﾜｰｸ残
CON
JMP @MR1807
;***　4STｶｰﾄﾘｯｼﾞ残  /  Cartridge remain at 4ST
STG @MR1807
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR307               ; Err100 TASK4 Err10解除完了
RES @MR307               ; Err100 TASK4 Err10解除完了
CON
JMP @MR1806
;***
;<h1/>　　Cycle Finish / ｻｲｸﾙ終了
STG @MR1808              ; ｻｲｸﾙ終了へ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6602               ; 4ST 治具  Open 
CON
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
MPS
ANB R40002               ; ﾒﾝﾃﾅﾝｽ動作中
DW #0 DM1354             ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
JMP @MR1809
MPP
AND R40002               ; ﾒﾝﾃﾅﾝｽ動作中
SET @MR2003              ; Main2停止要求
CON
JMP @MR3008              ; STEP終了処理
STG @MR1809
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
TMH @4 #2                ; ｳｴｲﾄﾀｲﾏｰ04
CON
AND @T4                  ; ｳｴｲﾄﾀｲﾏｰ04
SET R40603               ; 処理時間4取得
CON
SET R42303               ; ST4 1ｻｲｸﾙ終了
CON
JMP @MR1810
STG @MR1810
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R42303               ; ST4 1ｻｲｸﾙ終了
JMP @MR1600              ; ｻｲｸﾙ先頭
;<h1/>　　★★★　除材NG　ﾜｰｸ残り処理【1STにﾜｰｸを送ります】  /  Remove NG process
;Flag.処理  /  Handshake
STG @MR1900              ; 除材NG
RES @MR9000              ; M1→M2   除材要求
CON
RES @MR9006              ; M1→M2   治具開完了
CON
ANB @MR9001              ; M2→M1   除材完了
ANB @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
ANB @MR9005              ; M2→M1   治具開要求
DW #42 DM1354            ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
JMP @MR1901
;4ST 治具ｸﾗﾝﾌﾟ　 / 4ST Jig close
STG @MR1901
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6602               ; 4ST 治具  Open 
CON
SET MR6604               ; 4ST 治具  Close
CON
ANB R4115                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 開き圧確認
AND R4114                ; INDEX 4ST 治具ｸﾗﾝﾌﾟ 閉じ圧確認
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR1902              ; 浮き確認
;ｸﾗﾝﾌﾟ後ｶｰﾄﾘｯｼﾞ浮きﾁｪｯｸ / Cartridge floating check
STG @MR1902              ; 浮き確認
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
TMR @20 #10              ; ｳｴｲﾄﾀｲﾏｰ20
CON
AND @T20                 ; ｳｴｲﾄﾀｲﾏｰ20
AND R18815               ; RB1 CSICｶｰﾄﾘｯｼﾞ押さえ干渉外
MPS
LD R4010                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
JMP @MR1904
MPP
LDB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
ORB R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANL
SET @MR300               ; Err99 4STﾜｰｸ浮き
CON
JMP @MR1903
;***** ﾜｰｸ浮きの時 / When Work flotage check  *****
STG @MR1903
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR303               ; Err99 TASK4 Err9解除完了
RES @MR303               ; Err99 TASK4 Err9解除完了
CON
JMP @MR1902              ; 浮き確認
;***
STG @MR1904
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6604               ; 4ST 治具  Close
CON
MPS
ANB R40002               ; ﾒﾝﾃﾅﾝｽ動作中
JMP @MR1905
MPP
AND R40002               ; ﾒﾝﾃﾅﾝｽ動作中
SET @MR2003              ; Main2停止要求
CON
JMP @MR3008              ; STEP終了処理
STG @MR1905
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
TMH @1 #2                ; ｳｴｲﾄﾀｲﾏｰ01
CON
AND @T1                  ; ｳｴｲﾄﾀｲﾏｰ01
SET R40603               ; 処理時間4取得
CON
SET R42303               ; ST4 1ｻｲｸﾙ終了
CON
JMP @MR1906
STG @MR1906
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R42303               ; ST4 1ｻｲｸﾙ終了
JMP @MR1600              ; ｻｲｸﾙ先頭
;<h1/>　　AUTO 終了処理
;　　AUTO Finish Operation
STG @MR2900              ; AUTO終了処理
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR800               ; CSICﾃﾞｰﾀｾｯﾄ完了
CON
SET @MR2003              ; Main2停止要求
CON
JMP @MR2901
STG @MR2901
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR2002              ; Main2起動中
ANB @MR2502              ; Main3起動中
ANB @MR2802              ; Main4起動中
RES @MR2003              ; Main2停止要求
CON
RES @MR2503              ; Main3停止要求
CON
JMP @MR2902
STG @MR2902
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R40002               ; ﾒﾝﾃﾅﾝｽ動作中
RES R40303               ; TASK4動作中
CON
ENDS
MPP
AND R40002               ; ﾒﾝﾃﾅﾝｽ動作中
JMP @MR3008              ; STEP終了処理
;<h1/>　Main2 Remove trasfer
STG @MR2000              ; Main2起動
SET @MR2002              ; Main2起動中
CON
JMP @MR2004              ; Main2     ｻｲｸﾙ先頭
STG @MR2004              ; Main2     ｻｲｸﾙ先頭
MPS
AND @MR2003              ; Main2停止要求
JMP @MR2400              ; Main2停止処理
MPP
ANB @MR2003              ; Main2停止要求
JMP @MR2005
;除材ﾁｬｯｸ開  /  Remove chuck open
STG @MR2005
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR2006
;除材ﾊﾝﾄﾞ上昇  /  Remove hand up
STG @MR2006
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
JMP @MR2007
;取り出し要求確認  /  Check of Pick-up request
STG @MR2007
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR9000              ; M1→M2   除材要求
JMP @MR2100              ; 取り出し要求待ち
MPP
ANB @MR9000              ; M1→M2   除材要求
JMP @MR2008
;除材搬送　待機位置移動  /  Remove transfer move to Waiting position
STG @MR2008
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
DW #3 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR2009
STG @MR2009
AND R54001               ; RB1 MOVE END
RES R54001               ; RB1 MOVE END
CON
JMP @MR2100              ; 取り出し要求待ち
;取り出し要求待ち  /  Waiting for Pick-up request
STG @MR2100              ; 取り出し要求待ち
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD @MR9000               ; M1→M2   除材要求
AND @MR009               ; RB1 動作可能
ANL
SET @MR9004              ; M2→M1   除材中
CON
JMP @MR2101
MPP
LDB @MR9000              ; M1→M2   除材要求
AND @MR2003              ; Main2停止要求
ANL
JMP @MR2400              ; Main2停止処理
;除材搬送　INDEX取り出し位置移動  /  Remove transfer move to pick-up point
STG @MR2101
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
AND R4713                ; 4ST IC書込 書込ﾍｯﾄﾞ 後退端
AND R4711                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退端
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
DW #1 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR2102
STG @MR2102
AND R54001               ; RB1 MOVE END
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
RES R54001               ; RB1 MOVE END
CON
JMP @MR2103
;除材ﾊﾝﾄﾞ下降  /  Remove hand Down
STG @MR2103
SET @MR902               ; PACK4-3
CON
RES MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
SET MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
AND R4702                ; 4ST 除材ﾊﾝﾄﾞ 下降端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR2104
;除材ﾁｬｯｸ閉じ  /  Remove chuck Close
STG @MR2104
RES MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
SET MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
MPS
AND @MR003               ; ﾊﾝﾄﾞ　ﾜｰｸ有
SET @MR9005              ; M2→M1   治具開要求
CON
JMP @MR2105
MPP
AND @MR004               ; ﾊﾝﾄﾞ　ﾜｰｸ無
JMP @MR2300              ; ﾁｬｯｸ異常 開いて上昇
;治具開要求  /  Jig open request
STG @MR2105
AND @MR9006              ; M1→M2   治具開完了
RES @MR9005              ; M2→M1   治具開要求
CON
JMP @MR2106
;除材ﾊﾝﾄﾞ上昇  /  Remove hand up
STG @MR2106
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
RES @MR902               ; PACK4-3
CON
JMP @MR2107
STG @MR2107
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
MPS
AND @MR003               ; ﾊﾝﾄﾞ　ﾜｰｸ有
JMP @MR2108
MOV DM1354 DM1367        ; NGﾜｰｸﾌﾗｸﾞ ST4  NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
MPP
AND @MR004               ; ﾊﾝﾄﾞ　ﾜｰｸ無
JMP @MR2302              ; ﾁｬｯｸ異常 発報
;Flag.処理  /  Handshake
STG @MR2108
RES @MR9004              ; M2→M1   除材中
CON
SET @MR9001              ; M2→M1   除材完了
CON
JMP @MR2109
STG @MR2109
ANB @MR9000              ; M1→M2   除材要求
RES @MR9001              ; M2→M1   除材完了
CON
JMP @MR2110
;NGﾜｰｸ確認  /  NG Cartridge check
STG @MR2110
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND= DM1367 #0           ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
JMP @MR2200              ; RB1 天秤給材位置移動
MPP
AND<> DM1367 #0          ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
JMP @MR2111              ; NG排出
;***　除材ﾊﾝﾄﾞ　NG排出動作  /  Remove transfer NG Release Operation
STG @MR2111              ; NG排出
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
ANB @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
SET @MR9900              ; 除材ﾊﾝﾄﾞ  NG排出
CON
JMP @MR2112
STG @MR2112
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
AND @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
RES @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
CON
JMP @MR2004              ; Main2     ｻｲｸﾙ先頭
;***
;除材搬送　天秤給材位置移動  /  Remove transfer move to supply for Balancer point
STG @MR2200              ; RB1 天秤給材位置移動
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
DW #2 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR2201
STG @MR2201
AND R54001               ; RB1 MOVE END
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
RES R54001               ; RB1 MOVE END
CON
JMP @MR2202              ; 天秤給材要求待ち
;天秤給材要求待ち  /  Waiting for supply request from Balancer
STG @MR2202              ; 天秤給材要求待ち
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR9008              ; M3→M2   給材要求
SET @MR9012              ; M2→M3   給材中
CON
JMP @MR2203
;除材ﾊﾝﾄﾞ下降  /  Remove hand Down
STG @MR2203
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
SET MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
AND R4702                ; 4ST 除材ﾊﾝﾄﾞ 下降端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR2204
;除材ﾁｬｯｸ開  /  Remove chuck open
STG @MR2204
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR2205
;除材ﾊﾝﾄﾞ上昇  /  Remove hand up
STG @MR2205
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
MPS
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR2212
MPP
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR312               ; Err102 ｶｰﾄﾘｯｼﾞ天秤給材異常
CON
JMP @MR2206
;***　天秤上ｶｰﾄﾘｯｼﾞ給材異常  /  Cartridge supply error on Balancer
STG @MR2206
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR315               ; Err102 TASK4 Err12解除完了
RES @MR315               ; Err102 TASK4 Err12解除完了
CON
JMP @MR2207
STG @MR2207
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR2205
MPP
AND= DM1207 #2           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR2208
STG @MR2208
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR2210
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR2209
;***　天秤上ﾜｰｸ残 / Cartridge remain on Balancer
STG @MR2209
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR2208
;***　Flag.処理  /  Handshake
STG @MR2210
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
DW #0 DM1367             ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
CON
RES @MR9012              ; M2→M3   給材中
CON
SET @MR9010              ; M3→M2   給材異常
CON
JMP @MR2211
STG @MR2211
ANB @MR9008              ; M3→M2   給材要求
RES @MR9010              ; M3→M2   給材異常
CON
JMP @MR2004              ; Main2     ｻｲｸﾙ先頭
;***
;Flag.処理  /  Handshake
STG @MR2212
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
DW #0 DM1367             ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
CON
RES @MR9012              ; M2→M3   給材中
CON
SET @MR9009              ; M3→M2   給材完了
CON
JMP @MR2213
STG @MR2213
ANB @MR9008              ; M3→M2   給材要求
RES @MR9009              ; M3→M2   給材完了
CON
JMP @MR2004              ; Main2     ｻｲｸﾙ先頭
;
;★★★　除材ﾁｬｯｸ異常時処理  /  Remove hand chuck error process
;★★★　除材ﾁｬｯｸ開  /  Remove chuck open
STG @MR2300              ; ﾁｬｯｸ異常 開いて上昇
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR2301
;★★★　除材ﾊﾝﾄﾞ上昇  /  Remove hand up
STG @MR2301
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
JMP @MR2302              ; ﾁｬｯｸ異常 発報
;★★★　ﾜｰｸﾁｬｯｸ異常  /  Cartridge chuck error
STG @MR2302              ; ﾁｬｯｸ異常 発報
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR308               ; Err101 除材ﾁｬｯｸ異常
CON
JMP @MR2303
STG @MR2303
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR311               ; Err101 TASK4 Err11解除完了
RES @MR311               ; Err101 TASK4 Err11解除完了
CON
JMP @MR2304
STG @MR2304
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR2100              ; 取り出し要求待ち
MPP
AND= DM1207 #4           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
DW #43 DM1367            ; NGﾜｰｸﾌﾗｸﾞ ST4 Remove hand
CON
JMP @MR2305              ; RB1 NG排出
;★★★　除材ﾊﾝﾄﾞ　NG排出動作  /  Remove transfer NG Release Operation
STG @MR2305              ; RB1 NG排出
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
ANB @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
SET @MR9900              ; 除材ﾊﾝﾄﾞ  NG排出
CON
JMP @MR2306
STG @MR2306
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
AND @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
RES @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
CON
JMP @MR2307
;★★★　Flag.処理  /  Handshake
STG @MR2307
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR9004              ; M2→M1   除材中
CON
SET @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
CON
JMP @MR2306
STG @MR2308
ANB @MR9000              ; M1→M2   除材要求
RES @MR9002              ; M2→M1   除材異常　(ﾜｰｸ残)
CON
JMP @MR2004              ; Main2     ｻｲｸﾙ先頭
;★★★
;Main2 Finish / Main2 終了
;除材搬送　待機位置移動  /  Remove transfer move to Waiting position
STG @MR2400              ; Main2停止処理
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
DW #3 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR2401
STG @MR2401
AND R54001               ; RB1 MOVE END
RES R54001               ; RB1 MOVE END
CON
JMP @MR2402
STG @MR2402
SET @MR2503              ; Main3停止要求
CON
RES @MR2002              ; Main2起動中
CON
ENDS
;<h1/>　Main3 Balancer
STG @MR2500              ; Main3起動
SET @MR2502              ; Main3起動中
CON
JMP @MR2504              ; Main3     ｻｲｸﾙ先頭
STG @MR2504              ; Main3     ｻｲｸﾙ先頭
MPS
LDB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
ANB @MR4602              ; 天秤ｾﾞﾛﾘｾｯﾄ中
ANL
RES R14200               ; 重量検査
CON
MPS
AND @MR2503              ; Main3停止要求
JMP @MR2715              ; Main3停止処理
MPP
ANB @MR2503              ; Main3停止要求
SET @MR9008              ; M3→M2   給材要求
CON
JMP @MR2509              ; 給材開始待ち
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR2505
;***　残ｶｰﾄﾘｯｼﾞ排出  /  Remain Cartrige eject
STG @MR2505
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR4901              ; 天秤上NGﾜｰｸ排出完了
ANB @MR4902              ; 天秤上NGﾜｰｸ排出中
SET @MR4900              ; 天秤上NGﾜｰｸ排出
CON
JMP @MR2506
STG @MR2506
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4901              ; 天秤上NGﾜｰｸ排出完了
RES @MR4901              ; 天秤上NGﾜｰｸ排出完了
CON
JMP @MR2506
;***
STG @MR2509              ; 給材開始待ち
MPS
AND @MR9012              ; M2→M3   給材中
JMP @MR2510              ; 給材完了待ち
MPP
LDB @MR9012              ; M2→M3   給材中
AND @MR2503              ; Main3停止要求
ANL
RES @MR9008              ; M3→M2   給材要求
CON
JMP @MR2715              ; Main3停止処理
STG @MR2510              ; 給材完了待ち
MPS
AND @MR9009              ; M3→M2   給材完了
JMP @MR2512              ; 給材OK
MPP
AND @MR9010              ; M3→M2   給材異常
JMP @MR2511              ; 給材NG
;***　給材NG  /  Cartridge suppluy NG
STG @MR2511              ; 給材NG
RES @MR9008              ; M3→M2   給材要求
CON
ANB @MR9009              ; M3→M2   給材完了
ANB @MR9010              ; M3→M2   給材異常
JMP @MR2711              ; 重量測定  1ｻｲｸﾙ終了
;***
STG @MR2512              ; 給材OK
RES @MR9008              ; M3→M2   給材要求
CON
ANB @MR9009              ; M3→M2   給材完了
ANB @MR9010              ; M3→M2   給材異常
JMP @MR2600              ; 重量検査
;重量検査  /  Weight check
STG @MR2600              ; 重量検査
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND LR007                ; AP07_重量測定無し
JMP @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
MPP
ANB LR007                ; AP07_重量測定無し
SET @MR901               ; PACK4-2
CON
JMP @MR2601
STG @MR2601
TMH @21 #2               ; ｳｴｲﾄﾀｲﾏｰ21
CON
AND @T21                 ; ｳｴｲﾄﾀｲﾏｰ21
SET R14200               ; 重量検査
CON
JMP @MR2602
STG @MR2602
AND R14201               ; 重量検査終了
RES @MR901               ; PACK4-2
CON
RES R14201               ; 重量検査終了
CON
JMP @MR2603
STG @MR2603
MPS
AND R42500               ; Black 選択
MPS
LD>=.D DM2814 DM2810     ; BK重量上限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
AND<=.D DM2816 DM2810    ; BK重量下限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
ANL
MPS
LD>=.D DM2822 DM2810     ; BK重量上限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
AND<=.D DM2824 DM2810    ; BK重量下限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
ANL
JMP @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
MRD
AND<.D DM2822 DM2810     ; BK重量上限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2610              ; ｲﾝｸ重量  上限警告
MPP
AND>.D DM2824 DM2810     ; BK重量下限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2612              ; ｲﾝｸ重量  下限警告
MRD
AND<.D DM2814 DM2810     ; BK重量上限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2604              ; ｲﾝｸ重量  上限異常
MPP
AND>.D DM2816 DM2810     ; BK重量下限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2606              ; ｲﾝｸ重量  下限異常
MPP
AND R42501               ; 3CL 選択
MPS
LD>=.D DM2818 DM2810     ; CL重量上限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
AND<=.D DM2820 DM2810    ; CL重量下限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
ANL
MPS
LD>=.D DM2826 DM2810     ; CL重量上限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
AND<=.D DM2828 DM2810    ; CL重量下限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
ANL
JMP @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
MRD
AND<.D DM2826 DM2810     ; CL重量上限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2610              ; ｲﾝｸ重量  上限警告
MPP
AND>.D DM2828 DM2810     ; CL重量下限警告値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2612              ; ｲﾝｸ重量  下限警告
MRD
AND<.D DM2818 DM2810     ; CL重量上限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2604              ; ｲﾝｸ重量  上限異常
MPP
AND>.D DM2820 DM2810     ; CL重量下限異常値  ｲﾝｸ重量  測定ﾃﾞｰﾀ
JMP @MR2606              ; ｲﾝｸ重量  下限異常
;***　ｲﾝｸ重量　上限異常  /  Heavy in Ink weight error 
STG @MR2604              ; ｲﾝｸ重量  上限異常
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR404               ; Err104 ｲﾝｸ重量上限異常
CON
JMP @MR2605
STG @MR2605
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR407               ; Err104 TASK4 Err14解除完了
RES @MR407               ; Err104 TASK4 Err14解除完了
CON
JMP @MR2608
;***　ｲﾝｸ重量　下限異常  /  Light in Ink weight error 
STG @MR2606              ; ｲﾝｸ重量  下限異常
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR408               ; Err105 ｲﾝｸ重量下限異常
CON
JMP @MR2607
STG @MR2607
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err105 TASK4 Err15解除完了
RES @MR411               ; Err105 TASK4 Err15解除完了
CON
JMP @MR2608
;*** NGﾜｰｸ排出  /  NG Cartridge eject
STG @MR2608
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR4901              ; 天秤上NGﾜｰｸ排出完了
ANB @MR4902              ; 天秤上NGﾜｰｸ排出中
INC.D DM1616             ; 生産カウンタ9
CON
SET @MR4900              ; 天秤上NGﾜｰｸ排出
CON
JMP @MR2609
STG @MR2609
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4901              ; 天秤上NGﾜｰｸ排出完了
RES @MR4901              ; 天秤上NGﾜｰｸ排出完了
CON
JMP @MR2711              ; 重量測定  1ｻｲｸﾙ終了
;*　ｲﾝｸ重量　上限警告ﾚﾍﾞﾙ  /  Heavy in Ink weight warning 
STG @MR2610              ; ｲﾝｸ重量  上限警告
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR412               ; Err106 ｲﾝｸ重量上限警告
CON
JMP @MR2611
STG @MR2611
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR415               ; Err106 TASK4 Err16解除完了
RES @MR415               ; Err106 TASK4 Err16解除完了
CON
JMP @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
;*　ｲﾝｸ重量　下限警告ﾚﾍﾞﾙ  /  Light in Ink weight warning 
STG @MR2612              ; ｲﾝｸ重量  下限警告
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR500               ; Err107 ｲﾝｸ重量下限警告
CON
JMP @MR2613
STG @MR2613
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err107 TASK4 Err17解除完了
RES @MR503               ; Err107 TASK4 Err17解除完了
CON
JMP @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
;***
;排出ｺﾝﾍﾞﾔ満杯確認  /  Eject conveyer cartridre full check
LD R4803                 ; 4ST 良品ｶｰﾄﾘｯｼﾞ通過検出 ON=有
TMR @11 #5               ; 除材ｺﾝﾍﾞﾔ満杯
STG @MR2700              ; ｲﾝｸ重量OK ﾜｰｸ排出
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @T11                 ; 除材ｺﾝﾍﾞﾔ満杯
ANB @MR5002              ; 天秤上OKﾜｰｸ排出中
INC.D DM1602             ; 生産カウンタ2
CON
SET @MR5000              ; 天秤上OKﾜｰｸ排出
CON
JMP @MR2701
STG @MR2701
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR5001              ; 天秤上OKﾜｰｸ排出完了
RES @MR5001              ; 天秤上OKﾜｰｸ排出完了
CON
JMP @MR2711              ; 重量測定  1ｻｲｸﾙ終了
;1ｻｲｸﾙ終了処理  /  1cycle end process
STG @MR2711              ; 重量測定  1ｻｲｸﾙ終了
DIFU @MR2714             ; 天秤ｶｳﾝﾀ  1up
CON
MPS
ANB C0                   ; 天秤ｾﾞﾛﾘｾｯﾄｶｳﾝﾀ
JMP @MR2713
MPP
AND C0                   ; 天秤ｾﾞﾛﾘｾｯﾄｶｳﾝﾀ
SET @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
CON
JMP @MR2712
STG @MR2712
AND @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
RES @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
CON
JMP @MR2713
STG @MR2713
MPS
LDB R40002               ; ﾒﾝﾃﾅﾝｽ動作中
OR<> DM1405 #2           ; STEP Action selection
ANL
JMP @MR2504              ; Main3     ｻｲｸﾙ先頭
MPP
LD R40002                ; ﾒﾝﾃﾅﾝｽ動作中
AND= DM1405 #2           ; STEP Action selection
ANL
JMP @MR3008              ; STEP終了処理
;
;Main3 Finish / Main3 終了
STG @MR2715              ; Main3停止処理
RES @MR2502              ; Main3起動中
CON
SET @MR2803              ; Main4停止要求
CON
ENDS
;<h1/>　Main4 NG-box監視
;　Main4 NG-box check
STG @MR2800              ; Main4起動
SET @MR2802              ; Main4起動中
CON
JMP @MR2804              ; 監視中
STG @MR2804              ; 監視中
MPS
LD @MR2803               ; Main4停止要求
LDB @MR2002              ; Main2起動中
ANB @MR2502              ; Main3起動中
ANB @MR2802              ; Main4起動中
ORL
ANL
JMP @MR2815              ; Main4停止処理
MPP
LDB @MR2803              ; Main4停止要求
AND R1007                ; NG BOX 扉 Close
ANL
MPS
ANB R4800                ; 4ST NG BOX 有確認
SET @MR200               ; Err95 NG box無し
CON
JMP @MR2805              ; BOX無し
MPP
LD R4800                 ; 4ST NG BOX 有確認
ANB R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
ANL
TMR @15 #50              ; ｳｴｲﾄﾀｲﾏｰ15
CON
AND @T15                 ; ｳｴｲﾄﾀｲﾏｰ15
SET @MR112               ; Err94 NG box 満杯
CON
JMP @MR2806              ; BOX満杯
STG @MR2805              ; BOX無し
AND @MR203               ; Err95 TASK4 Err5解除完了
RES @MR203               ; Err95 TASK4 Err5解除完了
CON
JMP @MR2807
STG @MR2806              ; BOX満杯
AND @MR115               ; Err94 TASK4 Err4解除完了
RES @MR115               ; Err94 TASK4 Err4解除完了
CON
JMP @MR2807
STG @MR2807
MPS
ANB R1007                ; NG BOX 扉 Close
JMP @MR2804              ; 監視中
MRD
TMR @16 #3000            ; ｳｴｲﾄﾀｲﾏｰ16
CON
AND @T16                 ; ｳｴｲﾄﾀｲﾏｰ16
JMP @MR2804              ; 監視中
MPP
LD @MR2803               ; Main4停止要求
LDB @MR2002              ; Main2起動中
ANB @MR2502              ; Main3起動中
ANB @MR2802              ; Main4起動中
ORL
ANL
JMP @MR2815              ; Main4停止処理
;Main4 Finish / Main4 終了
STG @MR2815              ; Main4停止処理
RES @MR2802              ; Main4起動中
CON
ENDS
;<h1/>ｽﾃｯﾌﾟ運転
;STEP OERATION
STG R41403               ; TASK4 STEP起動
SET R40303               ; TASK4動作中
CON
AND R40400               ; 動作開始
JMP @MR3000              ; TASK4 STEP開始
;TASK1 STEP CONDITION CHECK
;1:通常運転				2:重量測定のみ			3:						4:NG排出動作	
;5:CSIC書き込み			6:						7:						8:
;
STG @MR3000              ; TASK4 STEP開始
MPS
AND= DM1404 #4           ; STEP Group selection
MPS
AND= DM1405 #1           ; STEP Action selection
DW #0 DM1354             ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
JMP @MR3100              ; 通常運転
MRD
AND= DM1405 #2           ; STEP Action selection
JMP @MR3200              ; 重量測定のみ
MRD
AND= DM1405 #4           ; STEP Action selection
DW #49 DM1354            ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
JMP @MR3100              ; 通常運転
MRD
AND= DM1405 #5           ; STEP Action selection
DW #0 DM1354             ; NGﾜｰｸﾌﾗｸﾞ ST4
CON
JMP @MR3100              ; 通常運転
MPP
LD<> DM1405 #1           ; STEP Action selection
AND<> DM1405 #2          ; STEP Action selection
AND<> DM1405 #4          ; STEP Action selection
AND<> DM1405 #5          ; STEP Action selection
ANL
JMP @MR3008              ; STEP終了処理
MPP
AND<> DM1404 #4          ; STEP Group selection
JMP @MR3008              ; STEP終了処理
;STEP終了処理
STG @MR3008              ; STEP終了処理
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R40012               ; HOLD要求
CON
JMP @MR3009
STG @MR3009
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR2002              ; Main2起動中
ANB @MR2502              ; Main3起動中
ANB @MR2802              ; Main4起動中
RES @MR2003              ; Main2停止要求
CON
RES @MR2503              ; Main3停止要求
CON
RES @MR2803              ; Main4停止要求
CON
RES R40303               ; TASK4動作中
CON
ENDS
;STEP1,4,5
;Normal operation   or   NG ejectoperation   or   CSIC write operation
STG @MR3100              ; 通常運転
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4009                 ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
AND R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
AND R4011                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (内)
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
ANL
JMP @MR3101
MPP
LDB R4009                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ有
ORB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
ORB R4010                ; INDEX 4ST ｶｰﾄﾘｯｼﾞ浮き確認 (外)
OR R4802                 ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
ANL
JMP @MR3008              ; STEP終了処理
STG @MR3101
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR1502              ; AUTO開始CSICﾃﾞｰﾀｾｯﾄ
CON
SET @MR2000              ; Main2起動
CON
SET @MR2500              ; Main3起動
CON
SET @MR2800              ; Main4起動
CON
JMP @MR1601              ; ﾜｰｸﾁｪｯｸ
;>>>
;STEP2:重量測定
;STEP2:Weight check
STG @MR3200              ; 重量測定のみ
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR3008              ; STEP終了処理
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR2600              ; 重量検査
;>>>
;<h1/>ｻﾌﾞﾙｰﾁﾝ
;<h1/>　CSIC機種切替
;　CSIC Model Change
STG @MR4000              ; CSIC機種切替
SET @MR4002              ; CSIC PC機種切替Sub中
CON
JMP @MR4005              ; Next step
STG @MR4005              ; Next step
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR4003              ; CSIC機種切替OK
CON
JMP @MR4006              ; Next step
STG @MR4006              ; Next step
MPS
LD R42500                ; Black 選択
AND MR13615              ; コマンド受付許可（非通信中)
ANL
ZRES MR13600 MR13611     ; CH1 CSIC書込み実行完了  CH2 CSIC機種切替実行失敗
CON
SET MR13508              ; Ch1選択
CON
RES MR13509              ; Ch2選択
CON
RES MR13510              ; ﾘﾄﾗｲ
CON
SET MR13502              ; CSIC機種切替実行開始
CON
JMP @MR4007              ; Next step
MPP
LD R42501                ; 3CL 選択
AND MR13815              ; コマンド受付許可（非通信中)
ANL
ZRES MR13800 MR13811     ; CH1 CSIC書込み実行完了  CH2 CSIC機種切替実行失敗
CON
SET MR13708              ; Ch1選択
CON
RES MR13709              ; Ch2選択
CON
RES MR13710              ; ﾘﾄﾗｲ
CON
SET MR13702              ; CSIC機種切替実行開始
CON
JMP @MR4007              ; Next step
STG @MR4007              ; Next step
MPS
AND R42500               ; Black 選択
MPS
AND MR13604              ; CH1 CSIC機種切替実行完了
SET @MR4003              ; CSIC機種切替OK
CON
JMP @MR4008              ; Next step
MPP
AND MR13605              ; CH1 CSIC機種切替実行失敗
RES @MR4003              ; CSIC機種切替OK
CON
JMP @MR4008              ; Next step
MPP
AND R42501               ; 3CL 選択
MPS
AND MR13804              ; CH1 CSIC機種切替実行完了
SET @MR4003              ; CSIC機種切替OK
CON
JMP @MR4008              ; Next step
MPP
AND MR13805              ; CH1 CSIC機種切替実行失敗
RES @MR4003              ; CSIC機種切替OK
CON
JMP @MR4008              ; Next step
STG @MR4008              ; Next step
RES MR13804              ; CH1 CSIC機種切替実行完了
CON
RES MR13805              ; CH1 CSIC機種切替実行失敗
CON
RES MR13605              ; CH1 CSIC機種切替実行失敗
CON
RES MR13604              ; CH1 CSIC機種切替実行完了
CON
RES MR2501               ; CSIC model switch Driving
CON
RES @MR4002              ; CSIC PC機種切替Sub中
CON
SET @MR4001              ; CSIC PC機種切替Sub完了
CON
ENDS
;<h1/>　IC書き込み
;　IC write
STG @MR4100              ; IC書き込み
SET @MR4102              ; IC書き込み中
CON
JMP @MR4105              ; Next step
STG @MR4105              ; Next step
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6803               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退
CON
SET MR6802               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進
CON
AND R4710                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
SET @MR900               ; PACK4-1
CON
JMP @MR4106              ; Next step
STG @MR4106              ; Next step
SET MR6804               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 下降
CON
AND R4708                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 下降端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR4107              ; Next step
STG @MR4107              ; Next step
SET MR6800               ; 4ST IC書込 書込ﾍｯﾄﾞ 前進
CON
AND R4712                ; 4ST IC書込 書込ﾍｯﾄﾞ 前進端
TMH @13 #20              ; ｳｴｲﾄﾀｲﾏｰ13
CON
AND @T13                 ; ｳｴｲﾄﾀｲﾏｰ13
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
MPS
LD LR003                 ; AP03_CSIC無し
OR LR015                 ; AP15_CSICﾕﾆｯﾄ無し
ANL
SET @MR4103              ; CSIC書込みOK
CON
JMP @MR4110              ; Next step
MPP
LDB LR003                ; AP03_CSIC無し
ANB LR015                ; AP15_CSICﾕﾆｯﾄ無し
ANL
JMP @MR4108              ; Next step
STG @MR4108              ; Next step
MPS
LD R42500                ; Black 選択
AND MR13615              ; コマンド受付許可（非通信中)
ANL
SET MR13508              ; Ch1選択
CON
RES MR13509              ; Ch2選択
CON
RES MR13510              ; ﾘﾄﾗｲ
CON
SET MR13500              ; CSIC書込み実行開始
CON
JMP @MR4109              ; Next step
MPP
LD R42501                ; 3CL 選択
AND MR13815              ; コマンド受付許可（非通信中)
ANL
SET MR13708              ; Ch1選択
CON
RES MR13709              ; Ch2選択
CON
RES MR13710              ; ﾘﾄﾗｲ
CON
SET MR13700              ; CSIC書込み実行開始
CON
JMP @MR4109              ; Next step
STG @MR4109              ; Next step
MPS
AND R42500               ; Black 選択
MPS
AND MR13600              ; CH1 CSIC書込み実行完了
SET @MR4103              ; CSIC書込みOK
CON
JMP @MR4110              ; Next step
MPP
AND MR13601              ; CH1 CSIC書込み実行失敗
RES @MR4103              ; CSIC書込みOK
CON
JMP @MR4110              ; Next step
MPP
AND R42501               ; 3CL 選択
MPS
AND MR13800              ; CH1 CSIC書込み実行完了
SET @MR4103              ; CSIC書込みOK
CON
JMP @MR4110              ; Next step
MPP
AND MR13801              ; CH1 CSIC書込み実行失敗
RES @MR4103              ; CSIC書込みOK
CON
JMP @MR4110              ; Next step
STG @MR4110              ; Next step
RES MR6800               ; 4ST IC書込 書込ﾍｯﾄﾞ 前進
CON
AND R4713                ; 4ST IC書込 書込ﾍｯﾄﾞ 後退端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR4111              ; Next step
STG @MR4111              ; Next step
RES MR6804               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 下降
CON
AND R4709                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 上昇端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
RES @MR900               ; PACK4-1
CON
JMP @MR4112              ; Next step
STG @MR4112              ; Next step
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6802               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 前進
CON
SET MR6803               ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退
CON
AND R4711                ; 4ST IC書込 ｶｰﾄﾘｯｼﾞ押さえ 後退端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR4113
STG @MR4113
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR13600              ; CH1 CSIC書込み実行完了
CON
RES MR13601              ; CH1 CSIC書込み実行失敗
CON
RES MR13800              ; CH1 CSIC書込み実行完了
CON
RES MR13801              ; CH1 CSIC書込み実行失敗
CON
RES @MR4102              ; IC書き込み中
CON
SET @MR4101              ; IC書き込み　完了
CON
ENDS
;<h1/>　ｲﾝｸ重量ﾃﾞｰﾀ取得
;　INK WEIGHT DATA
STG R14200               ; 重量検査
MPS
AND R30200               ; Port2 通信可能
SET @MR5101              ; 重量ﾃﾞｰﾀ取得中
CON
JMP @MR5103
MPP
ANB R30200               ; Port2 通信可能
SET @MR400               ; Err103 天秤 通信異常
CON
JMP @MR5102
LD @MR5101               ; 重量ﾃﾞｰﾀ取得中
TMR @17 #60              ; ｳｴｲﾄﾀｲﾏｰ17
CON
AND @T17                 ; ｳｴｲﾄﾀｲﾏｰ17
ZRES @MR5100 @MR5115     ; 重量検査
CON
SET @MR400               ; Err103 天秤 通信異常
CON
@SET @MR5102
STG @MR5102
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err103 TASK4 Err13解除完了
RES @MR403               ; Err103 TASK4 Err13解除完了
CON
JMP R14200               ; 重量検査
STG @MR5103
DW $0001 DM30716         ; Port2 ﾓｰﾄﾞ設定
CON
DW #1 DM30201            ; Port2 送信ﾃﾞｰﾀ長
CON
DW $5300 DM30202         ; Port2 送信ﾃﾞｰﾀ1
CON
SET R30301               ; Port2 送信要求
CON
JMP @MR5104
STG @MR5104
AND R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
BMOV DM30459 DM2800 #5   ; Port2 受信ﾃﾞｰﾀ1  生重量ﾃﾞｰﾀ1
JMP @MR5105
STG @MR5105
TMH @18 #5               ; ｳｴｲﾄﾀｲﾏｰ18
CON
AND @T18                 ; ｳｴｲﾄﾀｲﾏｰ18
SET R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR5106
STG @MR5106
TMH @19 #2               ; ｳｴｲﾄﾀｲﾏｰ19
CON
AND @T19                 ; ｳｴｲﾄﾀｲﾏｰ19
SET @MR4800              ; ASCIIﾃﾞｰﾀ変換
CON
JMP @MR5107
STG @MR5107
AND @MR4801              ; ASCIIﾃﾞｰﾀ変換完了
RES R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
RES R30301               ; Port2 送信要求
CON
RES @MR5101              ; 重量ﾃﾞｰﾀ取得中
CON
RES @MR4801              ; ASCIIﾃﾞｰﾀ変換完了
CON
JMP @MR4500              ; 取得ﾃﾞｰﾀ 診断
;When Communication Error
STG @MR4500              ; 取得ﾃﾞｰﾀ 診断
MPS
AND= DM2800 $2B30        ; 生重量ﾃﾞｰﾀ1
MPS
RES @MR4515              ; Communicated 2nd
CON
SET R14201               ; 重量検査終了
CON
ENDS
MPP
RFASC DM2800 DM10011     ; 生重量ﾃﾞｰﾀ1  AD変換ch0ﾃﾞｰﾀ先頭
MPP
AND<> DM2800 $2B30       ; 生重量ﾃﾞｰﾀ1
MPS
LDB @MR4515              ; Communicated 2nd
ANB R14200               ; 重量検査
ANL
JMP @MR4504              ; Next step
MPP
AND @MR4515              ; Communicated 2nd
RES R30301               ; Port2 送信要求
CON
RES R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
RES @MR4401              ; 通信再開
CON
RES R14200               ; 重量検査
CON
SET @MR400               ; Err103 天秤 通信異常
CON
JMP @MR4501              ; Next step
DIFU @MR102              ; ｼｰｹﾝｽｸﾘｱPLS.2
STG @MR4501              ; Next step
AND @MR403               ; Err103 TASK4 Err13解除完了
RES @MR403               ; Err103 TASK4 Err13解除完了
CON
JMP @MR4502              ; Next step
STG @MR4502              ; Next step
ANB R14200               ; 重量検査
AND @MR4401              ; 通信再開
RES @MR4515              ; Communicated 2nd
CON
SET @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
CON
JMP @MR4503
STG @MR4503
AND @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
RES @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
CON
SET R14200               ; 重量検査
CON
ENDS
STG @MR4504              ; Next step
@SET @MR4515             ; Communicated 2nd
CON
TMR @9 #50               ; ｳｴｲﾄﾀｲﾏｰ09
CON
AND @T9                  ; ｳｴｲﾄﾀｲﾏｰ09
JMP @MR4505              ; Next step
STG @MR4505              ; Next step
SET R14200               ; 重量検査
CON
ENDS
;<h1/>　天秤ﾘｾｯﾄ
;　Balance　Reseet
;Reset Counter
LDB @MR4603              ; ﾘｾｯﾄｶｳﾝﾀﾘｾｯﾄﾊﾟﾙｽ
C #0 #9999 @MR2714       ; 天秤ｾﾞﾛﾘｾｯﾄｶｳﾝﾀ  天秤ｶｳﾝﾀ  1up
;Balancer Reset
STG @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
AND T202                 ; 運転開始ﾃﾞｨﾚｲ(20s)
SET @MR4602              ; 天秤ｾﾞﾛﾘｾｯﾄ中
CON
DW $0001 DM30715         ; Port2 ﾃﾞｰﾀ格納単位設定
CON
DW #1 DM30722            ; Port2 受信ﾃﾞｰﾀ長設定
CON
DW $0000 DM30716         ; Port2 ﾓｰﾄﾞ設定
CON
DW #1 DM30201            ; Port2 送信ﾃﾞｰﾀ長
CON
DW $0052 DM30202         ; Port2 送信ﾃﾞｰﾀ1
CON
RES R30300               ; Port2 通信許可
CON
ANB R30200               ; Port2 通信可能
JMP @MR4604
STG @MR4604
SET R30300               ; Port2 通信許可
CON
AND R30200               ; Port2 通信可能
SET R30301               ; Port2 送信要求
CON
JMP @MR4605
STG @MR4605
AND R30201               ; Port2 送信完了
RES R30301               ; Port2 送信要求
CON
JMP @MR4606
STG @MR4606
ANB R30201               ; Port2 送信完了
AND R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
SET R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR4607
STG @MR4607
ANB R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
AND R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
RES R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR4608
STG @MR4608
AND R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
ANB R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
SET R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR4609
STG @MR4609
ANB R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
AND R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
RES R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR4610
STG @MR4610
AND R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
ANB R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
SET R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
JMP @MR4611
STG @MR4611
ANB R30202               ; Port2 受信ﾃﾞｰﾀ読出要求
RES R30302               ; Port2 受信ﾃﾞｰﾀ読出完了
CON
DIFU @MR4603             ; ﾘｾｯﾄｶｳﾝﾀﾘｾｯﾄﾊﾟﾙｽ
CON
JMP @MR4612
STG @MR4612
DW $0000 DM30715         ; Port2 ﾃﾞｰﾀ格納単位設定
CON
DW #9 DM30722            ; Port2 受信ﾃﾞｰﾀ長設定
CON
DW $0001 DM30716         ; Port2 ﾓｰﾄﾞ設定
CON
DW #1 DM30201            ; Port2 送信ﾃﾞｰﾀ長
CON
DW $5300 DM30202         ; Port2 送信ﾃﾞｰﾀ1
CON
RES R30300               ; Port2 通信許可
CON
ANB R30200               ; Port2 通信可能
JMP @MR4613
STG @MR4613
SET R30300               ; Port2 通信許可
CON
AND R30200               ; Port2 通信可能
TMH @6 #20               ; ｳｴｲﾄﾀｲﾏｰ06
CON
AND @T6                  ; ｳｴｲﾄﾀｲﾏｰ06
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR4601              ; 天秤ｾﾞﾛﾘｾｯﾄ完了
CON
RES @MR4602              ; 天秤ｾﾞﾛﾘｾｯﾄ中
CON
ENDS
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR4614
STG @MR4614
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR4615
STG @MR4615
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR4600              ; 天秤ｾﾞﾛﾘｾｯﾄ
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR4614
;通信ｴﾗｰ時処理  Processing when communication error
LD R30204                ; Port2 通信ｴﾗｰ
OR @MR4603               ; ﾘｾｯﾄｶｳﾝﾀﾘｾｯﾄﾊﾟﾙｽ
OR @MR101                ; ｼｰｹﾝｽｸﾘｱPLS.1
OR @MR102                ; ｼｰｹﾝｽｸﾘｱPLS.2
RES @MR4401              ; 通信再開
CON
RES R30301               ; Port2 送信要求
CON
SET R30305               ; Port2 ｼｰｹﾝｽｸﾘｱ
LD R30305                ; Port2 ｼｰｹﾝｽｸﾘｱ
TMR @14 #20              ; ｳｴｲﾄﾀｲﾏｰ14
CON
AND @T14                 ; ｳｴｲﾄﾀｲﾏｰ14
RES R30205               ; Port2 ｼｰｹﾝｽｸﾘｱ完了
CON
RES R30305               ; Port2 ｼｰｹﾝｽｸﾘｱ
LD R30205                ; Port2 ｼｰｹﾝｽｸﾘｱ完了
MPS
LDB R40003               ; 原点復帰中
ANB @MR4602              ; 天秤ｾﾞﾛﾘｾｯﾄ中
ANL
MPS
RES R30305               ; Port2 ｼｰｹﾝｽｸﾘｱ
MPP
AND R41003               ; TASK4 ERROR中
SET @MR4401              ; 通信再開
MPP
LD R40003                ; 原点復帰中
OR @MR4602               ; 天秤ｾﾞﾛﾘｾｯﾄ中
ANL
RES R30205               ; Port2 ｼｰｹﾝｽｸﾘｱ完了
;<h1/>　重量ﾃﾞｰﾀ変換
;　Weight Data Conversi 
;ASCIIﾃﾞｰﾀ → 整数形ﾃﾞｰﾀ変換  /  ASCII Data Integer Data Conversi 
;DM2810.D=VAL(DM2800.T) * 1000
;@MR4800=OFF
;@MR4801=ON
;
;
LD @MR4800               ; ASCIIﾃﾞｰﾀ変換
NCJ #1001
;DM2810.D=VAL(DM2800.T) * 1000
;
LD CR2002                ; 常時ON
MOV.F +0 @VM32
RFASC DM2800 @VM32       ; 生重量ﾃﾞｰﾀ1
LD CR2002                ; 常時ON
LDA.F @VM32
CON
MUL.F +1000
CON
INTG.D
CON
STA.D DM2810             ; ｲﾝｸ重量  測定ﾃﾞｰﾀ
;@MR4800=OFF
;
LD CR2003                ; 常時OFF
OUT @MR4800              ; ASCIIﾃﾞｰﾀ変換
;@MR4801=ON
;
LD CR2002                ; 常時ON
OUT @MR4801              ; ASCIIﾃﾞｰﾀ変換完了
LABEL #1001
;
;<h1/>　天秤上NGｶｰﾄﾘｯｼﾞ排出
;　Eject NG cartridge on Blancer
STG @MR4900              ; 天秤上NGﾜｰｸ排出
ANB @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
SET @MR4902              ; 天秤上NGﾜｰｸ排出中
CON
JMP @MR4904
STG @MR4904
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR005               ; NG排出可能
SET MR6806               ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
JMP @MR4905
STG @MR4905
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
JMP @MR4910
MPP
AND R4801                ; 4ST NG BOX 満杯検出 OFF=満杯
TMR @23 #50              ; ｳｴｲﾄﾀｲﾏｰ23
CON
AND @T23                 ; ｳｴｲﾄﾀｲﾏｰ23
JMP @MR4906
;*** 通過未検出  /  Cartridge pass undetect
STG @MR4906
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6806               ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
AND R4707                ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 後退端
SET @MR508               ; Err109 NG排出未通過
CON
JMP @MR4907
STG @MR4907
AND @MR511               ; Err109 TASK4 Err19解除完了
RES @MR511               ; Err109 TASK4 Err19解除完了
CON
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR4904
MPP
AND= DM1207 #4           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR4908
STG @MR4908
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR4910
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR4909
STG @MR4909
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR4908
;***
STG @MR4910
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R1007                ; NG BOX 扉 Close
RES MR6806               ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
AND R4707                ; 4ST 不良品ｶｰﾄﾘｯｼﾞ 排出 後退端
JMP @MR4911
STG @MR4911
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR4913
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR4912
STG @MR4912
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR4904
STG @MR4913
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR4902              ; 天秤上NGﾜｰｸ排出中
CON
SET @MR4901              ; 天秤上NGﾜｰｸ排出完了
CON
ENDS
;<h1/>　天秤上OKｶｰﾄﾘｯｼﾞ排出
;　Eject OK Cartridge on Blancer
STG @MR5000              ; 天秤上OKﾜｰｸ排出
SET @MR5002              ; 天秤上OKﾜｰｸ排出中
CON
JMP @MR5004
STG @MR5004
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR6808               ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
MPS
AND R4803                ; 4ST 良品ｶｰﾄﾘｯｼﾞ通過検出 ON=有
JMP @MR5009
MPP
ANB R4803                ; 4ST 良品ｶｰﾄﾘｯｼﾞ通過検出 ON=有
TMR @22 #50              ; ｳｴｲﾄﾀｲﾏｰ22
CON
AND @T22                 ; ｳｴｲﾄﾀｲﾏｰ22
JMP @MR5005
;*** 通過未検出  /  Cartridge pass undetect
STG @MR5005
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6808               ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
AND R4705                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 後退端
SET @MR504               ; Err108 排出ｺﾝﾍﾞﾔ未通過
CON
JMP @MR5006
STG @MR5006
AND @MR507               ; Err108 TASK4 Err18解除完了
RES @MR507               ; Err108 TASK4 Err18解除完了
CON
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR5004
MPP
AND= DM1207 #4           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR5007
STG @MR5007
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR5010
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR5008
STG @MR5008
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR5007
;***
STG @MR5009
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4704                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進端
OUT R40101               ; CALL POST
CON
AND R40102               ; POST OK
JMP @MR5010
STG @MR5010
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6808               ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 前進
CON
AND R4705                ; 4ST 良品ｶｰﾄﾘｯｼﾞ 排出 後退端
JMP @MR5011
STG @MR5011
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
JMP @MR5013              ; 終了
MPP
AND R4802                ; 4ST 天秤上 ｶｰﾄﾘｯｼﾞ有
SET @MR104               ; Err92 天秤上ﾜｰｸ残
CON
JMP @MR5012
STG @MR5012
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err92 TASK4 Err2解除完了
RES @MR107               ; Err92 TASK4 Err2解除完了
CON
JMP @MR5004
STG @MR5013              ; 終了
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR5002              ; 天秤上OKﾜｰｸ排出中
CON
SET @MR5001              ; 天秤上OKﾜｰｸ排出完了
CON
ENDS
;<h1/>　除材ﾊﾝﾄﾞNGｶｰﾄﾘｯｼﾞ排出
;　Eject NG cartridge in Remove hand
STG @MR9900              ; 除材ﾊﾝﾄﾞ  NG排出
ANB @MR4902              ; 天秤上NGﾜｰｸ排出中
SET @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
CON
JMP @MR9903
;除材ﾊﾝﾄﾞ上昇  /  Remove hand Up
STG @MR9903
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
JMP @MR9904              ; RB1　NG排出位置移動
;除材搬送　NG排出位置移動  /  Remove transfer move to pick-up point
STG @MR9904              ; RB1　NG排出位置移動
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR009               ; RB1 動作可能
DW #4 DM2350             ; RB1 Target Pos No Store
CON
SET R54000               ; RB1 MOVE
CON
JMP @MR9905
STG @MR9905
AND R54001               ; RB1 MOVE END
RES R54001               ; RB1 MOVE END
CON
JMP @MR9906
;除材ﾊﾝﾄﾞ下降  /  Remove hand Down
STG @MR9906
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR005               ; NG排出可能
RES MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
SET MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
AND R4702                ; 4ST 除材ﾊﾝﾄﾞ 下降端
JMP @MR9907
;除材ﾁｬｯｸ開き  /  Remove chuck Open
STG @MR9907
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4800                ; 4ST NG BOX 有確認
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
JMP @MR9908
STG @MR9908
TMR @30 #20              ; ｳｴｲﾄﾀｲﾏｰ30
CON
AND @T30                 ; ｳｴｲﾄﾀｲﾏｰ30
JMP @MR9909
;除材ﾊﾝﾄﾞ上昇  /  Remove hand Up
STG @MR9909
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6810               ; 4ST 除材ﾊﾝﾄﾞ 下降
CON
SET MR6811               ; 4ST 除材ﾊﾝﾄﾞ 上昇
CON
AND R4703                ; 4ST 除材ﾊﾝﾄﾞ 上昇端
JMP @MR9910              ; ﾜｰｸお持ち帰りﾁｪｯｸ
;除材ﾁｬｯｸ閉じ  /  Remove chuck Close
STG @MR9910              ; ﾜｰｸお持ち帰りﾁｪｯｸ
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
SET MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
MPS
AND @MR004               ; ﾊﾝﾄﾞ　ﾜｰｸ無
JMP @MR9912
MPP
AND @MR003               ; ﾊﾝﾄﾞ　ﾜｰｸ有
SET @MR108               ; Err93 除材ﾊﾝﾄﾞﾜｰｸ残
CON
JMP @MR9911
;***　除材ﾊﾝﾄﾞﾜｰｸ残  /  Cartridge remain in Remove hand
STG @MR9911
AND @MR015               ; TASK4 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR111               ; Err93 TASK4 Err3解除完了
RES @MR111               ; Err93 TASK4 Err3解除完了
CON
MPS
AND= DM1207 #1           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR9904              ; RB1　NG排出位置移動
MPP
AND= DM1207 #4           ; ｴﾗｰ復帰SW番号(ﾕｰｻﾞｰ用)
JMP @MR9910              ; ﾜｰｸお持ち帰りﾁｪｯｸ
;***
;除材ﾁｬｯｸ開き  /  Remove chuck Open
STG @MR9912
AND @MR100               ; TASK4除材ﾊﾝﾄﾞ ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR6812               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 閉
CON
SET MR6813               ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開
CON
AND R4701                ; 4ST 除材ﾊﾝﾄﾞ ﾁｬｯｸ 開端
RES @MR9902              ; 除材ﾊﾝﾄﾞ  NG排出中
CON
SET @MR9901              ; 除材ﾊﾝﾄﾞ  NG排出完了
CON
ENDS
;<h1/>Err
;Err92
STG @MR104               ; Err92 天秤上ﾜｰｸ残
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR105               ; 105
MOV #92 DM1200           ; 通常ｴﾗｰ番号
STG @MR105               ; 105
AND R40010               ; ERROR
JMP @MR106               ; 106
STG @MR106               ; 106
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR107               ; Err92 TASK4 Err2解除完了
CON
ENDS
;Err93
STG @MR108               ; Err93 除材ﾊﾝﾄﾞﾜｰｸ残
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR109               ; 109
MOV #93 DM1200           ; 通常ｴﾗｰ番号
STG @MR109               ; 109
AND R40010               ; ERROR
JMP @MR110               ; 110
STG @MR110               ; 110
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR111               ; Err93 TASK4 Err3解除完了
CON
ENDS
;Err94
STG @MR112               ; Err94 NG box 満杯
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
MPS
SET MR2010               ; NG box 扉開
CON
JMP @MR113               ; 113
MPP
MOV #94 DM1200           ; 通常ｴﾗｰ番号
STG @MR113               ; 113
AND R40010               ; ERROR
JMP @MR114               ; 114
STG @MR114               ; 114
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR115               ; Err94 TASK4 Err4解除完了
CON
ENDS
;Err95
STG @MR200               ; Err95 NG box無し
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
MPS
SET MR2010               ; NG box 扉開
CON
JMP @MR201               ; 201
MPP
MOV #95 DM1200           ; 通常ｴﾗｰ番号
STG @MR201               ; 201
AND R40010               ; ERROR
JMP @MR202               ; 202
STG @MR202               ; 202
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR203               ; Err95 TASK4 Err5解除完了
CON
ENDS
;Err96
STG @MR204               ; Err96 CSIC data set ERR
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR205               ; 205
MOV #96 DM1200           ; 通常ｴﾗｰ番号
STG @MR205               ; 205
AND R40010               ; ERROR
JMP @MR206               ; 206
STG @MR206               ; 206
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR207               ; Err96 TASK4 Err6解除完了
CON
ENDS
;Err97
STG @MR208               ; Err97 CSIC data set time out
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR209               ; 209
MOV #97 DM1200           ; 通常ｴﾗｰ番号
STG @MR209               ; 209
AND R40010               ; ERROR
JMP @MR210               ; 210
STG @MR210               ; 210
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR211               ; Err97 TASK4 Err7解除完了
CON
ENDS
;Err98
STG @MR212               ; Err98 CSIC Data write ERR
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR213               ; 213
MOV #98 DM1200           ; 通常ｴﾗｰ番号
STG @MR213               ; 213
AND R40010               ; ERROR
JMP @MR214               ; 214
STG @MR214               ; 214
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR215               ; Err98 TASK4 Err8解除完了
CON
ENDS
;Err99
STG @MR300               ; Err99 4STﾜｰｸ浮き
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR301               ; 301
MOV #99 DM1200           ; 通常ｴﾗｰ番号
STG @MR301               ; 301
AND R40010               ; ERROR
JMP @MR302               ; 302
STG @MR302               ; 302
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR303               ; Err99 TASK4 Err9解除完了
CON
ENDS
;Err100
STG @MR304               ; Err100 4STﾜｰｸ残
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR305               ; 305
MOV #100 DM1200          ; 通常ｴﾗｰ番号
STG @MR305               ; 305
AND R40010               ; ERROR
JMP @MR306               ; 306
STG @MR306               ; 306
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR307               ; Err100 TASK4 Err10解除完了
CON
ENDS
;Err101
STG @MR308               ; Err101 除材ﾁｬｯｸ異常
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR309               ; 309
MOV #101 DM1200          ; 通常ｴﾗｰ番号
STG @MR309               ; 309
AND R40010               ; ERROR
JMP @MR310               ; 310
STG @MR310               ; 310
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR311               ; Err101 TASK4 Err11解除完了
CON
ENDS
;Err102
STG @MR312               ; Err102 ｶｰﾄﾘｯｼﾞ天秤給材異常
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_REMOVE DM1204      ; ERROR_SW_REMOVE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR313               ; 313
MOV #102 DM1200          ; 通常ｴﾗｰ番号
STG @MR313               ; 313
AND R40010               ; ERROR
JMP @MR314               ; 314
STG @MR314               ; 314
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR315               ; Err102 TASK4 Err12解除完了
CON
ENDS
;Err103
STG @MR400               ; Err103 天秤 通信異常
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR401               ; 401
MOV #103 DM1200          ; 通常ｴﾗｰ番号
STG @MR401               ; 401
AND R40010               ; ERROR
JMP @MR402               ; 402
STG @MR402               ; 402
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR403               ; Err103 TASK4 Err13解除完了
CON
ENDS
;Err104
STG @MR404               ; Err104 ｲﾝｸ重量上限異常
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR405               ; 405
MOV #104 DM1200          ; 通常ｴﾗｰ番号
STG @MR405               ; 405
AND R40010               ; ERROR
JMP @MR406               ; 406
STG @MR406               ; 406
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR407               ; Err104 TASK4 Err14解除完了
CON
ENDS
;Err105
STG @MR408               ; Err105 ｲﾝｸ重量下限異常
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR409               ; 409
MOV #105 DM1200          ; 通常ｴﾗｰ番号
STG @MR409               ; 409
AND R40010               ; ERROR
JMP @MR410               ; 410
STG @MR410               ; 410
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR411               ; Err105 TASK4 Err15解除完了
CON
ENDS
;Err106
STG @MR412               ; Err106 ｲﾝｸ重量上限警告
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR413               ; 413
MOV #106 DM1200          ; 通常ｴﾗｰ番号
STG @MR413               ; 413
AND R40010               ; ERROR
JMP @MR414               ; 414
STG @MR414               ; 414
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR415               ; Err106 TASK4 Err16解除完了
CON
ENDS
;Err107
STG @MR500               ; Err107 ｲﾝｸ重量下限警告
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_NONE DM1203        ; ERROR_SW_NONE  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR501
MOV #107 DM1200          ; 通常ｴﾗｰ番号
STG @MR501
AND R40010               ; ERROR
JMP @MR502               ; 502
STG @MR502               ; 502
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR503               ; Err107 TASK4 Err17解除完了
CON
ENDS
;Err108
STG @MR504               ; Err108 排出ｺﾝﾍﾞﾔ未通過
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR505               ; 505
MOV #108 DM1200          ; 通常ｴﾗｰ番号
STG @MR505               ; 505
AND R40010               ; ERROR
JMP @MR506               ; 506
STG @MR506               ; 506
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR507               ; Err108 TASK4 Err18解除完了
CON
ENDS
;Err109
STG @MR508               ; Err109 NG排出未通過
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_CONTINUE DM1206    ; ERROR_SW_CONTINUE  Err_sw_CONTINUE
CON
JMP @MR509               ; 509
MOV #109 DM1200          ; 通常ｴﾗｰ番号
STG @MR509               ; 509
AND R40010               ; ERROR
JMP @MR510               ; 510
STG @MR510               ; 510
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR511               ; Err109 TASK4 Err19解除完了
CON
ENDS
;Err110
STG @MR512               ; Err110 TASK4 Err20
ANB R40010               ; ERROR
SET R40010               ; ERROR
CON
SET R41003               ; TASK4 ERROR中
CON
DW SW_RETRY DM1203       ; ERROR_SW_RETRY  Err_sw_RETRY
CON
DW SW_NONE DM1204        ; ERROR_SW_NONE  Err_sw_REMOVE
CON
DW SW_NONE DM1205        ; ERROR_SW_NONE  Err_sw_RECHECK
CON
DW SW_NONE DM1206        ; ERROR_SW_NONE  Err_sw_CONTINUE
CON
JMP @MR513               ; 513
MOV #110 DM1200          ; 通常ｴﾗｰ番号
STG @MR513               ; 513
AND R40010               ; ERROR
JMP @MR514               ; 514
STG @MR514               ; 514
ANB R40010               ; ERROR
RES R41003               ; TASK4 ERROR中
CON
SET @MR515               ; Err110 TASK4 Err20解除完了
CON
ENDS
;PACKｾｯﾄ
;Pack Set
LDB @MR900               ; PACK4-1
ANB @MR901               ; PACK4-2
ANB @MR902               ; PACK4-3
ANB @MR903               ; PACK4-4
ANB @MR904               ; PACK4-5
ANB @MR905               ; PACK4-6
ANB @MR906               ; PACK4-7
ANB @MR907               ; PACK4-8
INV
OUT R40203               ; ﾎﾟｰｽﾞ禁止4
END
ENDH
