DEVICE:53
;MODULE:AlwaysSignal
;MODULE_TYPE:0
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	Always_Signal
;ModuleType	:	Sub Module
;Function	:	条件生成
;---------------------------------------
;<使用方法>
;ﾌﾟﾛｼﾞｪｸﾄ全体に関わる条件ｼｸﾞﾅﾙ生成は本ﾓｼﾞｭｰﾙに記述して下さい
;・ﾓｰｼｮﾝｺﾝﾄﾛｰﾙ動作許可
;・ｺﾐｭﾆｹｰｼｮﾝﾕﾆｯﾄ通信許可
;・ﾋｰﾀｰ電源ON
;など
LD CR2008                ; 運転開始時1ｽｷｬﾝON
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR MR10100               ; ﾊﾝﾄﾞ在荷ﾁｪｯｸ
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT MR10100              ; ﾊﾝﾄﾞ在荷ﾁｪｯｸ
LD CR2002                ; 常時ON
MOV.D DM4200 DM4502      ; _機種別ﾃﾞｰﾀ　ﾃﾝﾎﾟﾗﾘ  離脱量(0.01mm)(U1)
;ﾍｯﾄﾞｻﾌﾞ→ﾎﾙﾀﾞｰｻﾌﾞの先入れ先だし回路
;<h1/>FIFOテーブル　読出し回路
LD MR401                 ; FIFO読出し　Trig
SET MR17200              ; 読出し開始
STG MR17200              ; 読出し開始
MPS
LDB CR2002               ; 常時ON
ANB MR17301              ; 書き込み実行中
ANL
SET MR17201              ; 読出し実行中
CON
JMP MR17202              ; START
MPP
AND CR2002               ; 常時ON
SET MR17201              ; 読出し実行中
CON
ANB MR401                ; FIFO読出し　Trig
JMP MR17202              ; START
STG MR17202              ; START
MPS
AND<> DM50 #0            ; 基板指定No.
MPS
AND= DM50 DM60           ; 基板指定No.  基板指定No.
JMP MR17206              ; 取出しOK
MPP
MOV DM50 DM60            ; 基板指定No.  基板指定No.
MPP
AND= DM50 #0             ; 基板指定No.
JMP MR17203              ; ﾃﾞｰﾀシフト開始
STG MR17203              ; ﾃﾞｰﾀシフト開始
LDA DM51                 ; FIFOﾃｰﾌﾞﾙ 1個目
CON
STA DM50                 ; 基板指定No.
CON
LDA DM52                 ; FIFOﾃｰﾌﾞﾙ 2個目
CON
STA DM51                 ; FIFOﾃｰﾌﾞﾙ 1個目
CON
LDA DM53                 ; FIFOﾃｰﾌﾞﾙ 3個目
CON
STA DM52                 ; FIFOﾃｰﾌﾞﾙ 2個目
CON
LDA DM54                 ; FIFOﾃｰﾌﾞﾙ 4個目
CON
STA DM53                 ; FIFOﾃｰﾌﾞﾙ 3個目
CON
LDA DM55                 ; FIFOﾃｰﾌﾞﾙ 5個目
CON
STA DM54                 ; FIFOﾃｰﾌﾞﾙ 4個目
CON
LDA DM56                 ; FIFOﾃｰﾌﾞﾙ 6個目
CON
STA DM55                 ; FIFOﾃｰﾌﾞﾙ 5個目
CON
LDA #0
CON
STA DM56                 ; FIFOﾃｰﾌﾞﾙ 6個目
CON
JMP MR17204
STG MR17204
MPS
LD= DM51 #0              ; FIFOﾃｰﾌﾞﾙ 1個目
AND= DM52 #0             ; FIFOﾃｰﾌﾞﾙ 2個目
AND= DM53 #0             ; FIFOﾃｰﾌﾞﾙ 3個目
AND= DM54 #0             ; FIFOﾃｰﾌﾞﾙ 4個目
AND= DM55 #0             ; FIFOﾃｰﾌﾞﾙ 5個目
AND= DM56 #0             ; FIFOﾃｰﾌﾞﾙ 6個目
ANL
OUT MR17210              ; 全てO
CON
SET MR403                ; FIFO読出し完了なし
CON
JMP MR17208
MPP
ANB MR17210              ; 全てO
JMP MR17202              ; START
;<<行コメント編集：Ctrl+Enter/Escで確定>>
STG MR17206              ; 取出しOK
LDA DM51                 ; FIFOﾃｰﾌﾞﾙ 1個目
CON
STA DM50                 ; 基板指定No.
CON
LDA DM52                 ; FIFOﾃｰﾌﾞﾙ 2個目
CON
STA DM51                 ; FIFOﾃｰﾌﾞﾙ 1個目
CON
LDA DM53                 ; FIFOﾃｰﾌﾞﾙ 3個目
CON
STA DM52                 ; FIFOﾃｰﾌﾞﾙ 2個目
CON
LDA DM54                 ; FIFOﾃｰﾌﾞﾙ 4個目
CON
STA DM53                 ; FIFOﾃｰﾌﾞﾙ 3個目
CON
LDA DM55                 ; FIFOﾃｰﾌﾞﾙ 5個目
CON
STA DM54                 ; FIFOﾃｰﾌﾞﾙ 4個目
CON
LDA DM56                 ; FIFOﾃｰﾌﾞﾙ 6個目
CON
STA DM55                 ; FIFOﾃｰﾌﾞﾙ 5個目
CON
MPS
LD= DM60 #1              ; 基板指定No.
AND DM11211.2            ; RB13 ﾎﾙﾀﾞｰSub　組込完了 記憶FLG
ANB DM11211.15           ; RB13 排出品 記憶FLG
LD= DM60 #2              ; 基板指定No.
AND DM11212.2            ; RB14 ﾎﾙﾀﾞｰSub　組込完了 記憶FLG
ANB DM11212.15           ; RB14 不良品 記憶FLG
ORL
LD= DM60 #3              ; 基板指定No.
AND DM11213.2            ; RB15 ﾎﾙﾀﾞｰSub　組込完了 記憶FLG
ANB DM11213.15           ; RB15 不良品 記憶FLG
ORL
LD= DM60 #4              ; 基板指定No.
AND DM11214.2            ; RB16 ﾎﾙﾀﾞｰSub　組込完了 記憶FLG
ANB DM11214.15           ; RB16 不良品FLG
ORL
LD= DM60 #5              ; 基板指定No.
AND DM11215.2            ; RB17 ﾎﾙﾀﾞｰSub　組込完了
ANB DM11215.15           ; RB17 不良品 記憶FLG
ORL
LD= DM60 #6              ; 基板指定No.
AND DM11216.2            ; RB18 ﾎﾙﾀﾞｰSub　組込完了 記憶FLG
ANB DM11216.15           ; RB18 不良品 記憶FLG
ORL
ANL
SET MR402                ; FIFO読出し完了(OK)
CON
JMP MR17208
MPP
ANB MR402                ; FIFO読出し完了(OK)
JMP MR17208
STG MR17208
ANB MR402                ; FIFO読出し完了(OK)
ANB MR403                ; FIFO読出し完了なし
RES MR17201              ; 読出し実行中
CON
ENDS
;<h1/>FIFOテーブル　書き込み回路
LD MR405                 ; FIFO書き込みTrig
SET MR17300              ; 書き込み開始
STG MR17300              ; 書き込み開始
ANB MR17201              ; 読出し実行中
RES MR17310              ; 書き込みOK　DM50へ
CON
RES MR17311              ; 書き込みOK　DM51へ
CON
RES MR17312              ; 書き込みOK　DM52へ
CON
RES MR17313              ; 書き込みOK　DM53へ
CON
RES MR17314              ; 書き込みOK　DM54へ
CON
RES MR17315              ; 書き込みOK　DM55へ
CON
RES MR17400              ; 書き込みOK　DM56へ
CON
SET MR17301              ; 書き込み実行中
CON
JMP MR17302              ; START
STG MR17302              ; START
MPS
AND= DM50 #0             ; 基板指定No.
SET MR17310              ; 書き込みOK　DM50へ
CON
JMP MR17303
MPP
AND<> DM50 #0            ; 基板指定No.
MPS
AND= DM51 #0             ; FIFOﾃｰﾌﾞﾙ 1個目
SET MR17311              ; 書き込みOK　DM51へ
CON
JMP MR17303
MPP
AND<> DM51 #0            ; FIFOﾃｰﾌﾞﾙ 1個目
MPS
AND= DM52 #0             ; FIFOﾃｰﾌﾞﾙ 2個目
SET MR17312              ; 書き込みOK　DM52へ
CON
JMP MR17303
MPP
AND<> DM52 #0            ; FIFOﾃｰﾌﾞﾙ 2個目
MPS
AND= DM53 #0             ; FIFOﾃｰﾌﾞﾙ 3個目
SET MR17313              ; 書き込みOK　DM53へ
CON
JMP MR17303
MPP
AND<> DM53 #0            ; FIFOﾃｰﾌﾞﾙ 3個目
MPS
AND= DM54 #0             ; FIFOﾃｰﾌﾞﾙ 4個目
SET MR17314              ; 書き込みOK　DM54へ
CON
JMP MR17303
MPP
AND<> DM54 #0            ; FIFOﾃｰﾌﾞﾙ 4個目
MPS
AND= DM55 #0             ; FIFOﾃｰﾌﾞﾙ 5個目
SET MR17315              ; 書き込みOK　DM55へ
CON
JMP MR17303
MPP
LD<> DM55 #0             ; FIFOﾃｰﾌﾞﾙ 5個目
AND= DM56 #0             ; FIFOﾃｰﾌﾞﾙ 6個目
ANL
SET MR17400              ; 書き込みOK　DM56へ
CON
JMP MR17303
STG MR17303
ANB MR17310              ; 書き込みOK　DM50へ
ANB MR17311              ; 書き込みOK　DM51へ
ANB MR17312              ; 書き込みOK　DM52へ
ANB MR17313              ; 書き込みOK　DM53へ
ANB MR17314              ; 書き込みOK　DM54へ
ANB MR17315              ; 書き込みOK　DM55へ
ANB MR17400              ; 書き込みOK　DM56へ
RES MR17301              ; 書き込み実行中
CON
ENDS
;TPｶﾚﾝﾀﾞﾀｲﾏ自動同期
LD= CM703 #8             ; ｶﾚﾝﾀﾞﾀｲﾏ（時）
AND= CM704 #0            ; ｶﾚﾝﾀﾞﾀｲﾏ（分）
AND= CM705 #0            ; ｶﾚﾝﾀﾞﾀｲﾏ（秒）
SET @R010
STG @R010
MPS
LDA CM700                ; ｶﾚﾝﾀﾞﾀｲﾏ（年）
CON
ADD #32768
CON
TBCD
CON
STA DM3010               ; _MainTP　ｶﾚﾝﾀﾞﾀｲﾏ（設定値）
MRD
LDA CM701                ; ｶﾚﾝﾀﾞﾀｲﾏ（月）
CON
TBCD
CON
STA DM3011               ; _MainTP　ｶﾚﾝﾀﾞﾀｲﾏ（設定値）
MRD
LDA CM702                ; ｶﾚﾝﾀﾞﾀｲﾏ（日）
CON
TBCD
CON
STA DM3012               ; _MainTP　ｶﾚﾝﾀﾞﾀｲﾏ（設定値）
MRD
LDA CM703                ; ｶﾚﾝﾀﾞﾀｲﾏ（時）
CON
TBCD
CON
STA @DM21
MRD
LDA CM704                ; ｶﾚﾝﾀﾞﾀｲﾏ（分）
CON
TBCD
CON
STA @DM20
MRD
UNIB @DM20 DM3013 #2     ; _MainTP　ｶﾚﾝﾀﾞﾀｲﾏ（設定値）
MPP
JMP @R011
STG @R011
TMH @1 #5
CON
AND @T1
BRES DM3010 #15          ; _MainTP　ｶﾚﾝﾀﾞﾀｲﾏ（設定値）
CON
ENDS
;ﾋｰﾀｰ電源ON
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ORP R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LDB MR24700              ; ﾋｰﾀｰ1過昇温異常
ANB DM2001.4             ; ｶｼﾒ1動作有無(0:有/1:無)
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
ANL
SET MR1300               ; ﾋｰﾀｰ1ON
MRD
LDB MR24701              ; ﾋｰﾀｰ2過昇温異常
ANB DM2001.4             ; ｶｼﾒ1動作有無(0:有/1:無)
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
ANL
SET MR1301               ; ﾋｰﾀｰ2ON
MRD
LDB MR24702              ; ﾋｰﾀｰ3過昇温異常
ANB DM2001.5             ; ｶｼﾒ2動作有無(0_有/1_無)
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
ANL
SET MR1302               ; ﾋｰﾀｰ3ON
MPP
LDB MR24703              ; ﾋｰﾀｰ4過昇温異常
ANB DM2001.5             ; ｶｼﾒ2動作有無(0_有/1_無)
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
ANL
SET MR1303               ; ﾋｰﾀｰ4ON
LDB MR24700              ; ﾋｰﾀｰ1過昇温異常
ANB MR24704              ; ﾋｰﾀｰ1ﾋｰﾀｰ系異常
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
INV
RES MR1300               ; ﾋｰﾀｰ1ON
LDB MR24701              ; ﾋｰﾀｰ2過昇温異常
ANB MR24705              ; ﾋｰﾀｰ2ﾋｰﾀｰ系異常
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
INV
RES MR1301               ; ﾋｰﾀｰ2ON
LDB MR24702              ; ﾋｰﾀｰ3過昇温異常
ANB MR24706              ; ﾋｰﾀｰ3ﾋｰﾀｰ系異常
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
INV
RES MR1302               ; ﾋｰﾀｰ3ON
LDB MR24703              ; ﾋｰﾀｰ4過昇温異常
ANB MR24707              ; ﾋｰﾀｰ4ﾋｰﾀｰ系異常
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB MR24914              ; ﾃﾞﾊﾞｯｸ(ﾋｰﾀｰ無し空運転)
INV
RES MR1303               ; ﾋｰﾀｰ4ON
;原点復帰完了記憶
LD MR10400               ; TASK0_原点復帰完了
AND MR10401              ; TASK1_原点復帰完了
AND MR10402              ; TASK2_原点復帰完了
AND MR10403              ; TASK3_原点復帰完了
AND MR10405              ; TASK5_原点復帰完了
AND MR10406              ; TASK6_原点復帰完了
OUT MR10415              ; 原点復帰完了OK
LD= DM9032 #9            ; _MODE_INDI指定番号
OR= DM9032 #2            ; _MODE_INDI指定番号
ANP R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
LD<> DM4110 #1           ; _Group1　ﾒﾝﾃ動作番号
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ORL
OR R46104                ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
DW #0 MR10400            ; TASK0_原点復帰完了
END
ENDH
