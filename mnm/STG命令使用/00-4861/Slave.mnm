DEVICE:53
;MODULE:Slave
;MODULE_TYPE:0
LD R50000                ; 即停止
OR R50900                ; TRAP
OR R50914                ; HOMEsw ON
ZRES @MR000 @MR915       ; MAIN PAUSE条件確認へ
LD R55000                ; 即停止/TRAP 入力無し
AND T200                 ; 動作中遅延
ANB R52004               ; ｽﾀｰﾄ_SW
ANB R1100                ; BOX START_SW
TMR @0 #10               ; 遅延
CON
AND @T0                  ; 遅延
MPS
@SET @MR000              ; MAIN PAUSE条件確認へ
MPP
AND=.D @MR000 #0         ; MAIN PAUSE条件確認へ
MPS
ANB R50301               ; MEIN部    Pause
@SET @MR000              ; MAIN PAUSE条件確認へ
MPP
AND R50301               ; MEIN部    Pause
MPS
ANB MR3001               ; SAFETY COVER OPEN
@SET @MR001              ; 001
MPP
AND MR3001               ; SAFETY COVER OPEN
@SET @MR101              ; 101
LD=.D @MR000 #0          ; MAIN PAUSE条件確認へ
OR R53002                ; 仮 異常検出FLG１
ANB T250
OUT R53002               ; 仮 異常検出FLG１
TMR #250 #20
LD= @MR200 #0            ; ﾄﾚﾁｪﾝPAUSE条件確認へ
OR R53003                ; 仮 異常検出FLG２
ANB T251
OUT R53003               ; 仮 異常検出FLG２
TMR #251 #20
LDP R53002               ; 仮 異常検出FLG１
INC DM900                ; 暫定　異常発生カウンタ
LDP R53003               ; 仮 異常検出FLG２
INC DM901                ; 暫定カウンタ
;<h1/>■■■■■ MAIN部 PAUSE / MAIN PAUSE ■■■■■
;***** Pause 判断 / Pause Judge  *****
;
STG @MR000               ; MAIN PAUSE条件確認へ
MPS
LD R50001                ; 自動中
OR R50002                ; ステップ動作中
OR R51101                ; 原点復帰
ANB CR2002               ; 常時ON
ANL
SET R50212               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
SET R50301               ; MEIN部    Pause
CON
MPS
ANB R50003               ; 原点復帰中
JMP @MR001               ; 001
MPP
AND R50003               ; 原点復帰中
RES MR3006
CON
JMP @MR001               ; 001
MPP
LDP R52006               ; PAUSE sw
ORP R1101                ; BOX　PAUSE_SW
ANL
SET R62006               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
SET R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
SET R50301               ; MEIN部    Pause
CON
JMP @MR001               ; 001
;***** Pack 判断 / Pack Judge  *****
;
LDB R51200               ; PACK1
ANB R51201               ; PACK2
ANB R51202               ; PACK3
ANB R51203               ; PACK4
ANB R51204               ; PACK5
ANB R51115               ; PACK6
OUB R50308               ; PACK中
LD R1003                 ; SAFETY COVER(ON=閉)
AND R51001               ; ｽﾀｰﾄsw ON
ANB @MR114               ; RB4停止指示中
OUT @MR400               ; PAUSE条件
STG @MR001               ; 001
MPS
ANB R50308               ; PACK中
JMP @MR100
MPP
LD R50308                ; PACK中
AND @MR400               ; PAUSE条件
ANL
RES R62006               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
RES R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
RES R50301               ; MEIN部    Pause
CON
JMP @MR000               ; MAIN PAUSE条件確認へ
;RB4減速停止 / RB4 Slow down → stop
;***** PAUSE 処理 / pause routine  *****
;
STG @MR100
SET MR50300              ; Pause
CON
SET MR3001               ; SAFETY COVER OPEN
CON
JMP @MR101               ; 101
LD MR50300               ; Pause
TMR #350 #10
CON
AND T350
RES MR3004               ; CONVEYER1 POWER ON
CON
RES MR3005               ; CONVEYER2 POWER ON
;***** ｶﾊﾞｰ閉 条件待ち / Cover close  Judge  *****
;
STG @MR101               ; 101
MPS
LDP R51001               ; ｽﾀｰﾄsw ON
ORP R1100                ; BOX START_SW
ANL
JMP @MR102               ; 102
MPP
LDP R52006               ; PAUSE sw
ORP R1101                ; BOX　PAUSE_SW
ANL
SET R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
SET MR3001               ; SAFETY COVER OPEN
CON
RES MR3003               ; MOTION CONTROLLER STOP
;***** Pause 条件復帰待ち / Pause Clear  Judge  *****
;
STG @MR102               ; 102
SET R50309               ; ERR Rset under input
CON
RES MR3001               ; SAFETY COVER OPEN
CON
JMP @MR103               ; 103
STG @MR103               ; 103
TMR @1 #5                ; ｶﾊﾞｰ閉   確認遅延
CON
AND @T1                  ; ｶﾊﾞｰ閉   確認遅延
MPS
AND R1003                ; SAFETY COVER(ON=閉)
JMP @MR104               ; 104
MPP
ANB R1003                ; SAFETY COVER(ON=閉)
SET MR3001               ; SAFETY COVER OPEN
CON
JMP @MR101               ; 101
STG @MR104               ; 104
RES MR3001               ; SAFETY COVER OPEN
CON
JMP @MR105               ; 105
STG @MR105               ; 105
MPS
LDB @MR114               ; RB4停止指示中
ORB R53000               ; 仮NAT
ANL
JMP @MR107               ; 107
MPP
LD @MR114                ; RB4停止指示中
AND R53000               ; 仮NAT
ANL
SET R26405               ; 軸4 位置決め運転再開
CON
JMP @MR106               ; 106
STG @MR106               ; 106
AND R26805               ; ｶｳﾝﾀ2 現在値変更要求
RES @MR114               ; RB4停止指示中
CON
RES R26405               ; 軸4 位置決め運転再開
CON
JMP @MR107               ; 107
STG @MR107               ; 107
MPS
AND R50001               ; 自動中
SET MR3004               ; CONVEYER1 POWER ON
CON
SET MR3005               ; CONVEYER2 POWER ON
CON
RES MR50300              ; Pause
CON
RES R50309               ; ERR Rset under input
CON
RES R62006               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
RES R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
RES R50301               ; MEIN部    Pause
CON
JMP @MR000               ; MAIN PAUSE条件確認へ
MPP
ANB R50001               ; 自動中
RES MR50300              ; Pause
CON
RES R50309               ; ERR Rset under input
CON
RES R62006               ; START ﾗﾝﾌﾟ点滅FLG(PAUSE release)
CON
RES R50214               ; 背面START ﾗﾝﾌﾟ点滅FLG
CON
RES R50301               ; MEIN部    Pause
CON
JMP @MR000               ; MAIN PAUSE条件確認へ
;<h1/>■■■■■ ﾄﾚｲﾁｪﾝｼﾞｬ PAUSE / Traychanger PAUSE ■■■■■
;***** Pause 判断 / Pause Judge  *****
;
;***** Pack 判断 / Pack Judge  *****
;
;***** PAUSE 処理 / pause routine  *****
;
;***** ｶﾊﾞｰ閉 条件待ち / Cover close  Judge  *****
;
;***** Pause 条件復帰待ち / Pause Clear  Judge  *****
;
;ﾄﾚｲﾁｪﾝｼﾞ部PAUSE処理 / Traychanger PAUSE process
END
ENDH
