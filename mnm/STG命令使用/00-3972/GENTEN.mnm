DEVICE:53
;MODULE:GENTEN
;MODULE_TYPE:1
;初期化
;
LD @CR2008
RES P1                   ; END_FLG
CON
RES P2                   ; ERR_FLG
;先頭R参照(先頭 + 0)
LD @CR2008
ADRSET UR0 @EM0          ; UT_NO  軸先頭ﾘﾚｰ1
LDA V0                   ; AXIS_NO
CON
SUB #1
CON
MUL #8
CON
STA @EM4                 ; 軸選択ｵﾌｾｯﾄ
CON
ADRADD.S @EM4 @EM0       ; 軸選択ｵﾌｾｯﾄ  軸先頭ﾘﾚｰ1
;先頭R参照(先頭 + 4000)
LD @CR2008
ADRSET UR0 @EM2          ; UT_NO  軸先頭ﾘﾚｰ2
LDA V0                   ; AXIS_NO
CON
SUB #1
CON
MUL #128
CON
ADD #640
CON
STA @EM4                 ; 軸選択ｵﾌｾｯﾄ
CON
ADRADD.S @EM4 @EM2       ; 軸選択ｵﾌｾｯﾄ  軸先頭ﾘﾚｰ2
LD @CR2008
ANB *@EM2:#68            ; 軸先頭ﾘﾚｰ2
SET *@EM2:#12            ; 軸先頭ﾘﾚｰ2
LD *@EM2:#76             ; 軸先頭ﾘﾚｰ2
RES *@EM2:#12            ; 軸先頭ﾘﾚｰ2
LDF *@EM2:#76            ; 軸先頭ﾘﾚｰ2
SET P1                   ; END_FLG
;異常処理
LD @CR2007
LD *@EM2:#64             ; 軸先頭ﾘﾚｰ2
OR *@EM2:#65             ; 軸先頭ﾘﾚｰ2
ANL
RES *@EM2:#12            ; 軸先頭ﾘﾚｰ2
CON
SET P2                   ; ERR_FLG
END
ENDH
