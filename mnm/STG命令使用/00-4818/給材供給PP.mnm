DEVICE:53
;MODULE:給材供給PP
;MODULE_TYPE:0
;SCRIPT_TYPE:
;****P&P給材 入力処理 / P&P給材  入力処理 ****
LD R4000                 ; 供給P&Pﾍｯﾄﾞ下降端
TMR @0 #3                ; 供給P&Pﾍｯﾄﾞ下降端
LD R4001                 ; P&P給材ﾍｯﾄﾞ上昇端
TMR @1 #2                ; P&P給材ﾍｯﾄﾞ上昇端
LD MR2509                ; 電磁MG吸着ﾘﾚｰ
TMR @2 #3                ; 電磁MG吸着ON確認
LDB MR2509               ; 電磁MG吸着ﾘﾚｰ
TMR @3 #3                ; 電磁MG吸着OFF確認
;****P&P給材 ﾊﾟﾚﾀｲｽﾞ計算 / P&P給材　ﾊﾟﾚﾀｲｽﾞ計算 ****
LD CR2002                ; 常時ON
MOV.L DM1254 DM1320      ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
MOV.L DM1256 DM1324      ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値計算用
MOV.L DM1258 DM1328      ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値計算用
LD CR2002                ; 常時ON
MOV.L DM1204 DM1322      ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
MOV.L DM1206 DM1326      ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値計算用
MOV.L DM1208 DM1330      ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値計算用
LD> DM1300 #1            ; P&P XY軸ﾎﾟｲﾝﾄNo.
ANP R60710               ; P&P XY軸ﾎﾟｲﾝﾄNo.DOWN SW
@DEC DM1300              ; P&P XY軸ﾎﾟｲﾝﾄNo.
LD< DM1300 #24           ; P&P XY軸ﾎﾟｲﾝﾄNo.
ANP R60711               ; P&P XY軸ﾎﾟｲﾝﾄNo.UP SW
@INC DM1300              ; P&P XY軸ﾎﾟｲﾝﾄNo.
LD= DM308 #34            ; 画面No.通知
ANB MR40005              ; 全起動中
ANB MR40610              ; STEP前半選択
MOV DM1300 DM1310        ; P&P XY軸ﾎﾟｲﾝﾄNo.  P&P XY軸ﾎﾟｲﾝﾄNo.計算用
LD MR40005               ; 全起動中
OR MR40610               ; STEP前半選択
LDA DM1100               ; 供給P&P取出しｶｳﾝﾄ値
CON
ADD #1
CON
STA DM1310               ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
;------------------------------------------------------------------------------------------------------
;-- タイトル								: パレタイジング
;------------------------------------------------------------------------------------------------------
;-- プログラム言語 						: スクリプト言語
;-- 算出方式　　　　　　　　　　　　　　 : ３点ティーチング方式
;-- 移動単位　 　　　　　　　　　　　　　: パルス
;-- 座標　　　　　　　　 　　　　　　　　: Ｘ−Ｙ直交座標
;-- Ｘ軸＋側移動方向　　　　　　　　　　 : 横軸左側方向
;-- Ｙ軸＋側移動方向　　　　　　　　　　 : 縦軸下側方向
;-- パレタイジング個数　　　　　　　　　 : Ｘ軸方向（３点）ｘ Ｙ軸方向（８点）＝計２４点
;-- パレタイジング基点　　　　　　　　　 : Ｘ軸−側およびＹ軸−側を基点
;-- ポイント番号増加方向　　　　　　　	: 基点よりＸ軸＋側へ第１，２，３　Ｙ軸＋側へ第１,４，７，１０，１３
;--　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 ，１６，１９，２２
;--          ----------------  行番号
;--          | 24 | 23 | 22 |   7行
;--          | 21 | 20 | 19 |   6行
;--          | 18 | 17 | 16 |   5行
;--          | 15 | 14 | 13 |   4行
;--          | 12 | 11 | 10 |   3行
;--          | 09 | 08 | 07 |   2行
;--          | 06 | 05 | 04 |   1行
;--          | 03 | 02 | 01 |   0行
;--  Ｘ軸＋<-----------------
;-- 列番号->  2列  1列  0列 |
;--                        Ｙ軸＋
;--　　　　　　　　　　　　 
;-- 直行軸に対する偏角補正　　　　　　　 : 三角関数を用いて補正
;------------------------------------------------------------------------------------------------------
;========== 以下スクリプト言語('で始まるのはコメント) ==========
;'求めるポイント番号（ＮＯ．１−２４）が格納されているデバイス　DM1310
;'計算を簡略化するのに実ポイント番号から１を引いた値を計算用ポイント番号（NO.0-23)として格納するデバイス　DM1312
;'求めた行番号を格納する（０−７行）を格納するデバイス　DM1400
;'求めた列番号を格納する（０−２列）を格納するデバイス　DM1401
;'ティーチングされた３点のデータ(パルス値<32ﾋﾞｯﾄﾃﾞｰﾀを想定>)を格納しているデバイスはそれぞれ以下
;'実ポイント番号１のＸ座標＝DM1320 Ｙ座標＝DM1322
;'実ポイント番号３のＸ座標＝DM1324 Ｙ座標＝DM1326
;'実ポイント番号２２のＸ座標＝DM1328 Ｙ座標＝DM1330
;'ポイント番号が１〜２４の範囲かつ
;'DM1322.LとDM1330.Lが等しくないなら以下のスクリプトを実行します(０除算回避)
;IF 1<=DM1310 AND DM1310<=24 AND DM1322.L <> DM1330.L THEN
; IF DM1310<>1 THEN
;
;'行番号、列番号を求める
;  DM1312.L = TOL(DM1310) - 1   '計算用ポイント番号＝実ポイント番号 − １
;  DM1400.L = DM1312.L / 3     'ポイント番号を３で割った商が行番号
;  DM1402.L = DM1312.L MOD 3   'ポイント番号を３で割った余りが列番号
;
;'ポイントデータを符号拡張する
;  DM1340.F = TOF(DM1320.L)
;  DM1342.F = TOF(DM1322.L)
;  DM1344.F = TOF(DM1324.L)
;  DM1346.F = TOF(DM1326.L)
;  DM1348.F = TOF(DM1328.L)
;  DM1350.F = TOF(DM1330.L)
;
;'直行Ｘ−Ｙ軸に対するパレタイジングの偏角(θ＝DM1420.F)を求める
;  DM1410.F = (DM1348.F - DM1340.F) / (DM1350.F - DM1342.F)    'tanθ(=DM1410.F)を求める
;  DM1420.F = ATAN(DM1410.F)
;
;'基準座標（ポイントＮＯ．１）からの求めるポイントのＸ方向長さ(=DM1450.F)およびＹ方向長さ(=DM1460.F)を求める
;  DM1430.F = ROOT((DM1344.F - DM1340.F) * (DM1344.F - DM1340.F) + (DM1346.F - DM1342.F) * (DM1346.F - DM1342.F)) 'ﾊﾟﾚﾀｲｼﾞﾝｸﾞの横幅算出
;  DM1440.F = ROOT((DM1348.F - DM1340.F) * (DM1348.F - DM1340.F) + (DM1350.F - DM1342.F) * (DM1350.F - DM1342.F)) 'ﾊﾟﾚﾀｲｼﾞﾝｸﾞの縦幅算出
;  DM1450.F = DM1430.F * TOF(DM1402.L) / 2  '数値2はﾊﾟﾚﾀｲｼﾞﾝｸﾞ横方向の分割数
;  DM1460.F = DM1440.F * TOF(DM1400.L) / 7  '数値7はﾊﾟﾚﾀｲｼﾞﾝｸﾞ縦方向の分割数
; 
;'最後に目的のポイントのＸ座標(=DM1332.L)、Ｙ座標(=DM1334.L)を求める
;  DM1470.F = ROOT(DM1450.F * DM1450.F + DM1460.F * DM1460.F) '求めるポイントの長さ算出(ﾋﾟﾀｺﾞﾗｽ)
;  DM1480.F = ASIN(DM1450.F / DM1470.F)    '求めるポイントのsin角度(φ)算出
;  DM1490.F = DM1480.F + DM1420.F          '偏角(θ)を補正した実角度(φ+θ)算出
;  DM1380.F = DM1470.F * SIN(DM1490.F)     '求めるポイントのＸ方向実長さ算出
;  DM1390.F = DM1470.F * COS(DM1490.F)     '求めるポイントのＹ方向実長さ算出
;  DM1332.L = DM1320.L + TOL(DM1380.F)     '基準(ポイントNO.1)のＸ座標にＸ方向長さを加算
;  DM1334.L = DM1322.L - TOL(DM1390.F)     '基準(ポイントNO.1)のＹ座標にＹ方向長さを加算
; ELSE
;
;'ポイントNO.1だけはティーチングデータを使用する
;  DM1332.L = DM1320.L
;  DM1334.L = DM1322.L
; END IF
;END IF
;'ポイント番号が１〜２４の範囲かつ
;
;'DM1322.LとDM1330.Lが等しくないなら以下のスクリプトを実行します(０除算回避)
;
;IF 1<=DM1310 AND DM1310<=24 AND DM1322.L <> DM1330.L THEN
;
LD>= DM1310 #1           ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
OUT @VB00
LD<= DM1310 #24          ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
AND @VB00
OUT @VB01
LD<>.L DM1322 DM1330     ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値計算用
AND @VB01
NCJ #2000
; IF DM1310<>1 THEN
;
LD<> DM1310 #1           ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
NCJ #2001
;'行番号、列番号を求める
;
;  DM1312.L = TOL(DM1310) - 1   '計算用ポイント番号＝実ポイント番号 − １
;
LD CR2002                ; 常時ON
LDA DM1310               ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
CON
EXT
CON
SUB.L +1
CON
STA.L DM1312
;  DM1400.L = DM1312.L / 3     'ポイント番号を３で割った商が行番号
;
LD CR2002                ; 常時ON
LDA.L DM1312
CON
EXT.L
CON
DIV.L +3
CON
STA.L DM1400
;  DM1402.L = DM1312.L MOD 3   'ポイント番号を３で割った余りが列番号
;
LD CR2002                ; 常時ON
LDA.L DM1312
CON
EXT.L
CON
DIV.L +3
CON
LDA.L TM2
CON
STA.L DM1402
;'ポイントデータを符号拡張する
;
;  DM1340.F = TOF(DM1320.L)
;
LD CR2002                ; 常時ON
LDA.L DM1320             ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
CON
FLOAT.L
CON
STA.F DM1340
;  DM1342.F = TOF(DM1322.L)
;
LD CR2002                ; 常時ON
LDA.L DM1322             ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
CON
FLOAT.L
CON
STA.F DM1342
;  DM1344.F = TOF(DM1324.L)
;
LD CR2002                ; 常時ON
LDA.L DM1324             ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値計算用
CON
FLOAT.L
CON
STA.F DM1344
;  DM1346.F = TOF(DM1326.L)
;
LD CR2002                ; 常時ON
LDA.L DM1326             ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値計算用
CON
FLOAT.L
CON
STA.F DM1346
;  DM1348.F = TOF(DM1328.L)
;
LD CR2002                ; 常時ON
LDA.L DM1328             ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値計算用
CON
FLOAT.L
CON
STA.F DM1348
;  DM1350.F = TOF(DM1330.L)
;
LD CR2002                ; 常時ON
LDA.L DM1330             ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値計算用
CON
FLOAT.L
CON
STA.F DM1350
;'直行Ｘ−Ｙ軸に対するパレタイジングの偏角(θ＝DM1420.F)を求める
;
;  DM1410.F = (DM1348.F - DM1340.F) / (DM1350.F - DM1342.F)    'tanθ(=DM1410.F)を求める
;
LD CR2002                ; 常時ON
LDA.F DM1350
CON
SUB.F DM1342
CON
STA.F @VM0
CON
LDA.F DM1348
CON
SUB.F DM1340
CON
DIV.F @VM0
CON
STA.F DM1410
;  DM1420.F = ATAN(DM1410.F)
;
LD CR2002                ; 常時ON
LDA.F DM1410
CON
ATAN
CON
STA.F DM1420
;'基準座標（ポイントＮＯ．１）からの求めるポイントのＸ方向長さ(=DM1450.F)およびＹ方向長さ(=DM1460.F)を求める
;
;  DM1430.F = ROOT((DM1344.F - DM1340.F) * (DM1344.F - DM1340.F) + (DM1346.F - DM1342.F) * (DM1346.F - DM1342.F)) 'ﾊﾟﾚﾀｲｼﾞﾝｸﾞの横幅算出
;
LD CR2002                ; 常時ON
LDA.F DM1346
CON
SUB.F DM1342
CON
STA.F @VM2
CON
LDA.F DM1346
CON
SUB.F DM1342
CON
MUL.F @VM2
CON
STA.F @VM4
CON
LDA.F DM1344
CON
SUB.F DM1340
CON
STA.F @VM6
CON
LDA.F DM1344
CON
SUB.F DM1340
CON
MUL.F @VM6
CON
ADD.F @VM4
CON
ROOT.F
CON
STA.F DM1430
;  DM1440.F = ROOT((DM1348.F - DM1340.F) * (DM1348.F - DM1340.F) + (DM1350.F - DM1342.F) * (DM1350.F - DM1342.F)) 'ﾊﾟﾚﾀｲｼﾞﾝｸﾞの縦幅算出
;
LD CR2002                ; 常時ON
LDA.F DM1350
CON
SUB.F DM1342
CON
STA.F @VM8
CON
LDA.F DM1350
CON
SUB.F DM1342
CON
MUL.F @VM8
CON
STA.F @VM10
CON
LDA.F DM1348
CON
SUB.F DM1340
CON
STA.F @VM12
CON
LDA.F DM1348
CON
SUB.F DM1340
CON
MUL.F @VM12
CON
ADD.F @VM10
CON
ROOT.F
CON
STA.F DM1440
;  DM1450.F = DM1430.F * TOF(DM1402.L) / 2  '数値2はﾊﾟﾚﾀｲｼﾞﾝｸﾞ横方向の分割数
;
LD CR2002                ; 常時ON
LDA.L DM1402
CON
FLOAT.L
CON
MUL.F DM1430
CON
DIV.F +2
CON
STA.F DM1450
;  DM1460.F = DM1440.F * TOF(DM1400.L) / 7  '数値7はﾊﾟﾚﾀｲｼﾞﾝｸﾞ縦方向の分割数
;
LD CR2002                ; 常時ON
LDA.L DM1400
CON
FLOAT.L
CON
MUL.F DM1440
CON
DIV.F +7
CON
STA.F DM1460
;'最後に目的のポイントのＸ座標(=DM1332.L)、Ｙ座標(=DM1334.L)を求める
;
;  DM1470.F = ROOT(DM1450.F * DM1450.F + DM1460.F * DM1460.F) '求めるポイントの長さ算出(ﾋﾟﾀｺﾞﾗｽ)
;
LD CR2002                ; 常時ON
LDA.F DM1460
CON
MUL.F DM1460
CON
STA.F @VM14
CON
LDA.F DM1450
CON
MUL.F DM1450
CON
ADD.F @VM14
CON
ROOT.F
CON
STA.F DM1470
;  DM1480.F = ASIN(DM1450.F / DM1470.F)    '求めるポイントのsin角度(φ)算出
;
LD CR2002                ; 常時ON
LDA.F DM1450
CON
DIV.F DM1470
CON
ASIN
CON
STA.F DM1480
;  DM1490.F = DM1480.F + DM1420.F          '偏角(θ)を補正した実角度(φ+θ)算出
;
LD CR2002                ; 常時ON
LDA.F DM1480
CON
ADD.F DM1420
CON
STA.F DM1490
;  DM1380.F = DM1470.F * SIN(DM1490.F)     '求めるポイントのＸ方向実長さ算出
;
LD CR2002                ; 常時ON
LDA.F DM1490
CON
SIN
CON
MUL.F DM1470
CON
STA.F DM1380
;  DM1390.F = DM1470.F * COS(DM1490.F)     '求めるポイントのＹ方向実長さ算出
;
LD CR2002                ; 常時ON
LDA.F DM1490
CON
COS
CON
MUL.F DM1470
CON
STA.F DM1390
;  DM1332.L = DM1320.L + TOL(DM1380.F)     '基準(ポイントNO.1)のＸ座標にＸ方向長さを加算
;
LD CR2002                ; 常時ON
LDA.F DM1380
CON
INTG.L
CON
ADD.L DM1320             ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
CON
STA.L DM1332             ; P&P X軸ﾎﾟｲﾝﾄ座標計算結果
;  DM1334.L = DM1322.L - TOL(DM1390.F)     '基準(ポイントNO.1)のＹ座標にＹ方向長さを加算
;
LD CR2002                ; 常時ON
LDA.F DM1390
CON
INTG.L
CON
STA.L @VM16
CON
LDA.L DM1322             ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用
CON
SUB.L @VM16
CON
STA.L DM1334             ; P&P Y軸ﾎﾟｲﾝﾄ座標計算結果
; ELSE
;
LD CR2002                ; 常時ON
CJ #2002
LABEL #2001
;'ポイントNO.1だけはティーチングデータを使用する
;
;  DM1332.L = DM1320.L
;
LD CR2002                ; 常時ON
MOV.L DM1320 DM1332      ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用  P&P X軸ﾎﾟｲﾝﾄ座標計算結果
;  DM1334.L = DM1322.L
;
LD CR2002                ; 常時ON
MOV.L DM1322 DM1334      ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値計算用  P&P Y軸ﾎﾟｲﾝﾄ座標計算結果
; END IF
;
LABEL #2002
;END IF
LABEL #2000
;
LD CR2002                ; 常時ON
MOV.L DM1332 DM1304      ; P&P X軸ﾎﾟｲﾝﾄ座標計算結果  P&P X軸ﾎﾟｲﾝﾄ座標計算結果表示
MOV.L DM1334 DM1302      ; P&P Y軸ﾎﾟｲﾝﾄ座標計算結果  P&P Y軸ﾎﾟｲﾝﾄ座標計算結果表示
;****P&P給材 手動操作 / P&P給材　手動 Operation ****
LD MR40300               ; 安全扉閉確認
MC
LDB R80702               ; P&P　XY軸供給位置PL
ANB R80704               ; P&P　XY軸ﾄﾚｲ位置PL
INV
OUT @MR100               ; P&P給材ﾍｯﾄﾞ下降可
LD R60600                ; P&P給材ﾍｯﾄﾞ下降SW
AND @MR100               ; P&P給材ﾍｯﾄﾞ下降可
SET MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
LD CR2002                ; 常時ON
OUT @MR101               ; P&P給材ﾍｯﾄﾞ上昇可
LD R60601                ; P&P給材ﾍｯﾄﾞ上昇SW
AND @MR101               ; P&P給材ﾍｯﾄﾞ上昇可
RES MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
LD CR2002                ; 常時ON
OUT @MR102               ; 電磁MG吸着可
LD R60602                ; 電磁MG吸着SW
AND @MR102               ; 電磁MG吸着可
SET MR2509               ; 電磁MG吸着ﾘﾚｰ
LD CR2002                ; 常時ON
OUT @MR103               ; 電磁MG開放可
LD R60603                ; 電磁MG開放SW
AND @MR103               ; 電磁MG開放可
RES MR2509               ; 電磁MG吸着ﾘﾚｰ
MCR
LD=.L DM11990 DM1200     ; P&P　Y軸現在位置座標  P&P　Y軸待機位置座標設定
AND R1108                ; P&P　Y軸原点復帰完了
AND=.L DM12050 DM1250    ; P&P　X軸現在位置座標  P&P　X軸待機位置座標設定
AND R1109                ; P&P　X軸原点復帰完了
OUT R80700               ; P&P　XY軸待機位置PL
LD=.L DM11990 +0         ; P&P　Y軸現在位置座標
AND R1108                ; P&P　Y軸原点復帰完了
AND=.L DM12050 +0        ; P&P　X軸現在位置座標
AND R1109                ; P&P　X軸原点復帰完了
OUT R80701               ; P&P　XY軸原点位置PL
LD=.L DM11990 DM1202     ; P&P　Y軸現在位置座標  P&P　Y軸供給位置座標設定
AND R1108                ; P&P　Y軸原点復帰完了
AND=.L DM12050 DM1252    ; P&P　X軸現在位置座標  P&P　X軸供給位置座標設定
AND R1109                ; P&P　X軸原点復帰完了
OUT R80702               ; P&P　XY軸供給位置PL
LD=.L DM11990 DM1302     ; P&P　Y軸現在位置座標  P&P Y軸ﾎﾟｲﾝﾄ座標計算結果表示
AND R1108                ; P&P　Y軸原点復帰完了
AND=.L DM12050 DM1304    ; P&P　X軸現在位置座標  P&P X軸ﾎﾟｲﾝﾄ座標計算結果表示
AND R1109                ; P&P　X軸原点復帰完了
AND<> DM1310 #1          ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
LD=.L DM11990 DM1204     ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値
AND R1108                ; P&P　Y軸原点復帰完了
AND=.L DM12050 DM1254    ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値
AND R1109                ; P&P　X軸原点復帰完了
AND= DM1310 #1           ; P&P XY軸ﾎﾟｲﾝﾄNo.計算用
ORL
OUT R80704               ; P&P　XY軸ﾄﾚｲ位置PL
;****P&P給材 Y軸表示ﾗﾝﾌﾟ / P&P給材　Y軸表示ﾗﾝﾌﾟ ****
LD R4000                 ; 供給P&Pﾍｯﾄﾞ下降端
OUT R80600               ; 供給P&Pﾍｯﾄﾞ下降端PL
LD R4001                 ; P&P給材ﾍｯﾄﾞ上昇端
OUT R80601               ; 供給P&Pﾍｯﾄﾞ上昇端PL
LD R2509                 ; PZT供給P&P MG吸着ON
OUT R80602               ; PZT供給P&P MG吸着ON PL
LDB R2509                ; PZT供給P&P MG吸着ON
OUT R80603               ; PZT供給P&P MG吸着OFF PL
LD=.L DM11990 DM1200     ; P&P　Y軸現在位置座標  P&P　Y軸待機位置座標設定
AND R1108                ; P&P　Y軸原点復帰完了
OUT R81000               ; P&P　Y軸待機位置PL
LD=.L DM11990 DM1202     ; P&P　Y軸現在位置座標  P&P　Y軸供給位置座標設定
AND R1108                ; P&P　Y軸原点復帰完了
OUT R81001               ; P&P　Y軸供給位置PL
LD=.L DM11990 DM1204     ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値
AND R1108                ; P&P　Y軸原点復帰完了
OUT R81002               ; P&P　Y軸ﾊﾟﾚﾀｲｽﾞP1位置PL
LD=.L DM11990 DM1206     ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値
AND R1108                ; P&P　Y軸原点復帰完了
OUT R81003               ; P&P　Y軸ﾊﾟﾚﾀｲｽﾞP3位置PL
LD=.L DM11990 DM1208     ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値
AND R1108                ; P&P　Y軸原点復帰完了
OUT R81004               ; P&P　Y軸ﾊﾟﾚﾀｲｽﾞP22位置PL
LD R46513                ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
OUT R80802               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰPL
LD R1108                 ; P&P　Y軸原点復帰完了
OUT R81006               ; P&P　Y軸原点復帰完了PL
OUT R80806               ; P&P　Y軸原点復帰完了PL
;****給材P&P停止条件 / 給材P&P停止条件  ****
LDB @MR310               ; P&P　Y軸移動
ANB @MR510               ; P&P　X軸移動
ANB @MR410               ; P&P　X軸原点復帰
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
LDB MR21014              ; 給材P&P原点復帰開始
ANB MR21015              ; 給材P&P起動中
ORL
OUT MR41102              ; 給材P&P停止可
;**** P&P給材 Y軸操作 / P&P給材 Y軸 Operation ****
LD CR2002                ; 常時ON
OUT R43600               ; 位置決めﾕﾆｯﾄ2動作許可
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R46513               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
LD R4001                 ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
OR CR2002                ; 常時ON
ANL
AND MR40300              ; 安全扉閉確認
OUT @MR110               ; P&P給材Y軸動作可能
LD @MR110                ; P&P給材Y軸動作可能
MPS
LD R60805                ; P&P Y軸JOG+SW
ANB R60804               ; P&P Y軸JOG-SW
ANL
OUT R46100               ; P&P Y軸JOG-
MPP
LD R60804                ; P&P Y軸JOG-SW
ANB R60805               ; P&P Y軸JOG+SW
ANL
OUT R46101
LDP R61100               ; P&P給材　Y軸位置取込可SW
ANB R81100               ; P&P給材　Y軸位置取込可能PL
LDPB R61100              ; P&P給材　Y軸位置取込可SW
AND R81100               ; P&P給材　Y軸位置取込可能PL
ORL
AND= DM308 #36           ; 画面No.通知
OUT R81100               ; P&P給材　Y軸位置取込可能PL
LDP R61101               ; P&P給材　Y軸書込み可SW
ANB R81101               ; P&P給材　Y軸書込み可能
LDPB R61101              ; P&P給材　Y軸書込み可SW
AND R81101               ; P&P給材　Y軸書込み可能
ORL
AND= DM308 #36           ; 画面No.通知
OUT R81101               ; P&P給材　Y軸書込み可能
LDP R60802               ; P&P給材　Y軸ｻｰﾎﾞOFF SW
ANB R80805               ; P&P給材　Y軸ｻｰﾎﾞOFF
LDPB R60802              ; P&P給材　Y軸ｻｰﾎﾞOFF SW
AND R80805               ; P&P給材　Y軸ｻｰﾎﾞOFF
ORL
AND= DM308 #35           ; 画面No.通知
OUT R80805               ; P&P給材　Y軸ｻｰﾎﾞOFF
LD R81100                ; P&P給材　Y軸位置取込可能PL
MPS
AND R61010               ; P&P　Y軸待機位置選択SW
@MOV.L DM11990 DM1200    ; P&P　Y軸現在位置座標  P&P　Y軸待機位置座標設定
MRD
AND R61011               ; P&P　Y軸供給位置選択SW
@MOV.L DM11990 DM1202    ; P&P　Y軸現在位置座標  P&P　Y軸供給位置座標設定
MRD
AND R61012               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
@MOV.L DM11990 DM1204    ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値
MRD
AND R61013               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3位置選択
@MOV.L DM11990 DM1206    ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値
MPP
AND R61014               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
@MOV.L DM11990 DM1208    ; P&P　Y軸現在位置座標  PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値
LDP R60803               ; P&PY軸JOG高速度選択SW
ANB R80803               ; P&PY軸JOG高速度選択PL
LDPB R60803              ; P&PY軸JOG高速度選択SW
AND R80803               ; P&PY軸JOG高速度選択PL
ORL
AND= DM308 #35           ; 画面No.通知
OUT R80803               ; P&PY軸JOG高速度選択PL
LD= DM308 #35            ; 画面No.通知
AND R80803               ; P&PY軸JOG高速度選択PL
OUT R46102               ; P&P　Y軸JOG高速度選択
LDP R80803               ; P&PY軸JOG高速度選択PL
LDP R60815               ; P&P Y軸JOG速度設定通知
AND R80803               ; P&PY軸JOG高速度選択PL
ORL
UWRIT.L #4 #14168 DM1240 #1
LDF R80803               ; P&PY軸JOG高速度選択PL
LD= DM308 #35            ; 画面No.通知
MEP
ORL
LDP R60815               ; P&P Y軸JOG速度設定通知
ANB R80803               ; P&PY軸JOG高速度選択PL
ORL
UWRIT.L #4 #14168 DM1242 #1
LD= DM308 #36            ; 画面No.通知
MEP
ORP R61114               ; P&P　Y軸座標 速度設定通知
ORP T202                 ; RB動作中遅延
LDB R61010               ; P&P　Y軸待機位置選択SW
ANB R61011               ; P&P　Y軸供給位置選択SW
ANB R61012               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
INV
MEF
ORL
LDB R61013               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3位置選択
ANB R61014               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
INV
MEF
ORL
UWRIT.L #4 #18016 DM1200 #1;P&P　Y軸待機位置座標設定
UWRIT.L #4 #18528 DM1202 #1;P&P　Y軸供給位置座標設定
UWRIT.L #4 #19040 DM1204 #1;PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1座標値
UWRIT.L #4 #19552 DM1206 #1;PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3座標値
UWRIT.L #4 #20064 DM1208 #1;PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22座標値
UWRIT.L #4 #22624 +0 #1
LD= DM308 #47            ; 画面No.通知
MEP
ORP R61114               ; P&P　Y軸座標 速度設定通知
ORP T202                 ; RB動作中遅延
LDB R61010               ; P&P　Y軸待機位置選択SW
ANB R61011               ; P&P　Y軸供給位置選択SW
ANB R61012               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
INV
MEF
ORL
LDB R61013               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP3位置選択
ANB R61014               ; PZTP&PY軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
INV
MEF
ORL
UWRIT.L #4 #18028 DM1220 #1
UWRIT.L #4 #18540 DM1222 #1
UWRIT.L #4 #19052 DM1224 #1
UWRIT.L #4 #19564 DM1226 #1
UWRIT.L #4 #20076 DM1228 #1
UWRIT.L #4 #22636 DM1220 #1
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R46513               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
AND R1108                ; P&P　Y軸原点復帰完了
ANB @MR301               ; P&P　Y軸手動待機位置移動
ANB @MR302               ; P&P　Y軸手動供給位置移動
ANB @MR303               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR304               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR305               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR307               ; P&P　Y軸手動原点位置移動
ANB @MR310               ; P&P　Y軸移動
ANB @MR210               ; P&P　Y軸原点復帰
AND MR40300              ; 安全扉閉確認
OUT @MR300               ; P&P　Y軸動作可能
LDP R61000               ; P&P　Y軸手動待機位置移動SW
ORP R60700               ; P&P　XY軸手動待機位置移動SW
AND @MR300               ; P&P　Y軸動作可能
OR @MR301                ; P&P　Y軸手動待機位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR301               ; P&P　Y軸手動待機位置移動
@MOV #1 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R61001               ; P&P　Y軸手動供給位置移動SW
ORP R60702               ; P&P　XY軸手動供給位置移動SW
ANB R8114                ; 転写SRB1位置決め干渉領域
AND @MR300               ; P&P　Y軸動作可能
OR @MR302                ; P&P　Y軸手動供給位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR302               ; P&P　Y軸手動供給位置移動
@MOV #2 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R61002               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動SW
AND @MR300               ; P&P　Y軸動作可能
OR @MR303                ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR303               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
@MOV #3 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R61003               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動SW
AND @MR300               ; P&P　Y軸動作可能
OR @MR304                ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR304               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
@MOV #4 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R61004               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動SW
AND @MR300               ; P&P　Y軸動作可能
OR @MR305                ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR305               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
@MOV #5 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R60701               ; P&P　XY軸手動原点位置移動SW
AND @MR300               ; P&P　Y軸動作可能
OR @MR307                ; P&P　Y軸手動原点位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR307               ; P&P　Y軸手動原点位置移動
@MOV #10 DM1245          ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDP R60704               ; P&P　XY軸手動ﾄﾚｲ位置移動SW
AND @MR300               ; P&P　Y軸動作可能
AND @MR500               ; P&P　X軸動作可能
OR @MR308                ; P&P　XY軸手動ﾄﾚｲ位置移動
ANB @MR310               ; P&P　Y軸移動
OUT @MR308               ; P&P　XY軸手動ﾄﾚｲ位置移動
UWRIT.L #4 #27744 DM1334 #1;P&P Y軸ﾎﾟｲﾝﾄ座標計算結果
UWRIT.L #4 #27756 DM1224 #1
@MOV #20 DM1245          ; P&P　Y軸ﾎﾟｲﾝﾄNo.
LDB @MR301               ; P&P　Y軸手動待機位置移動
ANB @MR302               ; P&P　Y軸手動供給位置移動
ANB @MR303               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR304               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR305               ; P&P　Y軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR307               ; P&P　Y軸手動原点位置移動
ANB @MR308               ; P&P　XY軸手動ﾄﾚｲ位置移動
ANB @MR607               ; P&P　Y軸待機位置移動
ANB @MR807
ANB @MR903               ; PZTﾄﾚｲT2Z軸供給高さ移動
ANB @MR912               ; 給材P&P待機位置移動
INV
OUT @MR309               ; P&P　Y軸移動指示集合
LD @MR309                ; P&P　Y軸移動指示集合
ANB @MR310               ; P&P　Y軸移動
OR @MR310                ; P&P　Y軸移動
ANB MR9010               ; P&P　Y軸位置決めｴﾗｰ
ANB MR9011               ; P&P　Y軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
ANB @MR315               ; P&P　Y軸移動完了
OUT @MR310               ; P&P　Y軸移動
TMH @11 #5               ; P&P　Y軸移動ﾃﾞｨﾚｰ
LDP @T11                 ; P&P　Y軸移動ﾃﾞｨﾚｰ
@RES @MR314              ; P&P　Y軸移動中
SET @MR311               ; P&P　Y軸開始ﾎﾟｲﾝﾄ指示
STG @MR311               ; P&P　Y軸開始ﾎﾟｲﾝﾄ指示
@U_WRPPNT #4 #1 DM1245   ; P&P　Y軸ﾎﾟｲﾝﾄNo.
MPS
TMH @12 #5               ; P&P　Y軸起動指令ﾃﾞｨﾚｰ
MPP
AND @T12                 ; P&P　Y軸起動指令ﾃﾞｨﾚｰ
JMP @MR312               ; P&P　Y軸起動指令
STG @MR312               ; P&P　Y軸起動指令
MPS
OUT R42000               ; P&P　Y軸位置決め制御開始
MPP
AND R42800               ; P&P　Y軸位置決め制御開始完了
JMP @MR313               ; P&P　Y軸移動確認
STG @MR313               ; P&P　Y軸移動確認
ANB R42802
JMP @MR314               ; P&P　Y軸移動中
STG @MR314               ; P&P　Y軸移動中
AND R42802
JMP @MR315               ; P&P　Y軸移動完了
STG @MR315               ; P&P　Y軸移動完了
ANB @MR310               ; P&P　Y軸移動
ENDS
LDB @MR310               ; P&P　Y軸移動
ZRES @MR311 @MR315       ; P&P　Y軸開始ﾎﾟｲﾝﾄ指示  P&P　Y軸移動完了
;**** P&P給材 Y軸操作  軸原点復帰 / P&P給材 Y軸 Operation ****
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R46513               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
ANB R1108                ; P&P　Y軸原点復帰完了
AND MR40300              ; 安全扉閉確認
OUT @MR200               ; P&P　Y軸動作可能
LDB R60806               ; P&P　Y軸原点復帰SW
ANB R61006               ; P&P　Y軸原点復帰SW
ANB @MR604               ; P&P　Y軸原点復帰開始
INV
AND @MR200               ; P&P　Y軸動作可能
ANB @MR210               ; P&P　Y軸原点復帰
OR @MR210                ; P&P　Y軸原点復帰
ANB @MR205               ; P&P　Y軸原点復帰完了
AND CR2002               ; 常時ON
OUT @MR210               ; P&P　Y軸原点復帰
TMH @10 #5               ; P&P　Y軸原点復帰ﾃﾞｨﾚｰ
LDP @T10                 ; P&P　Y軸原点復帰ﾃﾞｨﾚｰ
@SET @MR201              ; P&P　Y軸原点復帰開始
STG @MR201               ; P&P　Y軸原点復帰開始
SET MR2109               ; P&P　Y軸原点復帰HOME補助
CON
ANB R1108                ; P&P　Y軸原点復帰完了
JMP @MR202               ; P&P　Y軸原点復帰完了待ち
STG @MR202               ; P&P　Y軸原点復帰完了待ち
AND R1108                ; P&P　Y軸原点復帰完了
RES MR2109               ; P&P　Y軸原点復帰HOME補助
CON
JMP @MR203               ; P&P　Y軸目標座標変更
STG @MR203               ; P&P　Y軸目標座標変更
U_WRCPOS.L #4 #1 +0
SET R42004               ; P&P　Y軸現在座標変更要求
JMP @MR204               ; P&P　Y軸目標座標変更完了待ち
STG @MR204               ; P&P　Y軸目標座標変更完了待ち
AND R42804               ; P&P　Y軸現在座標変更完了
RES R42004               ; P&P　Y軸現在座標変更要求
CON
JMP @MR205               ; P&P　Y軸原点復帰完了
STG @MR205               ; P&P　Y軸原点復帰完了
ANB @MR210               ; P&P　Y軸原点復帰
ENDS
;**** P&P給材 X軸ﾗﾝﾌﾟ / P&P給材 X Axis LAMP ****
LD=.L DM12050 DM1250     ; P&P　X軸現在位置座標  P&P　X軸待機位置座標設定
AND R1109                ; P&P　X軸原点復帰完了
OUT R81200               ; P&P　X軸待機位置PL
LD=.L DM12050 DM1252     ; P&P　X軸現在位置座標  P&P　X軸供給位置座標設定
AND R1109                ; P&P　X軸原点復帰完了
OUT R81201               ; P&P　X軸供給位置PL
LD=.L DM12050 DM1254     ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値
AND R1109                ; P&P　X軸原点復帰完了
OUT R81202               ; P&P　X軸ﾊﾟﾚﾀｲｽﾞP1位置PL
LD=.L DM12050 DM1256     ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値
AND R1109                ; P&P　X軸原点復帰完了
OUT R81203               ; P&P　X軸ﾊﾟﾚﾀｲｽﾞP3位置PL
LD=.L DM12050 DM1258     ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値
AND R1109                ; P&P　X軸原点復帰完了
OUT R81204               ; P&P　X軸ﾊﾟﾚﾀｲｽﾞP22位置PL
LD R47313                ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
OUT R80902               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰPL
LD R1109                 ; P&P　X軸原点復帰完了
OUT R81206               ; P&P　X軸原点復帰完了PL
OUT R80906               ; P&P　X軸原点復帰完了PL
;**** P&P給材 X軸操作 / P&P給材 X軸 Operation ****
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R47313               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
LD R4001                 ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
OR CR2002                ; 常時ON
ANL
AND MR40300              ; 安全扉閉確認
OUT @MR112               ; P&P給材X軸動作可能
LD @MR112                ; P&P給材X軸動作可能
MPS
LD R60905                ; P&P X軸JOG+SW
ANB R60904               ; P&P X軸JOG-SW
ANL
OUT R46900               ; P&P X軸JOG+
MPP
LD R60904                ; P&P X軸JOG-SW
ANB R60905               ; P&P X軸JOG+SW
ANL
OUT R46901               ; P&P Y軸JOG-
LDP R61300               ; P&P給材　X軸位置取込可SW
ANB R81300               ; P&P給材　X軸位置取込可能PL
LDPB R61300              ; P&P給材　X軸位置取込可SW
AND R81300               ; P&P給材　X軸位置取込可能PL
ORL
AND= DM308 #37           ; 画面No.通知
OUT R81300               ; P&P給材　X軸位置取込可能PL
LDP R61301               ; P&P給材　X軸書込み可SW
ANB R81301               ; P&P給材　X軸書込み可能
LDPB R61301              ; P&P給材　X軸書込み可SW
AND R81301               ; P&P給材　X軸書込み可能
ORL
AND= DM308 #37           ; 画面No.通知
OUT R81301               ; P&P給材　X軸書込み可能
LDP R60902               ; P&P給材　X軸ｻｰﾎﾞOFF SW
ANB R80905               ; P&P給材　X軸ｻｰﾎﾞOFF
LDPB R60902              ; P&P給材　X軸ｻｰﾎﾞOFF SW
AND R80905               ; P&P給材　X軸ｻｰﾎﾞOFF
ORL
AND= DM308 #35           ; 画面No.通知
OUT R80905               ; P&P給材　X軸ｻｰﾎﾞOFF
LD R81300                ; P&P給材　X軸位置取込可能PL
MPS
AND R61210               ; P&P　X軸待機位置選択SW
@MOV.L DM12050 DM1250    ; P&P　X軸現在位置座標  P&P　X軸待機位置座標設定
MRD
AND R61211               ; P&P　X軸供給位置選択SW
@MOV.L DM12050 DM1252    ; P&P　X軸現在位置座標  P&P　X軸供給位置座標設定
MRD
AND R61212               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
@MOV.L DM12050 DM1254    ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値
MRD
AND R61213               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3位置選択SW
@MOV.L DM12050 DM1256    ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値
MPP
AND R61214               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
@MOV.L DM12050 DM1258    ; P&P　X軸現在位置座標  PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値
LDP R60903               ; P&PX軸JOG高速度選択SW
ANB R80903               ; P&PX軸JOG高速度選択PL
LDPB R60903              ; P&PX軸JOG高速度選択SW
AND R80903               ; P&PX軸JOG高速度選択PL
ORL
AND= DM308 #35           ; 画面No.通知
OUT R80903               ; P&PX軸JOG高速度選択PL
LD= DM308 #35            ; 画面No.通知
AND R80903               ; P&PX軸JOG高速度選択PL
OUT R46902               ; P&P　X軸JOG高速度選択
LDP R80903               ; P&PX軸JOG高速度選択PL
LDP R60915               ; P&P X軸JOG速度設定通知
AND R80903               ; P&PX軸JOG高速度選択PL
ORL
UWRIT.L #4 #14218 DM1290 #1
LDF R80903               ; P&PX軸JOG高速度選択PL
LD= DM308 #35            ; 画面No.通知
MEP
ORL
LDP R60915               ; P&P X軸JOG速度設定通知
ANB R80903               ; P&PX軸JOG高速度選択PL
ORL
UWRIT.L #4 #14218 DM1292 #1
LD= DM308 #37            ; 画面No.通知
MEP
ORP R61314               ; P&P　X軸座標 速度設定通知
ORP T202                 ; RB動作中遅延
LDB R61210               ; P&P　X軸待機位置選択SW
ANB R61211               ; P&P　X軸供給位置選択SW
ANB R61212               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
INV
MEF
ORL
LDB R61213               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3位置選択SW
ANB R61214               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
INV
MEF
ORL
UWRIT.L #4 #18048 DM1250 #1;P&P　X軸待機位置座標設定
UWRIT.L #4 #18560 DM1252 #1;P&P　X軸供給位置座標設定
UWRIT.L #4 #19072 DM1254 #1;PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1座標値
UWRIT.L #4 #19584 DM1256 #1;PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3座標値
UWRIT.L #4 #20096 DM1258 #1;PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22座標値
UWRIT.L #4 #22656 +0 #1
LD= DM308 #37            ; 画面No.通知
MEP
ORP R61314               ; P&P　X軸座標 速度設定通知
ORP T202                 ; RB動作中遅延
LDB R61210               ; P&P　X軸待機位置選択SW
ANB R61211               ; P&P　X軸供給位置選択SW
ANB R61212               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP1位置選択SW
INV
MEF
ORL
LDB R61213               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP3位置選択SW
ANB R61214               ; PZTP&PX軸ﾊﾟﾚﾀｲｽﾞP22位置選択SW
INV
MEF
ORL
UWRIT.L #4 #18060 DM1270 #1
UWRIT.L #4 #18572 DM1272 #1
UWRIT.L #4 #19084 DM1274 #1
UWRIT.L #4 #19596 DM1276 #1
UWRIT.L #4 #20108 DM1278 #1
UWRIT.L #4 #22668 DM1270 #1
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R47313               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
AND R1109                ; P&P　X軸原点復帰完了
ANB @MR501               ; P&P　X軸手動待機位置移動
ANB @MR502               ; P&P　X軸手動供給位置移動
ANB @MR503               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR504               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR505               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR507               ; P&P　X軸手動原点位置移動
ANB @MR510               ; P&P　X軸移動
AND MR40300              ; 安全扉閉確認
OUT @MR500               ; P&P　X軸動作可能
LDP R61200               ; P&P　XY軸手動待機位置移動SW
ORP R60700               ; P&P　XY軸手動待機位置移動SW
AND @MR500               ; P&P　X軸動作可能
OR @MR501                ; P&P　X軸手動待機位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR501               ; P&P　X軸手動待機位置移動
@MOV #1 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R61201               ; P&P　X軸手動供給位置移動SW
ORP R60702               ; P&P　XY軸手動供給位置移動SW
ANB R8114                ; 転写SRB1位置決め干渉領域
AND @MR500               ; P&P　X軸動作可能
OR @MR502                ; P&P　X軸手動供給位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR502               ; P&P　X軸手動供給位置移動
@MOV #2 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R61202               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動SW
AND @MR500               ; P&P　X軸動作可能
OR @MR503                ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR503               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
@MOV #3 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R61203               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動SW
AND @MR500               ; P&P　X軸動作可能
OR @MR504                ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR504               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
@MOV #4 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R61204               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動SW
AND @MR500               ; P&P　X軸動作可能
OR @MR505                ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR505               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
@MOV #5 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R60701               ; P&P　XY軸手動原点位置移動SW
AND @MR500               ; P&P　X軸動作可能
OR @MR507                ; P&P　X軸手動原点位置移動
ANB @MR510               ; P&P　X軸移動
ANB MR21013              ; 給材P&P起動OFF
OUT @MR507               ; P&P　X軸手動原点位置移動
@MOV #10 DM1295          ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDP R60704               ; P&P　XY軸手動ﾄﾚｲ位置移動SW
AND @MR300               ; P&P　Y軸動作可能
AND @MR500               ; P&P　X軸動作可能
OR @MR508                ; P&P　XY軸手動ﾄﾚｲ位置移動
ANB MR21013              ; 給材P&P起動OFF
ANB @MR510               ; P&P　X軸移動
OUT @MR508               ; P&P　XY軸手動ﾄﾚｲ位置移動
UWRIT.L #4 #27776 DM1332 #1;P&P X軸ﾎﾟｲﾝﾄ座標計算結果
UWRIT.L #4 #27788 DM1274 #1
@MOV #20 DM1295          ; P&P　X軸ﾎﾟｲﾝﾄNo.
LDB @MR501               ; P&P　X軸手動待機位置移動
ANB @MR502               ; P&P　X軸手動供給位置移動
ANB @MR503               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ1位置移動
ANB @MR504               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ2位置移動
ANB @MR505               ; P&P　X軸手動ﾊﾟﾚﾀｲｽﾞ3位置移動
ANB @MR507               ; P&P　X軸手動原点位置移動
ANB @MR508               ; P&P　XY軸手動ﾄﾚｲ位置移動
ANB @MR707               ; P&P　X軸待機位置移動
ANB @MR807
ANB @MR903               ; PZTﾄﾚｲT2Z軸供給高さ移動
ANB @MR912               ; 給材P&P待機位置移動
INV
OUT @MR509               ; P&P　X軸移動指示集合
LD @MR509                ; P&P　X軸移動指示集合
ANB @MR510               ; P&P　X軸移動
OR @MR510                ; P&P　X軸移動
ANB MR9012               ; P&P　X軸位置決めｴﾗｰ
ANB MR9013               ; P&P　X軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
ANB @MR515               ; P&P　X軸移動終了
ANB MR21013              ; 給材P&P起動OFF
OUT @MR510               ; P&P　X軸移動
TMH @16 #5               ; P&P　X軸移動開始ﾃﾞｨﾚｰ
LDP @T16                 ; P&P　X軸移動開始ﾃﾞｨﾚｰ
SET @MR511               ; P&P　X軸開始ﾎﾟｲﾝﾄ指示
STG @MR511               ; P&P　X軸開始ﾎﾟｲﾝﾄ指示
@U_WRPPNT #4 #2 DM1295   ; P&P　X軸ﾎﾟｲﾝﾄNo.
MPS
TMH @17 #5               ; P&P　X軸起動指令ﾃﾞｨﾚｰ
MPP
AND @T17                 ; P&P　X軸起動指令ﾃﾞｨﾚｰ
JMP @MR512               ; P&P　X軸起動指令
STG @MR512               ; P&P　X軸起動指令
MPS
OUT R42008               ; P&P　X軸位置決め制御開始
MPP
AND R42808               ; P&P　X軸位置決め制御開始完了
JMP @MR513               ; P&P　X軸移動確認
STG @MR513               ; P&P　X軸移動確認
ANB R42810               ; P&P　X軸位置決め完了
JMP @MR514               ; P&P　X軸移動完了
STG @MR514               ; P&P　X軸移動完了
AND R42810               ; P&P　X軸位置決め完了
JMP @MR515               ; P&P　X軸移動終了
STG @MR515               ; P&P　X軸移動終了
ANB @MR510               ; P&P　X軸移動
ENDS
LDB @MR510               ; P&P　X軸移動
ZRES @MR511 @MR515       ; P&P　X軸開始ﾎﾟｲﾝﾄ指示  P&P　X軸移動終了
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R47313               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
ANB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
ANB R1109                ; P&P　X軸原点復帰完了
AND MR40300              ; 安全扉閉確認
OUT @MR400               ; P&P　X軸動作可能
LDB R60906               ; P&P　X軸原点復帰SW
ANB R61206               ; P&P　X軸原点復帰SW
ANB @MR704               ; P&P　X軸原点復帰開始
INV
AND @MR400               ; P&P　X軸動作可能
ANB @MR410               ; P&P　X軸原点復帰
OR @MR410                ; P&P　X軸原点復帰
ANB @MR405               ; P&P　X軸原点復帰完了
ANB MR21013              ; 給材P&P起動OFF
OUT @MR410               ; P&P　X軸原点復帰
TMH @15 #5               ; P&P　X軸原点復帰開始ﾃﾞｨﾚｰ
LDP @T15                 ; P&P　X軸原点復帰開始ﾃﾞｨﾚｰ
@SET @MR401              ; P&P　X軸原点復帰開始
STG @MR401               ; P&P　X軸原点復帰開始
SET MR2111               ; P&P　X軸原点復帰HOME補助
CON
ANB R1109                ; P&P　X軸原点復帰完了
JMP @MR402               ; P&P　X軸原点復帰完了待ち
STG @MR402               ; P&P　X軸原点復帰完了待ち
AND R1109                ; P&P　X軸原点復帰完了
RES MR2111               ; P&P　X軸原点復帰HOME補助
CON
JMP @MR403               ; P&P　X軸目標座標変更
STG @MR403               ; P&P　X軸目標座標変更
U_WRCPOS.L #4 #2 +0
SET R42012               ; P&P　X軸現在座標変更要求
JMP @MR404               ; P&P　X軸目標座標変更完了待ち
STG @MR404               ; P&P　X軸目標座標変更完了待ち
AND R42812               ; P&P　X軸現在座標変更完了
RES R42012               ; P&P　X軸現在座標変更要求
CON
JMP @MR405               ; P&P　X軸原点復帰完了
STG @MR405               ; P&P　X軸原点復帰完了
ANB @MR410               ; P&P　X軸原点復帰
ENDS
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R46513               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R47313               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
OUT @MR600               ; Ｐ＆Ｐ原点復帰可
OUT MR21009              ; 給材P&P原点復帰可
LD MR40101               ; 各ﾕﾆｯﾄ原点復帰開始
ORP R60615               ; 手動給材P&P原点復帰SW
AND @MR600               ; Ｐ＆Ｐ原点復帰可
ANB MR21014              ; 給材P&P原点復帰開始
OR MR21014               ; 給材P&P原点復帰開始
ANB MR21013              ; 給材P&P起動OFF
ANB @MR610               ; P&P　Y軸原点復帰完了
OUT MR21014              ; 給材P&P原点復帰開始
OUT R80615               ; 給材P&P原点復帰PL
TMH @20 #5               ; Ｐ＆Ｐ原点復帰ﾃﾞｨﾚｰ
LDP @T20                 ; Ｐ＆Ｐ原点復帰ﾃﾞｨﾚｰ
SET @MR601
STG @MR601
ANB MR40101              ; 各ﾕﾆｯﾄ原点復帰開始
JMP @MR602               ; P&P給材ﾍｯﾄﾞ上昇
STG @MR602               ; P&P給材ﾍｯﾄﾞ上昇
RES MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
CON
AND @T1                  ; P&P給材ﾍｯﾄﾞ上昇端
JMP @MR603               ; P&P　Y軸原点条件確認
STG @MR603               ; P&P　Y軸原点条件確認
MPS
AND R1108                ; P&P　Y軸原点復帰完了
JMP @MR606               ; P&P　Y軸待機位置ﾃﾞｰﾀｾｯﾄ
MPP
ANB R1108                ; P&P　Y軸原点復帰完了
JMP @MR604               ; P&P　Y軸原点復帰開始
STG @MR604               ; P&P　Y軸原点復帰開始
AND @MR210               ; P&P　Y軸原点復帰
JMP @MR605               ; P&P　Y軸原点復帰完了待ち
STG @MR605               ; P&P　Y軸原点復帰完了待ち
ANB @MR210               ; P&P　Y軸原点復帰
AND=.L DM11990 +0        ; P&P　Y軸現在位置座標
AND R1108                ; P&P　Y軸原点復帰完了
JMP @MR606               ; P&P　Y軸待機位置ﾃﾞｰﾀｾｯﾄ
STG @MR606               ; P&P　Y軸待機位置ﾃﾞｰﾀｾｯﾄ
@MOV #1 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
JMP @MR607               ; P&P　Y軸待機位置移動
STG @MR607               ; P&P　Y軸待機位置移動
AND @MR310               ; P&P　Y軸移動
JMP @MR608               ; P&P　Y軸待機位置移動完了待ち
STG @MR608               ; P&P　Y軸待機位置移動完了待ち
ANB @MR310               ; P&P　Y軸移動
AND R81000               ; P&P　Y軸待機位置PL
RES MR21002              ; 位置決め供給位置侵入中
CON
JMP @MR609               ; P&P　X軸待機位置移動完了待ち
STG @MR609               ; P&P　X軸待機位置移動完了待ち
AND R81200               ; P&P　X軸待機位置PL
JMP @MR610               ; P&P　Y軸原点復帰完了
STG @MR610               ; P&P　Y軸原点復帰完了
LD MR21300               ; 給材P&P原点復帰完了
ORB MR40014              ; 全原点復帰中
ANL
ANB MR21014              ; 給材P&P原点復帰開始
ENDS
LD @MR610                ; P&P　Y軸原点復帰完了
OR MR21300               ; 給材P&P原点復帰完了
ANB MR40102              ; 各原点復帰完了FLGOFF
AND MR40014              ; 全原点復帰中
OUT MR21300              ; 給材P&P原点復帰完了
LDP @T20                 ; Ｐ＆Ｐ原点復帰ﾃﾞｨﾚｰ
SET @MR701               ; Ｐ＆Ｐ原点復帰開始
STG @MR701               ; Ｐ＆Ｐ原点復帰開始
JMP @MR702               ; P&P給材ﾍｯﾄﾞ上昇端確認
STG @MR702               ; P&P給材ﾍｯﾄﾞ上昇端確認
AND @T1                  ; P&P給材ﾍｯﾄﾞ上昇端
JMP @MR703               ; P&P　X軸原点条件確認
STG @MR703               ; P&P　X軸原点条件確認
MPS
AND R1109                ; P&P　X軸原点復帰完了
JMP @MR706               ; P&P　X軸待機位置ﾃﾞｰﾀｾｯﾄ
MPP
ANB R1109                ; P&P　X軸原点復帰完了
JMP @MR704               ; P&P　X軸原点復帰開始
STG @MR704               ; P&P　X軸原点復帰開始
AND @MR410               ; P&P　X軸原点復帰
JMP @MR705               ; P&P　X軸原点復帰完了待ち
STG @MR705               ; P&P　X軸原点復帰完了待ち
ANB @MR410               ; P&P　X軸原点復帰
AND=.L DM12050 +0        ; P&P　X軸現在位置座標
AND R1109                ; P&P　X軸原点復帰完了
JMP @MR706               ; P&P　X軸待機位置ﾃﾞｰﾀｾｯﾄ
STG @MR706               ; P&P　X軸待機位置ﾃﾞｰﾀｾｯﾄ
@MOV #1 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
JMP @MR707               ; P&P　X軸待機位置移動
STG @MR707               ; P&P　X軸待機位置移動
AND @MR510               ; P&P　X軸移動
JMP @MR708               ; P&P　X軸待機位置移動完了待ち
STG @MR708               ; P&P　X軸待機位置移動完了待ち
ANB @MR510               ; P&P　X軸移動
AND R81200               ; P&P　X軸待機位置PL
RES MR21001              ; 給材P&P位置決め位置供給中
CON
RES MR21002              ; 位置決め供給位置侵入中
CON
JMP @MR709               ; P&P　X軸原点復帰完了
STG @MR709               ; P&P　X軸原点復帰完了
ENDS
LDB MR21014              ; 給材P&P原点復帰開始
ZRES @MR601 @MR715
;**** PZT給材　自動運転 / PZT給材　自動運転 ****
LD CR2002                ; 常時ON
LDP R4802                ; ｽｷｰｼﾞ確認SW
OR T95                   ; ｽｷｰｼﾞ確認SWﾃﾞｨﾚｰ
ANL
AND MR40610              ; STEP前半選択
ANB MR40112              ; 自動ﾓｰﾄﾞ
LD MR40112               ; 自動ﾓｰﾄﾞ
AND LR40000              ; 通常ﾓｰﾄﾞ選択
ORL
OUT MR21005              ; STEPﾊﾟﾙｽ
LD R44800                ; 位置決めﾕﾆｯﾄ2動作可能
AND R46513               ; P&P　Y軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R47313               ; P&P　X軸ｻｰﾎﾞﾚﾃﾞｨｰ
AND R1108                ; P&P　Y軸原点復帰完了
AND R1109                ; P&P　X軸原点復帰完了
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
OUT MR21010              ; 給材P&P全原点
LDB MR21901              ; 給材P&P部ｼﾘﾝﾀﾞｰ異常
ANB MR21902              ; P&P給材ﾛﾎﾞｯﾄ異常
ANB CR2003               ; 常時OFF
ANB CR2003               ; 常時OFF
INV
OUT MR21011              ; 給材P&P全異常
LD MR40015               ; 主幹自動起動中
LD MR40105               ; ｻｲｸﾙ停止動作中
AND MR2509               ; 電磁MG吸着ﾘﾚｰ
AND MR22000              ; 位置決め徐塵供給要求
ORL
OR MR40610               ; STEP前半選択
AND MR21010              ; 給材P&P全原点
ANB MR21011              ; 給材P&P全異常
ANB MR21014              ; 給材P&P原点復帰開始
ANB MR21015              ; 給材P&P起動中
LDB MR40902              ; PZT投入数一致受付
OR MR2509                ; 電磁MG吸着ﾘﾚｰ
ANL
ANB MR40105              ; ｻｲｸﾙ停止動作中
OUT MR21012              ; 給材P&P起動条件
LD MR21011               ; 給材P&P全異常
OR MR40910               ; 主幹異常一括
OUT MR21013              ; 給材P&P起動OFF
LD< DM7000 #1            ; CAV装置CAV残数
AND<= DM7001 DM7002      ; CAV搬送部CAV残数  PZT投入数
OUT MR21102              ; CAV残数小
LD MR21005               ; STEPﾊﾟﾙｽ
AND MR21012              ; 給材P&P起動条件
OR MR21015               ; 給材P&P起動中
ANB MR21013              ; 給材P&P起動OFF
LD MR40112               ; 自動ﾓｰﾄﾞ
OR MR40610               ; STEP前半選択
ANL
ANB @MR915               ; 自動STEP終了
OUT MR21015              ; 給材P&P起動中
TMH @21 #5               ; 給材P&P自動起動ﾃﾞｨﾚｰ
LDP @T21                 ; 給材P&P自動起動ﾃﾞｨﾚｰ
SET @MR801
STG @MR801
JMP @MR802               ; 電磁MG吸着確認
STG @MR802               ; 電磁MG吸着確認
MPS
LD MR2509                ; 電磁MG吸着ﾘﾚｰ
ORB MR21100              ; P&P給材ﾍｯﾄﾞ動作1回FLG
ANL
JMP @MR900               ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
MPP
LDB MR2509               ; 電磁MG吸着ﾘﾚｰ
AND MR21100              ; P&P給材ﾍｯﾄﾞ動作1回FLG
ANL
JMP @MR813               ; PZT連続無しｶｳﾝﾄ比較
;**** PZT給材　ﾄﾚｲ取出し動作 / PZTﾄﾚｲ　ﾄﾚｲ取出し動作 ****
LD CR2002                ; 常時ON
LDA DM104                ; PZT CAV連続無しｶｳﾝﾄ設定
CON
SUB #1
CON
STA DM1510               ; PZT 連続無しｶｳﾝﾄ設定+1
STG @MR813               ; PZT連続無しｶｳﾝﾄ比較
MPS
AND< DM1500 DM1510       ; PZT連続無しｶｳﾝﾄ  PZT 連続無しｶｳﾝﾄ設定+1
JMP @MR805               ; PZTﾄﾚｲより取出し要求待ち
MPP
AND>= DM1500 DM1510      ; PZT連続無しｶｳﾝﾄ  PZT 連続無しｶｳﾝﾄ設定+1
JMP @MR814               ; PZT 連続無しｶｳﾝﾄ異常
STG @MR814               ; PZT 連続無しｶｳﾝﾄ異常
MPS
AND MR21401              ; PZTトレイ続行SW
@MOV #0 DM1500           ; PZT連続無しｶｳﾝﾄ
JMP @MR805               ; PZTﾄﾚｲより取出し要求待ち
MRD
AND MR21402              ; PZTトレイ交換SW
@MOV #24 DM1100          ; 供給P&P取出しｶｳﾝﾄ値
MPS
@MOV #0 DM1500           ; PZT連続無しｶｳﾝﾄ
MPP
ANB MR20000              ; 供給P&Pへ取出し要求
JMP @MR805               ; PZTﾄﾚｲより取出し要求待ち
MPP
LDB MR40015              ; 主幹自動起動中
ANB MR40610              ; STEP前半選択
ANL
TMR @22 #3               ; 主幹起動OFF確認
CON
AND @T22                 ; 主幹起動OFF確認
JMP @MR915               ; 自動STEP終了
LD @MR814                ; PZT 連続無しｶｳﾝﾄ異常
OUT MR21415              ; PZT CAV連続無しｶｳﾝﾄ異常
LD MR21403               ; PZT連続無し異常BZ停止SW
OR MR21414               ; PZT CAV連続無しｶｳﾝﾄ異常BZ停止
AND @MR814               ; PZT 連続無しｶｳﾝﾄ異常
OUT MR21414              ; PZT CAV連続無しｶｳﾝﾄ異常BZ停止
STG @MR805               ; PZTﾄﾚｲより取出し要求待ち
MPS
LD MR20000               ; 供給P&Pへ取出し要求
AND< DM1100 #24          ; 供給P&P取出しｶｳﾝﾄ値
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
AND MR21005              ; STEPﾊﾟﾙｽ
ANL
JMP @MR806               ; 供給動作へ
MPP
LDB MR40015              ; 主幹自動起動中
ANB MR40610              ; STEP前半選択
ANL
TMR @23 #3               ; 主幹起動OFF確認
CON
AND @T23                 ; 主幹起動OFF確認
JMP @MR915               ; 自動STEP終了
STG @MR806               ; 供給動作へ
UWRIT.L #4 #27744 DM1334 #1;P&P Y軸ﾎﾟｲﾝﾄ座標計算結果
UWRIT.L #4 #27756 DM1224 #1
@MOV #20 DM1245          ; P&P　Y軸ﾎﾟｲﾝﾄNo.
UWRIT.L #4 #27776 DM1332 #1;P&P X軸ﾎﾟｲﾝﾄ座標計算結果
UWRIT.L #4 #27788 DM1274 #1
@MOV #20 DM1295          ; P&P　X軸ﾎﾟｲﾝﾄNo.
JMP @MR807
STG @MR807
AND @MR310               ; P&P　Y軸移動
AND @MR510               ; P&P　X軸移動
JMP @MR808
STG @MR808
MPS
LDB @MR310               ; P&P　Y軸移動
ANB @MR510               ; P&P　X軸移動
AND R80704               ; P&P　XY軸ﾄﾚｲ位置PL
ANL
RES MR21001              ; 給材P&P位置決め位置供給中
CON
RES MR21002              ; 位置決め供給位置侵入中
CON
AND MR20000              ; 供給P&Pへ取出し要求
ANB MR40105              ; ｻｲｸﾙ停止動作中
ANB MR40902              ; PZT投入数一致受付
LD MR22000               ; 位置決め徐塵供給要求
OR MR23001               ; 転写SRB1取出し中
ANL
JMP @MR809
MPP
LDB MR40015              ; 主幹自動起動中
ANB MR22000              ; 位置決め徐塵供給要求
ANB MR23001              ; 転写SRB1取出し中
ANL
TMR @27 #3
CON
AND @T27
JMP @MR915               ; 自動STEP終了
STG @MR809
SET MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
CON
AND @T0                  ; 供給P&Pﾍｯﾄﾞ下降端
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR810
STG @MR810
ANB MR27105              ; 位置決めSRB2ﾁｬｯｸ開動作中
ANB MR27106              ; 位置決めSRB2ﾁｬｯｸ開動作中
OUT MR21200              ; 給材供給P/P投入ｶｳﾝﾄ中
SET MR2509               ; 電磁MG吸着ﾘﾚｰ
CON
AND @T2                  ; 電磁MG吸着ON確認
AND MR21005              ; STEPﾊﾟﾙｽ
@INC DM7002              ; PZT投入数
JMP @MR811
STG @MR811
RES MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
CON
AND @T1                  ; P&P給材ﾍｯﾄﾞ上昇端
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR812               ; PZTT1X軸搬供給位置ﾃﾞｰﾀｾｯﾄ
STG @MR812               ; PZTT1X軸搬供給位置ﾃﾞｰﾀｾｯﾄ
@INC DM1100              ; 供給P&P取出しｶｳﾝﾄ値
JMP @MR915               ; 自動STEP終了
;**** PZT給材　位置決め徐塵供給動作 / PZTﾄﾚｲ　位置決め徐塵供給動作 ****
STG @MR900               ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
MPS
LD MR22000               ; 位置決め徐塵供給要求
ANB R8114                ; 転写SRB1位置決め干渉領域
ANB MR23002              ; 転写SRB1徐塵部進入中
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
AND MR21005              ; STEPﾊﾟﾙｽ
LDB MR40902              ; PZT投入数一致受付
OR MR2509                ; 電磁MG吸着ﾘﾚｰ
ANL
ANL
JMP @MR901               ; PZTﾄﾚｲT2Z軸供給高さ移動
MPP
LDB MR40015              ; 主幹自動起動中
ANB MR22000              ; 位置決め徐塵供給要求
ANB MR40610              ; STEP前半選択
ANL
TMR @24 #3               ; 主幹起動OFF確認
CON
AND @T24                 ; 主幹起動OFF確認
JMP @MR915               ; 自動STEP終了
STG @MR901               ; PZTﾄﾚｲT2Z軸供給高さ移動
MPS
ANB MR21100              ; P&P給材ﾍｯﾄﾞ動作1回FLG
SET MR21405              ; P&P給材ﾍｯﾄﾞ動作1回記憶
MPP
SET MR2509               ; 電磁MG吸着ﾘﾚｰ
CON
SET MR21002              ; 位置決め供給位置侵入中
CON
JMP @MR902               ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
STG @MR902               ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
@MOV #2 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
@MOV #2 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
JMP @MR903               ; PZTﾄﾚｲT2Z軸供給高さ移動
STG @MR903               ; PZTﾄﾚｲT2Z軸供給高さ移動
AND @MR310               ; P&P　Y軸移動
AND @MR510               ; P&P　X軸移動
JMP @MR904
STG @MR904
ANB @MR310               ; P&P　Y軸移動
ANB @MR510               ; P&P　X軸移動
AND R80702               ; P&P　XY軸供給位置PL
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR905
STG @MR905
AND MR22000              ; 位置決め徐塵供給要求
AND R4003                ; ｱﾗｲﾒﾝﾄX軸後退端
AND R4005                ; ｱﾗｲﾒﾝﾄY軸後退端
AND R4007                ; ｼﾞｬﾏ板後退端
JMP @MR906
STG @MR906
SET MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
CON
AND @T0                  ; 供給P&Pﾍｯﾄﾞ下降端
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR907
STG @MR907
OUT MR21000              ; 位置決めｼﾞｬﾏ板ON要求
MPS
LDB MR22000              ; 位置決め徐塵供給要求
AND R4006                ; ｼﾞｬﾏ板前進端
AND MR21005              ; STEPﾊﾟﾙｽ
ANL
JMP @MR908
MPP
LDB MR40015              ; 主幹自動起動中
ANB MR40610              ; STEP前半選択
AND MR22011              ; 位置決め徐塵全異常
ANL
TMR @26 #10
CON
AND @T26
JMP @MR908
STG @MR908
RES MR2509               ; 電磁MG吸着ﾘﾚｰ
CON
AND @T3                  ; 電磁MG吸着OFF確認
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR909               ; P&P給材ﾍｯﾄﾞ上昇
STG @MR909               ; P&P給材ﾍｯﾄﾞ上昇
RES MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
CON
AND @T1                  ; P&P給材ﾍｯﾄﾞ上昇端
AND MR21100              ; P&P給材ﾍｯﾄﾞ動作1回FLG
AND MR21005              ; STEPﾊﾟﾙｽ
JMP @MR910
LD @MR909                ; P&P給材ﾍｯﾄﾞ上昇
AND @T1                  ; P&P給材ﾍｯﾄﾞ上昇端
ANB MR22200              ; 位置決め動作中
OR MR21100               ; P&P給材ﾍｯﾄﾞ動作1回FLG
LD MR40005               ; 全起動中
OR MR40610               ; STEP前半選択
ANL
OUT MR21100              ; P&P給材ﾍｯﾄﾞ動作1回FLG
STG @MR910
MPS
LD MR40015               ; 主幹自動起動中
OR MR40610               ; STEP前半選択
AND MR20000              ; 供給P&Pへ取出し要求
ANB MR40902              ; PZT投入数一致受付
ANL
JMP @MR915               ; 自動STEP終了
MRD
LDB MR40015              ; 主幹自動起動中
ANB MR40610              ; STEP前半選択
ANL
TMR @25 #3               ; 主幹起動OFF確認
CON
AND @T25                 ; 主幹起動OFF確認
JMP @MR911               ; 給材P&P待機位置ﾃﾞｰﾀｾｯﾄ
MRD
ANB MR20000              ; 供給P&Pへ取出し要求
JMP @MR911               ; 給材P&P待機位置ﾃﾞｰﾀｾｯﾄ
MPP
AND MR40902              ; PZT投入数一致受付
JMP @MR911               ; 給材P&P待機位置ﾃﾞｰﾀｾｯﾄ
STG @MR911               ; 給材P&P待機位置ﾃﾞｰﾀｾｯﾄ
@MOV #1 DM1245           ; P&P　Y軸ﾎﾟｲﾝﾄNo.
@MOV #1 DM1295           ; P&P　X軸ﾎﾟｲﾝﾄNo.
JMP @MR912               ; 給材P&P待機位置移動
STG @MR912               ; 給材P&P待機位置移動
AND @MR310               ; P&P　Y軸移動
AND @MR510               ; P&P　X軸移動
JMP @MR913               ; 給材P&P待機位置移動完了待ち
STG @MR913               ; 給材P&P待機位置移動完了待ち
ANB @MR310               ; P&P　Y軸移動
ANB @MR510               ; P&P　X軸移動
AND R80700               ; P&P　XY軸待機位置PL
RES MR21002              ; 位置決め供給位置侵入中
CON
JMP @MR915               ; 自動STEP終了
STG @MR915               ; 自動STEP終了
ANB MR21015              ; 給材P&P起動中
ENDS
LDB MR21015              ; 給材P&P起動中
ZRES @MR800 @MR915       ; 自動STEP終了
;<h1/> PZT給材P&P　異常処理
LDB MR4000               ; 供給P&Pﾍｯﾄﾞ下降ｾﾝｻｰ異常
ANB MR4001               ; P&P給材ﾍｯﾄﾞ上昇ｾﾝｻｰ異常
INV
OUT MR21901              ; 給材P&P部ｼﾘﾝﾀﾞｰ異常
LDB MR9010               ; P&P　Y軸位置決めｴﾗｰ
ANB MR9011               ; P&P　Y軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
ANB MR9012               ; P&P　X軸位置決めｴﾗｰ
ANB MR9013               ; P&P　X軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
INV
OUT MR21902              ; P&P給材ﾛﾎﾞｯﾄ異常
LD MR40110               ; 自動ﾓｰﾄﾞSW選択
OR MR21014               ; 給材P&P原点復帰開始
OR= DM300 #34            ; 画面表示No.
AND T210                 ; 異常監視開始
OUT MR21915              ; 異常監視
LD R4000                 ; 供給P&Pﾍｯﾄﾞ下降端
AND R4001                ; P&P給材ﾍｯﾄﾞ上昇端
LD R6200                 ; PZT給材ﾍｯﾄﾞ上下SOL
ANB R4000                ; 供給P&Pﾍｯﾄﾞ下降端
ORL
AND MR21915              ; 異常監視
TMR @30 #50              ; 供給P&Pﾍｯﾄﾞ下降ｾﾝｻｰ監視
CON
AND @T30                 ; 供給P&Pﾍｯﾄﾞ下降ｾﾝｻｰ監視
AND MR9915               ; 異常なし
SET MR4000               ; 供給P&Pﾍｯﾄﾞ下降ｾﾝｻｰ異常
LD MR4000                ; 供給P&Pﾍｯﾄﾞ下降ｾﾝｻｰ異常
RES MR6200               ; PZT給材ﾍｯﾄﾞ上下SOL補助
LDB R6200                ; PZT給材ﾍｯﾄﾞ上下SOL
ANB R4001                ; P&P給材ﾍｯﾄﾞ上昇端
AND MR21915              ; 異常監視
TMR @31 #50              ; P&P給材ﾍｯﾄﾞ上昇ｾﾝｻｰ監視
CON
AND @T31                 ; P&P給材ﾍｯﾄﾞ上昇ｾﾝｻｰ監視
AND MR9915               ; 異常なし
SET MR4001               ; P&P給材ﾍｯﾄﾞ上昇ｾﾝｻｰ異常
LD T210                  ; 異常監視開始
AND R46400               ; P&P　Y軸位置決めｴﾗｰ
AND MR9915               ; 異常なし
SET MR9010               ; P&P　Y軸位置決めｴﾗｰ
LD T210                  ; 異常監視開始
AND R46705               ; P&P　Y軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
AND MR9915               ; 異常なし
SET MR9011               ; P&P　Y軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
LD T210                  ; 異常監視開始
AND R47200               ; P&P　X軸位置決めｴﾗｰ
AND MR9915               ; 異常なし
SET MR9012               ; P&P　X軸位置決めｴﾗｰ
LD T210                  ; 異常監視開始
AND R47505               ; P&P　X軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
AND MR9915               ; 異常なし
SET MR9013               ; P&P　X軸ｻｰﾎﾞﾄﾞﾗｲﾊﾞｰ異常
;<h1/>PZT投入ｶｳﾝﾄｸﾘｱ
LDB MR40110              ; 自動ﾓｰﾄﾞSW選択
MPS
LD R110                  ; PZT投入ｶｳﾝﾄDOWN SW
AND>= DM7002 #1          ; PZT投入数
ANL
@DEC DM7002              ; PZT投入数
MPP
LD R111                  ; PZT投入ｶｳﾝﾄUP SW
AND< DM7002 #5           ; PZT投入数
ANL
@INC DM7002              ; PZT投入数
;<h1/>ﾌﾟﾛｸﾞﾗﾑﾓﾆﾀｰ用　DM
LD @MR801
@MOV #801 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR802                ; 電磁MG吸着確認
@MOV #802 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR803
@MOV #803 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR804
@MOV #804 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR805                ; PZTﾄﾚｲより取出し要求待ち
@MOV #805 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR806                ; 供給動作へ
@MOV #806 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR807
@MOV #807 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR808
@MOV #808 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR809
@MOV #809 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR810
@MOV #810 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR811
@MOV #811 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR812                ; PZTT1X軸搬供給位置ﾃﾞｰﾀｾｯﾄ
@MOV #812 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR813                ; PZT連続無しｶｳﾝﾄ比較
@MOV #813 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR814                ; PZT 連続無しｶｳﾝﾄ異常
@MOV #814 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR815
@MOV #815 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR900                ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
@MOV #900 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR901                ; PZTﾄﾚｲT2Z軸供給高さ移動
@MOV #901 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR902                ; PZTT2Z軸供給位置ﾃﾞｰﾀｾｯﾄ
@MOV #902 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR903                ; PZTﾄﾚｲT2Z軸供給高さ移動
@MOV #903 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR904
@MOV #904 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR905
@MOV #905 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR906
@MOV #906 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR907
@MOV #907 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR908
@MOV #908 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR909                ; P&P給材ﾍｯﾄﾞ上昇
@MOV #909 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR910
@MOV #910 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR911                ; 給材P&P待機位置ﾃﾞｰﾀｾｯﾄ
@MOV #911 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR912                ; 給材P&P待機位置移動
@MOV #912 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR913                ; 給材P&P待機位置移動完了待ち
@MOV #913 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR914
@MOV #914 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LD @MR915                ; 自動STEP終了
@MOV #915 DM501          ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
LDB MR21015              ; 給材P&P起動中
MOV #0 DM501             ; 給材供給PPｽﾃｯﾌﾟﾓﾆﾀ
END
ENDH
