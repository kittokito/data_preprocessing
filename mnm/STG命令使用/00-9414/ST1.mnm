DEVICE:53
;MODULE:ST1
;MODULE_TYPE:0
;***************************************
; 非常停止
; Emergency Stop 
;***************************************
LD R50010                ; Emergency　Stop
OR @MR000                ; Emergency STOP
ZRES @MR001 @MR5715
CON
OUT @MR000               ; Emergency STOP
TMR @49 #5
LD @T49
MDSTOP ST1
;RB3 Alarm復帰時全動作中止
LD MR15200               ; RB3 Alarm復帰中
ZRES @MR001 @MR1815      ; OK/NG Flag 15
CON
ZRES @MR2000 @MR5715     ; ST1 STEP開始
CON
@SET @MR1900
STG @MR1900
ANB MR15200              ; RB3 Alarm復帰中
MPS
AND @MR010               ; 1st全ﾜｰｸ無し
JMP @MR1902
MPP
ANB @MR010               ; 1st全ﾜｰｸ無し
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
SET @MR312               ; 投入口ﾜｰｸ除材要求
CON
JMP @MR1901
STG @MR1901
AND @MR315               ; Err12 ST1 Err12解除完了
RES @MR315               ; Err12 ST1 Err12解除完了
CON
JMP @MR1900
;解除後Autoの頭から再開
STG @MR1902
MPS
AND R50001               ; AUTO
SET @MR4200              ; 給材P&P  動作開始
CON
SET @MR5000              ; 除材P&P  動作開始
CON
@SET @MR3200
CON
ENDS
MPP
ANB R50001               ; AUTO
ENDS
;ﾜｰｸ有無ﾌﾗｸﾞ
;Work Existence Flag
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ANB @MR100               ; 除材ﾜｰｸ1有
ANB @MR101               ; 除材ﾜｰｸ2有
OUT @MR010               ; 1st全ﾜｰｸ無し
LDB R4200                ; IND1 ST2 ﾜｰｸ検出1(ST1側)
ANB R4201                ; IND1 ST2 ﾜｰｸ検出2(中1側)
ANB R4202                ; IND1 ST2 ﾜｰｸ検出3(中2側)
ANB R4203                ; IND1 ST2 ﾜｰｸ検出4(ST3側)
AND R4204                ; IND1 ST2 ﾜｰｸ浮き検出(外側)
AND R4205                ; IND1 ST2 ﾜｰｸ浮き検出(Index側)
OUT @MR002               ; ST2 ﾜｰｸ無し
LD R4210                 ; IND1 ST3 ﾜｰｸ浮き検出(外側)
AND R4211                ; IND1 ST3 ﾜｰｸ浮き検出(Index側)
ANB R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
ANB R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
ANB R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
ANB R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
OUT @MR003               ; ST3 ﾜｰｸ無し
LDB R4212                ; IND1 ST4 ﾜｰｸ検出
AND R4213                ; IND1 ST4 ﾜｰｸ浮き検出(外側)
AND R4214                ; IND1 ST4 ﾜｰｸ浮き検出(Index側)
OUT @MR004               ; ST4 ﾜｰｸ無し
LD @MR010                ; 1st全ﾜｰｸ無し
AND @MR002               ; ST2 ﾜｰｸ無し
AND @MR003               ; ST3 ﾜｰｸ無し
AND @MR004               ; ST4 ﾜｰｸ無し
OUT @MR006               ; IND1全STﾜｰｸ無し
;1stﾜｰｸ押さえﾌﾗｸﾞ
;1st Cartridge Holed Flag
LDB R4110                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ1開確認（4ST側
ANB R4111                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ2開確認（中1側
ANB R4112                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ3開確認（中2側
ANB R4113                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ4開確認（2ST側
OUT @MR011               ; IND1治具  ﾜｰｸ押さえOK
LD R4110                 ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ1開確認（4ST側
AND R4111                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ2開確認（中1側
AND R4112                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ3開確認（中2側
AND R4113                ; IND1 ST1 ﾜｰｸｸﾗﾝﾌﾟ4開確認（2ST側
OUT @MR012               ; IND1治具  ﾜｰｸ開放OK
;給材ｷｬﾝｾﾙﾀｲﾏｰ管理
;Timer Management for Supply Cancel
LD @MR1500               ; IND1 給材要求
ANB @MR1501              ; IND1 給材P&P 給材中
TMR #20 #9999            ; IND1 移載上流ﾜｰｸ待ち時間
;
LD @MR100                ; 除材ﾜｰｸ1有
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
LDB @MR100               ; 除材ﾜｰｸ1有
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ORL
LD @MR101                ; 除材ﾜｰｸ2有
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
LDB @MR101               ; 除材ﾜｰｸ2有
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORL
ANL
LD @MR102                ; 除材ﾜｰｸ3有
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
LDB @MR102               ; 除材ﾜｰｸ3有
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORL
ANL
LD @MR103                ; 除材ﾜｰｸ4有
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
LDB @MR103               ; 除材ﾜｰｸ4有
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORL
ANL
OUT @MR810               ; ｶｰﾄﾘｯｼﾞ状態 OK
LDB @MR100               ; 除材ﾜｰｸ1有
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
LDB @MR101               ; 除材ﾜｰｸ2有
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORL
LDB @MR102               ; 除材ﾜｰｸ3有
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORL
LDB @MR103               ; 除材ﾜｰｸ4有
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORL
OUT @MR811               ; 無いはずのｶｰﾄﾘｯｼﾞを検出
LD<> DM836 #0            ; ST1_1 ﾜｰｸ有無(0=無)回転後
LD R50002                ; STEP
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ORL
OUT @MR100               ; 除材ﾜｰｸ1有
LD<> DM837 #0            ; ST1_2 ﾜｰｸ有無(0=無)回転後
LD R50002                ; STEP
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORL
OUT @MR101               ; 除材ﾜｰｸ2有
LD<> DM838 #0            ; ST1_3 ﾜｰｸ有無(0=無)回転後
LD R50002                ; STEP
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORL
OUT @MR102               ; 除材ﾜｰｸ3有
LD<> DM839 #0            ; ST1_4 ﾜｰｸ有無(0=無)回転後
LD R50002                ; STEP
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORL
OUT @MR103               ; 除材ﾜｰｸ4有
;動作ﾊﾟﾗﾒｰﾀ
;Operation Parameter
LDB LR41100              ; AUTO-0 全ﾕﾆｯﾄ動作
ANB LR41101              ; AUTO-1 IND1 2UT
ANB LR41102              ; AUTO-2 IND1 3UT
ANB LR41103              ; AUTO-3 IND1 4UT
ANB LR41104              ; AUTO-4 IND2 3UT
ANB LR41105              ; AUTO-5 IND3 3UT
ANB LR41106              ; AUTO-6
ANB LR41107              ; AUTO-7
ANB LR41108              ; AUTO-8
OUB @MR013               ; ST1 AUTO Parameter OK
LD= W1B84 W1BC7          ; ｲﾝｸｺｰﾄﾞ1(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ1_from Host
AND= W1B85 W1BC8         ; ｲﾝｸｺｰﾄﾞ2(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ2_from Host
AND= W1B86 W1BC9         ; ｲﾝｸｺｰﾄﾞ3(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ3_from Host
AND= W1B87 W1BCA         ; ｲﾝｸｺｰﾄﾞ4(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ4_from Host
AND= W1B88 W1BCB         ; ｲﾝｸｺｰﾄﾞ5(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ5_from Host
AND= W1B89 W1BCC         ; ｲﾝｸｺｰﾄﾞ6(Model Master)_from Host  ｲﾝｸｺｰﾄﾞ6_from Host
AND= W1B7E W1BCD         ; 注入サイズ1_from Host  注入ｻｲｽﾞ1_from Host
OUT @MR001
;***************************************
; ﾎﾟｰｽﾞ ･ ｴﾗｰ 監視
; Pause ･ Error Check 
;***************************************
LDB R50300               ; Pause
ANB R50111               ; Err ST1
ANB R50110               ; Err INDEX
OUT @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
;<h1/>原点復帰動作
;HOME RETURN OPERATION 
LD R50003                ; HOME
ANB R50201               ; ST1 動作中
SET R50201               ; ST1 動作中
CON
SET @MR1000              ; ST1 原点復帰開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR1001              ; ST1 原点復帰終了
RES R50201               ; ST1 動作中
CON
RES @MR1001              ; ST1 原点復帰終了
STG @MR1000              ; ST1 原点復帰開始
SET MR18403              ; RB3:ﾏｸﾛ強制終了
CON
SET R50901               ; IND1 ST1  ｻｲｸﾙ動作中
CON
JMP @MR1006
STG @MR1006
ZRES R29000 R29915
CON
ZRES MR16000 MR16515     ; RB3_ﾌﾟﾛｸﾞﾗﾑｽﾀｰﾄ  Spare
CON
AND MR26100              ; A-RB3 電源ON
AND T523                 ; RB3ﾏｸﾛ再起動Wait
AND MR18415              ; RB3:DN正常通信中
TMR @1 #10
CON
AND @T1
RES MR18403              ; RB3:ﾏｸﾛ強制終了
CON
JMP @MR1007
STG @MR1007
AND R11801               ; 準備完了(ｺﾝﾄﾛｰﾗReady)
AND R18502               ; A-RB11 電源ON
AND DM2047.14
AND MR19501              ; RB11:DN正常通信中
AND DM2047.12
TMR @7 #10
CON
AND @T7
SET @MR1700              ; 給材P&P動作中
CON
SET MR16002              ; RB3_原点復帰開始
CON
JMP @MR1008
STG @MR1008
AND R11815               ; RB3_原点復帰中
JMP @MR1009
STG @MR1009
ANB R11815               ; RB3_原点復帰中
RES MR16002              ; RB3_原点復帰開始
CON
JMP @MR1010
STG @MR1010
RES @MR1700              ; 給材P&P動作中
CON
JMP @MR1011
STG @MR1011
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R11801               ; 準備完了(ｺﾝﾄﾛｰﾗReady)
SET @MR1200              ; 除材P&P原点復帰開始
CON
JMP @MR1100              ; 給材P&P原点復帰開始
;給材P&P / Supply P&P HOME
STG @MR1100              ; 給材P&P原点復帰開始
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND R4305                ; 給材ﾁｬｯｸ 開限
JMP @MR1103
MPP
ANB R4305                ; 給材ﾁｬｯｸ 開限
SET @MR104               ; Err2 ST1 Err2
CON
JMP @MR1101              ; Error中
;Err2 給材P&Pﾜｰｸ残 / Cartridge Remain 
STG @MR1101              ; Error中
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err2 ST1 Err2解除完了
RES @MR107               ; Err2 ST1 Err2解除完了
CON
MPS
ANB MR201                ; ｴﾗｰ中除材確認
JMP @MR1100              ; 給材P&P原点復帰開始
MPP
AND MR201                ; ｴﾗｰ中除材確認
JMP @MR1103
;
STG @MR1103
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR201                ; ｴﾗｰ中除材確認
CON
RES MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
SET MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
AND R4305                ; 給材ﾁｬｯｸ 開限
JMP @MR1104
STG @MR1104
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7012               ; ｾﾙ内PP給材側ｼﾌﾄ　前進
CON
SET MR7013               ; ｾﾙ内PP給材側ｼﾌﾄ　後退
CON
RES MR7102               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回
CON
SET MR7103               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回戻り
CON
AND R4301                ; ｾﾙ内P&P給材側ｼﾌﾄ　後退限
AND R4303                ; 給材ﾁｬｯｸ 戻り限
JMP @MR1106
STG @MR1106
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
SET MR16208              ; 給材P&P_原点復帰
CON
JMP @MR1107
STG @MR1107
AND R12008               ; 給材P&P_原点復帰完了
RES MR16208              ; 給材P&P_原点復帰
CON
JMP @MR1108
STG @MR1108
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR15004              ; 給材P&P原点復帰完了
CON
JMP @MR1300              ; ST1       ﾜｰｸ残確認
;動作可能が立たない時処理
LD @MR1106
ANB R12000               ; 給材ﾊﾝﾄﾞ動作可能
AND R11801               ; 準備完了(ｺﾝﾄﾛｰﾗReady)
TMR @2 #100
CON
AND @T2
@SET @MR1113
STG @MR1113
SET MR16008              ; RB3_progNo.　2ﾋﾟｯﾄ目
CON
JMP @MR1114
STG @MR1114
TMH @3 #5
CON
AND @T3
SET MR16000              ; RB3_ﾌﾟﾛｸﾞﾗﾑｽﾀｰﾄ
CON
JMP @MR1115
STG @MR1115
LD R12000                ; 給材ﾊﾝﾄﾞ動作可能
OR R12200                ; 除材ﾊﾝﾄﾞ動作可能
ANL
RES MR16008              ; RB3_progNo.　2ﾋﾟｯﾄ目
CON
RES MR16000              ; RB3_ﾌﾟﾛｸﾞﾗﾑｽﾀｰﾄ
CON
ENDS
;除材P&P / Remove P&P HOME
STG @MR1200              ; 除材P&P原点復帰開始
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB R4310                ; 除材ﾁｬｯｸ 閉限
OR R4311                 ; 除材ﾁｬｯｸ 開限
ANL
RES LR402                ; Cell内除材P&P ﾜｰｸ有
CON
JMP @MR1204
MPP
LDB R4311                ; 除材ﾁｬｯｸ 開限
AND R4310                ; 除材ﾁｬｯｸ 閉限
ANL
SET LR402                ; Cell内除材P&P ﾜｰｸ有
CON
SET @MR108               ; Err3 ST1 Err3
CON
JMP @MR1201
;Err3 原点復帰時除材P&Pﾜｰｸ残 / Cartridge remain on Remove P&P when HOME operation
STG @MR1201
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR111               ; Err3 ST1 Err3解除完了
RES @MR111               ; Err3 ST1 Err3解除完了
CON
JMP @MR1202
STG @MR1202
MPS
AND MR202                ; ｴﾗｰ中除材確認
JMP @MR1203
MPP
ANB MR202                ; ｴﾗｰ中除材確認
SET @MR108               ; Err3 ST1 Err3
CON
JMP @MR1201
STG @MR1203
RES MR202                ; ｴﾗｰ中除材確認
CON
JMP @MR1204
;
STG @MR1204
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7106               ; ｾﾙ内 除材ﾁｬｯｸ 閉じ
CON
SET MR7107               ; ｾﾙ内 除材ﾁｬｯｸ 開き
CON
AND R4311                ; 除材ﾁｬｯｸ 開限
RES LR402                ; Cell内除材P&P ﾜｰｸ有
CON
JMP @MR1205
STG @MR1205
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
JMP @MR1206
STG @MR1206
AND R12301               ; 除材P&P_PAUSE_待機位置移動完了
RES MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
JMP @MR1207
STG @MR1207
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
SET MR15003              ; 除材P&P原点復帰完了
CON
SET @MR1215              ; 除材P&P原点復帰完了
CON
ENDS
;
STG @MR1300              ; ST1       ﾜｰｸ残確認
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1215              ; 除材P&P原点復帰完了
RES @MR1215              ; 除材P&P原点復帰完了
CON
JMP @MR1400              ; 原点復帰終了処理
STG @MR1400              ; 原点復帰終了処理
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR600                ; IND1      ｻｲｸﾙ動作中
RES R50901               ; IND1 ST1  ｻｲｸﾙ動作中
CON
SET R50411               ; IND1 ST1   1ｻｲｸﾙ終了
CON
SET @MR1001              ; ST1 原点復帰終了
CON
ENDS
;<h1/>自動運転
;AUTO OPERATION
LD R50001                ; AUTO
ANB R50201               ; ST1 動作中
DW #0 @DM4
CON
SET R50201               ; ST1 動作中
CON
SET @MR4200              ; 給材P&P  動作開始
CON
SET @MR5000              ; 除材P&P  動作開始
CON
SET @MR3000              ; ST1 AUTO開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR3001              ; ST1 AUTO終了
ANB @MR4201              ; 給材P&P　動作中
ANB @MR5001              ; 除材P&P　動作中
RES R50201               ; ST1 動作中
CON
RES @MR3001              ; ST1 AUTO終了
; 動作パラメーター確認
; Operating Parameter Check
STG @MR3000              ; ST1 AUTO開始
MPS
AND R50209               ; IND1     動作開始
SET R50901               ; IND1 ST1  ｻｲｸﾙ動作中
CON
MPS
AND @MR013               ; ST1 AUTO Parameter OK
MPS
AND @MR001
SET R50210               ; Model OK
CON
JMP @MR3108              ; 3108
MPP
ANB @MR001
TMR @10 #10
CON
AND @T10
SET @MR200               ; Err5 ST1 Err5
CON
JMP @MR3008              ; 3008
MPP
ANB @MR013               ; ST1 AUTO Parameter OK
SET @MR308               ; Err11 ST1 Err11
CON
JMP @MR3008              ; 3008
MPP
LDB R50209               ; IND1     動作開始
AND R50000               ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
JMP @MR4102
; 動作パラメーター設定不良
; Operating Parameter Setting Error
STG @MR3008              ; 3008
MPS
AND @MR311               ; Err11 ST1 Err11解除完了
JMP @MR3009              ; 3009
MPP
AND @MR203               ; Err5 ST1 Err5解除完了
JMP @MR3009              ; 3009
STG @MR3009              ; 3009
RES @MR203               ; Err5 ST1 Err5解除完了
CON
RES @MR311               ; Err11 ST1 Err11解除完了
CON
SET R50009               ; HOLDRQ
CON
RES R50210               ; Model OK
CON
SET R50411               ; IND1 ST1   1ｻｲｸﾙ終了
CON
JMP @MR4102
;動作選択
STG @MR3108              ; 3108
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR1512              ; 除材ﾜｰｸ無 Flg.
CON
JMP @MR3200
;AUTO動作開始
;AUTO Operation Start
STG @MR3200
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
TMH @4 #10
CON
AND @T4
MPS
AND @MR810               ; ｶｰﾄﾘｯｼﾞ状態 OK
MPS
LDB @MR010               ; 1st全ﾜｰｸ無し
OR R50002                ; STEP
ANL
MPS
AND @MR100               ; 除材ﾜｰｸ1有
JMP @MR3201              ; No.1 除材
MPP
ANB @MR100               ; 除材ﾜｰｸ1有
SET @MR900               ; 除材P&P戻し
CON
JMP @MR3300              ; No.1 給材
MPP
LD @MR010                ; 1st全ﾜｰｸ無し
ANB R50002               ; STEP
ANL
SET @MR900               ; 除材P&P戻し
CON
SET @MR1512              ; 除材ﾜｰｸ無 Flg.
CON
JMP @MR3300              ; No.1 給材
MPP
ANB @MR810               ; ｶｰﾄﾘｯｼﾞ状態 OK
TMH @9 #30
CON
AND @T9
SET @MR412               ; Err16 ST1 Err16
CON
JMP @MR3100
;ﾜｰｸ状態NGの時
STG @MR3100
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR415               ; Err16 ST1 Err16解除完了
JMP @MR3101
STG @MR3101
RES @MR415               ; Err16 ST1 Err16解除完了
CON
JMP @MR3102
STG @MR3102
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR810               ; ｶｰﾄﾘｯｼﾞ状態 OK
JMP @MR3200
MPP
ANB @MR810               ; ｶｰﾄﾘｯｼﾞ状態 OK
SET @MR412               ; Err16 ST1 Err16
CON
JMP @MR3100
;<h1/>  No.1  除材動作
;  No.1 Remove Operation
STG @MR3201              ; No.1 除材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43200               ; ｻｲｸﾙﾀｲﾑ計測用1-1
CON
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
RES MR16105              ; 除材ﾜｰｸ選択 Bit-1
CON
RES MR16106              ; 除材ﾜｰｸ選択 Bit-2
CON
TMH @21 #2
CON
AND @T21
SET @MR1508              ; IND1 除材要求
CON
JMP @MR3202
STG @MR3202
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1509              ; IND1 除材P&P除材中
JMP @MR3203
STG @MR3203
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1509              ; IND1 除材P&P除材中
AND @MR1510              ; IND1 除材P&P除材完了
RES @MR1508              ; IND1 除材要求
CON
JMP @MR3204
STG @MR3204
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
RES @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR3205
MPP
BMOV DM3600 DM3680 #20   ; ST1-OUT-No1 QRID-1  REMOVE PP QRID-1
STG @MR3205
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
DW #0 DM836              ; ST1_1 ﾜｰｸ有無(0=無)回転後
CON
SET @MR2304              ; ST1_1 除材済み
CON
RES R43200               ; ｻｲｸﾙﾀｲﾑ計測用1-1
CON
JMP @MR3300              ; No.1 給材
MPP
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
SET @MR408               ; Err17-20
CON
JMP @MR3206
;Err17 ﾜｰｸ除材異常 / Cartridge Removing Error (ST1 PART)
STG @MR3206
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
JMP @MR3207
STG @MR3207
RES @MR411               ; Err17-20解除完了
CON
JMP @MR3205
;<h1/>  No.1  給材動作
;  No.1 Supply Operation
STG @MR3300              ; No.1 給材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43201               ; ｻｲｸﾙﾀｲﾑ計測用1-2
CON
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
JMP @MR3301
STG @MR3301
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND>= @DM4 #4
JMP @MR3303
MPP
AND< @DM4 #4
MPS
LD MR111                 ; Sｻｲｽﾞ
AND R4106                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ1検出(ST4側
LD MR112                 ; Lｻｲｽﾞ
ANB R4106                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ1検出(ST4側
ORL
ANL
JMP @MR3303
MPP
LD MR111                 ; Sｻｲｽﾞ
ANB R4106                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ1検出(ST4側
LD MR112                 ; Lｻｲｽﾞ
AND R4106                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ1検出(ST4側
ORL
ANL
TMR @24 #20
CON
AND @T24
SET @MR500               ; Err221
CON
JMP @MR3302
;Err221Index1 Sｶﾞｲﾄﾞ治具検出異常 / Index1 S-guide Jig error
STG @MR3302
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err221解除完了
RES @MR503               ; Err221解除完了
CON
JMP @MR3301
;
STG @MR3303
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANB @MR900               ; 除材P&P戻し
AND R11908               ; 除材P&P干渉外
RES MR16102              ; 挿入ﾜｰｸ選択 Bit-1
CON
RES MR16103              ; 挿入ﾜｰｸ選択 Bit-2
CON
TMH @22 #2
CON
AND @T22
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3304
STG @MR3304
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
JMP @MR3306
MPP
LDB @MR1501              ; IND1 給材P&P 給材中
LD T20                   ; IND1 移載上流ﾜｰｸ待ち時間
ANB @MR006               ; IND1全STﾜｰｸ無し
LDB R50002               ; STEP
OR MR915                 ; 仮NAT
ANL
LD R50000                ; HOLD
AND R51308               ; IND2     払出し完了
ANB @MR4201              ; 給材P&P　動作中
ORL
ANL
ANL
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3305
STG @MR3305
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3306
MPP
ANB @MR1501              ; IND1 給材P&P 給材中
TMH @23 #10
CON
AND @T23
RES R43201               ; ｻｲｸﾙﾀｲﾑ計測用1-2
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
DW #0 DM820              ; ST1_1 ﾜｰｸ有無(0=無)
CON
DW #0 DM821              ; ST1_2 ﾜｰｸ有無(0=無)
CON
DW #0 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
DW #0 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
MPP
JMP @MR3400              ; No.2 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
DW #0 DM820              ; ST1_1 ﾜｰｸ有無(0=無)
CON
DW #0 DM821              ; ST1_2 ﾜｰｸ有無(0=無)
CON
DW #0 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
DW #0 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
MPP
JMP @MR4000              ; 給除材完了処理
STG @MR3306
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1501              ; IND1 給材P&P 給材中
MPS
AND @MR1502              ; IND1 給材P&P給材完了
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3307
MPP
AND @MR1503              ; IND1 給材P&P給材異常完了
RES @MR1503              ; IND1 給材P&P給材異常完了
CON
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3300              ; No.1 給材
STG @MR3307
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
RES @MR1502              ; IND1 給材P&P給材完了
CON
JMP @MR3308              ; No.1ﾜｰｸﾁｪｯｸ
MPP
BMOV DM3260 DM3280 #20   ; Supply PP QRID-1  ST1-IN-No1 QRID-1
STG @MR3308              ; No.1ﾜｰｸﾁｪｯｸ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4100                 ; IND1 ST1 ﾜｰｸ1検出(ST4側)
AND R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR2300              ; ST1_1 給材済み
CON
RES R43201               ; ｻｲｸﾙﾀｲﾑ計測用1-2
CON
DW #1 DM820              ; ST1_1 ﾜｰｸ有無(0=無)
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3400              ; No.2 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3500              ; No.2　給材
MPP
LDB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ORB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR400               ; Err13-16
CON
JMP @MR3309
;Err13 ﾜｰｸ1給材異常 / Cartridge 1 supply Error (ST1 PART)
STG @MR3309
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err13-16解除完了
JMP @MR3310
STG @MR3310
RES @MR403               ; Err13-16解除完了
CON
JMP @MR3311
STG @MR3311
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
MPS
LD R4100                 ; IND1 ST1 ﾜｰｸ1検出(ST4側)
OR R50002                ; STEP
ANL
RES R43201               ; ｻｲｸﾙﾀｲﾑ計測用1-2
CON
SET @MR2300              ; ST1_1 給材済み
CON
DW #1 DM820              ; ST1_1 ﾜｰｸ有無(0=無)
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3400              ; No.2 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3500              ; No.2　給材
MPP
LDB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANB R50002               ; STEP
ANL
JMP @MR3300              ; No.1 給材
FMOV #0 DM3280 #20       ; ST1-IN-No1 QRID-1
MPP
LDB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3308              ; No.1ﾜｰｸﾁｪｯｸ
;<h1/>  No.2  除材動作
;  No.2 Remove Operation
STG @MR3400              ; No.2 除材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43202               ; ｻｲｸﾙﾀｲﾑ計測用1-3
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR101               ; 除材ﾜｰｸ2有
JMP @MR3401
MPP
ANB @MR101               ; 除材ﾜｰｸ2有
SET @MR2305              ; ST1_2 除材済み
CON
MPS
AND @MR2300              ; ST1_1 給材済み
JMP @MR3500              ; No.2　給材
MPP
ANB @MR2300              ; ST1_1 給材済み
JMP @MR3600              ; No.3 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR2300              ; ST1_1 給材済み
JMP @MR3500              ; No.2　給材
MPP
ANB @MR2300              ; ST1_1 給材済み
JMP @MR4000              ; 給除材完了処理
STG @MR3401
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
SET MR16105              ; 除材ﾜｰｸ選択 Bit-1
CON
RES MR16106              ; 除材ﾜｰｸ選択 Bit-2
CON
TMH @31 #2
CON
AND @T31
SET @MR1508              ; IND1 除材要求
CON
JMP @MR3402
STG @MR3402
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1509              ; IND1 除材P&P除材中
JMP @MR3403
STG @MR3403
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1509              ; IND1 除材P&P除材中
AND @MR1510              ; IND1 除材P&P除材完了
RES @MR1508              ; IND1 除材要求
CON
JMP @MR3404
STG @MR3404
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
RES @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR3405
MPP
BMOV DM3620 DM3680 #20   ; ST1-OUT-No2 QRID-1  REMOVE PP QRID-1
STG @MR3405
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
DW #0 DM837              ; ST1_2 ﾜｰｸ有無(0=無)回転後
CON
SET @MR2305              ; ST1_2 除材済み
CON
RES R43202               ; ｻｲｸﾙﾀｲﾑ計測用1-3
CON
MPS
AND @MR2300              ; ST1_1 給材済み
JMP @MR3500              ; No.2　給材
MPP
ANB @MR2300              ; ST1_1 給材済み
JMP @MR3600              ; No.3 除材
MPP
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
SET @MR408               ; Err17-20
CON
JMP @MR3406
;Err18 ﾜｰｸ除材異常 / Cartridge Removing Error (ST1 PART)
STG @MR3406
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
JMP @MR3407
STG @MR3407
RES @MR411               ; Err17-20解除完了
CON
JMP @MR3405
;<h1/>  No.2  給材動作  
;  No.2 Supply Operation
STG @MR3500              ; No.2　給材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43203               ; ｻｲｸﾙﾀｲﾑ計測用1-4
CON
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
JMP @MR3501
STG @MR3501
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND>= @DM4 #4
JMP @MR3504
MPP
AND< @DM4 #4
MPS
LD MR111                 ; Sｻｲｽﾞ
AND R4107                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ2検出(中1側
LD MR112                 ; Lｻｲｽﾞ
ANB R4107                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ2検出(中1側
ORL
ANL
JMP @MR3504
MPP
LD MR111                 ; Sｻｲｽﾞ
ANB R4107                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ2検出(中1側
LD MR112                 ; Lｻｲｽﾞ
AND R4107                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ2検出(中1側
ORL
ANL
TMR @25 #20
CON
AND @T25
SET @MR500               ; Err221
CON
JMP @MR3502
;Err221Index1 Sｶﾞｲﾄﾞ治具検出異常 / Index1 S-guide Jig error
STG @MR3502
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err221解除完了
RES @MR503               ; Err221解除完了
CON
JMP @MR3501
;
STG @MR3504
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
AND R11908               ; 除材P&P干渉外
SET MR16102              ; 挿入ﾜｰｸ選択 Bit-1
CON
RES MR16103              ; 挿入ﾜｰｸ選択 Bit-2
CON
TMH @32 #2
CON
AND @T32
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3505
STG @MR3505
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
JMP @MR3507
MPP
LDB @MR1501              ; IND1 給材P&P 給材中
LD T20                   ; IND1 移載上流ﾜｰｸ待ち時間
ANB R50002               ; STEP
LD R50000                ; HOLD
AND R51308               ; IND2     払出し完了
ANB @MR4201              ; 給材P&P　動作中
ORL
ANL
ANL
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3506
STG @MR3506
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3507
MPP
ANB @MR1501              ; IND1 給材P&P 給材中
TMR @33 #2
CON
AND @T33
DW #0 DM821              ; ST1_2 ﾜｰｸ有無(0=無)
CON
DW #0 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
DW #0 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3600              ; No.3 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR4000              ; 給除材完了処理
STG @MR3507
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1501              ; IND1 給材P&P 給材中
MPS
AND @MR1502              ; IND1 給材P&P給材完了
MPS
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3508              ; No.2 ﾜｰｸﾁｪｯｸ
MPP
BMOV DM3260 DM3300 #20   ; Supply PP QRID-1  ST1-IN-No2 QRID-1
MPP
AND @MR1503              ; IND1 給材P&P給材異常完了
RES @MR1503              ; IND1 給材P&P給材異常完了
CON
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3500              ; No.2　給材
STG @MR3508              ; No.2 ﾜｰｸﾁｪｯｸ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR1502              ; IND1 給材P&P給材完了
CON
MPS
LD R4101                 ; IND1 ST1 ﾜｰｸ2検出(中1側)
AND R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
DW #1 DM821              ; ST1_2 ﾜｰｸ有無(0=無)
CON
SET @MR2301              ; ST1_2 給材済み
CON
RES R43203               ; ｻｲｸﾙﾀｲﾑ計測用1-4
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3600              ; No.3 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3700              ; No.3　給材
MPP
LDB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR400               ; Err13-16
CON
JMP @MR3509
;Err14 ﾜｰｸ2給材異常 / Cartridge 2 supply Error (ST1 PART)
STG @MR3509
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err13-16解除完了
JMP @MR3510
STG @MR3510
RES @MR403               ; Err13-16解除完了
CON
JMP @MR3511
STG @MR3511
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
MPS
LD R4101                 ; IND1 ST1 ﾜｰｸ2検出(中1側)
OR R50002                ; STEP
ANL
DW #1 DM821              ; ST1_2 ﾜｰｸ有無(0=無)
CON
SET @MR2301              ; ST1_2 給材済み
CON
RES R43203               ; ｻｲｸﾙﾀｲﾑ計測用1-4
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3600              ; No.3 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3700              ; No.3　給材
MPP
LDB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ANB R50002               ; STEP
ANL
JMP @MR3500              ; No.2　給材
FMOV #0 DM3300 #20       ; ST1-IN-No2 QRID-1
MPP
LDB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3508              ; No.2 ﾜｰｸﾁｪｯｸ
;<h1/>  No.3  除材動作
;  No.3 Remove Operation
STG @MR3600              ; No.3 除材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43204               ; ｻｲｸﾙﾀｲﾑ計測用1-5
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR102               ; 除材ﾜｰｸ3有
JMP @MR3601
MPP
ANB @MR102               ; 除材ﾜｰｸ3有
SET @MR2306              ; ST1_3 除材済み
CON
MPS
AND @MR2301              ; ST1_2 給材済み
JMP @MR3700              ; No.3　給材
MPP
ANB @MR2301              ; ST1_2 給材済み
JMP @MR3800              ; No.4 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR2301              ; ST1_2 給材済み
JMP @MR3700              ; No.3　給材
MPP
ANB @MR2301              ; ST1_2 給材済み
JMP @MR4000              ; 給除材完了処理
STG @MR3601
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
RES MR16105              ; 除材ﾜｰｸ選択 Bit-1
CON
SET MR16106              ; 除材ﾜｰｸ選択 Bit-2
CON
TMH @34 #2
CON
AND @T34
SET @MR1508              ; IND1 除材要求
CON
JMP @MR3602
STG @MR3602
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1509              ; IND1 除材P&P除材中
JMP @MR3603
STG @MR3603
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1509              ; IND1 除材P&P除材中
AND @MR1510              ; IND1 除材P&P除材完了
RES @MR1508              ; IND1 除材要求
CON
JMP @MR3604
STG @MR3604
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
RES @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR3605
MPP
BMOV DM3640 DM3680 #20   ; ST1-OUT-No3 QRID-1  REMOVE PP QRID-1
STG @MR3605
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
DW #0 DM838              ; ST1_3 ﾜｰｸ有無(0=無)回転後
CON
SET @MR2306              ; ST1_3 除材済み
CON
RES R43204               ; ｻｲｸﾙﾀｲﾑ計測用1-5
CON
MPS
AND @MR2301              ; ST1_2 給材済み
JMP @MR3700              ; No.3　給材
MPP
ANB @MR2301              ; ST1_2 給材済み
JMP @MR3800              ; No.4 除材
MPP
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
SET @MR408               ; Err17-20
CON
JMP @MR3606
;Err19 ﾜｰｸ除材異常 / Cartridge Removing Error (ST1 PART)
STG @MR3606
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
JMP @MR3607
STG @MR3607
RES @MR411               ; Err17-20解除完了
CON
JMP @MR3605
;<h1/>  No.3  給材動作  
;  No.3 Supply Operation
STG @MR3700              ; No.3　給材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43205               ; ｻｲｸﾙﾀｲﾑ計測用1-6
CON
JMP @MR3701
STG @MR3701
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND>= @DM4 #4
JMP @MR3704
MPP
AND< @DM4 #4
MPS
LD MR111                 ; Sｻｲｽﾞ
AND R4108                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ3検出(中2側
LD MR112                 ; Lｻｲｽﾞ
ANB R4108                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ3検出(中2側
ORL
ANL
JMP @MR3704
MPP
LD MR111                 ; Sｻｲｽﾞ
ANB R4108                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ3検出(中2側
LD MR112                 ; Lｻｲｽﾞ
AND R4108                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ3検出(中2側
ORL
ANL
TMR @26 #20
CON
AND @T26
SET @MR500               ; Err221
CON
JMP @MR3702
;Err221Index1 Sｶﾞｲﾄﾞ治具検出異常 / Index1 S-guide Jig error
STG @MR3702
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err221解除完了
RES @MR503               ; Err221解除完了
CON
JMP @MR3701
;
STG @MR3704
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
AND R11908               ; 除材P&P干渉外
RES MR16102              ; 挿入ﾜｰｸ選択 Bit-1
CON
SET MR16103              ; 挿入ﾜｰｸ選択 Bit-2
CON
TMH @35 #2
CON
AND @T35
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3705
STG @MR3705
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
JMP @MR3707
MPP
LDB @MR1501              ; IND1 給材P&P 給材中
LD T20                   ; IND1 移載上流ﾜｰｸ待ち時間
ANB R50002               ; STEP
LD R50000                ; HOLD
AND R51308               ; IND2     払出し完了
ANB @MR4201              ; 給材P&P　動作中
ORL
ANL
ANL
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3706
STG @MR3706
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3707
MPP
ANB @MR1501              ; IND1 給材P&P 給材中
TMR @36 #2
CON
AND @T36
DW #0 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
DW #0 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3800              ; No.4 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR4000              ; 給除材完了処理
STG @MR3707
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1501              ; IND1 給材P&P 給材中
MPS
AND @MR1502              ; IND1 給材P&P給材完了
MPS
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3708              ; No.3 ﾜｰｸﾁｪｯｸ
MPP
BMOV DM3260 DM3320 #20   ; Supply PP QRID-1  ST1-IN-No3 QRID-1
MPP
AND @MR1503              ; IND1 給材P&P給材異常完了
RES @MR1503              ; IND1 給材P&P給材異常完了
CON
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3700              ; No.3　給材
STG @MR3708              ; No.3 ﾜｰｸﾁｪｯｸ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR1502              ; IND1 給材P&P給材完了
CON
MPS
LD R4102                 ; IND1 ST1 ﾜｰｸ3検出(中2側)
AND R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
DW #1 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
SET @MR2302              ; ST1_3 給材済み
CON
RES R43205               ; ｻｲｸﾙﾀｲﾑ計測用1-6
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3800              ; No.4 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3900              ; No.4　給材
MPP
LDB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR400               ; Err13-16
CON
JMP @MR3709
;Err14 ﾜｰｸ2給材異常 / Cartridge 2 supply Error (ST1 PART)
STG @MR3709
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err13-16解除完了
JMP @MR3710
STG @MR3710
RES @MR403               ; Err13-16解除完了
CON
JMP @MR3711
STG @MR3711
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
MPS
LD R4102                 ; IND1 ST1 ﾜｰｸ3検出(中2側)
OR R50002                ; STEP
ANL
DW #1 DM822              ; ST1_3 ﾜｰｸ有無(0=無)
CON
SET @MR2302              ; ST1_3 給材済み
CON
RES R43205               ; ｻｲｸﾙﾀｲﾑ計測用1-6
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3800              ; No.4 除材
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
JMP @MR3900              ; No.4　給材
MPP
LDB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ANB R50002               ; STEP
ANL
JMP @MR3700              ; No.3　給材
FMOV #0 DM3320 #20       ; ST1-IN-No3 QRID-1
MPP
LDB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3708              ; No.3 ﾜｰｸﾁｪｯｸ
;<h1/>  No.4  除材動作
;  No.4 Remove Operation
STG @MR3800              ; No.4 除材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43206               ; ｻｲｸﾙﾀｲﾑ計測用1-7
CON
MPS
ANB @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR103               ; 除材ﾜｰｸ4有
JMP @MR3801
MPP
ANB @MR103               ; 除材ﾜｰｸ4有
SET @MR2307              ; ST1_4 除材済み
CON
MPS
AND @MR2302              ; ST1_3 給材済み
JMP @MR3900              ; No.4　給材
MPP
ANB @MR2302              ; ST1_3 給材済み
JMP @MR4000              ; 給除材完了処理
MPP
AND @MR1512              ; 除材ﾜｰｸ無 Flg.
MPS
AND @MR2302              ; ST1_3 給材済み
JMP @MR3900              ; No.4　給材
MPP
ANB @MR2302              ; ST1_3 給材済み
JMP @MR4000              ; 給除材完了処理
STG @MR3801
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
SET MR16105              ; 除材ﾜｰｸ選択 Bit-1
CON
SET MR16106              ; 除材ﾜｰｸ選択 Bit-2
CON
TMH @37 #2
CON
AND @T37
SET @MR1508              ; IND1 除材要求
CON
JMP @MR3802
STG @MR3802
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1509              ; IND1 除材P&P除材中
JMP @MR3803
STG @MR3803
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1509              ; IND1 除材P&P除材中
AND @MR1510              ; IND1 除材P&P除材完了
RES @MR1508              ; IND1 除材要求
CON
JMP @MR3804
STG @MR3804
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
RES @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR3805
MPP
BMOV DM3660 DM3680 #20   ; ST1-OUT-No4 QRID-1  REMOVE PP QRID-1
STG @MR3805
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
DW #0 DM839              ; ST1_4 ﾜｰｸ有無(0=無)回転後
CON
SET @MR2305              ; ST1_2 除材済み
CON
RES R43206               ; ｻｲｸﾙﾀｲﾑ計測用1-7
CON
MPS
AND @MR2302              ; ST1_3 給材済み
JMP @MR3900              ; No.4　給材
MPP
ANB @MR2302              ; ST1_3 給材済み
JMP @MR4000              ; 給除材完了処理
MPP
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
SET @MR408               ; Err17-20
CON
JMP @MR3806
;Err20 ﾜｰｸ除材異常 / Cartridge Removing Error (ST1 PART)
STG @MR3806
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
JMP @MR3807
STG @MR3807
RES @MR411               ; Err17-20解除完了
CON
JMP @MR3805
;<h1/>  No.4  給材動作  
;  No.4 Supply Operation
STG @MR3900              ; No.4　給材
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43207               ; ｻｲｸﾙﾀｲﾑ計測用1-8
CON
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
JMP @MR3901
STG @MR3901
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND>= @DM4 #4
JMP @MR3904
MPP
AND< @DM4 #4
MPS
LD MR111                 ; Sｻｲｽﾞ
AND R4109                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ4検出(ST2側
LD MR112                 ; Lｻｲｽﾞ
ANB R4109                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ4検出(ST2側
ORL
ANL
INC @DM4
CON
JMP @MR3904
MPP
LD MR111                 ; Sｻｲｽﾞ
ANB R4109                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ4検出(ST2側
LD MR112                 ; Lｻｲｽﾞ
AND R4109                ; IND1 ST1 Sｻｲｽﾞ用ｶﾞｲﾄﾞ4検出(ST2側
ORL
ANL
TMR @27 #20
CON
AND @T27
SET @MR500               ; Err221
CON
JMP @MR3902
;Err221Index1 Sｶﾞｲﾄﾞ治具検出異常 / Index1 S-guide Jig error
STG @MR3902
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err221解除完了
RES @MR503               ; Err221解除完了
CON
JMP @MR3901
;
STG @MR3904
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
AND R11908               ; 除材P&P干渉外
SET MR16102              ; 挿入ﾜｰｸ選択 Bit-1
CON
SET MR16103              ; 挿入ﾜｰｸ選択 Bit-2
CON
TMH @38 #2
CON
AND @T38
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3905
STG @MR3905
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
JMP @MR3907
MPP
LDB @MR1501              ; IND1 給材P&P 給材中
LD T20                   ; IND1 移載上流ﾜｰｸ待ち時間
ANB R50002               ; STEP
LD R50000                ; HOLD
AND R51308               ; IND2     払出し完了
ANB @MR4201              ; 給材P&P　動作中
ORL
ANL
ANL
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3906
STG @MR3906
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1501              ; IND1 給材P&P 給材中
SET @MR1500              ; IND1 給材要求
CON
JMP @MR3907
MPP
ANB @MR1501              ; IND1 給材P&P 給材中
TMR @39 #2
CON
AND @T39
DW #0 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
CON
JMP @MR4000              ; 給除材完了処理
STG @MR3907
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB @MR1501              ; IND1 給材P&P 給材中
MPS
AND @MR1502              ; IND1 給材P&P給材完了
MPS
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3908              ; No.4 ﾜｰｸﾁｪｯｸ
MPP
BMOV DM3260 DM3340 #20   ; Supply PP QRID-1  ST1-IN-No4 QRID-1
MPP
AND @MR1503              ; IND1 給材P&P給材異常完了
RES @MR1503              ; IND1 給材P&P給材異常完了
CON
RES @MR1500              ; IND1 給材要求
CON
JMP @MR3900              ; No.4　給材
STG @MR3908              ; No.4 ﾜｰｸﾁｪｯｸ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR1502              ; IND1 給材P&P給材完了
CON
MPS
LD R4103                 ; IND1 ST1 ﾜｰｸ4検出(ST2側)
AND R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
DW #1 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
CON
SET @MR2303              ; ST1_4 給材済み
CON
RES R43207               ; ｻｲｸﾙﾀｲﾑ計測用1-8
CON
JMP @MR4000              ; 給除材完了処理
MPP
LDB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR400               ; Err13-16
CON
JMP @MR3909
;Err14 ﾜｰｸ2給材異常 / Cartridge 2 supply Error (ST1 PART)
STG @MR3909
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err13-16解除完了
JMP @MR3910
STG @MR3910
RES @MR403               ; Err13-16解除完了
CON
JMP @MR3911
STG @MR3911
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
MPS
LD R4103                 ; IND1 ST1 ﾜｰｸ4検出(ST2側)
OR R50002                ; STEP
ANL
DW #1 DM823              ; ST1_4 ﾜｰｸ有無(0=無)
CON
SET @MR2303              ; ST1_4 給材済み
CON
RES R43207               ; ｻｲｸﾙﾀｲﾑ計測用1-8
CON
JMP @MR4000              ; 給除材完了処理
MPP
LDB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ANB R50002               ; STEP
ANL
JMP @MR3900              ; No.4　給材
FMOV #0 DM3340 #20       ; ST1-IN-No4 QRID-1
MPP
LDB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3908              ; No.4 ﾜｰｸﾁｪｯｸ
;
STG @MR4000              ; 給除材完了処理
MPS
LD<> DM820 #0            ; ST1_1 ﾜｰｸ有無(0=無)
OR<> DM821 #0            ; ST1_2 ﾜｰｸ有無(0=無)
OR<> DM822 #0            ; ST1_3 ﾜｰｸ有無(0=無)
OR<> DM823 #0            ; ST1_4 ﾜｰｸ有無(0=無)
ANL
JMP @MR4002              ; ﾜｰｸ有り
MPP
LD= DM820 #0             ; ST1_1 ﾜｰｸ有無(0=無)
AND= DM821 #0            ; ST1_2 ﾜｰｸ有無(0=無)
AND= DM822 #0            ; ST1_3 ﾜｰｸ有無(0=無)
AND= DM823 #0            ; ST1_4 ﾜｰｸ有無(0=無)
ANL
JMP @MR4001              ; ﾜｰｸ無し
;ｶｰﾄﾘｯｼﾞ無し / No case
STG @MR4001              ; ﾜｰｸ無し
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
MPS
ANB R50002               ; STEP
JMP @MR4009              ; ﾜｰｸﾃﾞｰﾀ設定
MPP
AND R50002               ; STEP
MPS
ANB LR40202              ; IND1_ST1 STEP-03   除給材P&P
JMP @MR4009              ; ﾜｰｸﾃﾞｰﾀ設定
MPP
AND LR40202              ; IND1_ST1 STEP-03   除給材P&P
JMP @MR2101              ; 2101
;治具ｸﾗﾝﾌﾟ / Jig clamp
STG @MR4002              ; ﾜｰｸ有り
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R31500               ; ﾘｰｸ判定中ｸﾗﾝﾌﾟ禁止
RES MR7901               ; IND1 ST1治具1(縦) 開き
CON
SET MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
TMH @5 #10
CON
AND @T5
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4003
STG @MR4003
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R31500               ; ﾘｰｸ判定中ｸﾗﾝﾌﾟ禁止
RES MR7903               ; IND1 ST1治具2(横) 開き
CON
SET MR7902               ; IND1 ST1治具2(横) 閉じ
CON
TMH @6 #30
CON
AND @T6
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4004
STG @MR4004
MPS
ANB R50002               ; STEP
JMP @MR4005              ; ﾜｰｸ浮き確認
MPP
AND R50002               ; STEP
MPS
ANB LR40202              ; IND1_ST1 STEP-03   除給材P&P
JMP @MR4009              ; ﾜｰｸﾃﾞｰﾀ設定
MPP
AND LR40202              ; IND1_ST1 STEP-03   除給材P&P
JMP @MR2101              ; 2101
;ｶｰﾄﾘｯｼﾞ浮き確認 / Cartridge floating check
STG @MR4005              ; ﾜｰｸ浮き確認
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB R50002               ; STEP
ORB LR40203              ; IND1_ST1 STEP-04   押し棒
ANL
JMP @MR4006
MPP
LD R50002                ; STEP
AND LR40203              ; IND1_ST1 STEP-04   押し棒
ANL
JMP @MR2102              ; 2102
STG @MR4006
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4104                 ; IND1 ST1 ﾜｰｸ浮き検出(外側)
AND R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR4009              ; ﾜｰｸﾃﾞｰﾀ設定
MPP
LDB R4104                ; IND1 ST1 ﾜｰｸ浮き検出(外側)
ORB R4105                ; IND1 ST1 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR208               ; Err7 ST1 Err7
CON
JMP @MR4007
;Err7 ﾜｰｸ浮き / Cartridge floating
STG @MR4007
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR211               ; Err7 ST1 Err7解除完了
JMP @MR4008
STG @MR4008
RES @MR211               ; Err7 ST1 Err7解除完了
CON
JMP @MR4006
;ﾜｰｸﾃﾞｰﾀ設定
;Cartridge Data Settings
STG @MR4009              ; ﾜｰｸﾃﾞｰﾀ設定
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR16105              ; 除材ﾜｰｸ選択 Bit-1
CON
RES MR16106              ; 除材ﾜｰｸ選択 Bit-2
CON
ZRES @MR2300 @MR2305     ; ST1_1 給材済み  ST1_2 除材済み
CON
JMP @MR4010
STG @MR4010
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ZRES @MR1500 @MR1515     ; IND1 給材要求
CON
MPS
ANB R50002               ; STEP
JMP @MR4100              ; AUTO終了処理
MPP
AND R50002               ; STEP
JMP @MR2100
;AUTO 1ｻｲｸﾙ終了処理
;AUTO 1Cycle end Operation
STG @MR4100              ; AUTO終了処理
AND MR600                ; IND1      ｻｲｸﾙ動作中
SET R50411               ; IND1 ST1   1ｻｲｸﾙ終了
CON
JMP @MR4102
STG @MR4102
RES R50901               ; IND1 ST1  ｻｲｸﾙ動作中
CON
ANB R50209               ; IND1     動作開始
MPS
LDB R50002               ; STEP
AND R50409               ; IND1      ｻｲｸﾙ完了
ANL
MPS
LDB R50000               ; HOLD
ORB R50213               ; IND1　　　払出し完了
ANL
JMP @MR3000              ; ST1 AUTO開始
MPP
LD R50000                ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
JMP @MR4103              ; AUTO終了処理
MPP
AND R50002               ; STEP
JMP @MR2100
;AUTO 終了処理
;AUTO Finish Operation
STG @MR4103              ; AUTO終了処理
ANB @MR4201              ; 給材P&P　動作中
ANB @MR5001              ; 除材P&P　動作中
DW #0 @DM4
CON
SET @MR3001              ; ST1 AUTO終了
CON
ENDS
;<h1/>ｽﾃｯﾌﾟ運転
;STEP OERATION
LD R50002                ; STEP
ANB R50201               ; ST1 動作中
SET R50201               ; ST1 動作中
CON
SET @MR2000              ; ST1 STEP開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR2001              ; ST1 STEP終了
RES R50201               ; ST1 動作中
CON
RES @MR2001              ; ST1 STEP終了
LDB LR40200              ; IND1_ST1 STEP-01   通常動作
ANB LR40202              ; IND1_ST1 STEP-03   除給材P&P
ANB LR40201              ; IND1_ST1 STEP-02 flag
OUB @MR014               ; ST1 STEP Parameter OK
STG @MR2000              ; ST1 STEP開始
AND R50201               ; ST1 動作中
MPS
AND LR40200              ; IND1_ST1 STEP-01   通常動作
SET @MR4200              ; 給材P&P  動作開始
CON
SET @MR5000              ; 除材P&P  動作開始
CON
JMP @MR3200
MRD
AND LR40202              ; IND1_ST1 STEP-03   除給材P&P
SET @MR4200              ; 給材P&P  動作開始
CON
SET @MR5000              ; 除材P&P  動作開始
CON
JMP @MR3200
MRD
AND LR40201              ; IND1_ST1 STEP-02 flag
JMP @MR5605
MPP
ANB @MR014               ; ST1 STEP Parameter OK
JMP @MR2008              ; STEP終了処理
;STEP-0
STG @MR2100
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2008              ; STEP終了処理
;STEP-1
STG @MR2101              ; 2101
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2008              ; STEP終了処理
;STEP-2
STG @MR2102              ; 2102
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2008              ; STEP終了処理
STG @MR5607
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2008              ; STEP終了処理
;STEP終了処理
STG @MR2008              ; STEP終了処理
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ZRES @MR2300 @MR2305     ; ST1_1 給材済み  ST1_2 除材済み
CON
ZRES DM820 DM821         ; ST1_1 ﾜｰｸ有無(0=無)  ST1_2 ﾜｰｸ有無(0=無)
CON
ZRES DM3200 DM3799       ; IND2-ST2 QRID-1  排出時読込 
CON
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
SET R50009               ; HOLDRQ
CON
JMP @MR2009              ; 2009
STG @MR2009              ; 2009
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R50000               ; HOLD
ANB @MR4201              ; 給材P&P　動作中
ANB @MR5001              ; 除材P&P　動作中
SET R50411               ; IND1 ST1   1ｻｲｸﾙ終了
CON
SET @MR2001              ; ST1 STEP終了
CON
ENDS
;STEP " Workset Clamp "
STG @MR5605
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR7010               ; 治具ｴｱｰ供給ﾉｽﾞﾙ 上昇
CON
AND R4002                ; IND1 ST1治具ｴｱｰ供給ﾉｽﾞﾙ 上限
AND R4004                ; IND1 ST2治具ｴｱｰ供給ﾉｽﾞﾙ 上限
AND R4006                ; IND1 ST3治具ｴｱｰ供給ﾉｽﾞﾙ 上限
AND R4008                ; IND1 ST4治具ｴｱｰ供給ﾉｽﾞﾙ 上限
JMP @MR5606
STG @MR5606
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7901               ; IND1 ST1治具1(縦) 開き
CON
SET MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
RES MR7903               ; IND1 ST1治具2(横) 開き
CON
SET MR7902               ; IND1 ST1治具2(横) 閉じ
CON
JMP @MR5607
;<h1/>給材ﾊﾝﾄﾞ動作
;Supply Hand Operation
STG @MR4200              ; 給材P&P  動作開始
MPS
LD R50210                ; Model OK
LD R50002                ; STEP
AND @MR1500              ; IND1 給材要求
ORL
ANL
SET @MR4201              ; 給材P&P　動作中
CON
JMP @MR4300              ; 給材P&P ﾒｲﾝ
MPP
LDB R50210               ; Model OK
ANB R50002               ; STEP
AND R50000               ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
RES @MR4201              ; 給材P&P　動作中
CON
ENDS
;Operation Main
STG @MR4300              ; 給材P&P ﾒｲﾝ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
JMP @MR4301              ; 給材ﾊﾝﾄﾞ初期化
STG @MR4301              ; 給材ﾊﾝﾄﾞ初期化
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7012               ; ｾﾙ内PP給材側ｼﾌﾄ　前進
CON
SET MR7013               ; ｾﾙ内PP給材側ｼﾌﾄ　後退
CON
RES MR7102               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回
CON
SET MR7103               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回戻り
CON
RES MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
SET MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
AND R4301                ; ｾﾙ内P&P給材側ｼﾌﾄ　後退限
AND R4303                ; 給材ﾁｬｯｸ 戻り限
AND R4305                ; 給材ﾁｬｯｸ 開限
JMP @MR4302
STG @MR4302
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB R50002               ; STEP
AND R4305                ; 給材ﾁｬｯｸ 開限
ANL
JMP @MR4303
MPP
AND R50002               ; STEP
MPS
LD @MR1500               ; IND1 給材要求
ANB MR915                ; 仮NAT
AND R5313                ; IND2 ST4 ﾜｰｸ有無検出
ANL
SET MR15009              ; IND2_除材中
CON
JMP @MR4304
MPP
AND R50000               ; HOLD
RES @MR4201              ; 給材P&P　動作中
CON
ENDS
;IND2　除材要求待ち / Waiting for IND2 Remove Demand.
STG @MR4303
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND MR15008              ; IND2_除材要求
SET MR15009              ; IND2_除材中
CON
JMP @MR4304
MPP
LDB MR15008              ; IND2_除材要求
AND R50000               ; HOLD
AND R51308               ; IND2     払出し完了
ANL
RES @MR4201              ; 給材P&P　動作中
CON
ENDS
;給材P&P　ﾜｰｸ取り出し / Supply P&P Cartridge Pick up
STG @MR4304
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
SET MR16209              ; 給材P&P_取出位置へ移動
CON
JMP @MR4305
STG @MR4305
AND R12009               ; 給材P&P_取出位置移動完了
RES MR16209              ; 給材P&P_取出位置へ移動
CON
JMP @MR4306
STG @MR4306
TMH @15 #0
CON
AND @T15
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4307
STG @MR4307
RES MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
SET MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
MPS
AND R4304                ; 給材ﾁｬｯｸ 閉限
RES MR8108               ; IND2 ST4治具 閉じ
CON
SET MR8109               ; IND2 ST4治具 開き
CON
TMH @16 #20
CON
AND @T16
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4400
MPP
ANB R4304                ; 給材ﾁｬｯｸ 閉限
TMR @30 #100
CON
AND @T30
JMP @MR4308
STG @MR4308
RES MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
SET MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
JMP @MR4400
;給材P&P　挿入待機位置へ / Supply P&P Move to Waiting point.
STG @MR4400
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
SET MR16210              ; 給材P&P_待機位置へ移動
CON
JMP @MR4401
STG @MR4401
AND R11905               ; 給材P&P-IND2 Z軸干渉外
MPS
LDB R5313                ; IND2 ST4 ﾜｰｸ有無検出
AND R4304                ; 給材ﾁｬｯｸ 閉限
ANL
RES MR15009              ; IND2_除材中
CON
SET MR15010              ; IND2_除材完了
CON
JMP @MR4402
MRD
LD R5313                 ; IND2 ST4 ﾜｰｸ有無検出
ORB R4304                ; 給材ﾁｬｯｸ 閉限
ANL
SET @MR4202              ; ﾜｰｸ取出し異常有
CON
JMP @MR4404
MPP
BMOV DM3240 DM3260 #20   ; IND2-ST4 QRID-1  Supply PP QRID-1
STG @MR4402
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4403
STG @MR4403
RES MR7103               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回戻り
CON
SET MR7102               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回
CON
RES MR7013               ; ｾﾙ内PP給材側ｼﾌﾄ　後退
CON
SET MR7012               ; ｾﾙ内PP給材側ｼﾌﾄ　前進
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4404
STG @MR4404
AND R12010               ; 給材P&P_待機位置移動完了
RES MR16210              ; 給材P&P_待機位置へ移動
CON
JMP @MR4405
STG @MR4405
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR4304               ; Cylinder Error 4304
MPS
ANB @MR4202              ; ﾜｰｸ取出し異常有
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4406
MPP
AND @MR4202              ; ﾜｰｸ取出し異常有
JMP @MR4406
STG @MR4406
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB @MR4202              ; ﾜｰｸ取出し異常有
AND R4304                ; 給材ﾁｬｯｸ 閉限
ANL
JMP @MR4500
MPP
LD @MR4202               ; ﾜｰｸ取出し異常有
ORB R4304                ; 給材ﾁｬｯｸ 閉限
ANL
SET @MR112               ; Err4 ST1 Err4
CON
JMP @MR4407              ; Err4
;Err4 IND2　除材異常 / IND2 Remove Error
STG @MR4407              ; Err4
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR115               ; Err4 ST1 Err4解除完了
JMP @MR4408
STG @MR4408
RES @MR115               ; Err4 ST1 Err4解除完了
CON
JMP @MR4409
STG @MR4409
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR4202              ; ﾜｰｸ取出し異常有
MPS
LDB R5313                ; IND2 ST4 ﾜｰｸ有無検出
ANB R4304                ; 給材ﾁｬｯｸ 閉限
ANL
RES MR15009              ; IND2_除材中
CON
SET MR15011              ; IND2_除材異常完了
CON
JMP @MR4410              ; 給材P&P戻し
MPP
LD R5313                 ; IND2 ST4 ﾜｰｸ有無検出
OR R4304                 ; 給材ﾁｬｯｸ 閉限
ANL
SET @MR112               ; Err4 ST1 Err4
CON
JMP @MR4407              ; Err4
MPP
ANB @MR4202              ; ﾜｰｸ取出し異常有
MPS
ANB R4304                ; 給材ﾁｬｯｸ 閉限
JMP @MR4410              ; 給材P&P戻し
MPP
AND R4304                ; 給材ﾁｬｯｸ 閉限
SET @MR112               ; Err4 ST1 Err4
CON
JMP @MR4407              ; Err4
STG @MR4410              ; 給材P&P戻し
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR4202              ; ﾜｰｸ取出し異常有
CON
RES MR7012               ; ｾﾙ内PP給材側ｼﾌﾄ　前進
CON
SET MR7013               ; ｾﾙ内PP給材側ｼﾌﾄ　後退
CON
RES MR7102               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回
CON
SET MR7103               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回戻り
CON
RES MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
SET MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
JMP @MR4411
STG @MR4411
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4412
STG @MR4412
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
SET MR16208              ; 給材P&P_原点復帰
CON
JMP @MR4413
STG @MR4413
AND R12008               ; 給材P&P_原点復帰完了
RES MR16208              ; 給材P&P_原点復帰
CON
JMP @MR4300              ; 給材P&P ﾒｲﾝ
;給材P&P　挿入位置へ / Supply P&P Move to insert point.
STG @MR4500
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR1500              ; IND1 給材要求
SET @MR1501              ; IND1 給材P&P 給材中
CON
JMP @MR4501
STG @MR4501
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
JMP @MR4502
STG @MR4502
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
LD R12010                ; 給材P&P_待機位置移動完了
OR R12101                ; 給材P&P_PAUSE_待機位置移動完了
ANL
LD R11908                ; 除材P&P干渉外
LD @MR1705               ; 除材ﾊﾝﾄﾞ 干渉外へ移動中
LD< DM13057 #400         ; 除材ﾊﾝﾄﾞ現在値(整数)
OR< DM13057 @DM2         ; 除材ﾊﾝﾄﾞ現在値(整数)  除材PP移動開始確認位置
ANL
ORL
ANL
SET MR16211              ; 給材P&P_挿入上空へ移動
CON
JMP @MR4503
STG @MR4503
AND R12011               ; 給材P&P_挿入上空移動完了
RES MR16211              ; 給材P&P_挿入上空へ移動
CON
JMP @MR4504
STG @MR4504
AND R4302                ; 給材ﾁｬｯｸ 旋回限
AND R4300                ; ｾﾙ内P&P給材側ｼﾌﾄ　前進限
JMP @MR4505
STG @MR4505
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
SET MR16212              ; 給材P&P_挿入位置へ下降
CON
JMP @MR4506
STG @MR4506
AND R12012               ; 給材P&P_挿入位置下降完了
RES MR16212              ; 給材P&P_挿入位置へ下降
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4600
;給材P&P　ﾜｰｸｾｯﾄ / Supply P&P Cartridge set.
STG @MR4600
RES MR7104               ; ｾﾙ内 給材ﾁｬｯｸ 閉じ
CON
SET MR7105               ; ｾﾙ内 給材ﾁｬｯｸ 開き
CON
MPS
LDB MR4305               ; Cylinder Error 4305
AND R4305                ; 給材ﾁｬｯｸ 開限
ANL
TMH @17 #10
CON
AND @T17
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4601
MPP
AND MR4305               ; Cylinder Error 4305
JMP @MR4601
;給材P&P　原位置へ / Supply P&P Move to HOME point.
STG @MR4601
AND R12000               ; 給材ﾊﾝﾄﾞ動作可能
MPS
SET @MR1704              ; 給材PP 原位置戻り中
CON
SET MR16213              ; 給材P&P_原位置へ戻り
CON
JMP @MR4602
MPP
LDA DM13056              ; 給材ﾊﾝﾄﾞ現在値(整数)
CON
SUB #100
CON
STA @DM1                 ; 給材PP移動開始確認位置
STG @MR4602
AND R11904               ; 給材P&P-INDEX Z軸干渉外
RES MR7012               ; ｾﾙ内PP給材側ｼﾌﾄ　前進
CON
SET MR7013               ; ｾﾙ内PP給材側ｼﾌﾄ　後退
CON
RES MR7102               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回
CON
SET MR7103               ; ｾﾙ内PP給材ﾁｬｯｸ 旋回戻り
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4603
STG @MR4603
RES @MR1501              ; IND1 給材P&P 給材中
CON
SET @MR1502              ; IND1 給材P&P給材完了
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4604
STG @MR4604
AND R12013               ; 給材P&P_原位置戻り完了
RES @MR1704              ; 給材PP 原位置戻り中
CON
RES MR16213              ; 給材P&P_原位置へ戻り
CON
JMP @MR4605
STG @MR4605
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4301                ; ｾﾙ内P&P給材側ｼﾌﾄ　後退限
AND R4303                ; 給材ﾁｬｯｸ 戻り限
ANB MR4305               ; Cylinder Error 4305
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4700              ; 給材P&P 1ｻｲｸﾙ終了処理
;1cycle end process
STG @MR4700              ; 給材P&P 1ｻｲｸﾙ終了処理
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD MR15008               ; IND2_除材要求
ORB R50000               ; HOLD
ORB R50213               ; IND1　　　払出し完了
ANL
JMP @MR4300              ; 給材P&P ﾒｲﾝ
MPP
LDB MR15008              ; IND2_除材要求
AND R50000               ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
RES @MR4201              ; 給材P&P　動作中
CON
ENDS
;<h1/>除材P&P動作
;Remove P&P Operation
STG @MR5000              ; 除材P&P  動作開始
MPS
LD R50210                ; Model OK
OR R50002                ; STEP
ANL
SET @MR5001              ; 除材P&P　動作中
CON
JMP @MR5100              ; 除材P&P ﾒｲﾝ
MPP
LDB R50210               ; Model OK
ANB R50002               ; STEP
ANL
ENDS
;Operation Main
STG @MR5100              ; 除材P&P ﾒｲﾝ
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
JMP @MR5101              ; 除材ﾊﾝﾄﾞ初期化
STG @MR5101              ; 除材ﾊﾝﾄﾞ初期化
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
JMP @MR5102              ; 除材要求待ち
STG @MR5102              ; 除材要求待ち
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR1508              ; IND1 除材要求
SET @MR1509              ; IND1 除材P&P除材中
CON
JMP @MR5105
MPP
ANB @MR1508              ; IND1 除材要求
MPS
LDB R50000               ; HOLD
ORB R50213               ; IND1　　　払出し完了
ANL
MPS
LDB @MR900               ; 除材P&P戻し
AND @MR009               ; 先行動作条件
ANL
JMP @MR5508              ; IND1上空へ
MPP
AND @MR900               ; 除材P&P戻し
JMP @MR5103              ; 除材P&P待機位置へ
MRD
LDB R50002               ; STEP
AND R50000               ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
RES @MR5001              ; 除材P&P　動作中
CON
ENDS
MPP
LD R50002                ; STEP
AND R50000               ; HOLD
ANL
RES @MR5001              ; 除材P&P　動作中
CON
ENDS
;先行動作で上空待機時はここで待機位置へ戻す
STG @MR5103              ; 除材P&P待機位置へ
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
JMP @MR5104
STG @MR5104
AND R12301               ; 除材P&P_PAUSE_待機位置移動完了
RES MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
RES @MR900               ; 除材P&P戻し
CON
JMP @MR5100              ; 除材P&P ﾒｲﾝ
;除材P&P　取出し位置へ / Remove P&P Move to IND1 pick up point.
STG @MR5105
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7900               ; IND1 ST1治具1(縦) 閉じ
CON
SET MR7901               ; IND1 ST1治具1(縦) 開き
CON
RES MR7902               ; IND1 ST1治具2(横) 閉じ
CON
SET MR7903               ; IND1 ST1治具2(横) 開き
CON
AND @MR012               ; IND1治具  ﾜｰｸ開放OK
JMP @MR5106
STG @MR5106
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
LD R11900                ; 給材P&P干渉外
LD @MR1704               ; 給材PP 原位置戻り中
AND< DM13056 #300        ; 給材ﾊﾝﾄﾞ現在値(整数)
ORL
ANL
SET @MR1701              ; 除材P&P動作中(PACK)
CON
SET MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5107
LD @MR5107
AND> DM13057 #355        ; 除材ﾊﾝﾄﾞ現在値(整数)
RES MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
SET MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
STG @MR5107
AND R12209               ; 除材P&P_取出上空移動完了
RES MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5108
STG @MR5108
RES MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
SET MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
MPS
LDB MR4309               ; Cylinder Error 4309
AND R4309                ; ｾﾙ内P&P  除材側ｼﾌﾄ　後退限
ANL
JMP @MR5110
MPP
AND MR4309               ; Cylinder Error 4309
RES @MR1701              ; 除材P&P動作中(PACK)
CON
JMP @MR5109
STG @MR5109
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR4309               ; Cylinder Error 4309
JMP @MR5110
STG @MR5110
SET MR16410              ; 除材P&P_取出位置下降
CON
JMP @MR5111
STG @MR5111
AND R12210               ; 除材P&P_取出位置下降完了
RES MR16410              ; 除材P&P_取出位置下降
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5200
;除材P&P　ﾜｰｸ取出し / Remove P&P Cartridge pick up.
STG @MR5200
RES MR7107               ; ｾﾙ内 除材ﾁｬｯｸ 開き
CON
SET MR7106               ; ｾﾙ内 除材ﾁｬｯｸ 閉じ
CON
MPS
AND R4310                ; 除材ﾁｬｯｸ 閉限
TMH @18 #10
CON
AND @T18
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
SET LR402                ; Cell内除材P&P ﾜｰｸ有
CON
JMP @MR5300
MPP
ANB R4310                ; 除材ﾁｬｯｸ 閉限
TMR @20 #30
CON
AND @T20
JMP @MR5201
;Err15 ﾜｰｸ未検出 / No cartridge Detect
STG @MR5201
RES MR7106               ; ｾﾙ内 除材ﾁｬｯｸ 閉じ
CON
SET MR7107               ; ｾﾙ内 除材ﾁｬｯｸ 開き
CON
AND R4311                ; 除材ﾁｬｯｸ 開限
JMP @MR5202
STG @MR5202
SET MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5203
STG @MR5203
AND R12209               ; 除材P&P_取出上空移動完了
RES MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5204
STG @MR5204
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
JMP @MR5205
STG @MR5205
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
JMP @MR5206
STG @MR5206
AND R12301               ; 除材P&P_PAUSE_待機位置移動完了
RES @MR1701              ; 除材P&P動作中(PACK)
CON
SET @MR408               ; Err17-20
CON
RES MR16501              ; 除材P&P_PAUSE_待機位置移動
CON
JMP @MR5207
STG @MR5207
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
RES @MR411               ; Err17-20解除完了
CON
JMP @MR5208
STG @MR5208
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORL
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORL
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORL
ANL
RES @MR1509              ; IND1 除材P&P除材中
CON
SET @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR5700              ; 除材P&P 1ｻｲｸﾙ終了処理
MPP
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ORL
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ORL
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ORL
ANL
SET @MR408               ; Err17-20
CON
JMP @MR5207
;除材P&P　IND3上空へ / Remove P&P Move to above IND3.
STG @MR5300
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5301
STG @MR5301
AND R11912               ; 除材P&P-INDEX Z軸干渉外
MPS
AND R4310                ; 除材ﾁｬｯｸ 閉限
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5302
MPP
ANB R4310                ; 除材ﾁｬｯｸ 閉限
SET @MR5002              ; ﾜｰｸ取出し異常有
CON
JMP @MR5302
STG @MR5302
AND R12209               ; 除材P&P_取出上空移動完了
RES MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5303
LDB R4309                ; ｾﾙ内P&P  除材側ｼﾌﾄ　後退限
TMH @8 #5
STG @MR5303
AND @T8
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5304
STG @MR5304
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
MPS
SET @MR1705              ; 除材ﾊﾝﾄﾞ 干渉外へ移動中
CON
SET MR16411              ; 除材P&P_挿入上空移動
CON
JMP @MR5305
MPP
LDA DM13057              ; 除材ﾊﾝﾄﾞ現在値(整数)
CON
SUB #100
CON
STA @DM2                 ; 除材PP移動開始確認位置
STG @MR5305
LD< DM13057 @DM2         ; 除材ﾊﾝﾄﾞ現在値(整数)  除材PP移動開始確認位置
OR R12211                ; 除材P&P_挿入上空移動完了
ANL
RES @MR1509              ; IND1 除材P&P除材中
CON
SET @MR1510              ; IND1 除材P&P除材完了
CON
JMP @MR5306
STG @MR5306
AND R12211               ; 除材P&P_挿入上空移動完了
RES MR16411              ; 除材P&P_挿入上空移動
CON
RES @MR1701              ; 除材P&P動作中(PACK)
CON
RES @MR1705              ; 除材ﾊﾝﾄﾞ 干渉外へ移動中
CON
JMP @MR5307
STG @MR5307
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
MPS
LDB @MR5002              ; ﾜｰｸ取出し異常有
AND R4310                ; 除材ﾁｬｯｸ 閉限
ANL
JMP @MR5400
MPP
LD @MR5002               ; ﾜｰｸ取出し異常有
ORB R4310                ; 除材ﾁｬｯｸ 閉限
ANL
SET @MR408               ; Err17-20
CON
JMP @MR5308              ; Err5
;Err17-20 ﾜｰｸ除材異常 / Cartridge Removing Error (ST1 PART)
STG @MR5308              ; Err5
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err17-20解除完了
JMP @MR5309
STG @MR5309
RES @MR411               ; Err17-20解除完了
CON
JMP @MR5310
STG @MR5310
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR5002              ; ﾜｰｸ取出し異常有
MPS
ANB R4310                ; 除材ﾁｬｯｸ 閉限
RES @MR1509              ; IND1 除材P&P除材中
CON
SET @MR1511              ; IND1 除材P&P除材異常完了
CON
JMP @MR5311
MPP
AND R4310                ; 除材ﾁｬｯｸ 閉限
SET @MR408               ; Err17-20
CON
JMP @MR5308              ; Err5
MPP
ANB @MR5002              ; ﾜｰｸ取出し異常有
MPS
ANB R4310                ; 除材ﾁｬｯｸ 閉限
JMP @MR5311
MPP
AND R4310                ; 除材ﾁｬｯｸ 閉限
SET @MR408               ; Err17-20
CON
JMP @MR5308              ; Err5
STG @MR5311
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES @MR5002              ; ﾜｰｸ取出し異常有
CON
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
JMP @MR5312
STG @MR5312
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16408              ; 除材P&P_原点復帰
CON
JMP @MR5313
STG @MR5313
AND R12208               ; 除材P&P_原点復帰完了
RES MR16408              ; 除材P&P_原点復帰
CON
JMP @MR5100              ; 除材P&P ﾒｲﾝ
;除材P&P　IND3にﾜｰｸｾｯﾄ / Remove P&P set Cartridge on IND3.
STG @MR5400
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
LD MR15012               ; IND3_給材要求
OR R50002                ; STEP
ANL
MPS
LDB R6000                ; IND3 ST2 ﾜｰｸ有無検出
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
ANL
SET MR15013              ; IND3_給材中
CON
SET MR16412              ; 除材P&P_挿入位置下降
CON
JMP @MR5403
MPP
AND R6000                ; IND3 ST2 ﾜｰｸ有無検出
SET @MR212               ; Err8 ST1 Err8
CON
JMP @MR5401
;Err7　IND3　ﾜｰｸ残 / Cartridge remain on IND3
STG @MR5401
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB R51600               ; Err IND3
AND @MR215               ; Err8 ST1 Err8解除完了
JMP @MR5402
STG @MR5402
RES @MR215               ; Err8 ST1 Err8解除完了
CON
JMP @MR5400
;
STG @MR5403
AND R12212               ; 除材P&P_挿入位置下降完了
MPS
RES MR16412              ; 除材P&P_挿入位置下降
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5404
MPP
BMOV DM3680 DM3700 #20   ; REMOVE PP QRID-1  IND3-ST2 QRID-1
STG @MR5404
RES MR7106               ; ｾﾙ内 除材ﾁｬｯｸ 閉じ
CON
SET MR7107               ; ｾﾙ内 除材ﾁｬｯｸ 開き
CON
MPS
LDB MR4311               ; Cylinder Error 4311
AND R4311                ; 除材ﾁｬｯｸ 開限
ANL
TMH @19 #10
CON
AND @T19
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
RES LR402                ; Cell内除材P&P ﾜｰｸ有
CON
JMP @MR5500              ; 待機位置へ
MPP
AND MR4311               ; Cylinder Error 4311
JMP @MR5500              ; 待機位置へ
;除材P&P　移動先条件分岐 / Remove P&P conditional branching.
LD R50001                ; AUTO
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R11900               ; 給材P&P干渉外
ANB @MR1501              ; IND1 給材P&P 給材中
ANB R12214               ; 除材P&P_取出上空移動完了(挿入位
LD<> @MR4009 #0          ; ﾜｰｸﾃﾞｰﾀ設定
AND CR2003               ; 常時OFF
LD<> @MR4100 #0          ; AUTO終了処理
LDP R50209               ; IND1     動作開始
LDB R50209               ; IND1     動作開始
ANP MR1011               ; INDEX監視
ORL
ANL
ORL
ANL
LD= DM832 #1             ; ST4_1ﾌｨﾙﾑ貼付有無(0=無)
OR= DM833 #1             ; ST4_2ﾌｨﾙﾑ貼付有無(0=無)
OR= DM834 #1             ; ST4_3ﾌｨﾙﾑ貼付有無(0=無)
OR= DM835 #1             ; ST4_4ﾌｨﾙﾑ貼付有無(0=無)
ANL
OUT @MR009               ; 先行動作条件
;@　除材P&P　待機位置へ / Remove P&P Move to waiting point.
STG @MR5500              ; 待機位置へ
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16413              ; 除材P&P_待機位置移動
CON
JMP @MR5501
STG @MR5501
AND R11913               ; 除材P&P-IND3 Z軸干渉外
RES MR15013              ; IND3_給材中
CON
SET MR15014              ; IND3_給材完了
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5502
STG @MR5502
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5503
STG @MR5503
AND R12213               ; 除材P&P_待機位置移動完了
RES MR16413              ; 除材P&P_待機位置移動
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5504
STG @MR5504
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR4311               ; Cylinder Error 4311
JMP @MR5615
;A　除材P&P　IND1上空へ / Remove P&P Move to above IND1.
STG @MR5508              ; IND1上空へ
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
AND R11900               ; 給材P&P干渉外
ANB @MR1501              ; IND1 給材P&P 給材中
SET @MR1509              ; IND1 除材P&P除材中
CON
SET MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5509
STG @MR5509
AND R12209               ; 除材P&P_取出上空移動完了
RES MR16409              ; 除材P&P_取出上空移動
CON
JMP @MR5510
STG @MR5510
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5100              ; 除材P&P ﾒｲﾝ
;B　除材P&P 上昇 / Remove P&P Move to wet Pos(Upper) Up.
STG @MR5600              ; 除材P&P上昇
AND R12200               ; 除材ﾊﾝﾄﾞ動作可能
SET MR16502              ; 除材P&P_PAUSE_挿入上空移動
CON
JMP @MR5601
STG @MR5601
AND R11913               ; 除材P&P-IND3 Z軸干渉外
RES MR15013              ; IND3_給材中
CON
SET MR15014              ; IND3_給材完了
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5602
STG @MR5602
RES MR7015               ; ｾﾙ内PP除材側ｼﾌﾄ　後退
CON
SET MR7014               ; ｾﾙ内PP除材側ｼﾌﾄ　前進
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5603
STG @MR5603
AND R12301               ; 除材P&P_PAUSE_待機位置移動完了
RES MR16502              ; 除材P&P_PAUSE_挿入上空移動
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5615
;
STG @MR5615
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4308                ; ｾﾙ内P&P  除材側ｼﾌﾄ　前進限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR5700              ; 除材P&P 1ｻｲｸﾙ終了処理
;1cycle end process
STG @MR5700              ; 除材P&P 1ｻｲｸﾙ終了処理
AND @MR015               ; ST1 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD @MR1508               ; IND1 除材要求
ORB R50213               ; IND1　　　払出し完了
ORB R50000               ; HOLD
ANL
JMP @MR5100              ; 除材P&P ﾒｲﾝ
MPP
LDB @MR1508              ; IND1 除材要求
AND R50213               ; IND1　　　払出し完了
AND R50000               ; HOLD
ANL
RES @MR5001              ; 除材P&P　動作中
CON
ENDS
;<h1/>Err
;Err2 原点復帰時給材P&Pﾜｰｸ残
;Err2 Cartridge remain on Supply P&P when HOME operation
STG @MR104               ; Err2 ST1 Err2
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR105               ; 105
MOV #2 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR105               ; 105
AND R50008               ; Error
JMP @MR106               ; 106
STG @MR106               ; 106
ANB R50008               ; Error
SET @MR107               ; Err2 ST1 Err2解除完了
CON
ENDS
;Err3 原点復帰時除材P&Pﾜｰｸ残
;Err3 Cartridge remain on Remove P&P when HOME operation
STG @MR108               ; Err3 ST1 Err3
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR109               ; 109
MOV #3 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR109               ; 109
AND R50008               ; Error
JMP @MR110               ; 110
STG @MR110               ; 110
ANB R50008               ; Error
SET @MR111               ; Err3 ST1 Err3解除完了
CON
ENDS
;Err4 ﾜｰｸ除材異常 IND2 ST4
;Err4 Cartridge Removing Error (IND2 ST4 PART)
STG @MR112               ; Err4 ST1 Err4
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR113               ; 113
MOV #4 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR113               ; 113
AND R50008               ; Error
JMP @MR114               ; 114
STG @MR114               ; 114
ANB R50008               ; Error
SET @MR115               ; Err4 ST1 Err4解除完了
CON
ENDS
;Err5　流動機種異常
;Err5  Production model was abnormal
STG @MR200               ; Err5 ST1 Err5
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR201               ; 201
MOV #5 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR201               ; 201
AND R50008               ; Error
JMP @MR202               ; 202
STG @MR202               ; 202
ANB R50008               ; Error
SET R50009               ; HOLDRQ
CON
SET @MR203               ; Err5 ST1 Err5解除完了
CON
ENDS
;Err6 
;Err7　ﾜｰｸ浮き異常
;Err7 Cartridge Floating
STG @MR208               ; Err7 ST1 Err7
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR209               ; 209
MOV #7 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR209               ; 209
AND R50008               ; Error
JMP @MR210               ; 210
STG @MR210               ; 210
ANB R50008               ; Error
SET @MR211               ; Err7 ST1 Err7解除完了
CON
ENDS
;Err8 IND3_ST2ﾜｰｸ残
;Err8 IND3_ST2 Cartridge remain error
STG @MR212               ; Err8 ST1 Err8
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR213               ; 213
MOV #8 DM400             ; ﾒｯｾｰｼﾞNo.
STG @MR213               ; 213
AND R50008               ; Error
JMP @MR214               ; 214
STG @MR214               ; 214
ANB R50008               ; Error
SET @MR215               ; Err8 ST1 Err8解除完了
CON
ENDS
;Err9　治具押え　押さえ動作異常
;Err9 JIG Holder holding error
;未使用
;Err10　治具押え　戻り動作異常
;Err10 JIG Holder return error
;未使用
;Err11　動作ﾊﾟﾗﾒｰﾀ設定不良
;Err11 Operation palameter error
STG @MR308               ; Err11 ST1 Err11
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR309               ; 309
MOV #11 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR309               ; 309
AND R50008               ; Error
JMP @MR310               ; 310
STG @MR310               ; 310
ANB R50008               ; Error
SET @MR311               ; Err11 ST1 Err11解除完了
CON
ENDS
;Err12 IND1 1ST除材要求
; Error-12 Cartridge remove Demand (Cartridge turning on entrance part )
STG @MR312               ; 投入口ﾜｰｸ除材要求
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR313               ; 313
MOV #12 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR313               ; 313
AND R50008               ; Error
MPS
LD @MR100                ; 除材ﾜｰｸ1有
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANL
DW #0 DM836              ; ST1_1 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR101                ; 除材ﾜｰｸ2有
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ANL
DW #0 DM837              ; ST1_2 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR102                ; 除材ﾜｰｸ3有
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ANL
DW #0 DM838              ; ST1_3 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR103                ; 除材ﾜｰｸ4有
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ANL
DW #0 DM839              ; ST1_4 ﾜｰｸ有無(0=無)回転後
MPP
JMP @MR314               ; 314
STG @MR314               ; 314
ANB R50008               ; Error
SET @MR315               ; Err12 ST1 Err12解除完了
CON
ENDS
;Err13-16 ﾜｰｸ 給材異常
;Err13-16 Cartridge Supply Error
STG @MR400               ; Err13-16
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR401               ; 401
MPS
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #13 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #14 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #15 DM400            ; ﾒｯｾｰｼﾞNo.
MPP
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #16 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR401               ; 401
AND R50008               ; Error
JMP @MR402               ; 402
STG @MR402               ; 402
ANB R50008               ; Error
SET @MR403               ; Err13-16解除完了
CON
ENDS
;Err14 ﾜｰｸ2 給材異常
;Err14 Cartridge 2 Supply Error
STG @MR404               ; Err14 ST1 Err14
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR405               ; 405
MOV #14 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR405               ; 405
AND R50008               ; Error
JMP @MR406               ; 406
STG @MR406               ; 406
ANB R50008               ; Error
SET @MR407               ; Err14 ST1 Err14解除完了
CON
ENDS
;Err17-20 除材ﾜｰｸ未検出
;Err17-20 No Cartridge Detect
STG @MR408               ; Err17-20
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR409               ; 409
MPS
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #17 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
ANB MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #18 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LDB MR16105              ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #19 DM400            ; ﾒｯｾｰｼﾞNo.
MPP
LD MR16105               ; 除材ﾜｰｸ選択 Bit-1
AND MR16106              ; 除材ﾜｰｸ選択 Bit-2
ANL
MOV #20 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR409               ; 409
AND R50008               ; Error
JMP @MR410               ; 410
STG @MR410               ; 410
ANB R50008               ; Error
SET @MR411               ; Err17-20解除完了
CON
ENDS
;Err177 ｶｰﾄﾘｯｼﾞ異常 有るはずなのに無い
;Err178 ｶｰﾄﾘｯｼﾞ異常 無いはずなのに有る
STG @MR412               ; Err16 ST1 Err16
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR413               ; 413
MPS
ANB @MR811               ; 無いはずのｶｰﾄﾘｯｼﾞを検出
MOV #177 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
AND @MR811               ; 無いはずのｶｰﾄﾘｯｼﾞを検出
MOV #178 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
LD @MR100                ; 除材ﾜｰｸ1有
ANB R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANL
DW #5 DM3611             ; ST1-OUT-No1 NGﾜｰｸ 0=OK
CON
DW #0 DM836              ; ST1_1 ﾜｰｸ有無(0=無)回転後
MRD
LDB @MR100               ; 除材ﾜｰｸ1有
AND R4100                ; IND1 ST1 ﾜｰｸ1検出(ST4側)
ANL
DW #5 DM3611             ; ST1-OUT-No1 NGﾜｰｸ 0=OK
CON
DW #1 DM836              ; ST1_1 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR101                ; 除材ﾜｰｸ2有
ANB R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ANL
DW #5 DM3631             ; ST1-OUT-No2 NGﾜｰｸ 0=OK
CON
DW #0 DM837              ; ST1_2 ﾜｰｸ有無(0=無)回転後
MRD
LDB @MR101               ; 除材ﾜｰｸ2有
AND R4101                ; IND1 ST1 ﾜｰｸ2検出(中1側)
ANL
DW #5 DM3631             ; ST1-OUT-No2 NGﾜｰｸ 0=OK
CON
DW #1 DM837              ; ST1_2 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR102                ; 除材ﾜｰｸ3有
ANB R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ANL
DW #5 DM3651             ; ST1-OUT-No3 NGﾜｰｸ 0=OK
CON
DW #0 DM838              ; ST1_3 ﾜｰｸ有無(0=無)回転後
MRD
LDB @MR102               ; 除材ﾜｰｸ3有
AND R4102                ; IND1 ST1 ﾜｰｸ3検出(中2側)
ANL
DW #5 DM3651             ; ST1-OUT-No3 NGﾜｰｸ 0=OK
CON
DW #1 DM838              ; ST1_3 ﾜｰｸ有無(0=無)回転後
MRD
LD @MR103                ; 除材ﾜｰｸ4有
ANB R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ANL
DW #5 DM3671             ; ST1-OUT-No4 NGﾜｰｸ 0=OK
CON
DW #0 DM839              ; ST1_4 ﾜｰｸ有無(0=無)回転後
MPP
LDB @MR103               ; 除材ﾜｰｸ4有
AND R4103                ; IND1 ST1 ﾜｰｸ4検出(ST2側)
ANL
DW #5 DM3671             ; ST1-OUT-No4 NGﾜｰｸ 0=OK
CON
DW #1 DM839              ; ST1_4 ﾜｰｸ有無(0=無)回転後
STG @MR413               ; 413
AND R50008               ; Error
JMP @MR414               ; 414
STG @MR414               ; 414
ANB R50008               ; Error
SET @MR415               ; Err16 ST1 Err16解除完了
CON
ENDS
;Err221 Index1 Sｶﾞｲﾄﾞ治具検出異常
;Err221 Index1 S-guide Jig error
STG @MR500               ; Err221
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
JMP @MR501               ; 501
MOV #221 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR501               ; 501
AND R50008               ; Error
JMP @MR502               ; 502
STG @MR502               ; 502
ANB R50008               ; Error
SET R50009               ; HOLDRQ
CON
SET @MR503               ; Err221解除完了
CON
ENDS
;PACKｾｯﾄ
;Pack Set
LD R15900                ; A-RB3 電源ON
LDB R12000               ; 給材ﾊﾝﾄﾞ動作可能
ORB R12200               ; 除材ﾊﾝﾄﾞ動作可能
ANL
OR R12009                ; 給材P&P_取出位置移動完了
OR R12012                ; 給材P&P_挿入位置下降完了
OR R12210                ; 除材P&P_取出位置下降完了
OR R12212                ; 除材P&P_挿入位置下降完了
OR R11815                ; RB3_原点復帰中
OR @MR1700               ; 給材P&P動作中
OR @MR1701               ; 除材P&P動作中(PACK)
OUT R50101               ; PACK ST1
END
ENDH
