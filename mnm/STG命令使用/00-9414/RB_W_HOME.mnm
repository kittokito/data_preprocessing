DEVICE:53
;MODULE:RB_W_HOME
;MODULE_TYPE:1
;***** RB Control Macro *****
;RB Type      : Weld
;RB Controler : PSEL / ASEL
;Version      : 1.00
;Date         : 2011/08/12
;ACTION 		 : 原点復帰
;<引数>
;P0 : RB_W DeviceNet入力割付先頭
;P1 : RB_W DeviceNet出力割付先頭
;P2 : ﾏｸﾛ実行完了ﾌﾗｸﾞ
;P3 : 結果ｺｰﾄﾞ
;P4 : ｿﾌﾄ非常停止信号
;V0 : ﾀｲﾑｱｳﾄ設定(ms) 
;
;<結果ｺｰﾄﾞ一覧>
;#20 : 正常完了
;#21 : 応答なし
;#22 : RBステータス異常
;#23 : 設定異常
LD @CR2008
RES P2                   ; End_Flag
CON
DW #0 P3                 ; Result_Code
CON
SET @MR000
;ﾌﾟﾛｸﾞﾗﾑﾘｾｯﾄ
STG @MR000
SET P1:#2                ; RB_DV_OUT
CON
TMH @0 #100
CON
AND @T0
RES P1:#2                ; RB_DV_OUT
CON
JMP @MR001
STG @MR001
SET P1:#6                ; RB_DV_OUT
CON
TMH @1 #100
CON
AND @T1
JMP @MR002
STG @MR002
MPS
LD P0:#0                 ; RB_DV_IN
AND P0:#1                ; RB_DV_IN
ANL
JMP @MR003
MPP
LDB P0:#0                ; RB_DV_IN
ORB P0:#1                ; RB_DV_IN
ANL
TMH @2 #100
CON
AND @T2
DW #22 P3                ; Result_Code
CON
JMP @MR015
;HOME
STG @MR003
MPS
AND P0:#6                ; RB_DV_IN
SET P1:#7                ; RB_DV_OUT
CON
JMP @MR004
MPP
TMR @3 V0                ; TIMEOUT
CON
AND @T3
DW #21 P3                ; Result_Code
CON
JMP @MR015
STG @MR004
MPS
AND P0:#7                ; RB_DV_IN
RES P1:#7                ; RB_DV_OUT
CON
JMP @MR005
MPP
TMR @4 V0                ; TIMEOUT
CON
AND @T4
DW #21 P3                ; Result_Code
CON
JMP @MR015
STG @MR005
DW #1 P1:#48             ; RB_DV_OUT
CON
JMP @MR006
STG @MR006
TMH @5 #20
CON
AND @T5
JMP @MR007
STG @MR007
MPS
LDB P0:#7                ; RB_DV_IN
AND P0:#6                ; RB_DV_IN
ANL
SET P1:#10               ; RB_DV_OUT
CON
JMP @MR008
MPP
TMR @6 V0                ; TIMEOUT
CON
AND @T6
DW #21 P3                ; Result_Code
CON
JMP @MR015
STG @MR008
MPS
AND P0:#7                ; RB_DV_IN
RES P1:#10               ; RB_DV_OUT
CON
JMP @MR009
MPP
TMR @7 V0                ; TIMEOUT
CON
AND @T7
DW #21 P3                ; Result_Code
CON
JMP @MR015
STG @MR009
DW #20 P3                ; Result_Code
CON
JMP @MR015
STG @MR015
RES P1:#10               ; RB_DV_OUT
CON
RES P1:#7                ; RB_DV_OUT
CON
SET P2                   ; End_Flag
CON
ENDS
;終了処理
LD P4                    ; EMG_Flag
ZRES @MR000 @MR115
LD P2                    ; End_Flag
OR P4                    ; EMG_Flag
MEND
END
ENDH
