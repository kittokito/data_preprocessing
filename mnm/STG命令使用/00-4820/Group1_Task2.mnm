DEVICE:53
;MODULE:Group1_Task2
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task2
;ModuleType	:	Main Module
;Line		:	F2 PZT 固定ﾌﾟﾚｰﾄ接着組立ﾗｲﾝ
;Cell		:   ﾄﾚｲﾁｪﾝｼﾞｬｰ
;Function	:	加圧冶具搬送
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000～@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100～@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000～@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000～@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000～@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000～@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500～@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ　※状況により増設してください。
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG～JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @MR100 @MR6415      ; Task2 ERROR
LD= DM60000 MyTask       ; TaskNo /ERROR_DISP  自ﾀｽｸ番号
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK2　ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM616.U,EM617.U,@MR000.U,@MR3000.U
;
;FOR EM616 = EM616 TO 160 STEP 16
;	IF @MR3000:EM616 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM616 < 160 THEN
;	EM617 = (EM616 / 16) * 100 + DMX(@MR3000:EM616) + #3000
;END IF		
;		
;EM616 = EM616 + 16		
;IF EM616 > 160 THEN		
;	EM616 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM616.U,EM617.U,@MR000.U,@MR3000.U
;
;FOR EM616 = EM616 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM616 EM616          ; Task2 Main1@MR  Task2 Main1@MR
LABEL #2000
LD> EM616 #160           ; Task2 Main1@MR
CJ #2001
;	IF @MR3000:EM616 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0      ; AUTO Main1
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
ADD #16
CON
STA EM616                ; Task2 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM616 < 160 THEN
;
LD< EM616 #160           ; Task2 Main1@MR
NCJ #2004
;	EM617 = (EM616 / 16) * 100 + DMX(@MR3000:EM616) + #3000
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12          ; AUTO Main1
CON
DMX
CON
STA @VM0
CON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM617                ; Task2 Main1@MR
;END IF		
;
LABEL #2004
;EM616 = EM616 + 16		
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM616                ; Task2 Main1@MR
;IF EM616 > 160 THEN		
;
LD> EM616 #160           ; Task2 Main1@MR
NCJ #2005
;	EM616 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM616             ; Task2 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM618.U,EM619.U,@MR4000.U
;
;FOR EM618 = EM618 TO 80 STEP 16
;	IF @MR4000:EM618 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM618 < 80 THEN
;	EM619 = (EM618 / 16) * 100 + DMX(@MR4000:EM618) + #4000
;END IF
;
;EM618 = EM618 + 16		
;
;IF EM618 > 80 THEN
;	EM618 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM618.U,EM619.U,@MR4000.U
;
;FOR EM618 = EM618 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM618 EM618          ; Task2 Main2@MR  Task2 Main2@MR
LABEL #2006
LD> EM618 #80            ; Task2 Main2@MR
CJ #2007
;	IF @MR4000:EM618 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0      ; AUTO Main2
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
ADD #16
CON
STA EM618                ; Task2 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM618 < 80 THEN
;
LD< EM618 #80            ; Task2 Main2@MR
NCJ #2010
;	EM619 = (EM618 / 16) * 100 + DMX(@MR4000:EM618) + #4000
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12          ; AUTO Main2
CON
DMX
CON
STA @VM3
CON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM619                ; Task2 Main2@MR
;END IF
;
LABEL #2010
;EM618 = EM618 + 16		
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM618                ; Task2 Main2@MR
;IF EM618 > 80 THEN
;
LD> EM618 #80            ; Task2 Main2@MR
NCJ #2011
;	EM618 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM618             ; Task2 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM620.U,EM621.U,@MR4500.U
;	
;FOR EM620 = EM620 TO 320 STEP 16
;	IF @MR4500:EM620 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM620 < 320 THEN
;	EM621 = (EM620 / 16) * 100 + DMX(@MR4500:EM620) + #4500
;END IF
;		
;EM620 = EM620 + 16	
;
;IF EM620 > 320 THEN
;   EM620 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM620.U,EM621.U,@MR4500.U
;
;FOR EM620 = EM620 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM620 EM620          ; Task2 Sub@MR  Task2 Sub@MR
LABEL #2012
LD> EM620 #320           ; Task2 Sub@MR
CJ #2013
;	IF @MR4500:EM620 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; ①SUB_RB1_MOVE
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
ADD #16
CON
STA EM620                ; Task2 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM620 < 320 THEN
;
LD< EM620 #320           ; Task2 Sub@MR
NCJ #2016
;	EM621 = (EM620 / 16) * 100 + DMX(@MR4500:EM620) + #4500
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; ①SUB_RB1_MOVE
CON
DMX
CON
STA @VM6
CON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM621                ; Task2 Sub@MR
;END IF
;
LABEL #2016
;EM620 = EM620 + 16	
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM620                ; Task2 Sub@MR
;IF EM620 > 320 THEN
;
LD> EM620 #320           ; Task2 Sub@MR
NCJ #2017
;   EM620 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM620             ; Task2 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR802                ; _Grp1_Task2_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR402                ; _Grp1_Task2_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5202               ; _Grp1_Task2_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5402               ; _Grp1_Task2_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5602               ; _Grp1_Task2_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR602                ; _Grp1_Task2_Fin.STG
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
RES R41002               ; Grp1_Task2_起動中ﾌﾗｸﾞ
CON
ENDS
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>■HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5202               ; _Grp1_Task2_HOME.STG
JMP @MR1000              ; HOME
STG @MR1000              ; HOME
RES MR20002              ; TASK2復帰完了
CON
SET @MR1002              ; Home中
CON
JMP @MR1003
;<h1/>H1：原点復帰開始条件待ち
;ｽｶﾗRB、給除材ｴﾚﾍﾞｰﾀｰが復帰完了
STG @MR1003
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20000              ; TASK0復帰完了
AND MR20001              ; TASK1復帰完了
AND MR20003              ; TASK3復帰完了
ANL
JMP @MR1004
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>H2：位置決めｼﾘﾝﾀﾞ復帰
;ﾄﾚｲ位置決め前後ｼﾘﾝﾀﾞ復帰
STG @MR1004
RES MR7300               ; 加圧冶具給材_ﾄﾚｲ位置決め前進
CON
SET MR7301               ; 加圧冶具給材_ﾄﾚｲ位置決め後退
CON
MPS
LDB MR4511               ; 加圧冶具_ﾄﾚｲ位置決め_後限ERR
ANB R4510                ; 加圧冶具_ﾄﾚｲ位置決め_前限
AND R4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限
ANL
JMP @MR1005
MPP
LD MR4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲ位置決め上下ｼﾘﾝﾀﾞ復帰
STG @MR1005
RES MR7302               ; 加圧冶具給材_ﾄﾚｲ位置決め上昇
CON
SET MR7303               ; 加圧冶具給材_ﾄﾚｲ位置決め下降
CON
MPS
LDB MR4507               ; 加圧冶具_ﾄﾚｲ位置決_奥_下限ER
ANB MR4509               ; 加圧冶具_ﾄﾚｲ位置決_前_下限ER
ANB R4506                ; 加圧冶具_ﾄﾚｲ位置決め_奥_上限
AND R4507                ; 加圧冶具_ﾄﾚｲ位置決め_奥_下限
ANB R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
AND R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
ANL
JMP @MR1006
MPP
LD MR4507                ; 加圧冶具_ﾄﾚｲ位置決_奥_下限ER
OR MR4509                ; 加圧冶具_ﾄﾚｲ位置決_前_下限ER
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>H3：給材側ｼﾘﾝﾀﾞ復帰&ﾄﾚｲ確認
;給材側ｼﾘﾝﾀﾞ前後確認
LDB R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
OUT @MR800               ; 全給材ﾁｬｯｸ_後退
STG @MR1006
MPS
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41202               ; TASK2 PAUSE 要求
MPS
ANB @MR800               ; 全給材ﾁｬｯｸ_後退
JMP @MR1008              ; 給材側ｼﾘﾝﾀﾞ前進状態から復帰
MPP
AND @MR800               ; 全給材ﾁｬｯｸ_後退
JMP @MR1011              ; 給材側ｼﾘﾝﾀﾞ後退状態から復帰
;<h1/>H3-1：給材側ｼﾘﾝﾀﾞ前進状態から復帰
;→ﾁｬｯｸを閉じて、上昇させる。この時点ではﾄﾚｲを掴んでいるかは不明
;給材側ﾄﾚｲﾁｬｯｸ前進
STG @MR1008              ; 給材側ｼﾘﾝﾀﾞ前進状態から復帰
RES MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
SET MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
MPS
LDB MR4108               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
ANB MR4110               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
ANB MR4112               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
ANB MR4114               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
ANB R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
AND R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
ANB R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
AND R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
ANB R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
AND R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
ANB R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR1009
MPP
LD MR4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
OR MR4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
OR MR4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
OR MR4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾁｬｯｸ閉
STG @MR1009
RES MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
SET MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
MPS
LDB MR4100               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
ANB MR4102               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
ANB MR4104               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
ANB MR4106               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
ANB R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
AND R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
ANB R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
AND R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
ANB R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
AND R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
ANB R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR1010
MPP
LD MR4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
OR MR4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
OR MR4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
OR MR4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲ有無記憶ｾｯﾄ
STG @MR1010
MPS
AND<> @DM10 #1           ; 給材側ﾄﾚｲ情報(0不明1有2無)
DW #0 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR1100              ; 共通_給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
MPP
AND= @DM10 #1            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR1100              ; 共通_給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
;<h1/>H3-2：給材側ｼﾘﾝﾀﾞ後退状態から復帰
;→ﾁｬｯｸを開いて、上昇させる。ﾁｬｯｸﾄﾚｲ無し
;給材側ﾁｬｯｸ後退
STG @MR1011              ; 給材側ｼﾘﾝﾀﾞ後退状態から復帰
RES MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4109               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4111               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4113               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4115               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR1012
MPP
LD MR4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ開
STG @MR1012
RES MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4101               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4103               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4105               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4107               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR1100              ; 共通_給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
MPP
LD MR4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>H4：給材側ﾄﾚｲﾁｬｯｸ上昇
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR1100              ; 共通_給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
RES MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4201               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4205               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4209               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4213               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR1101
MPP
LD MR4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ上下子_上昇
STG @MR1101
RES MR7406               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7407               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_上昇
CON
MPS
LDB MR4203               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4207               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4211               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4215               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR1200              ; 除材側ｼﾘﾝﾀﾞ復帰&ﾄﾚｲ確認
MPP
LD MR4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
OR MR4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
OR MR4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限E
OR MR4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>H5：除材側ｼﾘﾝﾀﾞ復帰&ﾄﾚｲ確認
;除材側ｼﾘﾝﾀﾞ前後確認
LDB R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
OUT @MR801               ; 全除材側ﾁｬｯｸ_後退
STG @MR1200              ; 除材側ｼﾘﾝﾀﾞ復帰&ﾄﾚｲ確認
MPS
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41202               ; TASK2 PAUSE 要求
MPS
ANB @MR801               ; 全除材側ﾁｬｯｸ_後退
JMP @MR1201              ; 除材側ｼﾘﾝﾀﾞ前進状態から復帰
MPP
AND @MR801               ; 全除材側ﾁｬｯｸ_後退
JMP @MR1204              ; 除材側ｼﾘﾝﾀﾞ後退状態から復帰
;<h1/>H5-1：除材側ｼﾘﾝﾀﾞ前進状態から復帰
;→ﾁｬｯｸを閉じて、上昇させる。この時点ではﾄﾚｲを掴んでいるかは不明
;除材側ﾁｬｯｸ前進
STG @MR1201              ; 除材側ｼﾘﾝﾀﾞ前進状態から復帰
RES MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
SET MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
MPS
LDB MR4308               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
ANB MR4310               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
ANB MR4312               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
ANB MR4314               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
ANB R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
AND R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
ANB R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
AND R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
ANB R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
AND R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
ANB R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR1202
MPP
LD MR4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
OR MR4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
OR MR4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
OR MR4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ閉
STG @MR1202
RES MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
SET MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
MPS
LDB MR4300               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
ANB MR4302               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
ANB MR4304               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
ANB MR4306               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
ANB R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
AND R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
ANB R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
AND R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
ANB R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
AND R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
ANB R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR1203
MPP
LD MR4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
OR MR4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
OR MR4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
OR MR4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR1203
MPS
AND<> @DM11 #1           ; 除材側ﾄﾚｲ情報(0不明1有2無)
DW #0 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR1300              ; 共通_除材側ﾄﾚｲﾁｬｯｸ上下親_上昇
MPP
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR1300              ; 共通_除材側ﾄﾚｲﾁｬｯｸ上下親_上昇
;<h1/>H5-2：除材側ｼﾘﾝﾀﾞ後退状態から復帰
;→ﾁｬｯｸを開いて、上昇させる。ﾁｬｯｸﾄﾚｲ無し
;除材側ﾁｬｯｸ後退
STG @MR1204              ; 除材側ｼﾘﾝﾀﾞ後退状態から復帰
RES MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4309               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4311               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4313               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4315               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR1205
MPP
LD MR4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲﾁｬｯｸ開
STG @MR1205
RES MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4301               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4303               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4305               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4307               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR1300              ; 共通_除材側ﾄﾚｲﾁｬｯｸ上下親_上昇
MPP
LD MR4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>H6：除材側ﾄﾚｲﾁｬｯｸ上昇
;除材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR1300              ; 共通_除材側ﾄﾚｲﾁｬｯｸ上下親_上昇
RES MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4401               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4405               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR1301
MPP
LD MR4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲﾁｬｯｸ上下子_上昇
STG @MR1301
RES MR7414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_上昇
CON
MPS
LDB MR4403               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4407               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR1400
MPP
LD MR4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
OR MR4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
OR MR4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
OR MR4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>H7：ﾄﾚｲ有無確認
STG @MR1400
SET @MR4700              ; ③SUB_HOME_ﾄﾚｲ有無確認
CON
JMP @MR1401
STG @MR1401
AND @MR4701              ; ③SUB_HOME_ﾄﾚｲ有無確認完了
RES @MR4701              ; ③SUB_HOME_ﾄﾚｲ有無確認完了
CON
JMP @MR1402
;給材ﾁｬｯｸにﾄﾚｲが無い時、加圧冶具先行取出し記憶をｸﾘｱ
LD @MR1402
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
RES DM11427.1
;RB1移動分岐_ﾄﾚｲ情報より
;POS1:給材側
;POS2:除材側
;POS3:ｽｶﾗ渡し
STG @MR1402
MPS
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
MPS
AND= @DM12 #2            ; RB1ﾄﾚｲ情報(0不明1有2無)
DW #2 EM1300             ; RB1Target Pos
MPP
AND= @DM12 #1            ; RB1ﾄﾚｲ情報(0不明1有2無)
MPS
AND= DM11400 #99         ; RB1ﾄﾚｲ処理状況(0未処理99終了)
DW #2 EM1300             ; RB1Target Pos
MPP
AND= DM11400 #0          ; RB1ﾄﾚｲ処理状況(0未処理99終了)
DW #3 EM1300             ; RB1Target Pos
MRD
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
DW #2 EM1300             ; RB1Target Pos
MRD
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
DW #1 EM1300             ; RB1Target Pos
MRD
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM12 #2            ; RB1ﾄﾚｲ情報(0不明1有2無)
ANL
DW #1 EM1300             ; RB1Target Pos
MPP
JMP @MR1403
;<h1/>H8：RB1ﾄﾚｲ搬送移動
STG @MR1403
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR1404
STG @MR1404
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR1514
;<h1/>H_END：原点復帰終了
STG @MR1514
SET MR20002              ; TASK2復帰完了
CON
JMP @MR1515
STG @MR1515
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
RES @MR1002              ; Home中
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>■AUTO/自動動作
STG LR5402               ; _Grp1_Task2_AUTO.STG
JMP @MR3000              ; AUTO Main1
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1～32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000              ; AUTO Main1
MPS
ANB R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
MPS
ANB R57302               ; Task2 停止要求
MPS
LD= W2021 W2031          ; CAV機種番号1：CL_2：BK  ﾄﾚﾁｪﾝ機種番号1：CL_2：BK
AND= W2022 W2031         ; 転写機種番号1：CL_2：BK  ﾄﾚﾁｪﾝ機種番号1：CL_2：BK
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR DM2000.1              ; 上流OFFLINE
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
SET @MR3002              ; AUTO Main1 Busy
CON
JMP @MR3003
MPP
LD<> W2021 W2031         ; CAV機種番号1：CL_2：BK  ﾄﾚﾁｪﾝ機種番号1：CL_2：BK
OR<> W2022 W2031         ; 転写機種番号1：CL_2：BK  ﾄﾚﾁｪﾝ機種番号1：CL_2：BK
ANB DM2000.1             ; 上流OFFLINE
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR3915              ; AUTO END
MPP
AND R57302               ; Task2 停止要求
JMP @MR3915              ; AUTO END
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR3915              ; AUTO END
;<h1/>A-0：加圧冶具数確認
STG @MR3003
MPS
AND DM2000.1             ; 上流OFFLINE
JMP @MR3011              ; ●ﾄﾚｲ状況分岐STG
MPP
ANB DM2000.1             ; 上流OFFLINE
MPS
AND= @DM12 #1            ; RB1ﾄﾚｲ情報(0不明1有2無)
JMP @MR3005
MPP
AND= @DM12 #2            ; RB1ﾄﾚｲ情報(0不明1有2無)
MPS
LDB B3614                ; Index->TC 加圧冶具有無ｲﾝﾃﾞｯｸｽ側
ANB B3615                ; Index->TC 加圧冶具有無排出位置
ANB B3616                ; Index->TC 加圧冶具有無測定位置
ANL
JMP @MR3004
MPP
LD B3614                 ; Index->TC 加圧冶具有無ｲﾝﾃﾞｯｸｽ側
OR B3615                 ; Index->TC 加圧冶具有無排出位置
OR B3616                 ; Index->TC 加圧冶具有無測定位置
ANL
JMP @MR3009
STG @MR3004
SET MR20015              ; 加圧冶具数確認済み
CON
JMP @MR3011              ; ●ﾄﾚｲ状況分岐STG
;ﾄﾚﾁｪﾝ保持_加圧冶具数
LDP @MR3005
MPS
LDA DM11408              ; 加圧ﾄﾚｲﾜｰｸ有無記憶1-10_ON有
CON
BCNT
CON
STA @DM13                ; 加圧冶具1-10個数
MRD
LDA DM11409              ; 加圧ﾄﾚｲﾜｰｸ有無記憶11-20_ON有
CON
BCNT
CON
STA @DM14                ; 加圧冶具11-20個数
MRD
LDA DM11410              ; 加圧ﾄﾚｲﾜｰｸ有無記憶21-28_ON有
CON
BCNT
CON
STA @DM15                ; 加圧冶具21-28個数
MRD
LDA @DM13                ; 加圧冶具1-10個数
CON
ADD @DM14                ; 加圧冶具11-20個数
CON
ADD @DM15                ; 加圧冶具21-28個数
CON
STA @DM16                ; 加圧冶具ﾄﾚﾁｪﾝ保持総数
MPP
AND<> DM11417 #0         ; 加圧冶具情報：0無1空2完3NG
@INC @DM16               ; 加圧冶具ﾄﾚﾁｪﾝ保持総数
;組立装置_加圧冶具数
LDP @MR3005
DW #0 @DM17              ; 組立装置内_加圧冶具数
MPS
AND B3614                ; Index->TC 加圧冶具有無ｲﾝﾃﾞｯｸｽ側
@INC @DM17               ; 組立装置内_加圧冶具数
MRD
AND B3615                ; Index->TC 加圧冶具有無排出位置
@INC @DM17               ; 組立装置内_加圧冶具数
MPP
AND B3616                ; Index->TC 加圧冶具有無測定位置
@INC @DM17               ; 組立装置内_加圧冶具数
;組立装置&ﾄﾚﾁｪﾝ_加圧冶具数
LDP @MR3005
LDA @DM16                ; 加圧冶具ﾄﾚﾁｪﾝ保持総数
CON
ADD @DM17                ; 組立装置内_加圧冶具数
CON
STA @DM18                ; 組立装置との合計数
STG @MR3005
JMP @MR3006
;加圧冶具数判断
STG @MR3006
MPS
AND<= @DM18 #28          ; 組立装置との合計数
JMP @MR3004
MPP
AND> @DM18 #28           ; 組立装置との合計数
MPS
AND> @DM18 #29           ; 組立装置との合計数
JMP @MR3009
MPP
AND= @DM18 #29           ; 組立装置との合計数
MPS
ANB DM11427.1
JMP @MR3009
MPP
AND DM11427.1
MPS
AND= @DM10 #1            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR3004
MPP
AND<> @DM10 #1           ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR3009
;加圧冶具数不一致
STG @MR3009
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET MR20014              ; 自動停止
CON
SET R39004               ; ｴﾗｰ中
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #106 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3010
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3010
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3915              ; AUTO END
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>A1:ﾄﾚｲ状況分岐
;給材ﾁｬｯｸ、除材ﾁｬｯｸ、RB1上の3箇所のﾄﾚｲ情報より分岐
;注：3箇所同時にﾄﾚｲは存在できない(干渉する為)
;
;動作の流れ
;A:給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
;↓
;B:給材ﾁｬｯｸからﾄﾚｲ受取
;↓
;C:RB1_ﾜｰｸ受渡し位置へ
;↓
;D:RB1_ﾄﾚｲ除材位置へ
;↓
;E:除材側受渡し前_RB1_給材側移動
STG @MR3011              ; ●ﾄﾚｲ状況分岐STG
MPS
AND= @DM12 #2            ; RB1ﾄﾚｲ情報(0不明1有2無)
MPS
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
MPS
ANB R57302               ; Task2 停止要求
JMP @MR3012              ; A:給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
MPP
AND R57302               ; Task2 停止要求
JMP @MR3915              ; AUTO END
MRD
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR3100              ; B:給材ﾁｬｯｸからﾄﾚｲ受取
MPP
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR3506              ; E:除材側受渡し前_RB1_給材側移動
MPP
AND= @DM12 #1            ; RB1ﾄﾚｲ情報(0不明1有2無)
MPS
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ORL
ANL
MPS
AND<> DM11400 #99        ; RB1ﾄﾚｲ処理状況(0未処理99終了)
JMP @MR3200              ; C:RB1_ﾜｰｸ受渡し位置へ
MPP
AND= DM11400 #99         ; RB1ﾄﾚｲ処理状況(0未処理99終了)
JMP @MR3400              ; D:RB1_ﾄﾚｲ除材位置へ
MPP
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR3506              ; E:除材側受渡し前_RB1_給材側移動
;<h1/>A1-A：給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
;RB1_除材側移動
STG @MR3012              ; A:給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ANL
DW #2 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR3013
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3013
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR3014
;④SUB起動
STG @MR3014
SET @MR5100              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取
CON
JMP @MR3015
STG @MR3015
AND @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
RES @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
CON
MPS
ANB @MR902               ; TASK1停止_ﾄﾚｲ受取無し
JMP @MR3100              ; B:給材ﾁｬｯｸからﾄﾚｲ受取
MPP
AND @MR902               ; TASK1停止_ﾄﾚｲ受取無し
RES @MR902               ; TASK1停止_ﾄﾚｲ受取無し
CON
JMP @MR3011              ; ●ﾄﾚｲ状況分岐STG
;<h1/>A1-B：給材ﾁｬｯｸからﾄﾚｲ受取
;RB1_給材側移動
STG @MR3100              ; B:給材ﾁｬｯｸからﾄﾚｲ受取
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ANL
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR3101
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3101
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR3102
;給材ﾁｬｯｸからRB1へﾄﾚｲ受渡し
STG @MR3102
SET @MR5300              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡
CON
JMP @MR3103
;※加圧冶具取出し番号を1にｾｯﾄ
;ﾜｰｸ有無記憶をｾｯﾄ
;・1-10個目→D11408の1-10ﾋﾞｯﾄ(＃2046で1-10ﾋﾞｯﾄのみON)
;・11-20個目→D11409の1-10ﾋﾞｯﾄ(＃2046で1-10ﾋﾞｯﾄのみON)
;・21-28個目→D11410の1-8ﾋﾞｯﾄ(＃510で1-8ﾋﾞｯﾄのみON)
;完成品ｾｯﾄ記憶をﾘｾｯﾄ
STG @MR3103
AND @MR5301              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡完了
DW #1 DM11406            ; 加圧冶具目標位置
CON
DW #2046 DM11408         ; 加圧ﾄﾚｲﾜｰｸ有無記憶1-10_ON有
CON
DW #2046 DM11409         ; 加圧ﾄﾚｲﾜｰｸ有無記憶11-20_ON有
CON
DW #510 DM11410          ; 加圧ﾄﾚｲﾜｰｸ有無記憶21-28_ON有
CON
DW #0 DM11400            ; RB1ﾄﾚｲ処理状況(0未処理99終了)
CON
DW #0 DM11421            ; 加圧冶具完成品ｾｯﾄ番号
CON
DW #0 DM11426            ; 加圧冶具取出番号記憶
CON
DW #0 DM11423            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶1-10_ON済
CON
DW #0 DM11424            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶11-20_ON済
CON
DW #0 DM11425            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶21-28_ON済
CON
DW #28 DM11428           ; 完成品ｾｯﾄ必要数
CON
RES @MR5301              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡完了
CON
MPS
ANB DM11427.1
JMP @MR3200              ; C:RB1_ﾜｰｸ受渡し位置へ
MPP
AND DM11427.1
JMP @MR3104
;※先行取出し記憶有り
;1個目の加圧冶具が無い→D11408の1ﾋﾞｯﾄ目をOFF(冶具無し)
STG @MR3104
RES DM11408.1
CON
DW #1 DM11426            ; 加圧冶具取出番号記憶
CON
RES DM11427.1
CON
JMP @MR3200              ; C:RB1_ﾜｰｸ受渡し位置へ
;<h1/>A1-C：RB1_ﾜｰｸ受渡し位置へ
STG @MR3200              ; C:RB1_ﾜｰｸ受渡し位置へ
MPS
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ANL
DW #3 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR3202
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
MPP
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND= DM4110 #9           ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2914
STG @MR3202
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR3203
;TASK0へ準備完了
STG @MR3203
MPS
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
RES R47000               ; _処理時間1計測開始
CON
SET MR20300              ; T2→T0加圧冶具ﾄﾚｲ取出投入OK
CON
JMP @MR3204
MPP
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @14 #20
CON
AND @T14
DW #2 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR3011              ; ●ﾄﾚｲ状況分岐STG
;<h1/>A1-C1：ｽｶﾗよりﾄﾚｲﾁｪﾝｼﾞ要求待ち
STG @MR3204
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
LDB R57302               ; Task2 停止要求
OR MR20203               ; 払出し停止
ANL
MPS
LDB MR20101              ; 加圧冶具先行取出しﾌﾗｸﾞ
OR MR20113               ; 加圧冶具先行取出し準備ok
ANL
MPS
LD MR20301               ; T0→T2ﾄﾚｲ排出要求
ANB MR20203              ; 払出し停止
ANB MR20014              ; 自動停止
ANL
SET R47000               ; _処理時間1計測開始
CON
RES MR20300              ; T2→T0加圧冶具ﾄﾚｲ取出投入OK
CON
JMP @MR3205
MPP
LD MR20203               ; 払出し停止
AND MR20014              ; 自動停止
ANB MR20301              ; T0→T2ﾄﾚｲ排出要求
ANL
RES MR20300              ; T2→T0加圧冶具ﾄﾚｲ取出投入OK
CON
JMP @MR3205
MPP
LDB MR20113              ; 加圧冶具先行取出し準備ok
AND MR20101              ; 加圧冶具先行取出しﾌﾗｸﾞ
AND MR20500              ; T1→T2_給材EV頭出し済
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR3300
MPP
LD R57302                ; Task2 停止要求
ANB MR20203              ; 払出し停止
ANL
RES MR20300              ; T2→T0加圧冶具ﾄﾚｲ取出投入OK
CON
JMP @MR3915              ; AUTO END
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3205
RES MR20113              ; 加圧冶具先行取出し準備ok
CON
ANB MR20301              ; T0→T2ﾄﾚｲ排出要求
DW #99 DM11400           ; RB1ﾄﾚｲ処理状況(0未処理99終了)
CON
JMP @MR3400              ; D:RB1_ﾄﾚｲ除材位置へ
;<h1/>A1-C2：ｽｶﾗ加圧冶具先行取出し
;給材側ﾁｬｯｸ_ﾄﾚｲ受取動作(ｴﾚﾍﾞｰﾀｰから)
STG @MR3300
SET @MR5100              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取
CON
JMP @MR3301
STG @MR3301
AND @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
RES @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
CON
JMP @MR3302
STG @MR3302
SET MR20113              ; 加圧冶具先行取出し準備ok
CON
JMP @MR3204
;<h1/>A1-D：RB1_ﾄﾚｲ除材位置へ
STG @MR3400              ; D:RB1_ﾄﾚｲ除材位置へ
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ANL
DW #2 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR3401
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3401
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR3402
;<h1/>☆1_並列処理1_開始分岐
;給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
;※条件1：給材側のﾄﾚｲ無し
;  条件2：給材ｴﾚﾍﾞｰﾀｰが頭出し完了(ﾄﾚｲの受渡しが可能)
;条件外の場合には、並列動作しない。
STG @MR3402
MPS
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
ANB MR20203              ; 払出し停止
AND MR20500              ; T1→T2_給材EV頭出し済
ANL
MPS
ANB R57302               ; Task2 停止要求
SET @MR900               ; ☆1並列実行ﾌﾗｸﾞ
CON
SET @MR5100              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取
CON
JMP @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
MPP
AND R57302               ; Task2 停止要求
JMP @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
MPP
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
ORB MR20500              ; T1→T2_給材EV頭出し済
OR MR20203               ; 払出し停止
ANL
RES @MR900               ; ☆1並列実行ﾌﾗｸﾞ
CON
JMP @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
;除材側搬送後、ﾄﾚｲ有無確認
STG @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
MPS
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
JMP @MR3500
MPP
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @0 #5                ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
CON
AND @T0                  ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
JMP @MR3404              ; ERR63
;ERR63_除材側搬送後、ﾄﾚｲ無異常
STG @MR3404              ; ERR63
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #103 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4504 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3405
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3405
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3403              ; 除材側搬送後、ﾄﾚｲ有無確認
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲﾁｬｯｸ上下子_下降
STG @MR3500
RES MR7415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_上昇
CON
SET MR7414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_下降
CON
MPS
LDB MR4402               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
ANB MR4406               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
ANB MR4410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限E
ANB MR4414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限E
AND R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
ANB R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
AND R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
ANB R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
AND R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
ANB R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
AND R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
ANB R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR3501
MPP
LD MR4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
OR MR4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
OR MR4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限E
OR MR4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ前進
STG @MR3501
RES MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
SET MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
MPS
LDB MR4308               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
ANB MR4310               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
ANB MR4312               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
ANB MR4314               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
ANB R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
AND R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
ANB R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
AND R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
ANB R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
AND R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
ANB R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR3502
MPP
LD MR4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
OR MR4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
OR MR4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
OR MR4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ閉
STG @MR3502
RES MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
SET MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
MPS
LDB MR4300               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
ANB MR4302               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
ANB MR4304               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
ANB MR4306               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
ANB R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
AND R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
ANB R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
AND R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
ANB R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
AND R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
ANB R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR3503
MPP
LD MR4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
OR MR4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
OR MR4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
OR MR4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲﾁｬｯｸ上下子_上昇
STG @MR3503
RES MR7414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_上昇
CON
MPS
LDB MR4403               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4407               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
DW #2 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
DW #1 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
DW #0 DM11408            ; 加圧ﾄﾚｲﾜｰｸ有無記憶1-10_ON有
CON
DW #0 DM11409            ; 加圧ﾄﾚｲﾜｰｸ有無記憶11-20_ON有
CON
DW #0 DM11410            ; 加圧ﾄﾚｲﾜｰｸ有無記憶21-28_ON有
CON
DW #0 DM11423            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶1-10_ON済
CON
DW #0 DM11424            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶11-20_ON済
CON
DW #0 DM11425            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶21-28_ON済
CON
JMP @MR3504
MPP
LD MR4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
OR MR4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
OR MR4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
OR MR4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>☆1_並列処理1_完了確認
;給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
;※並列実行していない場合にはｽﾙｰ
STG @MR3504
MPS
LD @MR900                ; ☆1並列実行ﾌﾗｸﾞ
AND @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
ANL
MPS
ANB @MR902               ; TASK1停止_ﾄﾚｲ受取無し
JMP @MR3505
MPP
AND @MR902               ; TASK1停止_ﾄﾚｲ受取無し
RES @MR902               ; TASK1停止_ﾄﾚｲ受取無し
MPP
ANB @MR900               ; ☆1並列実行ﾌﾗｸﾞ
JMP @MR3506              ; E:除材側受渡し前_RB1_給材側移動
STG @MR3505
RES @MR900               ; ☆1並列実行ﾌﾗｸﾞ
CON
RES @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
CON
JMP @MR3506              ; E:除材側受渡し前_RB1_給材側移動
;<h1/>A1-E：ﾄﾚｲ除材側受渡し
;RB1_給材側移動
STG @MR3506              ; E:除材側受渡し前_RB1_給材側移動
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ANL
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR3507
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3507
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR3508
;<h1/>☆2_並列処理2_開始分岐
;※給材ﾁｬｯｸにﾄﾚｲが有る場合
;給材ﾁｬｯｸからRB1へﾄﾚｲ受渡し
STG @MR3508
MPS
LD= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
SET @MR901               ; ☆2並列実行
CON
SET @MR5300              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡
CON
JMP @MR3600
MPP
LD= @DM10 #2             ; 給材側ﾄﾚｲ情報(0不明1有2無)
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR3600
;除材ｴﾚﾍﾞｰﾀｰへﾄﾚｲ受渡し
;除材側ﾄﾚｲﾁｬｯｸ上下親子_下降
STG @MR3600
RES MR7415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_上昇
CON
SET MR7414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_下降
CON
RES MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
MPS
LDB MR4402               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
ANB MR4406               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
ANB MR4410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限E
ANB MR4414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限E
ANB MR4400               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4404               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
ANB R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
AND R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
ANB R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
AND R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
ANB R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
AND R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
ANB R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
AND R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR3602
MPP
LD MR4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
OR MR4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
OR MR4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限E
OR MR4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限E
OR MR4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
OR MR4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
OR MR4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
OR MR4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;TASK3除材ｴﾚﾍﾞｰﾀｰへﾄﾚｲ受渡し要求
STG @MR3602
SET MR20600              ; T2→T3ﾄﾚｲ受渡し要求
CON
JMP @MR3603
STG @MR3603
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20601              ; T3→T2ﾄﾚｲ受け取り準備完了
ANL
RES MR20600              ; T2→T3ﾄﾚｲ受渡し要求
CON
JMP @MR3604
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ開
STG @MR3604
RES MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4301               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4303               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4305               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4307               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR3605
MPP
LD MR4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ｴﾚﾍﾞｰﾀｰﾘﾌﾄｱｯﾌﾟ要求
STG @MR3605
SET MR20602              ; T2→T3ｴﾚﾍﾞｰﾀｰﾘﾌﾄｱｯﾌﾟ要求
CON
JMP @MR3606
STG @MR3606
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20603              ; T3→T2ﾄﾚｲﾁｬｯｸ完了
ANL
RES MR20602              ; T2→T3ｴﾚﾍﾞｰﾀｰﾘﾌﾄｱｯﾌﾟ要求
CON
JMP @MR3607
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ後退
STG @MR3607
RES MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4309               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4311               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4313               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4315               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR3608
MPP
LD MR4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;TASK3除材ｴﾚﾍﾞｰﾀｰへ下降許可
STG @MR3608
SET MR20604              ; T2→T3ｴﾚﾍﾞｰﾀｰ下降許可
CON
JMP @MR3609
;除材側ﾄﾚｲﾁｬｯｸ上下親子_上昇
STG @MR3609
RES MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
RES MR7414               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ子_上昇
CON
MPS
LDB MR4401               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4405               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB MR4403               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4407               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4415               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR3611
MPP
LD MR4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
OR MR4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
OR MR4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
OR MR4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限E
OR MR4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANL
SET @MR1900              ; Main1 HALT許可
;TASK3除材ｴﾚﾍﾞｰﾀｰ_退避完了待ち
STG @MR3611
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20605              ; T3→T2_ｴﾚﾍﾞｰﾀｰ退避完了
ANL
RES MR20604              ; T2→T3ｴﾚﾍﾞｰﾀｰ下降許可
CON
JMP @MR3612
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3612
ANB MR20605              ; T3→T2_ｴﾚﾍﾞｰﾀｰ退避完了
JMP @MR3613
;<h1/>☆2_並列処理2_完了確認
;給材ﾁｬｯｸからRB1へﾄﾚｲ受渡し
STG @MR3613
MPS
LD @MR901                ; ☆2並列実行
AND @MR5301              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡完了
ANL
JMP @MR3614
MPP
ANB @MR901               ; ☆2並列実行
JMP @MR3700
STG @MR3614
DW #1 DM11406            ; 加圧冶具目標位置
CON
DW #2046 DM11408         ; 加圧ﾄﾚｲﾜｰｸ有無記憶1-10_ON有
CON
DW #2046 DM11409         ; 加圧ﾄﾚｲﾜｰｸ有無記憶11-20_ON有
CON
DW #510 DM11410          ; 加圧ﾄﾚｲﾜｰｸ有無記憶21-28_ON有
CON
DW #0 DM11400            ; RB1ﾄﾚｲ処理状況(0未処理99終了)
CON
DW #0 DM11423            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶1-10_ON済
CON
DW #0 DM11424            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶11-20_ON済
CON
DW #0 DM11425            ; 加圧ﾄﾚｲ完成品ｾｯﾄ記憶21-28_ON済
CON
DW #0 DM11421            ; 加圧冶具完成品ｾｯﾄ番号
CON
DW #0 DM11426            ; 加圧冶具取出番号記憶
CON
DW #28 DM11428           ; 完成品ｾｯﾄ必要数
CON
RES @MR901               ; ☆2並列実行
CON
RES @MR5301              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡完了
CON
MPS
ANB DM11427.1
JMP @MR3700
MPP
AND DM11427.1
JMP @MR3615
;※先行取出し記憶有り
;1個目の加圧冶具が無い→D11408の1ﾋﾞｯﾄ目をOFF(冶具無し)
STG @MR3615
RES DM11408.1
CON
DW #1 DM11426            ; 加圧冶具取出番号記憶
CON
RES DM11427.1
CON
JMP @MR3700
;ﾄﾚｲ状況分岐STGへ戻る
STG @MR3700
MPS
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3011              ; ●ﾄﾚｲ状況分岐STG
MPP
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND= DM4110 #10          ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2914
;<h1/>A_END：Auto終了処理
STG @MR3915              ; AUTO END
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANB @MR4002              ; Main2 Busy
ANL
RES MR20015              ; 加圧冶具数確認済み
CON
RES @MR3002              ; AUTO Main1 Busy
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000              ; AUTO Main2
SET @MR4002              ; Main2 Busy
CON
JMP @MR4003
STG @MR4003
JMP @MR4415              ; Main2 END
STG @MR4415              ; Main2 END
SET @MR4001              ; Main2 END
CON
RES @MR4002              ; Main2 Busy
CON
ENDS
;<h1/>■MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1～32)
;・動作終了時は@MR2915にJMPして下さい
;ﾒﾝﾃ動作条件
;
;段ﾊﾞﾗｼ条件
;①給材・除材ﾁｬｯｸ開&親上昇&子上昇、位置決め後退&下降
;②給材ｴﾚﾍﾞｰﾀｰｻｰﾁ済OR下端、除材EVﾊﾝﾄﾞ干渉外
;③ｽｶﾗRB範囲外ORﾊﾝﾄﾞｼﾘﾝﾀﾞ全上昇
;④RB1ﾄﾚｲ搬送にﾄﾚｲ無し&ﾄﾚｲ検出範囲内
;
;段積み条件
;①給材・除材ﾁｬｯｸ開&親上昇&子上昇、位置決め下降
;②給材ｴﾚﾍﾞｰﾀｰｻｰﾁ済OR下端、除材EVﾊﾝﾄﾞ干渉外
;③ｽｶﾗRB範囲外ORﾊﾝﾄﾞｼﾘﾝﾀﾞ全上昇
;④RB1ﾄﾚｲ搬送にﾄﾚｲ有り&ﾄﾚｲ検出範囲内
;⑤除材EVﾊﾝﾄﾞ後退&開
;
LDB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANB R4800                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4801                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4802                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4803                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4804                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4805                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4806                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4807                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4808                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4809                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4810                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4811                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4812                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4813                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4814                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4815                ; 接着冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANB R4506                ; 加圧冶具_ﾄﾚｲ位置決め_奥_上限
AND R4507                ; 加圧冶具_ﾄﾚｲ位置決め_奥_下限
ANB R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
AND R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
ANB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANB R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANB R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
AND R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
LD<=.L DM20810 +3000     ; 軸3 現在座標
OR MR20100               ; 加圧給材EVｻｰﾁ済
ANL
AND<=.L DM11024 +68000   ; RB4 現在位置(下位)
AND<=.L DM11016 +68000   ; RB3 現在位置(下位)
LDB R5202                ; ｽｶﾗRB_加圧冶具ﾁｬｯｸ_下限
AND R5203                ; ｽｶﾗRB_加圧冶具ﾁｬｯｸ_上限
ANB R5206                ; ｽｶﾗRB_接着上冶具吸着_下限
AND R5207                ; ｽｶﾗRB_接着上冶具吸着_上限
ANB R5300                ; ｽｶﾗRB_接着下冶具ﾁｬｯｸ_下限
AND R5301                ; ｽｶﾗRB_接着下冶具ﾁｬｯｸ_上限
ORB DM11033.12           ; SRB出力:加圧治具エリア
ANL
ANB R4600                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4601                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4602                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4603                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4604                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4605                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4606                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4607                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右前_開限
ANB R4608                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4609                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4610                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4611                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4612                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左前_前限
AND R4613                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4614                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右前_前限
AND R4615                ; 加圧冶具除材EVﾄﾚｲﾁｬｯｸ_右前_後限
MPS
LD<=.L DM11000 +22200    ; RB1 現在位置(下位)
ANB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
LD>=.L DM11000 +42600    ; RB1 現在位置(下位)
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
ORL
ANB R4510                ; 加圧冶具_ﾄﾚｲ位置決め_前限
AND R4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限
ANL
OUT MR20104              ; 加圧段ﾊﾞﾗｼ条件
MPP
LD<=.L DM11000 +22200    ; RB1 現在位置(下位)
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
LD>=.L DM11000 +42600    ; RB1 現在位置(下位)
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
ORL
ANL
OUT MR20105              ; 加圧段積み条件
;<h1/>ﾒﾝﾃ動作分岐
STG LR5602               ; _Grp1_Task2_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
SET @MR2002              ; ﾒﾝﾃ中
CON
JMP @MR2003
STG @MR2003
MPS
AND= DM4110 #9           ; _Group1　ﾒﾝﾃ動作番号
MPS
AND MR20104              ; 加圧段ﾊﾞﾗｼ条件
JMP @MR3012              ; A:給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
MPP
ANB MR20104              ; 加圧段ﾊﾞﾗｼ条件
JMP @MR2100
MRD
AND= DM4110 #10          ; _Group1　ﾒﾝﾃ動作番号
MPS
AND MR20105              ; 加圧段積み条件
JMP @MR3400              ; D:RB1_ﾄﾚｲ除材位置へ
MPP
ANB MR20105              ; 加圧段積み条件
JMP @MR2102
MRD
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2400              ; ｼﾘﾝﾀﾞｰ手動操作
MPP
LD<> DM4110 #9           ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #10         ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #25         ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #26         ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2915              ; Mainte END
;<h1/>ｽﾃｯﾌﾟor通常　か選択
STG @MR2004
MPS
MSTRT SELECT_POST #1 MyTask #0 @MR2005;自ﾀｽｸ番号  SELECT完了
MPP
AND @MR2005              ; SELECT完了
RES @MR2005              ; SELECT完了
CON
ENDS
;<h1/>段ﾊﾞﾗｼ動作条件NG
STG @MR2100
SET R39004               ; ｴﾗｰ中
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #104 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR2101
STG @MR2101
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR2914
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>段積み動作条件NG
STG @MR2102
SET R39004               ; ｴﾗｰ中
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #105 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR2103
STG @MR2103
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR2914
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>手動操作_RB移動
STG @MR2400              ; ｼﾘﾝﾀﾞｰ手動操作
MPS
ANB R41202               ; TASK2 PAUSE 要求
OUT @MR2402              ; ｼﾘﾝﾀﾞｰ 手動操作中
CON
AND @MR1902              ; 終了確認
JMP @MR2914
MRD
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
MPP
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
ANP MR22000              ; Cylinder動作終了
LD= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
LDP R44914               ; Teaching End2
ORP R44915               ; Teaching End
ANL
ORL
ANL
SET @MR1902              ; 終了確認
LDP MR22600              ; SW81RB1POS1
AND @MR2402              ; ｼﾘﾝﾀﾞｰ 手動操作中
ANB @MR4502              ; ①SUB_RB1_MOVE中
DW #1 EM1300             ; RB1Target Pos
LDP MR22601              ; SW82RB1POS2
AND @MR2402              ; ｼﾘﾝﾀﾞｰ 手動操作中
ANB @MR4502              ; ①SUB_RB1_MOVE中
DW #2 EM1300             ; RB1Target Pos
LDP MR22602              ; SW83RB1POS3
AND @MR2402              ; ｼﾘﾝﾀﾞｰ 手動操作中
ANB @MR4502              ; ①SUB_RB1_MOVE中
DW #3 EM1300             ; RB1Target Pos
;<h1/>RB移動起動条件
;RB1加圧給材側進入OK
LDB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANB R4506                ; 加圧冶具_ﾄﾚｲ位置決め_奥_上限
AND R4507                ; 加圧冶具_ﾄﾚｲ位置決め_奥_下限
ANB R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
AND R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
LD<=.L DM20810 +3000     ; 軸3 現在座標
OR MR20100               ; 加圧給材EVｻｰﾁ済
ANL
OUT MR002                ; RB1加圧給材側進入OK
;RB1加圧除材側進入OK
LDB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4402                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4403                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4406                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4407                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4410                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4411                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4414                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4415                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_子上限
LD<=.L DM11016 +70000    ; RB3 現在位置(下位)
OR<=.L DM11024 +70000    ; RB4 現在位置(下位)
ANL
OUT MR003                ; RB1加圧除材側進入OK
LDB R5202                ; ｽｶﾗRB_加圧冶具ﾁｬｯｸ_下限
AND R5203                ; ｽｶﾗRB_加圧冶具ﾁｬｯｸ_上限
ANB R5206                ; ｽｶﾗRB_接着上冶具吸着_下限
AND R5207                ; ｽｶﾗRB_接着上冶具吸着_上限
ANB R5300                ; ｽｶﾗRB_接着下冶具ﾁｬｯｸ_下限
AND R5301                ; ｽｶﾗRB_接着下冶具ﾁｬｯｸ_上限
ORB DM11033.12           ; SRB出力:加圧治具エリア
ANB DM11034.15           ; SRB出力:動作中
OUT MR004                ; ｽｶﾗRB干渉外
;<h1/>RB移動起動
LDP MR23000              ; SW145RB1移動開始
AND @MR2402              ; ｼﾘﾝﾀﾞｰ 手動操作中
ANB @MR4502              ; ①SUB_RB1_MOVE中
AND MR002                ; RB1加圧給材側進入OK
AND MR003                ; RB1加圧除材側進入OK
AND MR004                ; ｽｶﾗRB干渉外
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
SET @MR2403
STG @MR2403
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR2404
STG @MR2404
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
ENDS
;<h1/>Maintenance 終了
STG @MR2914
MCALL MODE_INDI #2
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
MPS
LD R41202                ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41202               ; TASK2 PAUSE 要求
RES @MR1902              ; 終了確認
CON
RES @MR2002              ; ﾒﾝﾃ中
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
;<h1/>■SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/>①SUB_RB1_MOVE/加圧冶具搬送_動作
STG @MR4500              ; ①SUB_RB1_MOVE
AND R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
SET @MR4502              ; ①SUB_RB1_MOVE中
CON
JMP @MR4503              ; RB1_MOVE_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
;RB1_MOVE_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON  ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4503              ; RB1_MOVE_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
MPS
BSET DM11207 #3          ; RB1 制御信号
CON
BANB DM11007 #3          ; RB1 状態信号
BSET DM11207 #4          ; RB1 制御信号
CON
BAND DM11007 #4          ; RB1 状態信号
BRES DM11207 #3          ; RB1 制御信号
CON
JMP @MR4504
MPP
BLD DM11007 #3           ; RB1 状態信号
BORB DM11007 #4          ; RB1 状態信号
ANL
TMR @4 #20               ; RB1ｴﾗｰ
CON
AND @T4                  ; RB1ｴﾗｰ
BRES DM11207 #3          ; RB1 制御信号
CON
BRES DM11207 #4          ; RB1 制御信号
CON
JMP @MR4600              ; Error11 RB1_動作異常
STG @MR4504
SET R35000               ; RB1 MOVE
CON
JMP @MR4505
STG @MR4505
AND R35001               ; RB1 MOVE END
RES R35001               ; RB1 MOVE END
CON
JMP @MR4506
STG @MR4506
MPS
ANB R35003               ; RB1 Alarm
JMP @MR4507
MPP
AND R35003               ; RB1 Alarm
RES R35003               ; RB1 Alarm
CON
JMP @MR4600              ; Error11 RB1_動作異常
STG @MR4507
SET @MR4501              ; ①SUB_RB1_MOVE完了
CON
RES @MR4502              ; ①SUB_RB1_MOVE中
CON
ENDS
;<h1/>②SUB_RB1_HOME/加圧冶具搬送_復帰
STG @MR4508              ; ②SUB_RB1_HOME
SET @MR4509              ; ②SUB_RB1_HOME完了
CON
SET @MR4510              ; ②SUB_RB1_HOME中
CON
JMP @MR4511              ; RB1_HOME_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
;RB1_HOME_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON  ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4511              ; RB1_HOME_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
MPS
BSET DM11207 #3          ; RB1 制御信号
CON
BANB DM11007 #3          ; RB1 状態信号
BSET DM11207 #4          ; RB1 制御信号
CON
BAND DM11007 #4          ; RB1 状態信号
BRES DM11207 #3          ; RB1 制御信号
CON
JMP @MR4512
MPP
BLD DM11007 #3           ; RB1 状態信号
BORB DM11007 #4          ; RB1 状態信号
ANL
TMR @5 #20               ; RB1ｴﾗｰ
CON
AND @T5                  ; RB1ｴﾗｰ
BRES DM11207 #3          ; RB1 制御信号
CON
BRES DM11207 #4          ; RB1 制御信号
CON
JMP @MR4600              ; Error11 RB1_動作異常
STG @MR4512
MPS
BAND DM11007 #1          ; RB1 状態信号
JMP @MR4515
MPP
BANB DM11007 #1          ; RB1 状態信号
SET R35008               ; RB1 HOME
CON
JMP @MR4513
STG @MR4513
AND R35009               ; RB1 HOME END
RES R35009               ; RB1 HOME END
CON
JMP @MR4514
STG @MR4514
MPS
ANB R35003               ; RB1 Alarm
JMP @MR4515
MPP
AND R35003               ; RB1 Alarm
RES R35003               ; RB1 Alarm
CON
JMP @MR4600              ; Error11 RB1_動作異常
STG @MR4515
SET @MR4509              ; ②SUB_RB1_HOME完了
CON
RES @MR4510              ; ②SUB_RB1_HOME中
CON
ENDS
;Error11 RB1_動作異常
STG @MR4600              ; Error11 RB1_動作異常
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #1 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR4601
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11006              ; RB1 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4601
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR4510              ; ②SUB_RB1_HOME中
JMP @MR4511              ; RB1_HOME_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
MPP
AND @MR4502              ; ①SUB_RB1_MOVE中
JMP @MR4503              ; RB1_MOVE_ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON
;<h1/>③SUB_HOME_ﾄﾚｲ有無確認
STG @MR4700              ; ③SUB_HOME_ﾄﾚｲ有無確認
SET @MR4702              ; ③SUB_HOME_ﾄﾚｲ有無確認中
CON
JMP @MR4703              ; 分岐
;RB1の位置が給材側OR除材側(ﾄﾚｲ有無検出用)
;
;*****RB1の位置が給材側範囲内*****
;
;A:給材側のﾄﾚｲ有無でRB1上のﾄﾚｲを検出  かつ  給材側ﾄﾚｲ情報不明OR有記憶 
;→給材側ﾄﾚｲ情報「無」&復帰動作
;
;B:給材側のﾄﾚｲ有無でRB1上のﾄﾚｲを未検出  かつ  給材側ﾄﾚｲ情報不明OR有記憶 
;→RB1給材位置移動、ﾁｬｯｸ下降後、ﾄﾚｲ有無確認
;
;AB共通:除材側のﾄﾚｲ有無確認
;
;*****RB1の位置が除材側範囲内*****
;
;C:除材側のﾄﾚｲ有無でRB1上のﾄﾚｲを検出  かつ  除材側ﾄﾚｲ情報不明OR有記憶   
;→C:除材側ﾄﾚｲ情報「無」&復帰動作へ
;
;D:除材側のﾄﾚｲ有無でRB1上のﾄﾚｲを未検出  かつ  除材側ﾄﾚｲ情報不明OR有記憶 
;→RB1除材位置移動、ﾁｬｯｸ下降後、ﾄﾚｲ有無確認
;
;CD共通:給材側のﾄﾚｲ有無確認
;
;*****RB1の位置が給材側範囲外かつ除材側範囲外*****
;E:給材、除材側の近い方へ移動。(干渉がある為、ﾄﾚｲはRB1上かﾁｬｯｸ上の両方には存在できない）
STG @MR4703              ; 分岐
MPS
AND<=.L DM11000 +22200   ; RB1 現在位置(下位)
MPS
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @15 #5
CON
AND @T15
DW #1 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
MPS
LD= @DM10 #0             ; 給材側ﾄﾚｲ情報(0不明1有2無)
OR= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR4706              ; A
MPP
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4714              ; AB共通:除材側のﾄﾚｲ有無確認
MPP
ANB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @16 #5
CON
AND @T16
DW #2 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
MPS
LD= @DM10 #0             ; 給材側ﾄﾚｲ情報(0不明1有2無)
OR= @DM10 #1             ; 給材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR4708              ; B
MPP
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4714              ; AB共通:除材側のﾄﾚｲ有無確認
MRD
AND>=.L DM11000 +42600   ; RB1 現在位置(下位)
MPS
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @17 #5
CON
AND @T17
DW #1 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
MPS
LD= @DM11 #0             ; 除材側ﾄﾚｲ情報(0不明1有2無)
OR= @DM11 #1             ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR4805              ; C
MPP
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4813              ; CD共通:給材側のﾄﾚｲ有無確認
MPP
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @18 #5
CON
AND @T18
DW #2 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
MPS
LD= @DM11 #0             ; 除材側ﾄﾚｲ情報(0不明1有2無)
OR= @DM11 #1             ; 除材側ﾄﾚｲ情報(0不明1有2無)
ANL
JMP @MR4807              ; D
MPP
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4813              ; CD共通:給材側のﾄﾚｲ有無確認
MPP
LD>.L DM11000 +22200     ; RB1 現在位置(下位)
AND<.L DM11000 +42600    ; RB1 現在位置(下位)
ANL
MPS
AND<.L DM11000 +35000    ; RB1 現在位置(下位)
DW #1 EM1300             ; RB1Target Pos
CON
JMP @MR4704              ; E
MPP
AND>=.L DM11000 +35000   ; RB1 現在位置(下位)
DW #2 EM1300             ; RB1Target Pos
CON
JMP @MR4704              ; E
;RB1移動
STG @MR4704              ; E
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR4705
STG @MR4705
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR4703              ; 分岐
;<h1/>A:給材側のﾄﾚｲ有無でRB2上のﾄﾚｲを検出  かつ  給材側ﾄﾚｲ情報不明  
;→給材側ﾄﾚｲ情報「無」&復帰動作
;給材側ﾁｬｯｸ開
STG @MR4706              ; A
RES MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4101               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4103               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4105               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4107               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR4707
MPP
LD MR4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾁｬｯｸ後退
STG @MR4707
RES MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4109               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4111               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4113               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4115               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4714              ; AB共通:除材側のﾄﾚｲ有無確認
MPP
LD MR4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>B:給材側のﾄﾚｲ有無でRB2上のﾄﾚｲを未検出  かつ  給材側ﾄﾚｲ情報不明
;→RB2給材位置移動、ﾁｬｯｸ下降後、ﾄﾚｲ有無確認
;加圧冶具搬送RB2_給材側移動
STG @MR4708              ; B
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR4709
STG @MR4709
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR4710
;給材側ﾄﾚｲﾁｬｯｸ上下親_下降
STG @MR4710
RES MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
MPS
LDB MR4200               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4204               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4208               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4212               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4711
MPP
LD MR4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
OR MR4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
OR MR4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限E
OR MR4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲ有無確認
STG @MR4711
MPS
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @6 #20
CON
AND @T6
DW #1 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4712
MPP
LDB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
ANB R4501                ; 加圧冶具給材_ﾄﾚｲ浮き左(ONOK)
ANB R4502                ; 加圧冶具給材_ﾄﾚｲ浮き右(ONOK)
ANL
TMR @7 #20
CON
AND @T7
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4712
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR4712
RES MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4201               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4205               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4209               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4213               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4713
MPP
LD MR4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲ有無分岐
;ﾄﾚｲ有り→AB共通動作(除材側ﾄﾚｲ確認)へ
;ﾄﾚｲ無し→A動作へ
STG @MR4713
MPS
AND= @DM10 #1            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4714              ; AB共通:除材側のﾄﾚｲ有無確認
MPP
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4706              ; A
;<h1/>AB共通:除材側のﾄﾚｲ有無確認
;除材側ﾄﾚｲ情報分岐
STG @MR4714              ; AB共通:除材側のﾄﾚｲ有無確認
MPS
AND= @DM11 #0            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4715
MPP
AND<> @DM11 #0           ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5004              ; ﾄﾚｲ状態判別確認
;除材側ﾄﾚｲﾁｬｯｸ上下親_下降
STG @MR4715
RES MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
MPS
LDB MR4400               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4404               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4800
MPP
LD MR4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
OR MR4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
OR MR4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
OR MR4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲ有無確認
STG @MR4800
MPS
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @8 #20
CON
AND @T8
DW #1 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4801
MPP
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @9 #20
CON
AND @T9
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4801
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR4801
RES MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4401               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4405               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4802
MPP
LD MR4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲ有無分岐
STG @MR4802
MPS
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5004              ; ﾄﾚｲ状態判別確認
MPP
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4803
;除材側ﾁｬｯｸ開
STG @MR4803
RES MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4301               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4303               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4305               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4307               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR4804
MPP
LD MR4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ後退
STG @MR4804
RES MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4309               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4311               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4313               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4315               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5004              ; ﾄﾚｲ状態判別確認
MPP
LD MR4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>C:除材側のﾄﾚｲ有無でRB2上のﾄﾚｲを検出  かつ  除材側ﾄﾚｲ情報不明  
;→C:除材側ﾄﾚｲ情報「無」&復帰動作へ
;除材側ﾁｬｯｸ開
STG @MR4805              ; C
RES MR7408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4301               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4303               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4305               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4307               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4300                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4302                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4304                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4306                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR4806
MPP
LD MR4301                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4303                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4305                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4307                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾁｬｯｸ後退
STG @MR4806
RES MR7410               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7411               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4309               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4311               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4313               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4315               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4308                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4310                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4312                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4314                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4813              ; CD共通:給材側のﾄﾚｲ有無確認
MPP
LD MR4309                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4311                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4313                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4315                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/>D:除材側のﾄﾚｲ有無でRB2上のﾄﾚｲを未検出  かつ  除材側ﾄﾚｲ情報不明
;→RB2除材位置移動、ﾁｬｯｸ下降後、ﾄﾚｲ有無確認
;加圧冶具搬送RB2_給材側移動
STG @MR4807              ; D
DW #2 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1_MOVE
CON
JMP @MR4808
STG @MR4808
AND @MR4501              ; ①SUB_RB1_MOVE完了
RES @MR4501              ; ①SUB_RB1_MOVE完了
CON
JMP @MR4809
;除材側ﾄﾚｲﾁｬｯｸ上下親_下降
STG @MR4809
RES MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
MPS
LDB MR4400               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4404               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4408               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4810
MPP
LD MR4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
OR MR4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
OR MR4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限E
OR MR4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲ有無確認
STG @MR4810
MPS
AND R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @10 #20
CON
AND @T10
DW #1 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4811
MPP
ANB R4504                ; 加圧冶具除材_ﾄﾚｲ有無
TMR @11 #20
CON
AND @T11
DW #2 @DM11              ; 除材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR4811
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR4811
RES MR7412               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4401               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4405               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4409               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4413               ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4400                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4404                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4408                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4412                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4812
MPP
LD MR4401                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4405                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4409                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4413                ; 加圧冶具除材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;除材側ﾄﾚｲ有無分岐
;ﾄﾚｲ有り→CD共通動作(給材側ﾄﾚｲ確認)へ
;ﾄﾚｲ無し→C動作へ
STG @MR4812
MPS
AND= @DM11 #1            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4813              ; CD共通:給材側のﾄﾚｲ有無確認
MPP
AND= @DM11 #2            ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4805              ; C
;<h1/>CD共通:給材側のﾄﾚｲ有無確認
;給材側ﾄﾚｲ情報分岐
STG @MR4813              ; CD共通:給材側のﾄﾚｲ有無確認
MPS
AND= @DM10 #0            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR4814
MPP
AND<> @DM11 #0           ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5004              ; ﾄﾚｲ状態判別確認
;給材側ﾄﾚｲﾁｬｯｸ上下親_下降
STG @MR4814
RES MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
MPS
LDB MR4200               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4204               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4208               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4212               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR4815
MPP
LD MR4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
OR MR4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
OR MR4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限E
OR MR4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲ有無確認
STG @MR4815
MPS
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @12 #20
CON
AND @T12
DW #1 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5000
MPP
LDB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
ANB R4501                ; 加圧冶具給材_ﾄﾚｲ浮き左(ONOK)
ANB R4502                ; 加圧冶具給材_ﾄﾚｲ浮き右(ONOK)
ANL
TMR @13 #20
CON
AND @T13
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5000
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR5000
RES MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4201               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4205               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4209               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4213               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR5001
MPP
LD MR4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲ有無分岐
STG @MR5001
MPS
AND= @DM10 #1            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5004              ; ﾄﾚｲ状態判別確認
MPP
AND= @DM10 #2            ; 給材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5002
;給材側ﾁｬｯｸ開
STG @MR5002
RES MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4101               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4103               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4105               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4107               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR5003
MPP
LD MR4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾁｬｯｸ後退
STG @MR5003
RES MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4109               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4111               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4113               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4115               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5004              ; ﾄﾚｲ状態判別確認
MPP
LD MR4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲ状態判別確認
STG @MR5004              ; ﾄﾚｲ状態判別確認
AND<> @DM10 #0           ; 給材側ﾄﾚｲ情報(0不明1有2無)
AND<> @DM11 #0           ; 除材側ﾄﾚｲ情報(0不明1有2無)
JMP @MR5005
STG @MR5005
SET @MR4701              ; ③SUB_HOME_ﾄﾚｲ有無確認完了
CON
RES @MR4702              ; ③SUB_HOME_ﾄﾚｲ有無確認中
CON
ENDS
;<h1/>④SUB_給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取
STG @MR5100              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取
SET @MR5102              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取中
CON
JMP @MR5103
;TASK1給材ｴﾚﾍﾞｰﾀｰへﾄﾚｲ供給要求
STG @MR5103
SET MR20501              ; T2→T1ﾄﾚｲ供給要求
CON
JMP @MR5104
;TASK1給材ｴﾚﾍﾞｰﾀｰから準備完了待ち
STG @MR5104
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
AND MR20502              ; T1→T2ﾄﾚｲ受渡し準備完了
RES MR20501              ; T2→T1ﾄﾚｲ供給要求
CON
JMP @MR5106
MPP
LDB MR20502              ; T1→T2ﾄﾚｲ受渡し準備完了
ANB R41001               ; _Grp1_Task1_起動中ﾌﾗｸﾞ
ANL
RES MR20501              ; T2→T1ﾄﾚｲ供給要求
CON
SET @MR902               ; TASK1停止_ﾄﾚｲ受取無し
CON
JMP @MR5209
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ上下親子_下降
STG @MR5106
RES MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
SET MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
RES MR7407               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_上昇
CON
SET MR7406               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_下降
CON
JMP @MR5107
STG @MR5107
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR4200               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限E
ANB MR4204               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限E
ANB MR4208               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限E
ANB MR4212               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限E
ANB MR4202               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
ANB MR4206               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
ANB MR4210               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限E
ANB MR4214               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限E
AND R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
ANB R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
AND R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
ANB R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
AND R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
ANB R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
AND R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
ANB R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
AND R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
ANB R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
AND R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
ANB R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
AND R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
ANB R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
AND R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
ANB R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR5108
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ_前進
STG @MR5108
RES MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
SET MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
MPS
LDB MR4108               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
ANB MR4110               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
ANB MR4112               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
ANB MR4114               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
ANB R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
AND R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
ANB R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
AND R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
ANB R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
AND R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
ANB R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
JMP @MR5109
MPP
LD MR4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限ERR
OR MR4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限ERR
OR MR4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限ERR
OR MR4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ上下子_上昇
STG @MR5109
RES MR7406               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7407               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_上昇
CON
MPS
LDB MR4203               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4207               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4211               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4215               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR5110
MPP
LD MR4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
OR MR4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
OR MR4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限E
OR MR4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾁｬｯｸ閉
STG @MR5110
RES MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
SET MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
MPS
LDB MR4100               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
ANB MR4102               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
ANB MR4104               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
ANB MR4106               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
ANB R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
AND R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
ANB R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
AND R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
ANB R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
AND R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
ANB R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR5111
MPP
LD MR4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
OR MR4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
OR MR4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
OR MR4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲ有無確認
STG @MR5111
MPS
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
DW #1 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5200
MPP
ANB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @1 #5                ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
CON
AND @T1                  ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
JMP @MR5112
;ﾄﾚｲ受取異常
STG @MR5112
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #100 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4500 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR5113
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5113
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR5111
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;TASK1へﾄﾚｲ受取完了
STG @MR5200
SET MR20503              ; T2→T1ｴﾚﾍﾞｰﾀｰ下降許可
CON
JMP @MR5201
;給材側ﾄﾚｲﾁｬｯｸ上下親_上昇
STG @MR5201
RES MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
MPS
LDB MR4201               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4205               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4209               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4213               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANL
JMP @MR5202
MPP
LD MR4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
OR MR4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
OR MR4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
OR MR4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾁｬｯｸ開&位置決め上昇
STG @MR5202
SET MR7302               ; 加圧冶具給材_ﾄﾚｲ位置決め上昇
CON
RES MR7303               ; 加圧冶具給材_ﾄﾚｲ位置決め下降
CON
SET MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
RES MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
JMP @MR5203
STG @MR5203
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR4506               ; 加圧冶具_ﾄﾚｲ位置決_奥_上限ER
ANB MR4508               ; 加圧冶具_ﾄﾚｲ位置決_前_上限ER
ANB MR4101               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4103               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4105               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4107               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R4506                ; 加圧冶具_ﾄﾚｲ位置決め_奥_上限
ANB R4507                ; 加圧冶具_ﾄﾚｲ位置決め_奥_下限
AND R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
ANB R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
ANB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR5204
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;位置決め前進
STG @MR5204
RES MR7301               ; 加圧冶具給材_ﾄﾚｲ位置決め後退
CON
SET MR7300               ; 加圧冶具給材_ﾄﾚｲ位置決め前進
CON
MPS
LDB MR4510               ; 加圧冶具_ﾄﾚｲ位置決め_前限ERR
AND R4510                ; 加圧冶具_ﾄﾚｲ位置決め_前限
ANB R4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限
ANL
JMP @MR5205
MPP
LD MR4510                ; 加圧冶具_ﾄﾚｲ位置決め_前限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾁｬｯｸ閉
STG @MR5205
RES MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
SET MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
MPS
LDB MR4100               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
ANB MR4102               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
ANB MR4104               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
ANB MR4106               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
ANB R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
AND R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
ANB R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
AND R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
ANB R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
AND R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
ANB R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR5206
MPP
LD MR4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限ERR
OR MR4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限ERR
OR MR4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限ERR
OR MR4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;位置決め下降&後退
STG @MR5206
RES MR7300               ; 加圧冶具給材_ﾄﾚｲ位置決め前進
CON
SET MR7301               ; 加圧冶具給材_ﾄﾚｲ位置決め後退
CON
RES MR7302               ; 加圧冶具給材_ﾄﾚｲ位置決め上昇
CON
SET MR7303               ; 加圧冶具給材_ﾄﾚｲ位置決め下降
CON
MPS
LDB MR4511               ; 加圧冶具_ﾄﾚｲ位置決め_後限ERR
ANB MR4507               ; 加圧冶具_ﾄﾚｲ位置決_奥_下限ER
ANB MR4509               ; 加圧冶具_ﾄﾚｲ位置決_前_下限ER
ANB R4510                ; 加圧冶具_ﾄﾚｲ位置決め_前限
AND R4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限
ANB R4506                ; 加圧冶具_ﾄﾚｲ位置決め_奥_上限
AND R4507                ; 加圧冶具_ﾄﾚｲ位置決め_奥_下限
ANB R4508                ; 加圧冶具_ﾄﾚｲ位置決め_前_上限
AND R4509                ; 加圧冶具_ﾄﾚｲ位置決め_前_下限
ANL
JMP @MR5207
MPP
LD MR4511                ; 加圧冶具_ﾄﾚｲ位置決め_後限ERR
OR MR4507                ; 加圧冶具_ﾄﾚｲ位置決_奥_下限ER
OR MR4509                ; 加圧冶具_ﾄﾚｲ位置決_前_下限ER
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;TASK1からｴﾚﾍﾞｰﾀｰ退避完了待ち
STG @MR5207
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20504              ; T1→T2ｴﾚﾍﾞｰﾀｰ退避完了
ANL
RES MR20503              ; T2→T1ｴﾚﾍﾞｰﾀｰ下降許可
CON
JMP @MR5208
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5208
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20504              ; T1→T2ｴﾚﾍﾞｰﾀｰ退避完了
ANL
JMP @MR5209
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;④SUB_給材ｴﾚﾍﾞｰﾀｰ(TASK1)からﾄﾚｲ受取_終了
STG @MR5209
SET @MR5101              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取完了
CON
RES @MR5102              ; ④SUB_給材ｴﾚﾍﾞｰﾀｰからﾄﾚｲ受取中
CON
ENDS
;<h1/>⑤SUB_給材側ﾁｬｯｸからRB1へﾄﾚｲ受渡し
STG @MR5300              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡
SET @MR5302              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡中
CON
JMP @MR5303
;給材側ﾄﾚｲﾁｬｯｸ上下子_下降
STG @MR5303
RES MR7407               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_上昇
CON
SET MR7406               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_下降
CON
MPS
LDB MR4202               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
ANB MR4206               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
ANB MR4210               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限E
ANB MR4214               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限E
AND R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
ANB R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
AND R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
ANB R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
AND R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
ANB R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
AND R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
ANB R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR5304
MPP
LD MR4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限E
OR MR4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限E
OR MR4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限E
OR MR4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限E
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ開
STG @MR5304
RES MR7400               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_閉
CON
SET MR7401               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_開
CON
MPS
LDB MR4101               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
ANB MR4103               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
ANB MR4105               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
ANB MR4107               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
ANB R4100                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_閉限
AND R4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限
ANB R4102                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_閉限
AND R4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限
ANB R4104                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_閉限
AND R4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限
ANB R4106                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_閉限
AND R4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限
ANL
JMP @MR5305
MPP
LD MR4101                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_開限ERR
OR MR4103                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_開限ERR
OR MR4105                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_開限ERR
OR MR4107                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_開限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ_後退
STG @MR5305
RES MR7402               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_前進
CON
SET MR7403               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_後退
CON
MPS
LDB MR4109               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
ANB MR4111               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
ANB MR4113               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
ANB MR4115               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
ANB R4108                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_前限
AND R4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限
ANB R4110                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_前限
AND R4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限
ANB R4112                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_前限
AND R4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限
ANB R4114                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_前限
AND R4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限
ANL
DW #2 @DM10              ; 給材側ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5306
MPP
LD MR4109                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_後限ERR
OR MR4111                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_後限ERR
OR MR4113                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_後限ERR
OR MR4115                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_後限ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲ状態確認
STG @MR5306
MPS
ANB R4500                ; 加圧冶具給材_ﾄﾚｲ有無
TMR @2 #5                ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
CON
AND @T2                  ; 加圧ﾄﾚｲ有無ﾃﾞｨﾚｲ
JMP @MR5307
MPP
AND R4500                ; 加圧冶具給材_ﾄﾚｲ有無
MPS
LD R4501                 ; 加圧冶具給材_ﾄﾚｲ浮き左(ONOK)
AND R4502                ; 加圧冶具給材_ﾄﾚｲ浮き右(ONOK)
ANL
DW #1 @DM12              ; RB1ﾄﾚｲ情報(0不明1有2無)
CON
JMP @MR5401
MPP
LDB R4501                ; 加圧冶具給材_ﾄﾚｲ浮き左(ONOK)
ORB R4502                ; 加圧冶具給材_ﾄﾚｲ浮き右(ONOK)
ANL
TMR @3 #5                ; 加圧ﾄﾚｲ浮きﾃﾞｨﾚｲ
CON
AND @T3                  ; 加圧ﾄﾚｲ浮きﾃﾞｨﾚｲ
JMP @MR5309
;ﾄﾚｲﾁｬｯｸ受渡し後_ﾄﾚｲ無異常
STG @MR5307
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #101 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4500 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR5308
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5308
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR5306
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ﾄﾚｲﾁｬｯｸ受渡し後_ﾄﾚｲ浮き異常
STG @MR5309
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #102 @DM1             ; ErrorNo /ERROR_DISP
CON
MPS
SET @MR100               ; Task2 ERROR
CON
JMP @MR5310
MRD
ANB R4502                ; 加圧冶具給材_ﾄﾚｲ浮き右(ONOK)
DW #4502 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R4501                ; 加圧冶具給材_ﾄﾚｲ浮き左(ONOK)
DW #4501 @DM2            ; SensorNo /ERROR_DISP
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5310
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND @MR101               ; Task2 ERROR_End
ANL
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR5306
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;給材側ﾄﾚｲﾁｬｯｸ上下親子_上昇
STG @MR5401
RES MR7404               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_下降
CON
SET MR7405               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ親_上昇
CON
RES MR7406               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_下降
CON
SET MR7407               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ子_上昇
CON
JMP @MR5402
STG @MR5402
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR4201               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限E
ANB MR4205               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限E
ANB MR4209               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限E
ANB MR4213               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限E
ANB MR4203               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限E
ANB MR4207               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限E
ANB MR4211               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限E
ANB MR4215               ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限E
ANB R4200                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親下限
AND R4201                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_親上限
ANB R4204                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親下限
AND R4205                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_親上限
ANB R4208                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親下限
AND R4209                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_親上限
ANB R4212                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親下限
AND R4213                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_親上限
ANB R4202                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子下限
AND R4203                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左奥_子上限
ANB R4206                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子下限
AND R4207                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右奥_子上限
ANB R4210                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子下限
AND R4211                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_左前_子上限
ANB R4214                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子下限
AND R4215                ; 加圧冶具給材ﾄﾚｲﾁｬｯｸ_右前_子上限
ANL
JMP @MR5403
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;⑤SUB_給材側ﾁｬｯｸからRB1へﾄﾚｲ受渡し_終了
STG @MR5403
SET @MR5301              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡完了
CON
RES @MR5302              ; ⑤SUB_給材ﾁｬｯｸからRB1ﾄﾚｲ受渡中
CON
ENDS
;<h1/>-----------------------------------------------------------
;<h1/>*ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Task2 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
DW MyTask @DM0           ; 自ﾀｽｸ番号  TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task2 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task2 ERROR Busy
CON
SET @MR101               ; Task2 ERROR_End
CON
ENDS
;<h1/>*Select_Y_N 
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task2 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task2 Y/N
CON
DW #0 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task2 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task2 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task2 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task2 Y_N Busy
CON
SET @MR301               ; Task2 Y/N END
CON
ENDS
;<h1/>*TIMEUP ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task2 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #0 @DM40              ; TaskNo /TIMEUP_ERR
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR  TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task2 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task2 TIMEUP Busy
CON
SET @MR401               ; Task2 TIMEUP_END
CON
ENDS
;<h1/>*Select_ACT 
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task2 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #0 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT  TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task2 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task2 SEL_ACT Busy
CON
SET @MR201               ; Task2 SEL_ACT END
CON
ENDS
;<h1/>※機能Macro呼出し見本- 削除して下さい。-------------------------------------
;<h1/>※Error:記述見本
;ERR163 "****Error"
;<h1/>※SELECT_ACT　:記述見本
;画面番号33をブザー有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
;<h1/>※ SELECT_Y_N　記述見本
;//*Select_Y_N
;<h1/>HALT
LD R41202                ; TASK2 PAUSE 要求
AND @MR1900              ; Main1 HALT許可
LD @MR1901               ; Main2 HALT許可
ORB @MR4002              ; Main2 Busy
ANL
TMR @40 #5
CON
AND @T40
SET R42602               ; Grp1_Task2_ﾎﾟｰｽﾞ許可
LD R42602                ; Grp1_Task2_ﾎﾟｰｽﾞ許可
ORB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
RES @MR1900              ; Main1 HALT許可
CON
RES @MR1901              ; Main2 HALT許可
END
ENDH
