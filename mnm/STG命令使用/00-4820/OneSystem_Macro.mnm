DEVICE:53
;MODULE:OneSystem_Macro
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Master-Module
;
;-----------------------------------------
;ModuleName	:	OneSystem_Macro
;ModuleType	:	Master Module
;Function	:	Self Holding Macro
;-----------------------------------------
;
;Copylight(C) 2012 SEIKO EPSON Corp. All rights reserved.
;for Ver1.1.x
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES R39000 R39915       ; ERROR_DISP Start
CON
ZRES @R000 @R915
;<h1/>Group1
;※以下マクロはGroup1表示用固定です。
;Group2以降はユーザーにて作成下さい。
;<h1/>ERROR_DISP
STG R39000               ; ERROR_DISP Start
ANB R39102               ; SELECT_Y_N Busy
ANB R39202               ; SELECT_ACT Busy
SET R39002               ; ERROR_DISP Busy
CON
JMP @R000
STG @R000
MPS
MSTRT ERROR_DISP #1 DM60000 DM60001 DM60002 DM60006 DM60005 DM60004 DM60003 DM60007 DM60008;TaskNo /ERROR_DISP  ErrorNo /ERROR_DISP  SensorNo /ERROR_DISP  SW4 /ERROR_DISP  SW3 /ERROR_DISP  SW2 /ERROR_DISP  SW1 /ERROR_DISP  ReturnSW /ERROR_DISP  ReturnNo /ERROR_DISP
MPP
LD<> DM60007 #0          ; ReturnSW /ERROR_DISP
AND= DM60001 DM60008     ; ErrorNo /ERROR_DISP  ReturnNo /ERROR_DISP
ANL
JMP @R001
STG @R001
TMR @0 #2
CON
AND @T0
RES R39002               ; ERROR_DISP Busy
CON
ENDS
;<h1/>SELECT_Y_N
STG R39100               ; SELECT_Y_N Start
RES R39103               ; SELECT_Y_N Y/N
CON
SET R39102               ; SELECT_Y_N Busy
CON
JMP @R100
STG @R100
MPS
MSTRT SELECT_Y_N #1 DM60020 DM60021 DM60022 DM60023;TaskNo /SELECT_Y_N  ScreenNo /SELECT_Y_N  Bz_Use /SELECT_Y_N  Y_N /SELECT_Y_N
MPP
AND<> DM60023 #0         ; Y_N /SELECT_Y_N
JMP @R101                ; 消去
STG @R101                ; 消去
TMR @1 #2
CON
AND @T1
RES R39102               ; SELECT_Y_N Busy
CON
ENDS
;<h1/>SELECT_ACT
STG R39200               ; SELECT_ACT Start
SET R39202               ; SELECT_ACT Busy
CON
JMP @R200
STG @R200
MPS
MSTRT SELECT_ACT #1 DM60030 DM60031 DM60032 DM60033 DM60034 DM60035 DM60036 DM60037;TaskNo /SELECT_ACT  ScreenNo /SELECT_ACT  SW1 /SELECT_ACT  SW2 /SELECT_ACT  SW3 /SELECT_ACT  SW4 /SELECT_ACT  Bz_Use /SELECT_ACT  SelectSW /SELECT_ACT
MPP
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
JMP @R201
STG @R201
TMR @2 #2
CON
AND @T2
RES R39202               ; SELECT_ACT Busy
CON
ENDS
;<h1/>WARNING DISP Macro
LDB R53608               ; _WARN画面消去
ANB R46208               ; _Group1　ｴﾗｰ発生中
ANB @R300
AND= DM60050 #0          ; Warning_Disp_No.
AND R58500               ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
MPS
AND<> R58000 #0          ; Ionaiza Alarm
LDA R58000               ; Ionaiza Alarm
CON
DMX
CON
ADD #1
CON
@STA DM60050             ; Warning_Disp_No.
MRD
AND<> R58100 #0          ; Warning Disp#17
LDA R58100               ; Warning Disp#17
CON
DMX
CON
ADD #17
CON
@STA DM60050             ; Warning_Disp_No.
MRD
AND<> R58200 #0          ; Warning Disp#33
LDA R58200               ; Warning Disp#33
CON
DMX
CON
ADD #33
CON
@STA DM60050             ; Warning_Disp_No.
MPP
AND<> R58300 #0          ; Warning Disp#49
LDA R58300               ; Warning Disp#49
CON
DMX
CON
ADD #49
CON
@STA DM60050             ; Warning_Disp_No.
;Warning 消去　　
;IF DM60050 > 0 THEN
;	IF R58000:(DM60050-1) = 0 THEN
;		SET(@R301)
;	END IF
;END IF
LDB @R300
NCJ #1000
;IF DM60050 > 0 THEN
;
LD> DM60050 #0           ; Warning_Disp_No.
NCJ #2000
;	IF R58000:(DM60050-1) = 0 THEN
;
LD CR2002                ; 常時ON
LDA DM60050              ; Warning_Disp_No.
CON
EXT
CON
SUB.L +1
CON
STA.L Z12
LDB R58000:Z12           ; Ionaiza Alarm
NCJ #2001
;		SET(@R301)
;
LD CR2002                ; 常時ON
SET @R301
;	END IF
;
LABEL #2001
;END IF
LABEL #2000
LABEL #1000
;
;消去
LD @R301
AND<> DM60050 #0         ; Warning_Disp_No.
ANB _WARNING_DISP_1
OUT @R300
CON
MSTRT WARNING_DEL_1 #1 DM60050;Warning_Disp_No.
RES @R301
CON
DW #0 DM60050            ; Warning_Disp_No.
;表示
LD<> DM60050 #0          ; Warning_Disp_No.
MEP
ANB _WARNING_DISP_1
ANB _WARNING_DEL_1
MSTRT WARNING_DISP_1 #1 DM60050 #2 #1;Warning_Disp_No.
;表示:システム起動中
LDB R58500               ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
MSTRT MSG_DISP #1 #0 #0 #0
LDB R3800                ; ｴﾗｰ中
AND R58500               ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
SHOT #50 @MR303          ; ﾒｯｾｰｼﾞ消去
LD @MR303                ; ﾒｯｾｰｼﾞ消去
MSTRT MSG_DEL #1 #0
END
ENDH
