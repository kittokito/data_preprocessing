DEVICE:53
;MODULE:AlwaysMonitor
;MODULE_TYPE:0
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	AlwaysMonitor
;ModuleType	:	Sub Module
;Function	:	常時監視
;---------------------------------------
;<使用方法>
;常時監視が必要な物は本ﾓｼﾞｭｰﾙ内に記述して下さい
;・ﾋｰﾀｰ過昇温検知による非常停止
;・ﾁｬﾝﾊﾞｰ排気量低下によるｴﾗｰ出力
;など
;<h1/>CELL間 PAUSE 許可
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
LD B3605                 ; Index->TC ﾎﾟｰｽﾞ要求
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ORL
LD R41200                ; TASK0 PAUSE 要求
AND B3605                ; Index->TC ﾎﾟｰｽﾞ要求
ANB B3607                ; Index->TC ﾎﾟｰｽﾞ復帰要求
AND B3604                ; Index->TC 電源ON 
LDB B3604                ; Index->TC 電源ON 
ORB B360D                ; Index->TC  IL 進入許可
LD DM11033.14            ; SRB出力:加圧冶具置きエリア
OR DM11033.15            ; SRB出力:インデックスエリア
ANL
ORL
ANB DM2000.1             ; 上流OFFLINE
ORL
OUT R41200               ; TASK0 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41201               ; TASK1 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41202               ; TASK2 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41203               ; TASK3 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41204               ; TASK4 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41205               ; TASK5 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41206               ; TASK6 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41207               ; TASK7 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41208               ; TASK8 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41209               ; TASK9 PAUSE 要求
LD R44200                ; Grp1 ﾎﾟｰｽﾞ要求
OUT R41210               ; TASK10 PAUSE 要求
;<h1/>※隣接ｾﾙへのPAUSE許可
;隣接ｾﾙへのPAUSE許可
LD R42600                ; Grp1_Task0_ﾎﾟｰｽﾞ許可
ORB R41000               ; _Grp1_Task0_起動中ﾌﾗｸﾞ
OR DM2000.1              ; 上流OFFLINE
AND B3605                ; Index->TC ﾎﾟｰｽﾞ要求
ANB B3607                ; Index->TC ﾎﾟｰｽﾞ復帰要求
ANB DM11034.15           ; SRB出力:動作中
OUT B3656                ; TC->Index ﾎﾟｰｽﾞ許可
LD R42605                ; Grp1_Task5_ﾎﾟｰｽﾞ許可
ANB R41205               ; TASK5 PAUSE 要求
RES R42602               ; Grp1_Task2_ﾎﾟｰｽﾞ許可
;<h1/>サイクルタイム
;全体 Cycleを取り込みたいﾀｲﾐﾝｸﾞでMR000 OUTを実行してください。
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB MR000                ; Cycleﾀｲﾑｶｳﾝﾄ
SET R46115               ; _装置ｻｲｸﾙﾀｲﾑ計測中
MPP
AND MR000                ; Cycleﾀｲﾑｶｳﾝﾄ
RES R46115               ; _装置ｻｲｸﾙﾀｲﾑ計測中
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES R46001               ; _装置C/T取得
LDF R46115               ; _装置ｻｲｸﾙﾀｲﾑ計測中
SET R46001               ; _装置C/T取得
;<h1/>払い出しフラグ：TASKにより停止する順番ある場合使用。
LD R46106                ; _定停止移行中
OR R47800                ; _Group1　ﾒﾝﾃ動作定停止移行中
ANB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
SET R57300               ; Task0 停止要求
MPS
ANB R41000               ; _Grp1_Task0_起動中ﾌﾗｸﾞ
SET R57301               ; Task1 停止要求
CON
SET R57304               ; Task4 停止要求
MRD
ANB R41001               ; _Grp1_Task1_起動中ﾌﾗｸﾞ
SET R57302               ; Task2 停止要求
MRD
ANB R41004               ; _Grp1_Task4_起動中ﾌﾗｸﾞ
SET R57305               ; Task5 停止要求
MRD
ANB R41002               ; Grp1_Task2_起動中ﾌﾗｸﾞ
SET R57303               ; Task3 停止要求
MRD
ANB R41005               ; _Grp1_Task5_起動中ﾌﾗｸﾞ
SET R57306               ; Task6 停止要求
MPP
SET R57307               ; Task7 停止要求
CON
SET R57308               ; Task8 停止要求
CON
SET R57309               ; Task9 停止要求
LDB R40100               ; _Group1起動中ﾌﾗｸﾞ
ZRES R57300 R57315       ; Task0 停止要求  受入れTask 受入れ停止要求
;<h1/>エラー履歴クリア要求
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SHOT #50 R15604          ; ｴﾗｰ履歴ｸﾘｱ要求
;<h1/>払出しﾌﾗｸﾞﾘｾｯﾄ
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR20203              ; 払出し停止
;<h1/>※ Message BBS 必要に応じてPAUSE要求修正してください。
LD R58500                ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
MC
LD R46114                ; _装置原点復帰待ち
MEP
SMOV "原点復帰要求" DM3600     ; _BBS1行目表示文字列
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
AND R57315               ; 受入れTask 受入れ停止要求
MEP
SMOV "停止処理中" DM3600      ; _BBS1行目表示文字列
LD R46103                ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46114               ; _装置原点復帰待ち
MEP
SMOV "定停止中" DM3600       ; _BBS1行目表示文字列
LDB R46114               ; _装置原点復帰待ち
MEP
LDB R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46114               ; _装置原点復帰待ち
MEP
ORL
FMOV #0 DM3600 #20       ; _BBS1行目表示文字列
;Message2表示
LD B3605                 ; Index->TC ﾎﾟｰｽﾞ要求
SMOV "組立装置ﾎﾟｰｽﾞ中" DM3621 ; _BBS2行目表示文字列
LDB B3605                ; Index->TC ﾎﾟｰｽﾞ要求
FMOV #0 DM3621 #20       ; _BBS2行目表示文字列
LD= DM3000 #10           ; _MainTP　表示中ﾍﾟｰｼﾞNo
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANF B3605                ; Index->TC ﾎﾟｰｽﾞ要求
DW #2010 DM3008          ; _MainTP　切替ﾍﾟｰｼﾞNo
;Message3表示
LDB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MEP
FMOV #0 DM3642 #20       ; _BBS3行目表示文字列
MCR
;自動動作選択異常
STG R54402               ; ﾊﾟﾗﾒｰﾀNG
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #50 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R200
STG @R200
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
SET R54403               ; ﾊﾟﾗﾒｰﾀ設定ｴﾗｰ解除
CON
ENDS
;<h1/>機種情報出力
LD CR2002                ; 常時ON
LDA DM5260               ; 選択中ｺｰﾄﾞ
CON
STA W2031                ; ﾄﾚﾁｪﾝ機種番号1：CL_2：BK
;<h1/>ｻｰﾁﾌﾗｸﾞﾘｾｯﾄ
LD R18500                ; 軸1 JOG中
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
AND R18404               ; 軸1 軸制御中
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ORL
RES MR20102              ; 接着給材EVｻｰﾁ済
LD R19300                ; 軸2 JOG中
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
AND R19204               ; 軸2 軸制御中
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ORL
RES MR20103              ; 接着除材EVｻｰﾁ済
LD R20100                ; 軸3 JOG中
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
AND R20004               ; 軸3 軸制御中
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ORL
RES MR20100              ; 加圧給材EVｻｰﾁ済
;<h1/>MC軸ﾌﾞﾚｰｷ管理
;軸1_接着冶具給材ｴﾚﾍﾞｰﾀｰﾌﾞﾚｰｷ
LDB R18400               ; 軸1 軸ｴﾗｰ中
ANB R18705               ; 軸1 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
AND R18513               ; 軸1 ｻｰﾎﾞﾚﾃﾞｨ
INV
OR @T1                   ; 軸1減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
RES MR2008               ; SV1_上下冶具給材_BK解除
;ｴﾘｱｾﾝｻｰ遮光後、ﾌﾞﾚｰｷ解除ﾃﾞｨﾚｲ/ｻｰﾎﾞが停止してからﾌﾞﾚｰｷする。
LD R18002                ; 軸1 減速停止
ANB R18404               ; 軸1 軸制御中
TMR @1 #5                ; 軸1減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
;ﾌﾞﾚｰｷ解除状態ﾃﾞｨﾚｲ/ﾌﾞﾚｰｷが解除されてから、軸制御する。
LD MR2008                ; SV1_上下冶具給材_BK解除
TMR #10 #10              ; 軸1ﾌﾞﾚｰｷ解除ok
;軸2_接着冶具除材ｴﾚﾍﾞｰﾀｰﾌﾞﾚｰｷ
LDB R19200               ; 軸2 軸ｴﾗｰ中
ANB R19505               ; 軸2 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
AND R19313               ; 軸2 ｻｰﾎﾞﾚﾃﾞｨ
INV
OR @T2                   ; 軸2減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
RES MR2009               ; SV2_上下冶具除材_BK解除
;ｴﾘｱｾﾝｻｰ遮光後、ﾌﾞﾚｰｷ解除ﾃﾞｨﾚｲ/ｻｰﾎﾞが停止してからﾌﾞﾚｰｷする。
LD R18802                ; 軸2 減速停止
ANB R19204               ; 軸2 軸制御中
TMR @2 #5                ; 軸2減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
;ﾌﾞﾚｰｷ解除状態ﾃﾞｨﾚｲ/ﾌﾞﾚｰｷが解除されてから、軸制御する。
LD MR2009                ; SV2_上下冶具除材_BK解除
TMR #11 #10              ; 軸2ﾌﾞﾚｰｷ解除ok
;軸3_加圧冶具給材ｴﾚﾍﾞｰﾀｰﾌﾞﾚｰｷ
LDB R20000               ; 軸3 軸ｴﾗｰ中
ANB R20305               ; 軸3 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
AND R20113               ; 軸3 ｻｰﾎﾞﾚﾃﾞｨ
INV
OR @T3                   ; 軸3減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
RES MR2010               ; SV3_加圧冶具給材_BK解除
;ｴﾘｱｾﾝｻｰ遮光後、ﾌﾞﾚｰｷ解除ﾃﾞｨﾚｲ/ｻｰﾎﾞが停止してからﾌﾞﾚｰｷする。
LD R19602                ; 軸3 減速停止
ANB R20004               ; 軸3 軸制御中
TMR @3 #5                ; 軸3減速停止後ﾌﾞﾚｰｷﾃﾞｨﾚｲ
;ﾌﾞﾚｰｷ解除状態ﾃﾞｨﾚｲ/ﾌﾞﾚｰｷが解除されてから、軸制御する。
LD MR2010                ; SV3_加圧冶具給材_BK解除
TMR #12 #10              ; 軸3ﾌﾞﾚｰｷ解除ok
;<h1/>ｴﾘｱｾﾝｻｰ管理
;<h1/>加圧冶具側ｴﾘｱｾﾝｻｰ遮光検出
LDB DM11007.2            ; RB1_MOVE
ANB DM11023.2            ; RB3MOVE
ANB DM11031.2            ; RB4MOVE
ANB R20004               ; 軸3 軸制御中
INV
OUT @MR010               ; 加圧冶具側RB移動中
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LD= EM1312 #1            ; RB7Target Pos
OR= EM1312 #2            ; RB7Target Pos
ANL
AND R5210                ; 加圧冶具給材_ﾘﾌﾀ押込み確認
OUT @R000                ; ﾒﾝﾃ加圧給材EVﾄﾚｲ受渡し中
LDB MR20011              ; 加圧冶具側遮光検出
AND @MR010               ; 加圧冶具側RB移動中
MPS
LDB R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
ORB R5308                ; 加圧冶具給材_扉閉確認L
ORB R5309                ; 加圧冶具給材_扉閉確認R
ANB @R000                ; ﾒﾝﾃ加圧給材EVﾄﾚｲ受渡し中
ANB MR20202              ; 加圧給材EVﾄﾚｲ受渡し中
ORB R5310                ; 加圧冶具除材_扉閉確認L
ORB R5311                ; 加圧冶具除材_扉閉確認R
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
ANB R39004               ; ｴﾗｰ中
ANL
@SET @R300
CON
SET MR20011              ; 加圧冶具側遮光検出
MPP
LDB @R000                ; ﾒﾝﾃ加圧給材EVﾄﾚｲ受渡し中
ANB MR20202              ; 加圧給材EVﾄﾚｲ受渡し中
ANL
OUT MR7114               ; 加圧冶具側ｴﾘｱｾﾝｻ_点灯
;遮光時、RB一時停止処理
LD MR20011               ; 加圧冶具側遮光検出
SET DM11207.2            ; RB1STOP
CON
SET DM11223.2            ; RB3STOP
CON
SET DM11231.2            ; RB4STOP
CON
SET R19602               ; 軸3 減速停止
;遮光復帰後、RB一時停止解除
LDF MR20011              ; 加圧冶具側遮光検出
RES DM11207.2            ; RB1STOP
CON
RES DM11223.2            ; RB3STOP
CON
RES DM11231.2            ; RB4STOP
CON
RES R19602               ; 軸3 減速停止
;ｴﾗｰ表示
LD @R300
MPS
ANB R5214                ; 加圧冶具側ｴﾘｱｾﾝｻ_入光(ON)
DW #5214 @DM2            ; SensorNo /ERROR_DISP
MRD
ANB R5308                ; 加圧冶具給材_扉閉確認L
DW #5308 @DM2            ; SensorNo /ERROR_DISP
MRD
ANB R5309                ; 加圧冶具給材_扉閉確認R
DW #5309 @DM2            ; SensorNo /ERROR_DISP
MRD
ANB R5310                ; 加圧冶具除材_扉閉確認L
DW #5310 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R5311                ; 加圧冶具除材_扉閉確認R
DW #5311 @DM2            ; SensorNo /ERROR_DISP
STG @R300
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #44 @DM1              ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R301
STG @R301
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
SET R19905               ; 軸3 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
SET R19600               ; 軸3 軸ｴﾗｰｸﾘｱ
CON
ANB R20000               ; 軸3 軸ｴﾗｰ中
ANB R20305               ; 軸3 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
RES R19600               ; 軸3 軸ｴﾗｰｸﾘｱ
CON
RES R19905               ; 軸3 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
RES MR20011              ; 加圧冶具側遮光検出
CON
ENDS
;<h1/>接着冶具側ｴﾘｱｾﾝｻｰ遮光検出
LDB DM11015.2            ; RB2_MOVE
ANB R18404               ; 軸1 軸制御中
ANB R19204               ; 軸2 軸制御中
ANB DM11023.2            ; RB3MOVE
ANB DM11031.2            ; RB4MOVE
INV
OUT @MR011               ; 接着冶具側RB移動中
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LD= EM1308 #1            ; RB5Target Pos
OR= EM1308 #2            ; RB5Target Pos
ANL
AND R5212                ; 接着冶具給材_ﾘﾌﾀ押込み確認
OUT @R001                ; ﾒﾝﾃ接着給材EVﾄﾚｲ受渡し中
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
LD= EM1310 #1            ; RB6Target Pos
OR= EM1310 #2            ; RB6Target Pos
ANL
AND R5213                ; 接着冶具除材_ﾘﾌﾀ押込み確認
OUT @R002                ; ﾒﾝﾃ接着除材EVﾄﾚｲ受渡し中
LDB MR20012              ; 接着冶具側遮光検出
AND @MR011               ; 接着冶具側RB移動中
ANB @R001                ; ﾒﾝﾃ接着給材EVﾄﾚｲ受渡し中
ANB @R002                ; ﾒﾝﾃ接着除材EVﾄﾚｲ受渡し中
ANB MR20200              ; 接着給材EVﾄﾚｲ受渡し中
ANB MR20201              ; 接着除材EVﾄﾚｲ受渡し中
MPS
LDB R5215                ; 接着冶具側ｴﾘｱｾﾝｻ_入光(ON)
ORB R5312                ; 接着冶具_扉閉確認L
ORB R5313                ; 接着冶具_扉閉確認R
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
ANB R39004               ; ｴﾗｰ中
ANL
@SET @R302
CON
SET MR20012              ; 接着冶具側遮光検出
MPP
OUT MR7115               ; 接着冶具側ｴﾘｱｾﾝｻ_点灯
;遮光時、RB一時停止処理
LDP MR20012              ; 接着冶具側遮光検出
SET DM11223.2            ; RB3STOP
CON
SET DM11231.2            ; RB4STOP
CON
SET DM11215.2            ; RB2STOP
CON
SET R18002               ; 軸1 減速停止
CON
SET R18802               ; 軸2 減速停止
;遮光復帰後、RB一時停止解除
LDF MR20012              ; 接着冶具側遮光検出
RES DM11223.2            ; RB3STOP
CON
RES DM11231.2            ; RB4STOP
CON
RES R19105               ; 軸2 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
RES DM11215.2            ; RB2STOP
CON
RES R18002               ; 軸1 減速停止
CON
RES R18802               ; 軸2 減速停止
;ｴﾗｰ表示
LD @R302
MPS
ANB R5215                ; 接着冶具側ｴﾘｱｾﾝｻ_入光(ON)
DW #5215 @DM2            ; SensorNo /ERROR_DISP
MRD
ANB R5312                ; 接着冶具_扉閉確認L
DW #5312 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R5313                ; 接着冶具_扉閉確認R
DW #5313 @DM2            ; SensorNo /ERROR_DISP
STG @R302
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #45 @DM1              ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R303
STG @R303
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
SET R18000               ; 軸1 軸ｴﾗｰｸﾘｱ
CON
SET R18305               ; 軸1 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
SET R18800               ; 軸2 軸ｴﾗｰｸﾘｱ
CON
SET R19105               ; 軸2 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
ANB R18400               ; 軸1 軸ｴﾗｰ中
ANB R18705               ; 軸1 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
ANB R19200               ; 軸2 軸ｴﾗｰ中
ANB R19505               ; 軸2 ﾄﾞﾗｲﾊﾞｱﾗｰﾑ
RES R18000               ; 軸1 軸ｴﾗｰｸﾘｱ
CON
RES R18305               ; 軸1 ﾄﾞﾗｲﾊﾞｱﾗｰﾑﾘｾｯﾄ
CON
RES R18800               ; 軸2 軸ｴﾗｰｸﾘｱ
CON
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
RES MR20012              ; 接着冶具側遮光検出
CON
ENDS
;ｼｽﾃﾑ立ち上がり待ち
LD CR2008                ; 運転開始時1ｽｷｬﾝON
RES MR20108              ; ｼｽﾃﾑ立ち上がり済
LD= DM3008 #10           ; _MainTP　切替ﾍﾟｰｼﾞNo
SET MR20108              ; ｼｽﾃﾑ立ち上がり済
;ｽｶﾗRB(RC700)立ち上がり待ち
LD MR20108               ; ｼｽﾃﾑ立ち上がり済
AND R58500               ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
TMR #14 #100             ; ｽｶﾗRB立上り完了
LDB T14                  ; ｽｶﾗRB立上り完了
AND R58500               ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
MSTRT MSG_DISP #1 #5 #0 #0
LD T14                   ; ｽｶﾗRB立上り完了
SHOT #50 @R101
LD @R101
MSTRT MSG_DEL #1 #5
;ｸﾘｰﾝﾕﾆｯﾄ1ｱﾗｰﾑ1
LDB R4004                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1_ｱﾗｰﾑ1
ANB R39004               ; ｴﾗｰ中
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
@SET @R306
STG @R306
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #40 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R307
STG @R307
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;ｸﾘｰﾝﾕﾆｯﾄ1ｱﾗｰﾑ2
LDB R4005                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ1_ｱﾗｰﾑ2
ANB R39004               ; ｴﾗｰ中
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
@SET @R308
STG @R308
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #41 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R309
STG @R309
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;ｸﾘｰﾝﾕﾆｯﾄ2ｱﾗｰﾑ1
LDB R4006                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2_ｱﾗｰﾑ1
ANB R39004               ; ｴﾗｰ中
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
@SET @R310
STG @R310
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #42 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R311
STG @R311
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;ｸﾘｰﾝﾕﾆｯﾄ2ｱﾗｰﾑ2
LDB R4007                ; ｴｱｰｸﾘｰﾝﾕﾆｯﾄ2_ｱﾗｰﾑ2
ANB R39004               ; ｴﾗｰ中
AND MR20108              ; ｼｽﾃﾑ立ち上がり済
@SET @R312
STG @R312
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #43 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R313
STG @R313
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;元真空ｴﾗｰ
LDB R014                 ; 元真空検出
ANB R39004               ; ｴﾗｰ中
TMR #13 #30              ; 元真空異常ﾀｲﾏ
CON
AND T13                  ; 元真空異常ﾀｲﾏ
@SET @R314
STG @R314
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #46 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
SET @MR100               ; ERROR
CON
JMP @R315
STG @R315
AND @MR101               ;  ｴﾗｰ完了
AND @MR105               ; SW1
RES @MR101               ;  ｴﾗｰ完了
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;<h1/>ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task0 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task0 ERROR Busy
CON
SET @MR101               ;  ｴﾗｰ完了
CON
ENDS
END
ENDH
