DEVICE:53
;MODULE:Sensor
;MODULE_TYPE:0
;OneSystem UserOpen-Module
;
;-----------------------------------------
;ModuleName	:	SENSOR
;ModuleType	:	User Open Module
;Function	:	SENSOR Monitor
;-----------------------------------------
;*1送信毎に送信ﾌｧｲﾙ削除
;Copylight(C) 2011 SEIKO EPSON Corp. All rights reserved.
;<h1/>TASK 0　ｼﾘﾝﾀﾞｰ ｾﾝｻｰ監視
;
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R46200               ; _安全ｶﾊﾞｰ1開中
ANB R39004               ; ｴﾗｰ中
ANB R59915               ; _運転ﾓｰﾄﾞ指定
MC
;TASK0  ｽｶﾗRB
LD MR7300                ; ﾊﾝﾄﾞ1 下降
ANB MR7301               ; ﾊﾝﾄﾞ1 上昇
LDB R4500                ; ﾊﾝﾄﾞ1 下降端
OR R4501                 ; ﾊﾝﾄﾞ1 上昇端
ANL
TMR @10 #20
CON
AND @T10
DW #4500 DM60009         ; Sensor ERROR No.
CON
SET MR4500               ; ﾊﾝﾄﾞ1 下降端異常
LDB MR7300               ; ﾊﾝﾄﾞ1 下降
AND MR7301               ; ﾊﾝﾄﾞ1 上昇
LDB R4501                ; ﾊﾝﾄﾞ1 上昇端
OR R4500                 ; ﾊﾝﾄﾞ1 下降端
ANL
TMR @11 #20
CON
AND @T11
DW #4501 DM60009         ; Sensor ERROR No.
CON
SET MR4501               ; ﾊﾝﾄﾞ1 上昇端異常
LD MR7302                ; ﾊﾝﾄﾞ2 下降
ANB MR7303               ; ﾊﾝﾄﾞ2 上昇
LDB R4502                ; ﾊﾝﾄﾞ2 下降端
OR R4503                 ; ﾊﾝﾄﾞ2 上昇端
ANL
TMR @12 #20
CON
AND @T12
DW #4502 DM60009         ; Sensor ERROR No.
CON
SET MR4502               ; ﾊﾝﾄﾞ2 下降端異常
LDB MR7302               ; ﾊﾝﾄﾞ2 下降
AND MR7303               ; ﾊﾝﾄﾞ2 上昇
LDB R4503                ; ﾊﾝﾄﾞ2 上昇端
OR R4502                 ; ﾊﾝﾄﾞ2 下降端
ANL
TMR @13 #20
CON
AND @T13
DW #4503 DM60009         ; Sensor ERROR No.
CON
SET MR4503               ; ﾊﾝﾄﾞ2 上昇端異常
;TASK1  ﾌｰﾌﾟ打抜き
LD MR7202                ; ﾌｰﾌﾟ厚み測定ﾍｯﾄﾞ下降
ANB MR7203               ; ﾌｰﾌﾟ厚み測定ﾍｯﾄﾞ上昇
LDB R4400                ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ下降端
OR R4401                 ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ上昇端
ANL
TMR @20 #20
CON
AND @T20
DW #4400 DM60009         ; Sensor ERROR No.
CON
SET MR4400               ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ下降端異常
LDB MR7202               ; ﾌｰﾌﾟ厚み測定ﾍｯﾄﾞ下降
AND MR7203               ; ﾌｰﾌﾟ厚み測定ﾍｯﾄﾞ上昇
LDB R4401                ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ上昇端
OR R4400                 ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ下降端
ANL
TMR @21 #20
CON
AND @T21
DW #4401 DM60009         ; Sensor ERROR No.
CON
SET MR4401               ; ﾌｨﾙﾀ厚み測定ﾍｯﾄﾞ上昇端異常
LD MR7008                ; ﾌｨﾙﾀ切断 上昇
ANB MR7009               ; ﾌｨﾙﾀ切断 下降
LDB R4410                ; ﾌｨﾙﾀ切断 上昇端
OR R4411                 ; ﾌｨﾙﾀ切断 下降端
ANL
TMR @22 #20
CON
AND @T22
DW #4410 DM60009         ; Sensor ERROR No.
CON
SET MR4410               ; ﾌｨﾙﾀ切断 上昇端異常
LDB MR7008               ; ﾌｨﾙﾀ切断 上昇
AND MR7008               ; ﾌｨﾙﾀ切断 上昇
LDB R4411                ; ﾌｨﾙﾀ切断 下降端
OR R4410                 ; ﾌｨﾙﾀ切断 上昇端
ANL
TMR @23 #20
CON
AND @T23
DW #4411 DM60009         ; Sensor ERROR No.
CON
SET MR4411               ; ﾌｨﾙﾀ切断 下降端異常
LD MR7104                ; ﾀﾞｲｾｯﾄ吸引 ON
ANB MR7105               ; ﾀﾞｲｾｯﾄ吸引 OFF
LDB R4414                ; ﾀﾞｲｾｯﾄ吸引 ON側（ｹﾞｰﾄﾊﾞﾙﾌﾞ）
OR R4415                 ; ﾀﾞｲｾｯﾄ吸引 OFF側（ｹﾞｰﾄﾊﾞﾙﾌﾞ）
ANL
TMR @24 #20
CON
AND @T24
DW #4414 DM60009         ; Sensor ERROR No.
CON
SET MR4414               ; ﾀﾞｲｾｯﾄ吸引 ON側異常
LDB MR7104               ; ﾀﾞｲｾｯﾄ吸引 ON
AND MR7105               ; ﾀﾞｲｾｯﾄ吸引 OFF
LDB R4415                ; ﾀﾞｲｾｯﾄ吸引 OFF側（ｹﾞｰﾄﾊﾞﾙﾌﾞ）
OR R4414                 ; ﾀﾞｲｾｯﾄ吸引 ON側（ｹﾞｰﾄﾊﾞﾙﾌﾞ）
ANL
TMR @25 #20
CON
AND @T25
DW #4415 DM60009         ; Sensor ERROR No.
CON
SET MR4415               ; ﾀﾞｲｾｯﾄ吸引 OFF側異常
;TASK2  仮置きﾕﾆｯﾄ
LD MR7106                ; 仮置き1/2 長辺位置決め 閉じ
ANB MR7107               ; 仮置き1/2 長辺位置決め 開き
LDB R4200                ; 仮置き1/2長辺位置決め 閉じ
OR R4201                 ; 仮置き1/2長辺位置決め 開き
ANL
TMR @30 #20
CON
AND @T30
DW #4200 DM60009         ; Sensor ERROR No.
CON
SET MR4200               ; 仮置き1/2長辺位置決め 閉じ異常
LDB MR7106               ; 仮置き1/2 長辺位置決め 閉じ
AND MR7107               ; 仮置き1/2 長辺位置決め 開き
LDB R4201                ; 仮置き1/2長辺位置決め 開き
OR R4200                 ; 仮置き1/2長辺位置決め 閉じ
ANL
TMR @31 #20
CON
AND @T31
DW #4201 DM60009         ; Sensor ERROR No.
CON
SET MR4201               ; 仮置き1/2長辺位置決め 開き異常
LD MR7108                ; 仮置き1/2 短辺位置決め 閉じ
ANB MR7109               ; 仮置き1/2 短辺位置決め 開き
LDB R4202                ; 仮置き1/2短辺位置決め 閉じ
OR R4203                 ; 仮置き1/2短辺位置決め 開き
ANL
TMR @32 #20
CON
AND @T32
DW #4202 DM60009         ; Sensor ERROR No.
CON
SET MR4202               ; 仮置き1/2短辺位置決め 閉じ異常
LDB MR7108               ; 仮置き1/2 短辺位置決め 閉じ
AND MR7109               ; 仮置き1/2 短辺位置決め 開き
LDB R4203                ; 仮置き1/2短辺位置決め 開き
OR R4202                 ; 仮置き1/2短辺位置決め 閉じ
ANL
TMR @33 #20
CON
AND @T33
DW #4203 DM60009         ; Sensor ERROR No.
CON
SET MR4203               ; 仮置き1/2短辺位置決め 開き異常
LD MR7110                ; 仮置き3/4 長辺位置決め 閉じ
ANB MR7111               ; 仮置き3/4 長辺位置決め 開き
LDB R4204                ; 仮置き3/4長辺位置決め 閉じ
OR R4205                 ; 仮置き3/4長辺位置決め 開き
ANL
TMR @34 #20
CON
AND @T34
DW #4204 DM60009         ; Sensor ERROR No.
CON
SET MR4204               ; 仮置き3/4長辺位置決め 閉じ異常
LDB MR7110               ; 仮置き3/4 長辺位置決め 閉じ
AND MR7111               ; 仮置き3/4 長辺位置決め 開き
LDB R4205                ; 仮置き3/4長辺位置決め 開き
OR R4204                 ; 仮置き3/4長辺位置決め 閉じ
ANL
TMR @35 #20
CON
AND @T35
DW #4205 DM60009         ; Sensor ERROR No.
CON
SET MR4101               ; 溶着1 上昇端異常
LD MR7112                ; 仮置き3/4 短辺位置決め 閉じ
ANB MR7113               ; 仮置き3/4 短辺位置決め 開き
LDB R4206                ; 仮置き3/4短辺位置決め 閉じ
OR R4207                 ; 仮置き3/4短辺位置決め 開き
ANL
TMR @36 #20
CON
AND @T36
DW #4206 DM60009         ; Sensor ERROR No.
CON
SET MR4206               ; 仮置き3/4短辺位置決め 閉じ異常
LDB MR7112               ; 仮置き3/4 短辺位置決め 閉じ
AND MR7113               ; 仮置き3/4 短辺位置決め 開き
LDB R4207                ; 仮置き3/4短辺位置決め 開き
OR R4206                 ; 仮置き3/4短辺位置決め 閉じ
ANL
TMR @37 #20
CON
AND @T37
DW #4207 DM60009         ; Sensor ERROR No.
CON
SET MR4207               ; 仮置き3/4短辺位置決め 開き異常
;TASK3  ﾌﾚｰﾑ搬送
LD MR7114                ; ﾌﾚｰﾑｾｯﾄ 下降
ANB MR7115               ; ﾌﾚｰﾑｾｯﾄ 上昇
MPS
LDB R4300                ; ﾌﾚｰﾑｾｯﾄ1 下降端(手前側)
OR R4301                 ; ﾌﾚｰﾑｾｯﾄ1 上昇端(手前側)
ANL
TMR @40 #20
CON
AND @T40
DW #4300 DM60009         ; Sensor ERROR No.
CON
SET MR4300               ; ﾌﾚｰﾑｾｯﾄ1 下降端(手前側)異常
MPP
LDB R4302                ; ﾌﾚｰﾑｾｯﾄ2 下降端(奥側)
OR R4303                 ; ﾌﾚｰﾑｾｯﾄ2 上昇端(奥側)
ANL
TMR @41 #20
CON
AND @T41
DW #4302 DM60009         ; Sensor ERROR No.
CON
SET MR4302               ; ﾌﾚｰﾑｾｯﾄ2 下降端(奥側)異常
LDB MR7114               ; ﾌﾚｰﾑｾｯﾄ 下降
AND MR7115               ; ﾌﾚｰﾑｾｯﾄ 上昇
MPS
LDB R4301                ; ﾌﾚｰﾑｾｯﾄ1 上昇端(手前側)
OR R4300                 ; ﾌﾚｰﾑｾｯﾄ1 下降端(手前側)
ANL
TMR @42 #20
CON
AND @T42
DW #4301 DM60009         ; Sensor ERROR No.
CON
SET MR4301               ; ﾌﾚｰﾑｾｯﾄ1 上昇端(手前側)異常
MPP
LDB R4303                ; ﾌﾚｰﾑｾｯﾄ2 上昇端(奥側)
OR R4302                 ; ﾌﾚｰﾑｾｯﾄ2 下降端(奥側)
ANL
TMR @43 #20
CON
AND @T43
DW #4303 DM60009         ; Sensor ERROR No.
CON
SET MR4303               ; ﾌﾚｰﾑｾｯﾄ2 上昇端(奥側)異常
LD MR7200                ; ﾌﾚｰﾑｾｯﾄ 前進(ｸﾗﾝﾌﾟ側へ)
ANB MR7201               ; ﾌﾚｰﾑｾｯﾄ 後退(逃げ側へ)
MPS
LDB R4304                ; ﾌﾚｰﾑｾｯﾄ前後1 ｸﾗﾝﾌﾟ側端
OR R4305                 ; ﾌﾚｰﾑｾｯﾄ前後1 逃げ端
ANL
TMR @44 #20
CON
AND @T44
DW #4304 DM60009         ; Sensor ERROR No.
CON
SET MR4304               ; ﾌﾚｰﾑｾｯﾄ前後1 ｸﾗﾝﾌﾟ側端異常
MPP
LDB R4306                ; ﾌﾚｰﾑｾｯﾄ前後2 ｸﾗﾝﾌﾟ側端
OR R4307                 ; ﾌﾚｰﾑｾｯﾄ前後2 逃げ端
ANL
TMR @45 #20
CON
AND @T45
DW #4306 DM60009         ; Sensor ERROR No.
CON
SET MR4306               ; ﾌﾚｰﾑｾｯﾄ前後2 ｸﾗﾝﾌﾟ側端異常
LDB MR7200               ; ﾌﾚｰﾑｾｯﾄ 前進(ｸﾗﾝﾌﾟ側へ)
AND MR7201               ; ﾌﾚｰﾑｾｯﾄ 後退(逃げ側へ)
MPS
LDB R4305                ; ﾌﾚｰﾑｾｯﾄ前後1 逃げ端
OR R4304                 ; ﾌﾚｰﾑｾｯﾄ前後1 ｸﾗﾝﾌﾟ側端
ANL
TMR @46 #20
CON
AND @T46
DW #4305 DM60009         ; Sensor ERROR No.
CON
SET MR4305               ; ﾌﾚｰﾑｾｯﾄ前後1 逃げ端異常
MPP
LDB R4307                ; ﾌﾚｰﾑｾｯﾄ前後2 逃げ端
OR R4306                 ; ﾌﾚｰﾑｾｯﾄ前後2 ｸﾗﾝﾌﾟ側端
ANL
TMR @47 #20
CON
AND @T47
DW #4307 DM60009         ; Sensor ERROR No.
CON
SET MR4307               ; ﾌﾚｰﾑｾｯﾄ前後2 逃げ端異常
;TASK4  溶着ﾕﾆｯﾄ
LD MR7100                ; 溶着1 下降
ANB MR7101
LDB R4100                ; 溶着1 下降端
OR R4101                 ; 溶着1 上昇端
ANL
TMR @50 #20
CON
AND @T50
AND CR2003               ; 常時OFF
DW #4100 DM60009         ; Sensor ERROR No.
CON
SET MR4100               ; 溶着1 下降端異常
LDB MR7100               ; 溶着1 下降
AND MR7101
LDB R4101                ; 溶着1 上昇端
OR R4100                 ; 溶着1 下降端
ANL
TMR @51 #20
CON
AND @T51
DW #4101 DM60009         ; Sensor ERROR No.
CON
SET MR4101               ; 溶着1 上昇端異常
LD MR7102                ; 溶着2 下降
ANB MR7103
LDB R4102                ; 溶着2 下降端
OR R4103                 ; 溶着2 上昇端
ANL
TMR @52 #20
CON
AND @T52
AND CR2003               ; 常時OFF
DW #4102 DM60009         ; Sensor ERROR No.
CON
SET MR4102               ; 溶着2 下降端異常
LDB MR7102               ; 溶着2 下降
AND MR7103
LDB R4103                ; 溶着2 上昇端
OR R4102                 ; 溶着2 下降端
ANL
TMR @53 #20
CON
AND @T53
DW #4103 DM60009         ; Sensor ERROR No.
CON
SET MR4103               ; 溶着2 上昇端異常
LD MR7304                ; 段差ﾛｰﾗ 下降
ANB MR7305               ; 段差ﾛｰﾗ 上昇
LDB R4108                ; ﾀﾞﾝｻｰﾛｰﾗ 下降端
OR R4109                 ; ﾀﾞﾝｻｰﾛｰﾗ 上昇端
ANL
TMR @54 #20
CON
AND @T54
DW #4108 DM60009         ; Sensor ERROR No.
CON
SET MR4108               ; ﾀﾞﾝｻｰﾛｰﾗ 下降端異常
LDB MR7304               ; 段差ﾛｰﾗ 下降
AND MR7305               ; 段差ﾛｰﾗ 上昇
LDB R4109                ; ﾀﾞﾝｻｰﾛｰﾗ 上昇端
OR R4108                 ; ﾀﾞﾝｻｰﾛｰﾗ 下降端
ANL
TMR @55 #20
CON
AND @T55
DW #4109 DM60009         ; Sensor ERROR No.
CON
SET MR4109               ; ﾀﾞﾝｻｰﾛｰﾗ 上昇端異常
LD MR7306                ; ｾﾞﾛﾃﾝｼｮﾝ 下降
ANB MR7307               ; ｾﾞﾛﾃﾝｼｮﾝ 上昇
LDB R4110                ; ｾﾞﾛﾃﾝｼｮﾝ 下降端
OR R4111                 ; ｾﾞﾛﾃﾝｼｮﾝ 上昇端
ANL
TMR @56 #20
CON
AND @T56
DW #4110 DM60009         ; Sensor ERROR No.
CON
SET MR4110               ; ｾﾞﾛﾃﾝｼｮﾝ 下降端異常
LDB MR7306               ; ｾﾞﾛﾃﾝｼｮﾝ 下降
AND MR7307               ; ｾﾞﾛﾃﾝｼｮﾝ 上昇
LDB R4111                ; ｾﾞﾛﾃﾝｼｮﾝ 上昇端
OR R4110                 ; ｾﾞﾛﾃﾝｼｮﾝ 下降端
ANL
TMR @57 #20
CON
AND @T57
DW #4111 DM60009         ; Sensor ERROR No.
CON
SET MR4111               ; ｾﾞﾛﾃﾝｼｮﾝ 上昇端異常
LD MR7308                ; ﾃｰﾌﾟ ゆるめ
ANB MR7309               ; ﾃｰﾌﾟ 締め
LDB R4112                ; ﾃｰﾌﾟ ゆるめ側端
OR R4113                 ; ﾃｰﾌﾟ 締め側端
ANL
TMR @58 #20
CON
AND @T58
DW #4112 DM60009         ; Sensor ERROR No.
CON
SET MR4112               ; ﾃｰﾌﾟ ゆるめ側端異常
LDB MR7308               ; ﾃｰﾌﾟ ゆるめ
AND MR7309               ; ﾃｰﾌﾟ 締め
LDB R4113                ; ﾃｰﾌﾟ 締め側端
OR R4112                 ; ﾃｰﾌﾟ ゆるめ側端
ANL
TMR @59 #20
CON
AND @T59
DW #4113 DM60009         ; Sensor ERROR No.
CON
SET MR4113               ; ﾃｰﾌﾟ 締め側端異常
;TASK5  反転ﾕﾆｯﾄ
MCR
;TASK0 Sensor ERROR
LD>= DM60009 #4500       ; Sensor ERROR No.
AND<= DM60009 #4303      ; Sensor ERROR No.
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #0 @DM0               ; TaskNo /ERROR_DISP
CON
DW #0 @DM1               ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
LDA DM60009              ; Sensor ERROR No.
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; Task0 ERROR
CON
SET @R000
;TASK1 Sensor ERROR
LD>= DM60009 #4400       ; Sensor ERROR No.
AND<= DM60009 #4411      ; Sensor ERROR No.
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1 @DM0               ; TaskNo /ERROR_DISP
CON
DW #0 @DM1               ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
LDA DM60009              ; Sensor ERROR No.
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; Task0 ERROR
CON
SET @R000
;TASK2 Sensor ERROR
LD>= DM60009 #4200       ; Sensor ERROR No.
AND<= DM60009 #4207      ; Sensor ERROR No.
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #2 @DM0               ; TaskNo /ERROR_DISP
CON
DW #0 @DM1               ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
LDA DM60009              ; Sensor ERROR No.
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; Task0 ERROR
CON
SET @R000
;TASK3 Sensor ERROR
LD>= DM60009 #4300       ; Sensor ERROR No.
AND<= DM60009 #4307      ; Sensor ERROR No.
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #3 @DM0               ; TaskNo /ERROR_DISP
CON
DW #0 @DM1               ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
LDA DM60009              ; Sensor ERROR No.
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; Task0 ERROR
CON
SET @R000
;TASK4 Sensor ERROR
LD>= DM60009 #4100       ; Sensor ERROR No.
AND<= DM60009 #4113      ; Sensor ERROR No.
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #4 @DM0               ; TaskNo /ERROR_DISP
CON
DW #0 @DM1               ; ErrorNo /ERROR_DISP
CON
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
LDA DM60009              ; Sensor ERROR No.
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; Task0 ERROR
CON
SET @R000
;
STG @R000
AND @R101                ; Task0 ERROR_End
RES @R101                ; Task0 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
ZRES MR4100 MR4515       ; 溶着1 下降端異常
CON
DW #0 DM60009            ; Sensor ERROR No.
CON
ENDS
;MyTask Error Process Substance/エラー処理実体
STG @R100                ; Task0 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @R105 @R108         ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @R102                ; Task0 ERROR Busy
CON
JMP @R103
STG @R103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
JMP @R104
STG @R104
ANB R39002               ; ERROR_DISP Busy
RES @R102                ; Task0 ERROR Busy
CON
SET @R101                ; Task0 ERROR_End
CON
ENDS
END
ENDH
