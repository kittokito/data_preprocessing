DEVICE:53
;MODULE:Group1_Task4
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task4
;ModuleType	:	Main Module
;Line		:	μTFP CAV Plate Assembly Line
;Cell		:	<NR> 2Cell
;Function	:	ｲﾝﾃﾞｯｸｽから除材
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000〜@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100〜@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;Home			@MR1000〜@MR1915		HOME動作時使用ｴﾘｱ
;Maintenance		@MR2000〜@MR2915		MAINTE動作時使用ｴﾘｱ
;Auto(Main1)		@MR3000〜@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000〜@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;Subroutine		@MR4500〜@MR5915		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG〜JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR10400              ; 点灯/消灯制御入力(L1)
CON
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
ZRES @R000 @R115         ; RB6動作開始
CON
ZRES @MR100 @MR5915      ; Task4 ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
LD CR2002                ; 常時ON
FLIK #30 #30 @MR004      ; ﾌﾘｯｶ
LD= DM60000 #4           ; TaskNo /ERROR_DISP
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK4 ERROR
;ON STG Main1
;TYPE EM632.U,EM633.U,@MR000.U,@MR3000.U
;
;FOR EM632 = EM632 TO 160 STEP 16
;	IF @MR3000:EM632 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM632 < 160 THEN
;	EM633 = (EM632 / 16) * 100 + DMX(@MR3000:EM632) + #3000
;END IF		
;		
;EM632 = EM632 + 16		
;IF EM632 > 160 THEN		
;	EM632 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM632.U,EM633.U,@MR000.U,@MR3000.U
;
;FOR EM632 = EM632 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM632 EM632          ; Task4 Main1@MR  Task4 Main1@MR
LABEL #2000
LD> EM632 #160           ; Task4 Main1@MR
CJ #2001
;	IF @MR3000:EM632 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0      ; AUTO Main1
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
ADD #16
CON
STA EM632                ; Task4 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM632 < 160 THEN
;
LD< EM632 #160           ; Task4 Main1@MR
NCJ #2004
;	EM633 = (EM632 / 16) * 100 + DMX(@MR3000:EM632) + #3000
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12          ; AUTO Main1
CON
DMX
CON
STA @VM0
CON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM633                ; Task4 Main1@MR
;END IF		
;
LABEL #2004
;EM632 = EM632 + 16		
;
LD CR2002                ; 常時ON
LDA EM632                ; Task4 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM632                ; Task4 Main1@MR
;IF EM632 > 160 THEN		
;
LD> EM632 #160           ; Task4 Main1@MR
NCJ #2005
;	EM632 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM632             ; Task4 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM634.U,EM635.U,@MR4000.U
;
;FOR EM634 = EM634 TO 80 STEP 16
;	IF @MR4000:EM634 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM634 < 80 THEN
;	EM635 = (EM634 / 16) * 100 + DMX(@MR4000:EM634) + #4000
;END IF
;
;EM634 = EM634 + 16		
;
;IF EM634 > 80 THEN
;	EM634 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM634.U,EM635.U,@MR4000.U
;
;FOR EM634 = EM634 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM634 EM634          ; Task4 Main2@MR  Task4 Main2@MR
LABEL #2006
LD> EM634 #80            ; Task4 Main2@MR
CJ #2007
;	IF @MR4000:EM634 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0      ; AUTO Main2
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
ADD #16
CON
STA EM634                ; Task4 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM634 < 80 THEN
;
LD< EM634 #80            ; Task4 Main2@MR
NCJ #2010
;	EM635 = (EM634 / 16) * 100 + DMX(@MR4000:EM634) + #4000
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12          ; AUTO Main2
CON
DMX
CON
STA @VM3
CON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM635                ; Task4 Main2@MR
;END IF
;
LABEL #2010
;EM634 = EM634 + 16		
;
LD CR2002                ; 常時ON
LDA EM634                ; Task4 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM634                ; Task4 Main2@MR
;IF EM634 > 80 THEN
;
LD> EM634 #80            ; Task4 Main2@MR
NCJ #2011
;	EM634 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM634             ; Task4 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM636.U,EM637.U,@MR4500.U
;	
;FOR EM636 = EM636 TO 320 STEP 16
;	IF @MR4500:EM636 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM636 < 320 THEN
;	EM637 = (EM636 / 16) * 100 + DMX(@MR4500:EM636) + #4500
;END IF
;		
;EM636 = EM636 + 16	
;
;IF EM636 > 320 THEN
;   EM636 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM636.U,EM637.U,@MR4500.U
;
;FOR EM636 = EM636 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM636 EM636          ; Task4 Sub@MR  Task4 Sub@MR
LABEL #2012
LD> EM636 #320           ; Task4 Sub@MR
CJ #2013
;	IF @MR4500:EM636 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; 除材準備開始
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
ADD #16
CON
STA EM636                ; Task4 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM636 < 320 THEN
;
LD< EM636 #320           ; Task4 Sub@MR
NCJ #2016
;	EM637 = (EM636 / 16) * 100 + DMX(@MR4500:EM636) + #4500
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; 除材準備開始
CON
DMX
CON
STA @VM6
CON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM637                ; Task4 Sub@MR
;END IF
;
LABEL #2016
;EM636 = EM636 + 16	
;
LD CR2002                ; 常時ON
LDA EM636                ; Task4 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM636                ; Task4 Sub@MR
;IF EM636 > 320 THEN
;
LD> EM636 #320           ; Task4 Sub@MR
NCJ #2017
;   EM636 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM636             ; Task4 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR804                ; _Grp1_Task4_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR404                ; _Grp1_Task4_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5204               ; _Grp1_Task4_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES @MR3515              ; 最終除材動作中
CON
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
JMP LR5404               ; _Grp1_Task4_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5604               ; _Grp1_Task4_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR604                ; _Grp1_Task4_Fin.STG
RES MR22604              ; TASK0→TASK4 HOLD
CON
RES R41004               ; _Grp1_Task4_起動中ﾌﾗｸﾞ
CON
ENDS
;<h1/>HOME
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
;各種条件
LD<=.L DM11132 DM11122   ; X軸 現在位置-5mm  RB8 現在位置1
AND<=.L DM11122 DM11130  ; RB8 現在位置1  X軸 現在位置+5mm
AND>=.L DM11142 +3000    ; RB9 現在位置1
ANB CR2002               ; 常時ON
OUT @MR1009              ; 吸着ﾍｯﾄﾞ ﾜｰｸｾｯﾄﾃｰﾌﾞﾙ内有り
;TASK4 原点復帰ﾒｲﾝ
STG LR5204               ; _Grp1_Task4_HOME.STG
ANB @MR001               ; TASK4 ERROR
MPS
ANB R41204               ; TASK4 PAUSE 
JMP @MR1000              ; HOME
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR1000              ; HOME
JMP @MR1100
STG @MR1100
ANB @MR1001              ; TASK4　原点復帰動作中
SET @MR1001              ; TASK4　原点復帰動作中
CON
JMP @MR1101
STG @MR1101
MPS
ANB @MR1009              ; 吸着ﾍｯﾄﾞ ﾜｰｸｾｯﾄﾃｰﾌﾞﾙ内有り
SET @MR1200              ; 除材RB部原点復帰
CON
SET @MR1300              ; 搬送RB部原点復帰
CON
JMP @MR1102
MPP
AND @MR1009              ; 吸着ﾍｯﾄﾞ ﾜｰｸｾｯﾄﾃｰﾌﾞﾙ内有り
ENDS
STG @MR1102
AND @MR1202              ; 除材RB部原点復帰完了
AND @MR1302              ; 搬送RB部原点復帰完了
RES @MR1202              ; 除材RB部原点復帰完了
CON
RES @MR1302              ; 搬送RB部原点復帰完了
CON
JMP @MR1515              ; HOME END
STG @MR1515              ; HOME END
ANB @MR001               ; TASK4 ERROR
SET MR008                ; TASK4原点復帰完了
CON
RES @MR1001              ; TASK4　原点復帰動作中
CON
JMP LR604                ; _Grp1_Task4_Fin.STG
;除材RB部の原点復帰
STG @MR1200              ; 除材RB部原点復帰
SET @MR1201              ; 除材RB部原点復帰中
CON
ANB @MR1009              ; 吸着ﾍｯﾄﾞ ﾜｰｸｾｯﾄﾃｰﾌﾞﾙ内有り
RES MR18200              ; RB6:動作完了
CON
RES MR18202              ; RB6:原点復帰完了
CON
JMP @MR1203
STG @MR1203
SET MR18209              ; RB6:ARMRST
CON
JMP @MR1204
STG @MR1204
MPS
AND MR18200              ; RB6:動作完了
RES MR18200              ; RB6:動作完了
CON
JMP @MR1208
MPP
ANB MR18200              ; RB6:動作完了
TMR @100 #50
CON
AND @T100
RES MR18200              ; RB6:動作完了
CON
SET @MR800               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ動作異常
CON
JMP @MR1205
STG @MR1205
AND R39004               ; ｴﾗｰ中
JMP @MR1207
STG @MR1207
ANB R39004               ; ｴﾗｰ中
AND @MR4007              ; SW1 ｴﾗｰ解除
RES @MR4007              ; SW1 ｴﾗｰ解除
CON
SET MR6005               ; RBC2 RB8 停止
CON
SET MR6006               ; RBC2 RB9 停止
CON
JMP @MR1200              ; 除材RB部原点復帰
STG @MR1208
TMR @101 #3
CON
AND @T101
SET MR18204              ; RB6:HOME
CON
JMP @MR1209
STG @MR1209
MPS
AND MR18202              ; RB6:原点復帰完了
SET MR3307               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済
CON
RES MR18202              ; RB6:原点復帰完了
CON
JMP @MR1212
MPP
ANB MR18202              ; RB6:原点復帰完了
TMR @102 #300
CON
AND @T102
SET @MR800               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ動作異常
CON
RES MR3307               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済
CON
RES MR18202              ; RB6:原点復帰完了
CON
JMP @MR1210
STG @MR1210
AND R39004               ; ｴﾗｰ中
JMP @MR1211
STG @MR1211
ANB R39004               ; ｴﾗｰ中
AND @MR4007              ; SW1 ｴﾗｰ解除
RES @MR4007              ; SW1 ｴﾗｰ解除
CON
JMP @MR1208
STG @MR1212
DW #1 DM11028            ; RB6 目標ﾎﾟｲﾝﾄ番号
CON
SET @R000                ; RB6動作開始
CON
JMP @MR1213
STG @MR1213
AND @R001                ; RB6動作完了
RES @R001                ; RB6動作完了
CON
JMP @MR1215
STG @MR1215
RES @MR1201              ; 除材RB部原点復帰中
CON
SET @MR1202              ; 除材RB部原点復帰完了
CON
ENDS
;搬送ﾛﾎﾞｯﾄ部の原点復帰
STG @MR1300              ; 搬送RB部原点復帰
RES MR19002              ; RB4:原点復帰完了
CON
RES MR18802              ; RB3:原点復帰完了
CON
JMP @MR1303
STG @MR1303
SET @MR1301              ; 搬送RB部原点復帰中
CON
SET MR19009              ; RB4:ARMRST
CON
SET MR19209              ; RB8:ARMRST
CON
SET MR19409              ; RB9:ARMRST
CON
SET MR18809              ; RB3:ARMRST
CON
JMP @MR1304
STG @MR1304
MPS
LD MR19000               ; RB4:動作完了
AND MR19200              ; RB8:動作完了
AND MR19400              ; RB9:動作完了
AND MR18800              ; RB3:動作完了
ANL
JMP @MR1308
MRD
ANB MR19000              ; RB4:動作完了
TMR #700 #150            ; ｳｪｲﾄﾀｲﾏ
CON
AND T700                 ; ｳｪｲﾄﾀｲﾏ
JMP @MR1305
MRD
ANB MR19200              ; RB8:動作完了
TMR #701 #150            ; ｳｪｲﾄﾀｲﾏ
CON
AND T701                 ; ｳｪｲﾄﾀｲﾏ
JMP @MR1305
MRD
ANB MR19400              ; RB9:動作完了
TMR #702 #150            ; ｳｪｲﾄﾀｲﾏ
CON
AND T702                 ; ｳｪｲﾄﾀｲﾏ
JMP @MR1305
MPP
ANB MR18800              ; RB3:動作完了
TMR #703 #150            ; ｳｪｲﾄﾀｲﾏ
CON
AND T703                 ; ｳｪｲﾄﾀｲﾏ
JMP @MR1305
STG @MR1305
ANB R39004               ; ｴﾗｰ中
MPS
ANB MR19000              ; RB4:動作完了
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #83 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1306
MRD
ANB MR19200              ; RB8:動作完了
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #24 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1306
MRD
ANB MR19400              ; RB9:動作完了
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #25 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1306
MPP
ANB MR18800              ; RB3:動作完了
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #84 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1306
STG @MR1306
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1307
STG @MR1307
AND @MR105               ; SW1
JMP @MR1300              ; 搬送RB部原点復帰
STG @MR1308
RES MR19000              ; RB4:動作完了
CON
RES MR19200              ; RB8:動作完了
CON
RES MR19400              ; RB9:動作完了
CON
RES MR18800              ; RB3:動作完了
CON
RES @MR1302              ; 搬送RB部原点復帰完了
CON
JMP @MR1309
STG @MR1309
RES MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR2907               ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR2909               ; 搬送Z軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
CON
JMP @MR1310
STG @MR1310
MPS
LD>.L DM10572 +13000     ; SCON-1 現在位置（下位8bit）
OR>.L DM10580 +13000     ; SCON-2 現在位置（下位8bit）
ANB @MR1400
ANL
JMP @MR1311
MPP
LD<=.L DM10572 +13000    ; SCON-1 現在位置（下位8bit）
AND<=.L DM10580 +13000   ; SCON-2 現在位置（下位8bit）
ANB @MR1311
ANL
JMP @MR1400
STG @MR1311
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #27 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1312
STG @MR1312
SET @MR1900              ; Main1 HALT許可
CON
ANB @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1313
STG @MR1313
AND @MR105               ; SW1
JMP @MR1300              ; 搬送RB部原点復帰
STG @MR1400
MPS
LDB MR19213              ; RB8:ｱﾗｰﾑ出力
ANB MR19413              ; RB9:ｱﾗｰﾑ出力
ANB MR18813              ; RB3:ｱﾗｰﾑ出力
ANB MR19013              ; RB4:ｱﾗｰﾑ出力
ANB MR18213              ; RB6:ｱﾗｰﾑ出力
ANL
JMP @MR1401
MPP
LD MR19213               ; RB8:ｱﾗｰﾑ出力
OR MR19413               ; RB9:ｱﾗｰﾑ出力
OR MR18013               ; RB5:ｱﾗｰﾑ出力
OR MR18213               ; RB6:ｱﾗｰﾑ出力
OR MR19013               ; RB4:ｱﾗｰﾑ出力
ANL
TMR @110 #30
CON
AND @T110
JMP @MR1300              ; 搬送RB部原点復帰
STG @MR1401
ANB R39004               ; ｴﾗｰ中
SET MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
CON
SET @MR1410              ; X軸原点復帰開始
CON
JMP @MR1405
STG @MR1405
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
JMP @MR1406
STG @MR1406
AND @R006                ; RB9動作完了
RES @R006                ; RB9動作完了
CON
JMP @MR1409
STG @MR1409
SET @MR1500              ; RB9待機位置移動完了
CON
ENDS
STG @MR1410              ; X軸原点復帰開始
JMP @MR1411
STG @MR1411
SET MR2907               ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR19202              ; RB8:原点復帰完了
CON
JMP @MR1501
STG @MR1501
AND @MR1500              ; RB9待機位置移動完了
AND MR24200              ; 除材搬送_Y軸_P1
RES @MR1500              ; RB9待機位置移動完了
CON
JMP @MR1502
STG @MR1502
DW #1 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R010                ; RB8動作開始
CON
JMP @MR1503
STG @MR1503
AND @R011                ; RB8動作完了
RES @R011                ; RB8動作完了
CON
JMP @MR1504
STG @MR1504
MPS
AND>= DM10540 #4500      ; MSEP Axis-4 現在位置（下位8bit）
MPS
AND< DM10540 #8400       ; MSEP Axis-4 現在位置（下位8bit）
DW #5 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR1505
MPP
AND>= DM10540 #8400      ; MSEP Axis-4 現在位置（下位8bit）
DW #2 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR1505
MPP
AND< DM10540 #4500       ; MSEP Axis-4 現在位置（下位8bit）
JMP @MR1510              ; Z軸原点復帰開始
STG @MR1505
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @MR1510              ; Z軸原点復帰開始
STG @MR1510              ; Z軸原点復帰開始
TMR @111 #5
CON
AND @T111
AND MR23000              ; 除材搬送_X軸_P1
AND MR24200              ; 除材搬送_Y軸_P1
SET MR19004              ; RB4:HOME
CON
JMP @MR1511
STG @MR1511
MPS
AND MR19002              ; RB4:原点復帰完了
DW #0 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET MR2909               ; 搬送Z軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR19002              ; RB4:原点復帰完了
CON
JMP @MR1600
MPP
LDB MR19002              ; RB4:原点復帰完了
BANB DM10755 #4          ; MSEP Axis-5 制御信号
ANL
TMR @112 #200
CON
AND @T112
RES MR2909               ; 搬送Z軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR19002              ; RB4:原点復帰完了
CON
JMP @MR1512
STG @MR1512
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #83 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1513
STG @MR1513
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1508
STG @MR1508
AND @MR105               ; SW1
JMP @MR1514
STG @MR1514
TMR @113 #10
CON
AND @T113
SET MR19009              ; RB4:ARMRST
CON
AND MR19000              ; RB4:動作完了
JMP @MR1600
STG @MR1600
RES MR19000              ; RB4:動作完了
CON
JMP @MR1602
STG @MR1602
DW #1 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR1606
STG @MR1606
AND @R101                ; RB4動作完了
RES @R101                ; RB4動作完了
CON
SET @MR1607              ; RB4待機位置移動完了
CON
JMP @MR1700              ; θ軸原点復帰開始
STG @MR1700              ; θ軸原点復帰開始
SET MR18804              ; RB3:HOME
CON
JMP @MR1701
STG @MR1701
MPS
AND MR18802              ; RB3:原点復帰完了
SET MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR18802              ; RB3:原点復帰完了
CON
JMP @MR1708
MPP
LDB MR18802              ; RB3:原点復帰完了
BANB DM10747 #4          ; MSEP Axis-4 制御信号
ANL
TMR @114 #200
CON
AND @T114
RES MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
CON
RES MR18802              ; RB3:原点復帰完了
CON
JMP @MR1702
STG @MR1702
SET @MR1900              ; Main1 HALT許可
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #84 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1703
STG @MR1703
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1704
STG @MR1704
AND @MR105               ; SW1
JMP @MR1705
STG @MR1705
TMR @115 #10
CON
AND @T115
SET MR18809              ; RB3:ARMRST
CON
AND MR18800              ; RB3:動作完了
JMP @MR1706
STG @MR1706
RES MR18800              ; RB3:動作完了
CON
JMP @MR1700              ; θ軸原点復帰開始
STG @MR1708
AND @MR1607              ; RB4待機位置移動完了
RES @MR1607              ; RB4待機位置移動完了
CON
JMP @MR1800
STG @MR1800
DW #1 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR1801
STG @MR1801
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @MR1805
STG @MR1805
SET MR12808              ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
TMR @116 #3
CON
AND @T116
MPS
AND MR12810              ; 除材吸着ﾊﾝﾄﾞ 吸着確認-OFF
JMP @MR1810
MPP
AND MR12809              ; 除材吸着ﾊﾝﾄﾞ 吸着確認-ON
JMP @MR1806
STG @MR1806
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
TMH @117 #3
CON
AND @T117
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
JMP @MR1807
STG @MR1807
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #6000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #47 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7510 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR1808
STG @MR1808
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR1809
STG @MR1809
AND @MR105               ; SW1
JMP @MR1805
STG @MR1810
SET MR12812              ; 除材吸着ﾊﾝﾄﾞ 破壊確認開始
CON
AND MR12813              ; 除材吸着ﾊﾝﾄﾞ 吸着破壊OK
RES MR12813              ; 除材吸着ﾊﾝﾄﾞ 吸着破壊OK
CON
JMP @MR1811
STG @MR1811
MPS
LD<> #1 DM11108          ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
OR<=.L DM10548 +10       ; MSEP Axis-5 現在位置（下位8bit）
ANL
DW #1 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR1812
MPP
LD= #1 DM11108           ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
AND>.L DM10548 +100      ; MSEP Axis-5 現在位置（下位8bit）
ANL
JMP @MR1813
STG @MR1812
AND @R101                ; RB4動作完了
RES @R101                ; RB4動作完了
CON
JMP @MR1810
STG @MR1813
MPS
LD<> #1 DM11088          ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
OR<=.L DM10540 +200      ; MSEP Axis-4 現在位置（下位8bit）
ANL
DW #1 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR1814
MPP
LD= #1 DM11088           ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
AND>.L DM10540 +200      ; MSEP Axis-4 現在位置（下位8bit）
ANL
JMP @MR1815
STG @MR1814
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @MR1810
STG @MR1815
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
TMH @118 #3
CON
AND @T118
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
SET @MR1302              ; 搬送RB部原点復帰完了
CON
RES @MR1301              ; 搬送RB部原点復帰中
CON
ENDS
;<h1/>AUTO/自動動作
STG LR5404               ; _Grp1_Task4_AUTO.STG
JMP @MR3000              ; AUTO Main1
;<h1/>Auto (Main1)
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1〜32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000              ; AUTO Main1
ANB @MR001               ; TASK4 ERROR
MPS
LDB R41204               ; TASK4 PAUSE 
ANB MR24914              ; 4ST　動作完了
ANB MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
ANL
LDA DM35000              ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
CON
STA DM35030              ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ補助
CON
DW #0 EM40100            ; 除材ﾎﾟｼﾞｼｮﾝ
CON
ANB @MR3515              ; 最終除材動作中
RES MR19710              ; NG排出
CON
RES @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
CON
MPS
AND MR22504              ; TASK0→TASK4 START
SET @MR3002              ; AUTO Main1 Busy
CON
SET MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR3908
MPP
AND MR22604              ; TASK0→TASK4 HOLD
RES @MR3002              ; AUTO Main1 Busy
CON
JMP @MR3909
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3909
RES MR22504              ; TASK0→TASK4 START
CON
RES MR22604              ; TASK0→TASK4 HOLD
CON
JMP @MR3915              ; AUTO END
STG @MR3908
TMR @0 #1
CON
AND @T0
RES MR22504              ; TASK0→TASK4 START
CON
JMP @MR3003
STG @MR3003
JMP @MR3004
STG @MR3004
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
MPS
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
SET LR12110              ; INDEX_治具2 ﾜｰｸ有無-10
CON
JMP @MR3908
MRD
LDB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
JMP @MR3212
MPP
LDB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
ANL
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9102               ; INDEX_治具-2上ﾜｰｸ全て有り
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
MPS
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
SET LR12210              ; INDEX_治具3 ﾜｰｸ有無-10
CON
JMP @MR3908
MRD
LDB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
JMP @MR3212
MPP
LDB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
ANL
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #5 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9103               ; INDEX_治具-3上ﾜｰｸ全て有り
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
MPS
AND MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
SET LR12310              ; INDEX_治具4 ﾜｰｸ有無-10
CON
JMP @MR3908
MRD
LDB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
AND MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
JMP @MR3212
MPP
LDB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
ANL
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9104               ; INDEX_治具-4上ﾜｰｸ全て有り
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
MPS
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
SET LR12010              ; INDEX_治具1 ﾜｰｸ有無-10
CON
JMP @MR3908
MRD
LDB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
JMP @MR3212
MPP
LDB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
ANL
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
MPS
AND= #10 EM31904         ; 転写状態
JMP @MR3308
MRD
AND= #5 EM31904          ; 転写状態
JMP @MR3208
MPP
AND= #0 EM31904          ; 転写状態
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB MR9101               ; INDEX_治具-1上ﾜｰｸ全て有り
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
STG @MR3208
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #9004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #119 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3209
STG @MR3209
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR3210
STG @MR3210
MPS
AND @MR105               ; SW1
JMP @MR3908
MPP
AND @MR108               ; SW4
DW #10 EM31904           ; 転写状態
CON
JMP @MR3211
STG @MR3211
LDA #200
CON
STA EM31515              ; WORK DATA
CON
STA EM31565              ; WORK DATA
CON
STA EM31615              ; WORK DATA
CON
STA EM31665              ; WORK DATA
CON
STA EM31715              ; WORK DATA
CON
STA EM31765              ; WORK DATA
CON
STA EM31815              ; WORK DATA
CON
STA EM31865              ; WORK DATA
CON
STA EM31915              ; WORK DATA
CON
STA EM31965              ; WORK DATA
CON
JMP @MR3005
STG @MR3212
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1006 @DM9            ; ReturnSW /ERROR_DISP
CON
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #54 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3213
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #55 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3213
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #56 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3213
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
DW #53 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3213
STG @MR3213
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR3214
STG @MR3214
MPS
AND @MR105               ; SW1
JMP @MR3003
MPP
AND @MR108               ; SW4
JMP @MR3215
STG @MR3215
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ZRES LR12101 LR12110     ; INDEX_治具2 ﾜｰｸ有無-1  INDEX_治具2 ﾜｰｸ有無-10
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
TMH @60 #3
CON
AND @T60
DW #0 EM31904            ; 転写状態
CON
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
JMP @MR3003
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ZRES LR12201 LR12210     ; INDEX_治具3 ﾜｰｸ有無-1  INDEX_治具3 ﾜｰｸ有無-10
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
TMH @61 #3
CON
AND @T61
DW #0 EM31904            ; 転写状態
CON
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
JMP @MR3003
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ZRES LR12301 LR12310     ; INDEX_治具4 ﾜｰｸ有無-1  INDEX_治具4 ﾜｰｸ有無-10
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
TMH @62 #3
CON
AND @T62
DW #0 EM31904            ; 転写状態
CON
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
JMP @MR3003
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ZRES LR12001 LR12010     ; INDEX_治具1 ﾜｰｸ有無-1  INDEX_治具1 ﾜｰｸ有無-10
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
TMH @63 #3
CON
AND @T63
DW #0 EM31904            ; 転写状態
CON
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
JMP @MR3003
STG @MR3308
MPS
AND LR10012              ; 除材ﾜｰｸ有無画像 有効/無効
JMP @MR3309
MPP
ANB LR10012              ; 除材ﾜｰｸ有無画像 有効/無効
JMP @MR3005
STG @MR3309
RES @MR3315              ; ﾜｰｸ有り
CON
SET R18500               ; 画像　除材部ﾜｰｸ検査要求
CON
JMP @MR3310              ; ﾜｰｸ確認
STG @MR3310              ; ﾜｰｸ確認
AND R18501               ; 画像　除材部ﾜｰｸ検査完了
RES R18501               ; 画像　除材部ﾜｰｸ検査完了
CON
JMP @MR3311
LD @MR3311
AND R18700               ; ﾜｰｸ1　有り
AND R18702               ; ﾜｰｸ2　有り
AND R18704               ; ﾜｰｸ3　有り
AND R18706               ; ﾜｰｸ4　有り
AND R18708               ; ﾜｰｸ5　有り
AND R18710               ; ﾜｰｸ6　有り
AND R18712               ; ﾜｰｸ7　有り
AND R18714               ; ﾜｰｸ8　有り
AND R18800               ; ﾜｰｸ9　有り
AND R18802               ; ﾜｰｸ10　有り
SET @MR3315              ; ﾜｰｸ有り
STG @MR3311
MPS
AND @MR3315              ; ﾜｰｸ有り
JMP @MR3005
MPP
ANB @MR3315              ; ﾜｰｸ有り
TMR #1260 #20
CON
AND T1260
JMP @MR3314
STG @MR3314
ANB R39004               ; ｴﾗｰ中
DW #1024 DM29051
CON
RES @MR3315              ; ﾜｰｸ有り
CON
SET R39004               ; ｴﾗｰ中
CON
DW #1004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #48 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3312
STG @MR3312
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR3313
STG @MR3313
MPS
AND @MR105               ; SW1
DW #0 DM29051
CON
JMP @MR3309
MPP
AND @MR108               ; SW4
DW #0 DM29051
CON
JMP @MR3005
STG @MR3005
RES @MR3315              ; ﾜｰｸ有り
CON
MPS
AND R8102                ; ﾀﾞﾐｰBOX有無確認
JMP @MR3107
MPP
ANB R8102                ; ﾀﾞﾐｰBOX有無確認
TMR @1 #3
CON
AND @T1
JMP @MR3101
STG @MR3101
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #126 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #8102 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3102
STG @MR3102
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP R003                 ; ｽﾄｯﾌﾟSW
STG @MR3103
AND @MR105               ; SW1
JMP @MR3005
STG @MR3107
MPS
ANB R8101                ; ﾀﾞﾐｰBOX満杯検出
JMP @MR3011
MPP
AND R8101                ; ﾀﾞﾐｰBOX満杯検出
TMR @3 #3
CON
AND @T3
JMP @MR3109
STG @MR3109
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #127 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #8101 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR3110
STG @MR3110
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR3111
STG @MR3111
AND @MR105               ; SW1
JMP @MR3107
STG @MR3011
SET @MR4500              ; 除材準備開始
CON
JMP @MR3012
STG @MR3012
AND @MR4501              ; 除材動作　準備完了
RES @MR4501              ; 除材動作　準備完了
CON
DW #1 EM40100            ; 除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3006
STG @MR3006
MPS
ANB R41204               ; TASK4 PAUSE 
SET @MR5500              ; ﾜｰｸﾃﾞｰﾀ取得
CON
JMP @MR3008
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3008
MPS
AND= EM40100 #1          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #1 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #2          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #2 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #3          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #3 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #4          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #4 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #5          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #5 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #6          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #6 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #7          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #7 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #8          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #8 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MRD
AND= EM40100 #9          ; 除材ﾎﾟｼﾞｼｮﾝ
DW #9 DM35010            ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
MPP
AND= EM40100 #10         ; 除材ﾎﾟｼﾞｼｮﾝ
DW #10 DM35010           ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR3300
;ﾜｰｸﾃﾞｰﾀがﾀﾞﾐｰならばﾀﾞﾐｰ箱へ廃棄処理
;OKﾜｰｸであれば搬送動作を行う
STG @MR3300
AND @MR3301              ; ﾎﾟｯﾄﾀｲﾑ管理 計算完了
RES @MR3301              ; ﾎﾟｯﾄﾀｲﾑ管理 計算完了
CON
JMP @MR3303
;'接着剤ﾎﾟｯﾄﾗｲﾌ ﾀｲﾑ管理
;
;SELECT CASE EM40100
;  CASE 1
;    DM27100.D = SEC(EM31516)
;  CASE 2
;    DM27100.D = SEC(EM31566)   
;  CASE 3
;    DM27100.D = SEC(EM31616)
;  CASE 4
;    DM27100.D = SEC(EM31666)
;  CASE 5
;    DM27100.D = SEC(EM31716)
;  CASE 6
;    DM27100.D = SEC(EM31766)
;  CASE 7
;    DM27100.D = SEC(EM31816)
;  CASE 8
;    DM27100.D = SEC(EM31866)
;  CASE 9
;    DM27100.D = SEC(EM31916)
;  CASE 10
;    DM27100.D = SEC(EM31966)
;END SELECT    
;        
;DM27102.D = DM27100.D + DM7070.D '次装置搬送可能時間  (通算 秒)
;
;DM27104.D = SEC(CM700) '現在時刻  (通算 秒)
;
;DM27108.D = DM27102.D - DM27104.D
;
;IF DM27102.D < DM27104.D THEN 
;
;DM27108.D = 0
;
;END IF
;
;
;SET(@MR3301)
LD @MR3300
NCJ #1004
;'接着剤ﾎﾟｯﾄﾗｲﾌ ﾀｲﾑ管理
;
;SELECT CASE EM40100
;
LD CR2002                ; 常時ON
MOV EM40100 @VM9         ; 除材ﾎﾟｼﾞｼｮﾝ
;  CASE 1
;
LD= @VM9 #1
NCJ #2018
;    DM27100.D = SEC(EM31516)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM10
SEC EM31516 @VM10        ; 接着時刻 YY（年）
MOV.D @VM10 DM27100
LD CR2002                ; 常時ON
CJ #2019
LABEL #2018
;  CASE 2
;
LD= @VM9 #2
NCJ #2020
;    DM27100.D = SEC(EM31566)   
;
LD CR2002                ; 常時ON
MOV.D #0 @VM12
SEC EM31566 @VM12        ; 接着時刻 YY（年）
MOV.D @VM12 DM27100
LD CR2002                ; 常時ON
CJ #2021
LABEL #2020
;  CASE 3
;
LD= @VM9 #3
NCJ #2022
;    DM27100.D = SEC(EM31616)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM14
SEC EM31616 @VM14        ; 接着時刻 YY（年）
MOV.D @VM14 DM27100
LD CR2002                ; 常時ON
CJ #2023
LABEL #2022
;  CASE 4
;
LD= @VM9 #4
NCJ #2024
;    DM27100.D = SEC(EM31666)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM16
SEC EM31666 @VM16        ; 接着時刻 YY（年）
MOV.D @VM16 DM27100
LD CR2002                ; 常時ON
CJ #2025
LABEL #2024
;  CASE 5
;
LD= @VM9 #5
NCJ #2026
;    DM27100.D = SEC(EM31716)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM18
SEC EM31716 @VM18        ; 接着時刻 YY（年）
MOV.D @VM18 DM27100
LD CR2002                ; 常時ON
CJ #2027
LABEL #2026
;  CASE 6
;
LD= @VM9 #6
NCJ #2028
;    DM27100.D = SEC(EM31766)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM20
SEC EM31766 @VM20        ; 接着時刻 YY（年）
MOV.D @VM20 DM27100
LD CR2002                ; 常時ON
CJ #2029
LABEL #2028
;  CASE 7
;
LD= @VM9 #7
NCJ #2030
;    DM27100.D = SEC(EM31816)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM22
SEC EM31816 @VM22        ; 接着時刻 YY（年）
MOV.D @VM22 DM27100
LD CR2002                ; 常時ON
CJ #2031
LABEL #2030
;  CASE 8
;
LD= @VM9 #8
NCJ #2032
;    DM27100.D = SEC(EM31866)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM24
SEC EM31866 @VM24        ; 接着時刻 YY（年）
MOV.D @VM24 DM27100
LD CR2002                ; 常時ON
CJ #2033
LABEL #2032
;  CASE 9
;
LD= @VM9 #9
NCJ #2034
;    DM27100.D = SEC(EM31916)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM26
SEC EM31916 @VM26        ; 接着時刻 YY（年）
MOV.D @VM26 DM27100
LD CR2002                ; 常時ON
CJ #2035
LABEL #2034
;  CASE 10
;
LD= @VM9 #10
NCJ #2036
;    DM27100.D = SEC(EM31966)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM28
SEC EM31966 @VM28        ; 接着時刻 YY（年）
MOV.D @VM28 DM27100
;END SELECT    
;
LABEL #2036
LABEL #2035
LABEL #2033
LABEL #2031
LABEL #2029
LABEL #2027
LABEL #2025
LABEL #2023
LABEL #2021
LABEL #2019
;DM27102.D = DM27100.D + DM7070.D '次装置搬送可能時間  (通算 秒)
;
LD CR2002                ; 常時ON
LDA.L DM27100
CON
ADD.L DM7070             ; 装置基礎ﾃﾞｰﾀ36
CON
STA.D DM27102
;DM27104.D = SEC(CM700) '現在時刻  (通算 秒)
;
LD CR2002                ; 常時ON
MOV.D #0 @VM30
SEC CM700 @VM30          ; ｶﾚﾝﾀﾞﾀｲﾏ（年）
MOV.D @VM30 DM27104
;DM27108.D = DM27102.D - DM27104.D
;
LD CR2002                ; 常時ON
LDA.L DM27102
CON
SUB.L DM27104
CON
STA.D DM27108
;IF DM27102.D < DM27104.D THEN 
;
LD<.D DM27102 DM27104
NCJ #2037
;DM27108.D = 0
;
LD CR2002                ; 常時ON
MOV.D #0 DM27108
;END IF
;
LABEL #2037
;SET(@MR3301)
LD CR2002                ; 常時ON
SET @MR3301              ; ﾎﾟｯﾄﾀｲﾑ管理 計算完了
LABEL #1004
;
STG @MR3303
MPS
ANB DM2000.3             ; 転写後ﾜｰｸ時間管理 有効/無効
MPS
ANB MR19710              ; NG排出
MPS
AND>.D DM27108 #0
JMP @MR3010
MPP
AND=.D DM27108 #0
MPS
ANB @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
JMP @MR3305
MPP
AND @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
JMP @MR3010
MPP
AND MR19710              ; NG排出
JMP @MR3010
MPP
AND DM2000.3             ; 転写後ﾜｰｸ時間管理 有効/無効
JMP @MR3010
STG @MR3305
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #9004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #64 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR3306
STG @MR3306
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR3307
STG @MR3307
MPS
AND @MR105               ; SW1
SET @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
CON
JMP @MR3010
MPP
AND @MR108               ; SW4
SET @MR3304              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｰｴﾗｰ継続処理済み
CON
RES @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
CON
JMP @MR3010
STG @MR3010
SET R46001               ; _装置C/T取得
CON
SET MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
SET @MR4600              ; 除材処理
CON
JMP @MR3015
STG @MR3015
AND @MR4601              ; 除材処理完了
MPS
AND<> EM40100 #10        ; 除材ﾎﾟｼﾞｼｮﾝ
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR4601              ; 除材処理完了
CON
JMP @MR3401
MPP
AND= EM40100 #10         ; 除材ﾎﾟｼﾞｼｮﾝ
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
JMP @MR3402
STG @MR3402
MPS
AND= #3 DM35030          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ補助
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES LR12010              ; INDEX_治具1 ﾜｰｸ有無-10
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR4601              ; 除材処理完了
CON
RES @MR3515              ; 最終除材動作中
CON
ENDS
MRD
AND= #0 DM35030          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ補助
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES LR12110              ; INDEX_治具2 ﾜｰｸ有無-10
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR4601              ; 除材処理完了
CON
RES @MR3515              ; 最終除材動作中
CON
ENDS
MRD
AND= #1 DM35030          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ補助
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES LR12210              ; INDEX_治具3 ﾜｰｸ有無-10
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR4601              ; 除材処理完了
CON
RES @MR3515              ; 最終除材動作中
CON
ENDS
MPP
AND= #2 DM35030          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ補助
RES MR6606               ; 除材UT ｻｲｸﾙﾀｲﾑ計測用
CON
RES LR12310              ; INDEX_治具4 ﾜｰｸ有無-10
CON
RES MR6607               ; 個別除材動作 ｻｲｸﾙﾀｲﾑ計測用
CON
RES @MR4601              ; 除材処理完了
CON
RES @MR3515              ; 最終除材動作中
CON
ENDS
;吸着OKの場合は、EM10100をｲﾝｸﾘﾒﾝﾄし、
;11以上の場合は、1STの終了→ｲﾝﾃﾞｯｸｽへ動作完了を出す
;10未満の場合は、次のﾜｰｸ受け取りへ
STG @MR3401
MPS
AND= EM40100 #1          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12001              ; INDEX_治具1 ﾜｰｸ有無-1
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12101              ; INDEX_治具2 ﾜｰｸ有無-1
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12201              ; INDEX_治具3 ﾜｰｸ有無-1
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12301              ; INDEX_治具4 ﾜｰｸ有無-1
MRD
AND= EM40100 #2          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12002              ; INDEX_治具1 ﾜｰｸ有無-2
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12102              ; INDEX_治具2 ﾜｰｸ有無-2
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12202              ; INDEX_治具3 ﾜｰｸ有無-2
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12302              ; INDEX_治具4 ﾜｰｸ有無-2
MRD
AND= EM40100 #3          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12003              ; INDEX_治具1 ﾜｰｸ有無-3
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12103              ; INDEX_治具2 ﾜｰｸ有無-3
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12203              ; INDEX_治具3 ﾜｰｸ有無-3
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12303              ; INDEX_治具4 ﾜｰｸ有無-3
MRD
AND= EM40100 #4          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12004              ; INDEX_治具1 ﾜｰｸ有無-4
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12104              ; INDEX_治具2 ﾜｰｸ有無-4
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12204              ; INDEX_治具3 ﾜｰｸ有無-4
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12304              ; INDEX_治具4 ﾜｰｸ有無-4
MRD
AND= EM40100 #5          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12005              ; INDEX_治具1 ﾜｰｸ有無-5
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12105              ; INDEX_治具2 ﾜｰｸ有無-5
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12205              ; INDEX_治具3 ﾜｰｸ有無-5
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12305              ; INDEX_治具4 ﾜｰｸ有無-5
MRD
AND= EM40100 #6          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12006              ; INDEX_治具1 ﾜｰｸ有無-6
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12106              ; INDEX_治具2 ﾜｰｸ有無-6
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12206              ; INDEX_治具3 ﾜｰｸ有無-6
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12306              ; INDEX_治具4 ﾜｰｸ有無-6
MRD
AND= EM40100 #7          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12007              ; INDEX_治具1 ﾜｰｸ有無-7
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12107              ; INDEX_治具2 ﾜｰｸ有無-7
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12207              ; INDEX_治具3 ﾜｰｸ有無-7
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12307              ; INDEX_治具4 ﾜｰｸ有無-7
MRD
AND= EM40100 #8          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12008              ; INDEX_治具1 ﾜｰｸ有無-8
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12108              ; INDEX_治具2 ﾜｰｸ有無-8
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12208              ; INDEX_治具3 ﾜｰｸ有無-8
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12308              ; INDEX_治具4 ﾜｰｸ有無-8
MRD
AND= EM40100 #9          ; 除材ﾎﾟｼﾞｼｮﾝ
MPS
AND= #1 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12009              ; INDEX_治具1 ﾜｰｸ有無-9
MRD
AND= #2 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12109              ; INDEX_治具2 ﾜｰｸ有無-9
MRD
AND= #3 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12209              ; INDEX_治具3 ﾜｰｸ有無-9
MPP
AND= #4 EM31501          ; インデックス治具NO
DW #0 EM31500            ; ﾜｰｸ情報1
CON
@DEC DM29000             ; 装置内ﾜｰｸ個数
CON
RES LR12309              ; INDEX_治具4 ﾜｰｸ有無-9
MPP
TMR @5 #1
CON
AND @T5
JMP @MR3403
STG @MR3403
@INC EM40100             ; 除材ﾎﾟｼﾞｼｮﾝ
CON
TMR @6 #1
CON
AND @T6
JMP @MR3404
STG @MR3404
MPS
AND>= EM40100 #11        ; 除材ﾎﾟｼﾞｼｮﾝ
ENDS
MPP
AND>= #10 EM40100        ; 除材ﾎﾟｼﾞｼｮﾝ
RES @MR3515              ; 最終除材動作中
CON
JMP @MR3006
STG @MR3500              ; 除材終了動作
JMP @MR3501
STG @MR3501
DW #1 DM11028            ; RB6 目標ﾎﾟｲﾝﾄ番号
CON
SET @R000                ; RB6動作開始
CON
JMP @MR3502
STG @MR3502
AND @R001                ; RB6動作完了
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES @R001                ; RB6動作完了
CON
SET @MR5300              ; 除材終了動作
CON
JMP @MR3900
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES @R001                ; RB6動作完了
CON
SET @MR5300              ; 除材終了動作
CON
ENDS
;Auto終了処理
STG @MR3900
ANB @MR001               ; TASK4 ERROR
MPS
LDB R41204               ; TASK4 PAUSE 
AND @MR5300              ; 除材終了動作
ANL
SET MR24914              ; 4ST　動作完了
CON
RES @MR5300              ; 除材終了動作
CON
JMP @MR3000              ; AUTO Main1
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR3915              ; AUTO END
JMP LR604                ; _Grp1_Task4_Fin.STG
;<h1/>Maintenance
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1〜32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5604               ; _Grp1_Task4_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
JMP @MR2100
STG @MR2100
SET MR23914              ; ﾒﾝﾃﾅﾝｽ中
CON
JMP @MR2101
STG @MR2101
LD> #2000 DM3000         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR> DM3000 #2118         ; _MainTP　表示中ﾍﾟｰｼﾞNo
LD<= #2000 DM3000        ; _MainTP　表示中ﾍﾟｰｼﾞNo
AND<= DM3000 #2118       ; _MainTP　表示中ﾍﾟｰｼﾞNo
ORL
ANL
MPS
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
MRD
ANB R41204               ; TASK4 PAUSE 
MPS
LD= DM4110 #9            ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #10           ; _Group1　ﾒﾝﾃ動作番号
ANL
DW #1 DM35020            ; 99_ﾀﾞﾐｰﾜｰｸ　1_良品ﾜｰｸ
CON
LDA DM25028
CON
STA DM35010              ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR2700              ; 除材動作開始
MRD
LD= DM4110 #25           ; _Group1　ﾒﾝﾃ動作番号
AND R45015               ; 単動終了
ANL
JMP @MR2915              ; Mainte END
MRD
LD= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
AND R44914               ; *Group3　ｴﾘｱｾﾝｻ継続実行SW2ﾗﾝﾌﾟ
ANL
JMP @MR2915              ; Mainte END
MPP
AND= DM4110 #11          ; _Group1　ﾒﾝﾃ動作番号
DW #99 DM35020           ; 99_ﾀﾞﾐｰﾜｰｸ　1_良品ﾜｰｸ
CON
LDA DM25028
CON
STA DM35010              ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
CON
JMP @MR2700              ; 除材動作開始
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR2110
LD CR2002                ; 常時ON
MC
LD MR23914               ; ﾒﾝﾃﾅﾝｽ中
LD= DM3000 #2013         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR= DM3000 #2014         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR= DM3000 #2015         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR= DM3000 #2116         ; _MainTP　表示中ﾍﾟｰｼﾞNo
OR= DM3000 #2117         ; _MainTP　表示中ﾍﾟｰｼﾞNo
ANL
MPS
LDP MR2707               ; 除材ﾊﾝﾄﾞ 吸着ON SW
ANB MR2708               ; 除材ﾊﾝﾄﾞ 吸着OFF SW
ANB MR2709               ; 除材ﾊﾝﾄﾞ 破壊ON SW
ANL
SET MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
RES MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
RES MR15300              ; 除材ﾊﾝﾄﾞ吸着OFF
MRD
LDP MR2708               ; 除材ﾊﾝﾄﾞ 吸着OFF SW
ANB MR2707               ; 除材ﾊﾝﾄﾞ 吸着ON SW
ANB MR2709               ; 除材ﾊﾝﾄﾞ 破壊ON SW
ANL
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
SET MR15300              ; 除材ﾊﾝﾄﾞ吸着OFF
MRD
LDP MR2709               ; 除材ﾊﾝﾄﾞ 破壊ON SW
ANB MR2707               ; 除材ﾊﾝﾄﾞ 吸着ON SW
ANB MR2708               ; 除材ﾊﾝﾄﾞ 吸着OFF SW
ANL
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
SET MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
RES MR15300              ; 除材ﾊﾝﾄﾞ吸着OFF
MPP
AND MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
OUT @MR2300              ; 全吸着操作用条件1
STG @MR2700              ; 除材動作開始
ANB @MR2701              ; 除材動作中
SET @MR2701              ; 除材動作中
CON
JMP @MR2703
STG @MR2703
MPS
MSTRT SELECT_POST #1 #4 #0 @MR2704
MPP
AND @MR2704
JMP @MR2705
STG @MR2705
MPS
ANB R003                 ; ｽﾄｯﾌﾟSW
RES @MR2704
CON
SET @MR4600              ; 除材処理
CON
JMP @MR2706
MPP
AND R003                 ; ｽﾄｯﾌﾟSW
RES @MR2704
CON
RES @MR2701              ; 除材動作中
CON
JMP @MR2110
STG @MR2706
AND @MR4601              ; 除材処理完了
DW #1 DM35020            ; 99_ﾀﾞﾐｰﾜｰｸ　1_良品ﾜｰｸ
CON
RES @MR4601              ; 除材処理完了
CON
RES @MR2701              ; 除材動作中
CON
JMP @MR2108
LD @MR2300               ; 全吸着操作用条件1
MPS
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANP MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
RES MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANP MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
RES MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANP MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
RES MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANP MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
RES MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANP MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANP MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANP MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANP MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANB MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
MRD
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANP MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR12612              ; 給材部ﾃｰﾌﾞﾙ2 破壊確認開始
CON
SET @MR2210
MRD
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANP MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR12704              ; 給材部ﾃｰﾌﾞﾙ3 破壊確認開始
CON
SET @MR2211
MRD
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANP MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR12712              ; 給材部ﾃｰﾌﾞﾙ4 破壊確認開始
CON
SET @MR2212
MPP
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR2202               ; 除材 仮吸着 全吸着 吸着ON SW
ANB MR2203               ; 除材 仮吸着 全吸着 吸着OFF SW
ANP MR2204               ; 除材 仮吸着 全吸着 破壊ON SW
ANL
SET MR12604              ; 給材部ﾃｰﾌﾞﾙ1 破壊確認開始
CON
SET @MR2213
STG @MR2210
AND MR12613              ; 給材部ﾃｰﾌﾞﾙ2 吸着破壊OK
RES MR12613              ; 給材部ﾃｰﾌﾞﾙ2 吸着破壊OK
CON
ENDS
STG @MR2211
AND MR12705              ; 給材部ﾃｰﾌﾞﾙ3 吸着破壊OK
RES MR12705              ; 給材部ﾃｰﾌﾞﾙ3 吸着破壊OK
CON
ENDS
STG @MR2212
AND MR12713              ; 給材部ﾃｰﾌﾞﾙ4 吸着破壊OK
RES MR12713              ; 給材部ﾃｰﾌﾞﾙ4 吸着破壊OK
CON
ENDS
STG @MR2213
AND MR12605              ; 給材部ﾃｰﾌﾞﾙ1 吸着破壊OK
RES MR12605              ; 給材部ﾃｰﾌﾞﾙ1 吸着破壊OK
CON
ENDS
LD CR2002                ; 常時ON
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10612              ; ST2ﾜｰｸ吸着 吸着ON
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10700              ; ST3ﾜｰｸ吸着 吸着ON
ORL
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10703              ; ST4ﾜｰｸ吸着 吸着ON
ORL
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10609              ; ST1ﾜｰｸ吸着 吸着ON
ORL
ANL
OUT MR2500               ; 除材 全吸着 吸着ON ﾗﾝﾌﾟ
LD CR2002                ; 常時ON
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR10612              ; ST2ﾜｰｸ吸着 吸着ON
AND MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
ANB MR10614              ; ST2ﾜｰｸ吸着 破壊ON
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR10700              ; ST3ﾜｰｸ吸着 吸着ON
AND MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
ANB MR10702              ; ST3ﾜｰｸ吸着 破壊ON
ORL
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR10703              ; ST4ﾜｰｸ吸着 吸着ON
AND MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
ANB MR10705              ; ST4ﾜｰｸ吸着 破壊ON
ORL
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
ANB MR10609              ; ST1ﾜｰｸ吸着 吸着ON
AND MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
ANB MR10611              ; ST1ﾜｰｸ吸着 破壊ON
ORL
ANL
OUT MR2501               ; 除材 全吸着 吸着OFF ﾗﾝﾌﾟ
LD CR2002                ; 常時ON
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10614              ; ST2ﾜｰｸ吸着 破壊ON
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10702              ; ST3ﾜｰｸ吸着 破壊ON
ORL
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10705              ; ST4ﾜｰｸ吸着 破壊ON
ORL
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND MR10611              ; ST1ﾜｰｸ吸着 破壊ON
ORL
ANL
OUT MR2502               ; 除材 全吸着 破壊ON ﾗﾝﾌﾟ
LD CR2002                ; 常時ON
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
ORL
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
ORL
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
ORL
ANL
OUT MR2503               ; 除材 全吸着 圧力ｾﾝｻOUT1 ﾗﾝﾌﾟ
LD CR2002                ; 常時ON
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7505                ; ﾜｰｸｾｯﾄ部 ST2 圧力2
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7507                ; ﾜｰｸｾｯﾄ部 ST3 圧力2
ORL
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7509                ; ﾜｰｸｾｯﾄ部 ST4 圧力2
ORL
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7503                ; ﾜｰｸｾｯﾄ部 ST1 圧力2
ORL
ANL
OUT MR2504               ; 除材 全吸着 圧力ｾﾝｻOUT2 ﾗﾝﾌﾟ
LD= DM11124 #3           ; RB8 現在ﾎﾟｼﾞｼｮﾝ番号
AND= DM11144 #12         ; RB9 現在ﾎﾟｼﾞｼｮﾝ番号
AND= DM11084 #1          ; RB3 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR19201              ; RB8:動作中
ANB MR19401              ; RB9:動作中
ANB MR18801              ; RB3:動作中
AND MR2907               ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
ANB @MR2810              ; ｱﾗｲﾒﾝﾄ動作中
ANP MR3601               ; XYθｱﾗｲﾒﾝﾄ移動 SW
SET @R700
CON
SET @R702
LD @R700
AND @MR004               ; ﾌﾘｯｶ
LD= DM11128 DM11124      ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号  RB8 現在ﾎﾟｼﾞｼｮﾝ番号
AND= DM11148 DM11144     ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号  RB9 現在ﾎﾟｼﾞｼｮﾝ番号
AND= DM11088 DM11084     ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号  RB3 現在ﾎﾟｼﾞｼｮﾝ番号
ANB @R700
ORL
OUT MR3708               ; XYθｱﾗｲﾒﾝﾄ移動 SW ﾗﾝﾌﾟ
LD MR23914               ; ﾒﾝﾃﾅﾝｽ中
AND= DM3000 #2013        ; _MainTP　表示中ﾍﾟｰｼﾞNo
MPS
ANB MR001                ; ｲﾝﾃﾞｯｸｽ原点復帰完了
OUT MR3312               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝｲﾝﾀｰﾛｯｸ ﾗﾝﾌﾟ
MPP
LD MR3307                ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済
LDB MR3307               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済
AND @MR2411              ; ﾎﾟｲﾝﾄ1移動中
AND @MR004               ; ﾌﾘｯｶ
ORL
ANL
OUT MR3313               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ原点復帰 ﾗﾝﾌﾟ
LD CR2002                ; 常時ON
ANB MR19201              ; RB8:動作中
ANB MR19401              ; RB9:動作中
ANB MR18801              ; RB3:動作中
AND MR2907               ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
ANB @MR2810              ; ｱﾗｲﾒﾝﾄ動作中
ANB @R700
ANP MR3601               ; XYθｱﾗｲﾒﾝﾄ移動 SW
SET MR3603               ; θ軸ｱﾗｲﾒﾝﾄ中
CON
SET @R700
CON
SET @R702
STG @R702
DW #20 DM11088           ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
LDA.L EM2123             ; RB3 P2 目標位置（下位bit）
CON
ADD.L EM2284             ; ｱﾗｲﾒﾝﾄ θ軸移動量
CON
STA.L DM10740            ; MSEP Axis-4 目標位置（下位8bit）
CON
LDA EM2315               ; θ軸ｱﾗｲﾒﾝﾄ速度
CON
STA DM10744              ; MSEP Axis-4 速度
CON
TMR @20 #5
CON
AND @T20
JMP @R703
STG @R703
SET @R105                ; RB3動作開始
CON
JMP @R704
STG @R704
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @R705
STG @R705
RES MR3603               ; θ軸ｱﾗｲﾒﾝﾄ中
CON
ENDS
LD CR2002                ; 常時ON
ANB MR19201              ; RB8:動作中
ANB MR19401              ; RB9:動作中
ANB MR18801              ; RB3:動作中
AND MR2907               ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
ANB @MR2810              ; ｱﾗｲﾒﾝﾄ動作中
ANP MR3602               ; XYｱﾗｲﾒﾝﾄ移動 SW
SET MR3604               ; XY軸ｱﾗｲﾒﾝﾄ中
CON
SET @R707
STG @R707
DW #20 DM11128           ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #18 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
LDA.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L EM2280             ; ｱﾗｲﾒﾝﾄ X軸移動量
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
LDA.L EM2243             ; RB9 P12 目標位置（下位bit）
CON
ADD.L EM2282             ; ｱﾗｲﾒﾝﾄ Y軸移動量
CON
STA.L DM10780            ; SCON-2 目標位置（下位8bit）
CON
LDA EM2313               ; X軸ｱﾗｲﾒﾝﾄ速度
CON
STA DM10776              ; SCON-1 速度
CON
LDA EM2314               ; Y軸ｱﾗｲﾒﾝﾄ速度
CON
STA DM10784              ; SCON-2 速度
CON
TMR @21 #5
CON
AND @T21
JMP @R708
STG @R708
SET @R010                ; RB8動作開始
CON
SET @R005                ; RB9動作開始
CON
JMP @R709
STG @R709
AND @R011                ; RB8動作完了
AND @R006                ; RB9動作完了
RES @R011                ; RB8動作完了
CON
RES @R006                ; RB9動作完了
CON
JMP @R710
STG @R710
RES MR3604               ; XY軸ｱﾗｲﾒﾝﾄ中
CON
RES @R700
CON
ENDS
MCR
STG @MR2108
ANB R39104               ; SELECT_Y_N Interlock
SET R39104               ; SELECT_Y_N Interlock
CON
DW #7 @DM21              ; ScreenNo /SELECT_Y_N
CON
DW #0 @DM22              ; Bz_Use /SELECT_Y_N
CON
SET @MR300               ; Task4 SELECT_Y_N
CON
JMP @MR2109
STG @MR2109
AND @MR301               ; Task4 Y/N END
RES @MR301               ; Task4 Y/N END
CON
RES R39104               ; SELECT_Y_N Interlock
CON
MPS
AND @MR306               ; Task4 Y/N
JMP @MR2000              ; Mainte
MPP
ANB @MR306               ; Task4 Y/N
JMP @MR2110
STG @MR2110
MCALL HOLD_REQUEST #1
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
MPS
MCALL MODE_INDI #2
MPP
ANB @MR001               ; TASK4 ERROR
MPS
ANB R41204               ; TASK4 PAUSE 
RES MR23914              ; ﾒﾝﾃﾅﾝｽ中
CON
SET R46103               ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
CON
JMP LR604                ; _Grp1_Task4_Fin.STG
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
;<h1/>ERROR
;//*Error Sample
;[使用方法]
;・@DM1にERROR番号を代入
;・@DM2にSensor番号を代入(ｾﾝｻ無しｴﾗｰの場合は0)
;・@DM9に復帰SW番号(1〜9、0はSW無し)をdegit単位で4桁入力
;・Task0 ERROR SET(@MR100)でｴﾗｰ処理開始
;・ｴﾗｰ復帰でTask0 ERROR END(@MR101)がON
;・押下復帰SW番号により左から対応した@MR105,@MR106,@MR107,@MR108のいずれかがON
;・上記ONが成立したらJMPするSTGに対応する処理を記述
;Error28　除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ動作異常
STG @MR800               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ動作異常
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #17 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR4006
STG @MR4006
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
SET @MR4007              ; SW1 ｴﾗｰ解除
CON
ENDS
MRD
AND @MR106               ; SW2
SET @MR4008
CON
ENDS
MRD
AND @MR107               ; SW3
SET @MR4009
CON
ENDS
MPP
AND @MR108               ; SW4
SET @MR4010
CON
ENDS
;Error Sample *//
;MyTask Error Process Substance/ｴﾗｰ処理実体
STG @MR100               ; Task4 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #4 @DM0               ; TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task4 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task4 ERROR Busy
CON
SET @MR101               ; Task4 ERROR_End
CON
ENDS
;<h1/>SELECT_ACT
;//*Select_ACT Sample
;画面番号33をﾌﾞｻﾞｰ有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
STG @MR4104
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
DW #33 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #1 @DM32              ; Bz_Use /SELECT_ACT
CON
DW #5 @DM33              ; SW1_No /SELECT_ACT
CON
DW #10 @DM34             ; SW2_No /SELECT_ACT
CON
DW #0 @DM35              ; SW3_No /SELECT_ACT
CON
DW #34 @DM36             ; SW4_No /SELECT_ACT
MPP
SET @MR200               ; Task4 SELECT_ACT
CON
JMP @MR4105
STG @MR4105
AND @MR201               ; Task4 SEL_ACT END
RES @MR201               ; Task4 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
JMP @MR4106
MRD
AND @MR206               ; SW2
JMP @MR4107
MRD
AND @MR207               ; SW3
JMP @MR4108
MPP
AND @MR208               ; SW4
JMP @MR4109
;Select_ACT Sample *//
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task4 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #4 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task4 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task4 SEL_ACT Busy
CON
SET @MR201               ; Task4 SEL_ACT END
CON
ENDS
;<h1/>SELECT_Y_N
;//*Select_Y_N Sample
STG @MR4203
ANB R39104               ; SELECT_Y_N Interlock
SET R39104               ; SELECT_Y_N Interlock
CON
DW #7 @DM21              ; ScreenNo /SELECT_Y_N
CON
DW #0 @DM22              ; Bz_Use /SELECT_Y_N
CON
SET @MR300               ; Task4 SELECT_Y_N
CON
JMP @MR4204
STG @MR4204
AND @MR301               ; Task4 Y/N END
RES @MR301               ; Task4 Y/N END
CON
RES R39104               ; SELECT_Y_N Interlock
CON
MPS
AND @MR306               ; Task4 Y/N
JMP @MR4205
MPP
ANB @MR306               ; Task4 Y/N
JMP @MR4206
;*Select_Y_N Sample//
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task4 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task4 Y/N
CON
DW #4 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task4 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task4 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task4 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task4 Y_N Busy
CON
SET @MR301               ; Task4 Y/N END
CON
ENDS
;<h1/>TIMEUP_ERROR
;//*TIMEUP_ERROR Sample
;ｻﾝﾌﾟﾙｾﾝｻ:MR5000=ON AND MR5001 = OFF のいずれかが5sﾀｲﾑｱｯﾌﾟしたらTIMEUP_ERROR出力
;ｴﾗｰ復帰後、再度ｾﾝｻ確認
;TIMEUP_ERROR Sample *//
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task4 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #4 @DM40              ; TaskNo /TIMEUP_ERR
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR  TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task4 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task4 TIMEUP Busy
CON
SET @MR401               ; Task4 TIMEUP_END
CON
ENDS
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/>ｲﾝﾃﾞｯｸｽ部除材準備ｻﾌﾞﾙｰﾁﾝ
STG @MR4500              ; 除材準備開始
JMP @MR4503
STG @MR4503
DW #2 DM11028            ; RB6 目標ﾎﾟｲﾝﾄ番号
CON
SET @R000                ; RB6動作開始
CON
JMP @MR4504
STG @MR4504
AND @R001                ; RB6動作完了
RES @R001                ; RB6動作完了
CON
JMP @MR4506
STG @MR4506
DW #4 DM11028            ; RB6 目標ﾎﾟｲﾝﾄ番号
CON
SET @R000                ; RB6動作開始
CON
JMP @MR4507
STG @MR4507
AND @R001                ; RB6動作完了
RES @R001                ; RB6動作完了
CON
JMP @R200
STG @R200
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
JMP @MR4510
MPP
ANB R7504                ; ﾜｰｸｾｯﾄ部 ST2 圧力1
TMR @30 #20
CON
AND @T30
JMP @R201
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
JMP @MR4510
MPP
ANB R7506                ; ﾜｰｸｾｯﾄ部 ST3 圧力1
TMR @31 #20
CON
AND @T31
JMP @R202
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
JMP @MR4510
MPP
ANB R7508                ; ﾜｰｸｾｯﾄ部 ST4 圧力1
TMR @32 #20
CON
AND @T32
JMP @R203
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
MPS
AND R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
JMP @MR4510
MPP
ANB R7502                ; ﾜｰｸｾｯﾄ部 ST1 圧力1
TMR @33 #20
CON
AND @T33
JMP @R204
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR4512
STG @R201
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #41 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7504 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @R205
STG @R202
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #42 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7506 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @R205
STG @R203
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #43 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7508 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @R205
STG @R204
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #40 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7502 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @R205
STG @R205
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @R206
STG @R206
AND @MR105               ; SW1
JMP @R200
STG @MR4510
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
JMP @MR4511
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
JMP @MR4511
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
JMP @MR4511
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
SET MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
JMP @MR4511
STG @MR4511
MPS
LD= DM35000 #0           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7505                ; ﾜｰｸｾｯﾄ部 ST2 圧力2
ANL
JMP @MR4512
MRD
LD= DM35000 #1           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7507                ; ﾜｰｸｾｯﾄ部 ST3 圧力2
ANL
JMP @MR4512
MRD
LD= DM35000 #2           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7509                ; ﾜｰｸｾｯﾄ部 ST4 圧力2
ANL
JMP @MR4512
MRD
LD= DM35000 #3           ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
AND R7503                ; ﾜｰｸｾｯﾄ部 ST1 圧力2
ANL
JMP @MR4512
MPP
TMR @35 #10
CON
AND @T35
JMP @MR4512
STG @MR4512
DW #3 DM11028            ; RB6 目標ﾎﾟｲﾝﾄ番号
CON
SET @R000                ; RB6動作開始
CON
JMP @MR4513
STG @MR4513
AND @R001                ; RB6動作完了
RES @R001                ; RB6動作完了
CON
JMP @MR5800
STG @MR5800
MPS
AND= DM35000 #0          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10614              ; ST2ﾜｰｸ吸着 破壊ON
CON
SET MR10613              ; ST2ﾜｰｸ吸着 吸着OFF
CON
RES MR10612              ; ST2ﾜｰｸ吸着 吸着ON
CON
JMP @MR5801
MRD
AND= DM35000 #1          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10702              ; ST3ﾜｰｸ吸着 破壊ON
CON
SET MR10701              ; ST3ﾜｰｸ吸着 吸着OFF
CON
RES MR10700              ; ST3ﾜｰｸ吸着 吸着ON
CON
JMP @MR5801
MRD
AND= DM35000 #2          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10705              ; ST4ﾜｰｸ吸着 破壊ON
CON
SET MR10704              ; ST4ﾜｰｸ吸着 吸着OFF
CON
RES MR10703              ; ST4ﾜｰｸ吸着 吸着ON
CON
JMP @MR5801
MPP
AND= DM35000 #3          ; ｲﾝﾃﾞｯｸｽ位置ﾃﾞｰﾀ
RES MR10611              ; ST1ﾜｰｸ吸着 破壊ON
CON
SET MR10610              ; ST1ﾜｰｸ吸着 吸着OFF
CON
RES MR10609              ; ST1ﾜｰｸ吸着 吸着ON
CON
JMP @MR5801
STG @MR5801
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
JMP @MR5815
STG @MR5815
SET @MR4501              ; 除材動作　準備完了
CON
ENDS
;<h1/>除材開始ｻﾌﾞﾙｰﾁﾝ
STG @MR4600              ; 除材処理
JMP @MR4603
STG @MR4603
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #1 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #2 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
SET @R010                ; RB8動作開始
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4604
STG @MR4604
AND @R006                ; RB9動作完了
AND @R011                ; RB8動作完了
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
RES @R101                ; RB4動作完了
CON
JMP @MR4606
STG @MR4606
MPS
AND= DM35010 #1          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #2 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #2          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #3 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #3          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #4 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #4          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #5 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #5          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #6 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #6          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #7 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #7          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #8 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #8          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #9 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MRD
AND= DM35010 #9          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #10 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
MPP
AND= DM35010 #10         ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #11 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4607
STG @MR4607
MPS
AND MR23400              ; 除材搬送_θ軸_P1
SET @R005                ; RB9動作開始
CON
JMP @MR4608
MPP
ANB MR23400              ; 除材搬送_θ軸_P1
JMP @MR4609
STG @MR4609
DW #1 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR4610
STG @MR4610
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @MR4607
STG @MR4608
AND @R006                ; RB9動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
JMP @MR4611
STG @MR4611
DW #3 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4612
STG @MR4612
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R101                ; RB4動作完了
CON
JMP @MR4613
STG @MR4613
ZRES MR12808 MR12815     ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
SET MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
RES MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
TMR @40 #0
CON
AND @T40
JMP @MR4700
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
TMR @41 #2
CON
AND @T41
JMP @MR4700
STG @MR4700
DW #4 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4701
STG @MR4701
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R101                ; RB4動作完了
CON
JMP @MR4702
STG @MR4702
MPS
LD= DM5010 #1            ; _AUTO動作番号
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
SET MR12808              ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
JMP @MR4703
MPP
LD= DM5010 #4            ; _AUTO動作番号
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR4707
STG @MR4703
MPS
LD MR12809               ; 除材吸着ﾊﾝﾄﾞ 吸着確認-ON
ANB MR12810              ; 除材吸着ﾊﾝﾄﾞ 吸着確認-OFF
ANL
JMP @MR4707
MPP
LD MR12810               ; 除材吸着ﾊﾝﾄﾞ 吸着確認-OFF
ANB MR12809              ; 除材吸着ﾊﾝﾄﾞ 吸着確認-ON
ANL
JMP @MR4704
STG @MR4704
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1709 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #46 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #7511 @DM2            ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR4705
STG @MR4705
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR4706
STG @MR4706
MPS
AND @MR105               ; SW1
ZRES MR12808 MR12815     ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
JMP @MR4702
MRD
AND @MR106               ; SW2
ZRES MR12808 MR12815     ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
SET @MR4915              ; ﾜｰｸPASS
CON
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
JMP @MR5008
MPP
AND @MR108               ; SW4
ZRES MR12808 MR12815     ; 除材吸着ﾊﾝﾄﾞ 吸着確認開始
CON
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
JMP @MR5008
STG @MR4707
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
AND @R006                ; RB9動作完了
DW #5 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4708
STG @MR4708
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
RES @R101                ; RB4動作完了
CON
SET MR314                ; 除材P&P Data shift Request
CON
MPS
AND LR10012              ; 除材ﾜｰｸ有無画像 有効/無効
JMP @MR4709
MPP
ANB LR10012              ; 除材ﾜｰｸ有無画像 有効/無効
JMP @MR4715
STG @MR5008
AND @R006                ; RB9動作完了
JMP @MR5009
STG @MR5009
MPS
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
JMP @MR5200
MPP
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= DM35010 #10         ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
RES @R006                ; RB9動作完了
CON
SET @MR3500              ; 除材終了動作
CON
SET @MR3515              ; 最終除材動作中
CON
JMP @MR5200
MPP
AND<> DM35010 #10        ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
RES @R006                ; RB9動作完了
CON
JMP @MR5200
;<h1/>除材ﾜｰｸ確認追加
STG @MR4709
RES @MR5010              ; ﾜｰｸ除材OK
CON
SET R18500               ; 画像　除材部ﾜｰｸ検査要求
CON
JMP @MR5001
STG @MR5001
AND R18501               ; 画像　除材部ﾜｰｸ検査完了
RES R18501               ; 画像　除材部ﾜｰｸ検査完了
CON
JMP @MR5002              ; ﾜｰｸ確認
LD @MR5002               ; ﾜｰｸ確認
MPS
AND= DM35010 #1          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #1 DM29051
CON
AND R18701               ; ﾜｰｸ1　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #2          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #2 DM29051
CON
AND R18703               ; ﾜｰｸ2　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #3          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #4 DM29051
CON
AND R18705               ; ﾜｰｸ3　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #4          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #8 DM29051
CON
AND R18707               ; ﾜｰｸ4　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #5          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #16 DM29051
CON
AND R18709               ; ﾜｰｸ5　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #6          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #32 DM29051
CON
AND R18711               ; ﾜｰｸ6　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #7          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #64 DM29051
CON
AND R18713               ; ﾜｰｸ7　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #8          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #128 DM29051
CON
AND R18715               ; ﾜｰｸ8　無し
SET @MR5010              ; ﾜｰｸ除材OK
MRD
AND= DM35010 #9          ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #256 DM29051
CON
AND R18801               ; ﾜｰｸ9　無し
SET @MR5010              ; ﾜｰｸ除材OK
MPP
AND= DM35010 #10         ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
DW #512 DM29051
CON
AND R18803               ; ﾜｰｸ10　無し
SET @MR5010              ; ﾜｰｸ除材OK
STG @MR5002              ; ﾜｰｸ確認
MPS
AND @MR5010              ; ﾜｰｸ除材OK
DW #0 DM29051
CON
JMP @MR4715
MPP
ANB @MR5010              ; ﾜｰｸ除材OK
TMR #1262 #10
CON
AND T1262
JMP @MR5003
STG @MR5003
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #48 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR5004
STG @MR5004
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5005
STG @MR5005
MPS
AND @MR105               ; SW1
DW #0 DM29051
CON
JMP @MR4709
MPP
AND @MR108               ; SW4
DW #0 DM29051
CON
JMP @MR4715
STG @MR4715
RES @MR5010              ; ﾜｰｸ除材OK
CON
TMR @43 #0
CON
AND @T43
MPS
AND= DM35010 #10         ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SET @MR3500              ; 除材終了動作
CON
SET @MR3515              ; 最終除材動作中
CON
JMP @MR4710
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR4710
MPP
AND<> DM35010 #10        ; 除材部　除材ﾎﾟｼﾞｼｮﾝ
JMP @MR4710
STG @MR4710
AND MR514                ; 完了
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LD= EM32115 #200         ; WORK DATA
OR MR19710               ; NG排出
OR @MR3302               ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
ANL
RES MR514                ; 完了
CON
JMP @MR5200
MPP
LD= EM32115 #100         ; WORK DATA
OR= EM32115 #0           ; WORK DATA
OR= EM32115 #120         ; WORK DATA
ANB @MR3302              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｴﾗｰ出力済み
ANB MR19710              ; NG排出
ANL
RES MR514                ; 完了
CON
JMP @MR4712
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LD= DM4110 #9            ; _Group1　ﾒﾝﾃ動作番号
OR= DM4110 #10           ; _Group1　ﾒﾝﾃ動作番号
ANL
RES MR514                ; 完了
CON
JMP @MR4712
MPP
AND= DM4110 #11          ; _Group1　ﾒﾝﾃ動作番号
JMP @MR5200
STG @MR4712
MPS
ANB R41204               ; TASK4 PAUSE 
DW #3 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #2 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #12 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #5 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
JMP @MR4713
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR4713
SET @R010                ; RB8動作開始
CON
SET @R105                ; RB3動作開始
CON
SET @R100                ; RB4動作開始
CON
AND>.L DM10540 +6500     ; MSEP Axis-4 現在位置（下位8bit）
SET @R005                ; RB9動作開始
CON
JMP @MR4714
STG @MR4714
AND @R011                ; RB8動作完了
AND @R106                ; RB3動作完了
AND @R006                ; RB9動作完了
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
RES @R106                ; RB3動作完了
CON
RES @R101                ; RB4動作完了
CON
RES MR514                ; 完了
CON
JMP @MR4800
STG @MR4800
JMP @MR4801
STG @MR4801
JMP @MR4803
STG @MR4803
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB DM2000.0             ; ｱﾗｲﾒﾝﾄ画像 有効/無効
SET MR10400              ; 点灯/消灯制御入力(L1)
CON
SET MR9500               ; ｱﾗｲﾒﾝﾄ　画像検査開始
CON
SET MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR4804
MPP
AND DM2000.0             ; ｱﾗｲﾒﾝﾄ画像 有効/無効
JMP @MR4805
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= #10 DM4110          ; _Group1　ﾒﾝﾃ動作番号
SET MR10400              ; 点灯/消灯制御入力(L1)
CON
SET MR9500               ; ｱﾗｲﾒﾝﾄ　画像検査開始
CON
SET MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
JMP @MR4804
MPP
AND= #9 DM4110           ; _Group1　ﾒﾝﾃ動作番号
JMP @MR4805
STG @MR4804
AND MR9501               ; 画像検査　ｱﾗｲﾒﾝﾄ移動完了
MPS
ANB MR4515               ; NG排出処理
RES MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR9501               ; 画像検査　ｱﾗｲﾒﾝﾄ移動完了
CON
JMP @MR4805
MPP
AND MR4515               ; NG排出処理
RES MR6608               ; 画像ｱﾗｲﾒﾝﾄ ｻｲｸﾙﾀｲﾑ計測用
CON
RES MR9501               ; 画像検査　ｱﾗｲﾒﾝﾄ移動完了
CON
JMP @MR5100
STG @MR5100
RES MR4515               ; NG排出処理
CON
DW #2 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R010                ; RB8動作開始
CON
SET @R005                ; RB9動作開始
CON
JMP @MR5101
STG @MR5101
AND @R011                ; RB8動作完了
AND @R006                ; RB9動作完了
RES MR10400              ; 点灯/消灯制御入力(L1)
CON
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR5102
STG @MR5102
DW #1 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR5103
STG @MR5103
AND @R101                ; RB4動作完了
RES @R101                ; RB4動作完了
CON
JMP @MR5104
STG @MR5104
AND MR23001              ; 除材搬送_X軸_P2
AND MR24200              ; 除材搬送_Y軸_P1
DW #1 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
JMP @MR5105
STG @MR5105
BANB DM10547 #2          ; MSEP Axis-4 状態信号
AND @R106                ; RB3動作完了
RES @R106                ; RB3動作完了
CON
JMP @MR5200
STG @MR4805
TMH @44 #10
CON
AND @T44
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES MR10400              ; 点灯/消灯制御入力(L1)
CON
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
BANB DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
JMP @MR4806
MPP
BAND DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
MPS
LD= @DM7 #0
ORB LR10009              ; [NR]受渡し位置追加
ANL
LDA.L DM7000             ; 装置基礎ﾃﾞｰﾀ1
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
JMP @MR4806
MPP
LD= @DM7 #1
AND LR10009              ; [NR]受渡し位置追加
ANL
LDA.L DM7016             ; 装置基礎ﾃﾞｰﾀ9
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
JMP @MR4806
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LD= DM15001 #1
ORB LR10009              ; [NR]受渡し位置追加
ANL
LDA.L DM7000             ; 装置基礎ﾃﾞｰﾀ1
CON
LDA.L DM7000             ; 装置基礎ﾃﾞｰﾀ1
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
JMP @MR4806
MPP
AND= DM15001 #2
LDA.L DM7016             ; 装置基礎ﾃﾞｰﾀ9
CON
AND LR10009              ; [NR]受渡し位置追加
LDA.L DM7016             ; 装置基礎ﾃﾞｰﾀ9
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
JMP @MR4806
STG @MR4806
LDA.L DM7002             ; 装置基礎ﾃﾞｰﾀ2
CON
SUB.L EM2243             ; RB9 P12 目標位置（下位bit）
CON
ADD.L DM10580            ; SCON-2 現在位置（下位8bit）
CON
ADD.L DM7010             ; 装置基礎ﾃﾞｰﾀ6
CON
STA.L DM10780            ; SCON-2 目標位置（下位8bit）
CON
STA.L EM38108
CON
LDA DM7004               ; 装置基礎ﾃﾞｰﾀ3
CON
STA DM10776              ; SCON-1 速度
CON
LDA DM7006               ; 装置基礎ﾃﾞｰﾀ4
CON
STA DM10784              ; SCON-2 速度
CON
LDA.L DM10540            ; MSEP Axis-4 現在位置（下位8bit）
CON
ADD.L DM7012             ; 装置基礎ﾃﾞｰﾀ7
CON
STA.L DM10740            ; MSEP Axis-4 目標位置（下位8bit）
CON
LDA.L DM10540            ; MSEP Axis-4 現在位置（下位8bit）
CON
STA.L EM38308
CON
LDA EM2315               ; θ軸ｱﾗｲﾒﾝﾄ速度
CON
STA DM10744              ; MSEP Axis-4 速度
CON
DW #5 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #21 DM11128           ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #17 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #19 DM11088           ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
MPS
BANB DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
JMP @MR4810
MPP
BAND DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
INC @DM7
CON
MPS
AND= @DM7 #2
MOV #0 @DM7
MPP
JMP @MR4810
STG @MR4810
TMH @45 #10
CON
AND @T45
SET @R100                ; RB4動作開始
CON
SET @R105                ; RB3動作開始
CON
SET @R005                ; RB9動作開始
CON
JMP @MR4811
STG @MR4811
AND @R006                ; RB9動作完了
AND @R106                ; RB3動作完了
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R106                ; RB3動作完了
CON
RES @R006                ; RB9動作完了
CON
SET MR414                ; to 3cell Data shift Request
CON
RES @R101                ; RB4動作完了
CON
JMP @MR4813
STG @MR4813
MPS
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
MPP
LDB R41204               ; TASK4 PAUSE 
LDB DM2000.15            ; 下流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
AND R5503                ; I_ｲﾝﾀｰﾛｯｸ信号2（隣ｾﾙ2）
OR DM2000.15             ; 下流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
ANL
ANL
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND B0C1                 ; ｾﾙ2へ動作開始許可
JMP @MR4814
MRD
LDB DM2000.3             ; 転写後ﾜｰｸ時間管理 有効/無効
ANB B0C1                 ; ｾﾙ2へ動作開始許可
ANB @MR3304              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｰｴﾗｰ継続処理済み
ANB MR19711              ; 良品処理
ANL
LDA.L DM27102
CON
SUB.L DM10914
CON
STA.L DM27120
CON
AND>.L +0 DM27120
JMP @MR5108
MRD
LD DM2000.3              ; 転写後ﾜｰｸ時間管理 有効/無効
AND B0C1                 ; ｾﾙ2へ動作開始許可
ANB @MR3304              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｰｴﾗｰ継続処理済み
ANL
JMP @MR4814
MPP
AND DM2000.15            ; 下流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
JMP @MR4814
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES MR508                ; ﾃﾞｰﾀ書き込み完了
CON
JMP @MR4814
STG @MR5108
SET @MR1900              ; Main1 HALT許可
CON
ANB R39004               ; ｴﾗｰ中
RES MR17600              ; TP/ｴﾗｰｺｰﾄﾞ表示
CON
SET R39004               ; ｴﾗｰ中
CON
DW #9004 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #65 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
@SET @MR100              ; Task4 ERROR
CON
JMP @MR5109
STG @MR5109
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5110
STG @MR5110
MPS
AND @MR105               ; SW1
SET MR19710              ; NG排出
CON
JMP @MR5100
MPP
AND @MR108               ; SW4
SET MR19711              ; 良品処理
CON
JMP @MR4813
STG @MR4814
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
BANB DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
MPS
BLD W0EE #0
ORB LR10009              ; [NR]受渡し位置追加
ANL
LDA.L DM7000             ; 装置基礎ﾃﾞｰﾀ1
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
SET B063                 ; ｾﾙ3へ動作開始通知
CON
SET MR5603               ; O_ｲﾝﾀｰﾛｯｸ信号2
CON
ANB B0C1                 ; ｾﾙ2へ動作開始許可
JMP @MR4815
MPP
BLD W0EE #1
AND LR10009              ; [NR]受渡し位置追加
ANL
LDA.L DM7016             ; 装置基礎ﾃﾞｰﾀ9
CON
SUB.L EM2186             ; RB8 P3 目標位置（下位bit）
CON
ADD.L DM10572            ; SCON-1 現在位置（下位8bit）
CON
ADD.L DM7008             ; 装置基礎ﾃﾞｰﾀ5
CON
STA.L DM10772            ; SCON-1 目標位置（下位8bit）
CON
STA.L EM38008
CON
SET B063                 ; ｾﾙ3へ動作開始通知
CON
SET MR5603               ; O_ｲﾝﾀｰﾛｯｸ信号2
CON
ANB B0C1                 ; ｾﾙ2へ動作開始許可
JMP @MR4815
MPP
BAND DM2000 #15          ; _動作ﾊﾟﾗﾒｰﾀ
JMP @MR4815
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR4815
STG @MR4815
RES @MR3304              ; ﾎﾟｯﾄﾀｲﾑｵｰﾊﾞｰｴﾗｰ継続処理済み
CON
SET @R010                ; RB8動作開始
CON
JMP @MR4900
STG @MR4900
AND @R011                ; RB8動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R011                ; RB8動作完了
CON
JMP @MR4901
STG @MR4901
DW #6 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4902
STG @MR4902
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R101                ; RB4動作完了
CON
JMP @MR4903
STG @MR4903
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
SET MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
JMP @MR4904
STG @MR4904
DW #7 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR4905
STG @MR4905
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
RES @R101                ; RB4動作完了
CON
JMP @MR4907
STG @MR4907
DW #1 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
TMH @46 #10
CON
AND @T46
SET @R010                ; RB8動作開始
CON
SET @R005                ; RB9動作開始
CON
SET @MR4908
CON
JMP @MR4908
STG @MR4908
AND @R011                ; RB8動作完了
AND @R006                ; RB9動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
MPS
ANB DM2000.13            ; ﾄﾚｻﾋﾞﾘﾃｨ 有効/無効
SET MR410                ; SDCard書き込みﾌﾗｸﾞ
CON
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR4909
MPP
AND DM2000.13            ; ﾄﾚｻﾋﾞﾘﾃｨ 有効/無効
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR4909
MPP
AND DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR4909
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR4909
STG @MR4909
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
TMR @47 #0
CON
AND @T47
RES B063                 ; ｾﾙ3へ動作開始通知
CON
RES MR5603               ; O_ｲﾝﾀｰﾛｯｸ信号2
CON
JMP @MR4910
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES B063                 ; ｾﾙ3へ動作開始通知
CON
RES MR5603               ; O_ｲﾝﾀｰﾛｯｸ信号2
CON
JMP @MR4914
STG @MR4910
@INC.D DM5022            ; _生産ｶｳﾝﾀ2
CON
JMP @MR4912
STG @MR4912
TMR @48 #0
CON
AND @T48
JMP @MR4914
STG @MR4914
DW #1 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #1 DM11088            ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R105                ; RB3動作開始
CON
SET @R100                ; RB4動作開始
CON
JMP @MR5000
STG @MR5000
AND @R101                ; RB4動作完了
AND @R106                ; RB3動作完了
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
LDB DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
LD MR413                 ; SDCard書き込み完了
OR MR9914
BOR DM2000 #13           ; _動作ﾊﾟﾗﾒｰﾀ
ANL
ANL
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R106                ; RB3動作完了
CON
RES @R101                ; RB4動作完了
CON
RES MR413                ; SDCard書き込み完了
CON
JMP @MR5013
MPP
AND DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R106                ; RB3動作完了
CON
RES @R101                ; RB4動作完了
CON
JMP @MR5013
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R106                ; RB3動作完了
CON
RES @R101                ; RB4動作完了
CON
JMP @MR5013
STG @MR5013
AND MR508                ; ﾃﾞｰﾀ書き込み完了
RES MR508                ; ﾃﾞｰﾀ書き込み完了
CON
SET @MR4601              ; 除材処理完了
CON
ENDS
STG @MR5200
MPS
ANB R41204               ; TASK4 PAUSE 
JMP @MR5201
MPP
AND R41204               ; TASK4 PAUSE 
SET @MR1900              ; Main1 HALT許可
STG @MR5201
MPS
LDB @MR4915              ; ﾜｰｸPASS
AND< DM10540 #700        ; MSEP Axis-4 現在位置（下位8bit）
ANL
DW #4 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #13 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R010                ; RB8動作開始
CON
JMP @MR5202
MPP
AND @MR4915              ; ﾜｰｸPASS
JMP @MR5203
STG @MR5202
AND @R011                ; RB8動作完了
SET @R005                ; RB9動作開始
CON
JMP @MR5203
STG @MR5203
MPS
LDB @MR4915              ; ﾜｰｸPASS
AND @R011                ; RB8動作完了
AND @R006                ; RB9動作完了
ANL
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R006                ; RB9動作完了
CON
RES @R011                ; RB8動作完了
CON
JMP @MR5204
MPP
AND @MR4915              ; ﾜｰｸPASS
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
JMP @MR5206
STG @MR5204
DW #8 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
JMP @MR5205
STG @MR5205
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R101                ; RB4動作完了
CON
JMP @MR5206
STG @MR5206
MPS
ANB @MR4915              ; ﾜｰｸPASS
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
TMH @49 #3
CON
AND @T49
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
DW #14 DM11148           ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
JMP @MR5207
MPP
AND @MR4915              ; ﾜｰｸPASS
RES MR10606              ; 除材ﾊﾝﾄﾞ 吸着ON
CON
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
TMH @50 #3
CON
AND @T50
SET MR10607              ; 除材ﾊﾝﾄﾞ 吸着OFF
CON
JMP @MR5208
STG @MR5207
AND @R006                ; RB9動作完了
RES @R006                ; RB9動作完了
CON
JMP @MR5208
STG @MR5208
RES MR10608              ; 除材ﾊﾝﾄﾞ 破壊ON
CON
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
@INC.D DM5024            ; _生産ｶｳﾝﾀ3
CON
JMP @MR5209
MPP
ANB R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR5209
STG @MR5209
DW #1 DM11108            ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号
CON
DW #1 DM11128            ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R100                ; RB4動作開始
CON
SET @R010                ; RB8動作開始
CON
JMP @MR5211
STG @MR5211
AND @R011                ; RB8動作完了
AND @R101                ; RB4動作完了
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES @R011                ; RB8動作完了
CON
RES @R101                ; RB4動作完了
CON
JMP @MR5212
STG @MR5212
DW #1 DM11148            ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号
CON
SET @R005                ; RB9動作開始
CON
JMP @MR5213
STG @MR5213
AND @R006                ; RB9動作完了
RES @R006                ; RB9動作完了
CON
JMP @MR5215
STG @MR5215
RES @MR4915              ; ﾜｰｸPASS
CON
SET @MR4601              ; 除材処理完了
CON
ENDS
;<h1/>RB6動作ｻﾌﾞﾙｰﾁﾝ
STG @R000                ; RB6動作開始
ANB @R002                ; RB6動作中
ANB MR18213              ; RB6:ｱﾗｰﾑ出力
SET @R002                ; RB6動作中
CON
JMP @R003
STG @R003
TMH @51 #10
CON
AND @T51
SET MR18205              ; RB6:MOVE
CON
JMP @R004
STG @R004
AND= DM11028 DM11024     ; RB6 目標ﾎﾟｲﾝﾄ番号  RB6 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR18205              ; RB6:MOVE
TMH @52 #10
CON
AND @T52
RES @R002                ; RB6動作中
CON
SET @R001                ; RB6動作完了
CON
ENDS
;<h1/>RB9動作ｻﾌﾞﾙｰﾁﾝ
STG @R005                ; RB9動作開始
ANB @R007                ; RB9動作中
ANB MR19413              ; RB9:ｱﾗｰﾑ出力
SET @R007                ; RB9動作中
CON
JMP @R008
STG @R008
TMH @10 #10
CON
AND @T10
SET MR19405              ; RB9:Y軸　MOVE
CON
JMP @R009
STG @R009
AND= DM11148 DM11144     ; RB9 Y軸　目標ﾎﾟｲﾝﾄ番号  RB9 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR19405              ; RB9:Y軸　MOVE
TMH @11 #0
CON
AND @T11
RES @R007                ; RB9動作中
CON
SET @R006                ; RB9動作完了
CON
ENDS
;<h1/>RB8動作ｻﾌﾞﾙｰﾁﾝ
STG @R010                ; RB8動作開始
ANB @R012                ; RB8動作中
ANB MR19213              ; RB8:ｱﾗｰﾑ出力
SET @R012                ; RB8動作中
CON
JMP @R013
STG @R013
TMH @12 #10
CON
AND @T12
SET MR19205              ; RB8:X軸　MOVE
CON
JMP @R014
STG @R014
AND= DM11128 DM11124     ; RB8 X軸　目標ﾎﾟｲﾝﾄ番号  RB8 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR19205              ; RB8:X軸　MOVE
TMH @13 #0
CON
AND @T13
RES @R012                ; RB8動作中
CON
SET @R011                ; RB8動作完了
CON
ENDS
;<h1/>RB4動作ｻﾌﾞﾙｰﾁﾝ
STG @R100                ; RB4動作開始
ANB @R102                ; RB4動作中
ANB MR19013              ; RB4:ｱﾗｰﾑ出力
SET @R102                ; RB4動作中
CON
JMP @R103
STG @R103
TMH @14 #10
CON
AND @T14
SET MR19005              ; RB4:Z軸  MOVE
CON
JMP @R104
STG @R104
AND= DM11108 DM11104     ; RB4 Z軸　目標ﾎﾟｲﾝﾄ番号  RB4 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR19005              ; RB4:Z軸  MOVE
TMH @15 #0
CON
AND @T15
RES @R102                ; RB4動作中
CON
SET @R101                ; RB4動作完了
CON
ENDS
;<h1/>RB3動作ｻﾌﾞﾙｰﾁﾝ
STG @R105                ; RB3動作開始
ANB @R107                ; RB3動作中
ANB MR18813              ; RB3:ｱﾗｰﾑ出力
SET @R107                ; RB3動作中
CON
JMP @R108
STG @R108
TMH @16 #10
CON
AND @T16
SET MR18805              ; RB3:θ軸　MOVE
CON
JMP @R109
STG @R109
AND= DM11088 DM11084     ; RB3 θ軸　目標ﾎﾟｲﾝﾄ番号  RB3 現在ﾎﾟｼﾞｼｮﾝ番号
ANB MR18805              ; RB3:θ軸　MOVE
TMH @17 #0
CON
AND @T17
RES @R107                ; RB3動作中
CON
SET @R106                ; RB3動作完了
CON
ENDS
;<h1/>画像検査要求ｻﾌﾞﾙｰﾁﾝ
;DM16050（仮割付）：除材ｶﾒﾗ状態信号
;bit0:FLG　　ｺﾏﾝﾄﾞ実行完了時ON
;bit1:BUSY　 制御ｺﾏﾝﾄﾞ実行中ON
;bit2:READY　ONでｺﾏﾝﾄﾞ実行可能
;bit3:OR　　 判定結果NGでON
;bit4:RUN　　ｶﾒﾗ運転ﾓｰﾄﾞ中にON
;bit15:ERR　 異常時ON
;
;DM16090：除材ｶﾒﾗ制御信号
;bit0:EXE　　制御ｺﾏﾝﾄﾞ実行
;bit1:TRG　　計測実行
;bit15:ERCLR ｴﾗｰｸﾘｱ
BLD DM16050 #15
ANB @MR003               ; 除材ｶﾒﾗｱﾗｰﾑ
OUT @MR5503
;最新ｴﾗｰ情報取得 ｺﾏﾝﾄﾞｺｰﾄﾞ：00205000
;下位4桁 DM16092→5000＝0101,0000,0000,0000（10進数：#20480）
;上位4桁 DM16093→0020＝0000,0000,0010,0000 (10進数：＃32）
LDP @MR5503
ANB R39004               ; ｴﾗｰ中
SET @MR003               ; 除材ｶﾒﾗｱﾗｰﾑ
CON
SET R39004               ; ｴﾗｰ中
CON
MOV #20480 DM16092
MOV #32 DM16093
SET @MR5504
;給材ｶﾒﾗ制御ｺﾏﾝﾄﾞ実行
STG @MR5504
BSET DM16090 #0
CON
BRES DM16090 #1
CON
BAND DM16050 #1
JMP @MR5505
STG @MR5505
BAND DM16050 #0
BRES DM16090 #0
CON
JMP @MR5506
;給材ｶﾒﾗ計測実行
STG @MR5506
BRES DM16090 #0
CON
BSET DM16090 #1
CON
BAND DM16050 #1
JMP @MR5508
STG @MR5508
BRES DM16090 #1
CON
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #51 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task4 ERROR
CON
JMP @MR5509
STG @MR5509
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task4 ERROR_End
RES @MR101               ; Task4 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
JMP @MR5510
STG @MR5510
AND @MR105               ; SW1
BSET DM16090 #15
CON
BANB DM16050 #15
JMP @MR5512
STG @MR5512
TMR @98 #5
CON
AND @T98
BRES DM16090 #15
CON
RES @MR003               ; 除材ｶﾒﾗｱﾗｰﾑ
CON
ENDS
;<h1/>HALT
LD R41204                ; TASK4 PAUSE 
AND @MR1900              ; Main1 HALT許可
ANB @R107                ; RB3動作中
ANB @R102                ; RB4動作中
ANB @R012                ; RB8動作中
ANB @R007                ; RB9動作中
ANB @R002                ; RB6動作中
TMR @190 #2
CON
AND @T190
SET R42604               ; _Grp1_Task4_ﾎﾟｰｽﾞ許可
LDB R41204               ; TASK4 PAUSE 
RES @MR1900              ; Main1 HALT許可
CON
RES R42604               ; _Grp1_Task4_ﾎﾟｰｽﾞ許可
;
END
ENDH
