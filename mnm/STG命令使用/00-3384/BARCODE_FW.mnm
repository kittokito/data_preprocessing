DEVICE:52
;MODULE:BARCODE_FW
;MODULE_TYPE:0
;I/Oﾁｪｯｸ用の仮読込ﾗﾀﾞｰです
;上手く動かなかったらごめんなさい　_(__　＿)_
;
LD R4100
@SET @MR108              ; CELL 選択
CON
@SET @MR300              ; BCR読込
LD R4101
@SET @MR109              ; TANK 選択
CON
@SET @MR300              ; BCR読込
LDB R4100
ANB R4101
TMR @0 #5                ; ﾃﾞｨﾚｲ
CON
AND @T0                  ; ﾃﾞｨﾚｲ
OUT @MR002               ; ｲﾝｸ照合SW 中間位置
RES R32201               ; Port2 受信完了
CON
ZRES @MR100 @MR109       ; TANK 選択
CON
ZRES @MR300 @MR315       ; BCR読込  BCR読み込み完了
CON
ZRES @MR505 @MR507       ; BCR CELLﾃﾞｰﾀｴﾗｰ  BCR TANKﾃﾞｰﾀｴﾗｰ
;
STG @MR300               ; BCR読込
MPS
LDB @MR002               ; ｲﾝｸ照合SW 中間位置
AND R32201               ; Port2 受信完了
ANL
JMP @MR301
MPP
AND @MR002               ; ｲﾝｸ照合SW 中間位置
ENDS
STG @MR301
RES R30201               ; Port2 受信完了
CON
MPS
LDB R32101               ; Port2 受信ﾃﾞｰﾀ未転送
ANB R32102               ; Port2 受信ｴﾗｰ
ANL
JMP @MR302
MPP
LD R32101                ; Port2 受信ﾃﾞｰﾀ未転送
OR R32102                ; Port2 受信ｴﾗｰ
ANL
SET @MR100
CON
ENDS
STG @MR302
MPS
AND @MR108               ; CELL 選択
MPS
AND< DM32001 #11         ; Port2 受信ﾃﾞｰﾀ長
BMOV DM32002 DM37100 #5  ; ｻﾃﾗｲﾄBCR SCANｺｰﾄﾞ1
MOV #0 DM37105           ; NULﾃﾞｰﾀ
JMP @MR314
MPP
AND>= DM32001 #11        ; Port2 受信ﾃﾞｰﾀ長
SET @MR505               ; BCR CELLﾃﾞｰﾀｴﾗｰ
CON
ENDS
MPP
AND @MR109               ; TANK 選択
MPS
AND>= DM32001 #11        ; Port2 受信ﾃﾞｰﾀ長
BMOV DM32002 DM37000 #5  ; ﾀﾝｸBCR SCANｺｰﾄﾞ1
MOV #0 DM37005           ; NULﾃﾞｰﾀ
JMP @MR314
MPP
AND< DM32001 #11         ; Port2 受信ﾃﾞｰﾀ長
SET @MR507               ; BCR TANKﾃﾞｰﾀｴﾗｰ
CON
ENDS
STG @MR314
SET @MR315               ; BCR読み込み完了
CON
ENDS
END
ENDH
