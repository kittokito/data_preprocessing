DEVICE:51
;MODULE:Master
;MODULE_TYPE:0
LD R50010                ; Emergency　Stop
ZRES @MR000 @MR515
LD CR2002                ; 常時ON
OUT R51000               ; ﾃﾞﾊﾞｯｸﾞ用常時ON
;CPU RUN後ﾀｲﾏｰ
LD CR2002                ; 常時ON
TMR @5 #10               ; CPU RUN後1s
;Action Parameter
LD CR2002                ; 常時ON
MPS
AND LR41400              ; ﾋｰﾀｰ無し=ON
OUT MR000                ; ﾋｰﾀｰ無し=ON
MRD
AND LR41401              ; ON=ｴﾘｱｾﾝｻｰなし
OUT MR001                ; ON=ｴﾘｱｾﾝｻｰなし
MRD
AND LR41402              ; Action Parameter 02
OUT MR002                ; Action Parameter 02
MRD
AND LR41403              ; Action Parameter 03
OUT MR003                ; Action Parameter 03
MRD
AND LR41404              ; Action Parameter 04
OUT MR004                ; Action Parameter 04
MRD
AND LR41405              ; Action Parameter 05
OUT MR005                ; Action Parameter 05
MRD
AND LR41406              ; Action Parameter 06
OUT MR006                ; Action Parameter 06
MRD
AND LR41407              ; Action Parameter 07
OUT MR007                ; Action Parameter 07
MRD
AND LR41408              ; Action Parameter 08
OUT MR008                ; Action Parameter 08
MRD
AND LR41409              ; Action Parameter 09
OUT MR009                ; Action Parameter 09
MRD
AND LR41410              ; Action Parameter 10
OUT MR010                ; Action Parameter 10
MRD
AND LR41411              ; Action Parameter 11
OUT MR011                ; Action Parameter 11
MRD
AND LR41412              ; Action Parameter 12
OUT MR012                ; Action Parameter 12
MRD
AND LR41413              ; Action Parameter 13
OUT MR013                ; Action Parameter 13
MRD
AND LR41414              ; Action Parameter 14
OUT MR014                ; Action Parameter 14
MPP
AND LR41415              ; Action Parameter 15
OUT MR015                ; Action Parameter 15
;START SW
LD R1001                 ; ｽﾀｰﾄ ｽｲｯﾁ(左)
AND R1002                ; ｽﾀｰﾄ ｽｲｯﾁ(右)
OUT R50105               ; ｽﾀｰﾄSW ON
;Task Control / タスク制御
LD R50001                ; AUTO
DIFU @MR000
LD @MR000
ORP R50003               ; HOME
SET R50209               ; 動作開始
;Task Controll / タスク制御
LDP R50209               ; 動作開始
LD R50001                ; AUTO
OR R50003                ; HOME
ANL
MDSTRT R-F
SET @MR001
CON
RES R50409               ; ｻｲｸﾙ完了
;STOP Manegment/停止処理
LD R50001                ; AUTO
LDF R50603               ; TP AUTO選択
ORP R50009               ; HOLDRQ
ANL
LD R50002                ; STEP
LDF R50604               ; TP STEP選択
ORP R50009               ; HOLDRQ
ANL
ORL
ORP R50003               ; HOME
SET R50000               ; HOLD
CON
RES R50009               ; HOLDRQ
LDB R50004               ; TASKDO
OR R50308                ; ﾀｽｸ停止待ち
RES R50001               ; AUTO
CON
RES R50002               ; STEP
LD R50003                ; HOME
LDB R50004               ; TASKDO
OR R50308                ; ﾀｽｸ停止待ち
ANL
RES R50003               ; HOME
CON
SET R50007               ; 原点復帰　完了
;Each UT Task Stop / 各UTタスク停止
LD R50001                ; AUTO
OR R50003                ; HOME
AND R50409               ; ｻｲｸﾙ完了
LD R50002                ; STEP
AND R51808
ORL
TMH @10 #1               ; ｳｴｲﾄﾀｲﾏｰ10
CON
AND @T10                 ; ｳｴｲﾄﾀｲﾏｰ10
RES R51808
CON
RES R50409               ; ｻｲｸﾙ完了
CON
RES R50209               ; 動作開始
CON
SET R50308               ; ﾀｽｸ停止待ち
LD R50308                ; ﾀｽｸ停止待ち
ANB R51311               ; IND2 ST3 動作中
RES R50308               ; ﾀｽｸ停止待ち
CON
RES R50004               ; TASKDO
CON
RES R50000               ; HOLD
CON
DIFU @MR103
STG @MR103
JMP @MR104
MDSTOP R-F
STG @MR104
ANB _R-F
ENDS
;＠モード選択　/　Select Mode
LDB R50004               ; TASKDO
ANB R50008               ; Error
ANB R50300               ; Pause
ANB R50010               ; Emergency　Stop
ANB R1014                ; 元圧確認
LD R1003                 ; ｴﾘｱｾﾝｻｰ入力
OR MR001                 ; ON=ｴﾘｱｾﾝｻｰなし
ANL
TMH @6 #30
CON
AND @T6
OUT R50407               ; 動作条件
;ＨＯＭＥ
LDB R50007               ; 原点復帰　完了
ANP R50105               ; ｽﾀｰﾄSW ON
ANB LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
AND R50407               ; 動作条件
DIFU @MR200
LD @MR200
SET R50003               ; HOME
CON
SET R50004               ; TASKDO
;ＡＵＴＯ
LD R1007                 ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
AND R50007               ; 原点復帰　完了
AND R50407               ; 動作条件
ANP R50105               ; ｽﾀｰﾄSW ON
MPS
AND R50212               ; ﾋｰﾀｰ適温
DIFU @MR300
MPP
ANB R50212               ; ﾋｰﾀｰ適温
OUT R50213               ; ﾋｰﾀ適温外運転開始
LD @MR300
SET R50001               ; AUTO
CON
SET R50004               ; TASKDO
;ＳＴＥＰ
LDB R1007                ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
AND R50007               ; 原点復帰　完了
ANP R50105               ; ｽﾀｰﾄSW ON
AND R50407               ; 動作条件
DIFU @MR400
LD @MR400
SET R50002               ; STEP
CON
SET R50004               ; TASKDO
;STEP Operation / STEP動作
LD R50002                ; STEP
MPS
ANB _R-F
MDSTRT R-F
MPP
AND R50409               ; ｻｲｸﾙ完了
SET R51808
CON
RES R50409               ; ｻｲｸﾙ完了
;Ｃａｌｌ　Ｐｏｓｔ
LD R1007                 ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
ZRES R50403 R50405       ; CallPost中  CallPost START入力完了
STG R50400               ; Call Post
ANB R50403               ; CallPost中
ANB R50105               ; ｽﾀｰﾄSW ON
LD R50002                ; STEP
ORB R1007                ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
ANL
SET R50403               ; CallPost中
CON
JMP R50404               ; CallPost START入力待ち
STG R50404               ; CallPost START入力待ち
ANP R50105               ; ｽﾀｰﾄSW ON
ANB R50008               ; Error
ANB R50300               ; Pause
ANB R50010               ; Emergency　Stop
JMP R50405               ; CallPost START入力完了
STG R50405               ; CallPost START入力完了
ANB R50400               ; Call Post
RES R50403               ; CallPost中
CON
ENDS
LD R50400                ; Call Post
AND R50404               ; CallPost START入力待ち
OUT R50401               ; Post Busy
LD R50002                ; STEP
ORB R1007                ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
AND R50405               ; CallPost START入力完了
LDB R50002               ; STEP
AND R1007                ; ｽﾃｯﾌﾟ ｾﾚｸﾄ
ORL
OUT R50402               ; Post Ok
;Error Release Delay Management / エラー解除遅延処理
LDP R50107               ; ｴﾗｰ中非常停止
SET R50109               ; ｴﾗｰ解除
LDB R50008               ; Error
OR R50109                ; ｴﾗｰ解除
TMR @3 #15
LD @T3
OR CR2008                ; 運転開始時1ｽｷｬﾝON
SET @MR500
CON
ZRES R51400 R51404       ; Err IND2  Err IND2ST4
CON
RES R50109               ; ｴﾗｰ解除
CON
RES R50107               ; ｴﾗｰ中非常停止
STG @MR501
AND @MR500
RES @MR500
CON
SET R50108               ; ｴﾗｰ中
CON
ENDS
LD R50008                ; Error
AND R50108               ; ｴﾗｰ中
AND R50015               ; ｴﾗｰﾘｾｯﾄSW ON
TMR @4 #5
LD R50008                ; Error
AND R50108               ; ｴﾗｰ中
ANP R50105               ; ｽﾀｰﾄSW ON
SET R50015               ; ｴﾗｰﾘｾｯﾄSW ON
;Error Release Manegment / エラー解除処理
LD R50008                ; Error
AND R50108               ; ｴﾗｰ中
AND R50015               ; ｴﾗｰﾘｾｯﾄSW ON
ANP R50105               ; ｽﾀｰﾄSW ON
AND @T4
ANB R50300               ; Pause
MPS
SET R50109               ; ｴﾗｰ解除
CON
RES R50108               ; ｴﾗｰ中
CON
RES R50008               ; Error
MPP
ZRES R50110 R50114       ; Err INDEX  Err ST4
CON
ZRES MR1000 MR1115       ; Cylinder Error 1000  Cylinder Error 1115
LDP R50008               ; Error
SET @MR501
;Error Reset Key SW Operation Check / エラーリセットキーＳＷ動作確認
LD CR2007                ; 運転開始時1ｽｷｬﾝOFF
AND LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
ANB R50010               ; Emergency　Stop
@SET @MR502
STG @MR502
ANB R015                 ; ｴﾗｰﾘｾｯﾄｽｲｯﾁ
JMP @MR503
STG @MR503
AND R015                 ; ｴﾗｰﾘｾｯﾄｽｲｯﾁ
JMP @MR504
STG @MR504
ANB R015                 ; ｴﾗｰﾘｾｯﾄｽｲｯﾁ
MPS
AND R50007               ; 原点復帰　完了
SET LR49915              ; ｴﾗｰﾘｾｯﾄｷｰ動作OK
CON
ENDS
MPP
ANB R50007               ; 原点復帰　完了
RES LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
RES LR49915              ; ｴﾗｰﾘｾｯﾄｷｰ動作OK
CON
ENDS
;サイクルタイム計測
LD R50209                ; 動作開始
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
@INC DM5180              ; Total
LD R50209                ; 動作開始
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
@INC DM5182              ; ST1
CON
AND CR2003               ; 常時OFF
@INC DM5184              ; ST2
CON
@INC DM5186              ; ST3
CON
@INC DM5188              ; ST4
LD R50200                ; INDEX Do
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
@INC DM5198              ; INDEX
LDP R50409               ; ｻｲｸﾙ完了
MOV DM5182 DM5183        ; ST1  ST1 to panel
LDP R50412               ; ST2 1ｻｲｸﾙ終了
MOV DM5184 DM5185        ; ST2  ST2 to panel
LDP R50413               ; ST3 1ｻｲｸﾙ終了
MOV DM5186 DM5187        ; ST3  ST3 to panel
LDP R50414               ; ST4 1ｻｲｸﾙ終了
MOV DM5188 DM5189        ; ST4  ST4 to panel
LDP R50409               ; ｻｲｸﾙ完了
WSR DM5190 #4 #1         ; Total CT履歴00
MOV DM5180 DM5190        ; Total  Total CT履歴00
LDP R50409               ; ｻｲｸﾙ完了
MOV DM5198 DM5199        ; INDEX  INDEX to panel
MOV DM5180 DM5181        ; Total  Total to panel
MOV #0 DM5182            ; ST1
MOV #0 DM5184            ; ST2
MOV #0 DM5186            ; ST3
MOV #0 DM5188            ; ST4
LDP R50409               ; ｻｲｸﾙ完了
MOV DM5182 DM5183        ; ST1  ST1 to panel
LDP R50409               ; ｻｲｸﾙ完了
MOV #0 DM5198            ; INDEX
MOV #0 DM5180            ; Total
;ST1 CT1
LD R43200                ; ｻｲｸﾙﾀｲﾑ計測用1-1
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5200              ; ST1-1 **** CT計測ｶｳﾝﾀ
LDF R43200               ; ｻｲｸﾙﾀｲﾑ計測用1-1
MOV DM5200 DM5201        ; ST1-1 **** CT計測ｶｳﾝﾀ  ST1-1 **** CT
DW #0 DM5200             ; ST1-1 **** CT計測ｶｳﾝﾀ
LD R43201                ; ｻｲｸﾙﾀｲﾑ計測用1-2
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5202              ; ST1-2 **** CT計測ｶｳﾝﾀ
LDF R43201               ; ｻｲｸﾙﾀｲﾑ計測用1-2
MOV DM5202 DM5203        ; ST1-2 **** CT計測ｶｳﾝﾀ  ST1-2 **** CT
DW #0 DM5202             ; ST1-2 **** CT計測ｶｳﾝﾀ
;ST2 CT2
LD R43208                ; ｻｲｸﾙﾀｲﾑ計測用2-1
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5220              ; ST2-1 **** CT計測ｶｳﾝﾀ
LDF R43208               ; ｻｲｸﾙﾀｲﾑ計測用2-1
MOV DM5220 DM5221        ; ST2-1 **** CT計測ｶｳﾝﾀ  ST2-1 **** CT
DW #0 DM5220             ; ST2-1 **** CT計測ｶｳﾝﾀ
LD R43209                ; ｻｲｸﾙﾀｲﾑ計測用2-2
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5222              ; ST2-2 **** CT計測ｶｳﾝﾀ
LDF R43209               ; ｻｲｸﾙﾀｲﾑ計測用2-2
MOV DM5222 DM5223        ; ST2-2 **** CT計測ｶｳﾝﾀ  ST2-2 **** CT
DW #0 DM5222             ; ST2-2 **** CT計測ｶｳﾝﾀ
LD R43210                ; ｻｲｸﾙﾀｲﾑ計測用2-3
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5224              ; ST2-3 **** CT計測ｶｳﾝﾀ
LDF R43210               ; ｻｲｸﾙﾀｲﾑ計測用2-3
MOV DM5224 DM5225        ; ST2-3 **** CT計測ｶｳﾝﾀ  ST2-3 **** CT
DW #0 DM5224             ; ST2-3 **** CT計測ｶｳﾝﾀ
LD R43211                ; ｻｲｸﾙﾀｲﾑ計測用2-4
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5226              ; ST2-4 **** CT計測ｶｳﾝﾀ
LDF R43211               ; ｻｲｸﾙﾀｲﾑ計測用2-4
MOV DM5226 DM5227        ; ST2-4 **** CT計測ｶｳﾝﾀ  ST2-4 **** CT
DW #0 DM5226             ; ST2-4 **** CT計測ｶｳﾝﾀ
LD R43212                ; ｻｲｸﾙﾀｲﾑ計測用2-5
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5228              ; ST2-5 **** CT計測ｶｳﾝﾀ
LDF R43212               ; ｻｲｸﾙﾀｲﾑ計測用2-5
MOV DM5228 DM5229        ; ST2-5 **** CT計測ｶｳﾝﾀ  ST2-5 **** CT
DW #0 DM5228             ; ST2-5 **** CT計測ｶｳﾝﾀ
LD R43213                ; ｻｲｸﾙﾀｲﾑ計測用2-6
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5230              ; ST2-6 **** CT計測ｶｳﾝﾀ
LDF R43213               ; ｻｲｸﾙﾀｲﾑ計測用2-6
MOV DM5230 DM5231        ; ST2-6 **** CT計測ｶｳﾝﾀ  ST2-6 **** CT
DW #0 DM5230             ; ST2-6 **** CT計測ｶｳﾝﾀ
;ST3 CT1
LD R43300                ; ｻｲｸﾙﾀｲﾑ計測用3-1
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5240              ; ST3-1 **** CT計測ｶｳﾝﾀ
LDF R43300               ; ｻｲｸﾙﾀｲﾑ計測用3-1
MOV DM5240 DM5241        ; ST3-1 **** CT計測ｶｳﾝﾀ  ST3-1 **** CT
DW #0 DM5240             ; ST3-1 **** CT計測ｶｳﾝﾀ
LD R43301                ; ｻｲｸﾙﾀｲﾑ計測用3-2
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5242              ; ST3-2 **** CT計測ｶｳﾝﾀ
LDF R43301               ; ｻｲｸﾙﾀｲﾑ計測用3-2
MOV DM5242 DM5243        ; ST3-2 **** CT計測ｶｳﾝﾀ  ST3-2 **** CT
DW #0 DM5242             ; ST3-2 **** CT計測ｶｳﾝﾀ
;ST4 CT1
LD R43308                ; ｻｲｸﾙﾀｲﾑ計測用4-1
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5260              ; ST4-1 **** CT計測ｶｳﾝﾀ
LDF R43308               ; ｻｲｸﾙﾀｲﾑ計測用4-1
MOV DM5260 DM5261        ; ST4-1 **** CT計測ｶｳﾝﾀ  ST4-1 **** CT
DW #0 DM5260             ; ST4-1 **** CT計測ｶｳﾝﾀ
LD R43309                ; ｻｲｸﾙﾀｲﾑ計測用4-2
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5262              ; ST4-2 **** CT計測ｶｳﾝﾀ
LDF R43309               ; ｻｲｸﾙﾀｲﾑ計測用4-2
MOV DM5262 DM5263        ; ST4-2 **** CT計測ｶｳﾝﾀ  ST4-2 **** CT
DW #0 DM5262             ; ST4-2 **** CT計測ｶｳﾝﾀ
LD R43310                ; ｻｲｸﾙﾀｲﾑ計測用4-3
AND CR2005               ; 100msｸﾛｯｸﾊﾟﾙｽ
AND R50001               ; AUTO
@INC DM5264              ; ST4-3 **** CT計測ｶｳﾝﾀ
LDF R43310               ; ｻｲｸﾙﾀｲﾑ計測用4-3
MOV DM5264 DM5265        ; ST4-3 **** CT計測ｶｳﾝﾀ  ST4-3 **** CT
DW #0 DM5264             ; ST4-3 **** CT計測ｶｳﾝﾀ
;
LDF R50008               ; Error
WSR DM500 #9 #1          ; Err履歴00
MOV DM400 DM500          ; ﾒｯｾｰｼﾞNo.  Err履歴00
END
ENDH
