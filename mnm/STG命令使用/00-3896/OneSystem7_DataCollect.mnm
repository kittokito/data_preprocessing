DEVICE:53
;MODULE:OneSystem7_DataCollect
;MODULE_TYPE:0
;OneSystem Master-Module
;
;-----------------------------------------
;ModuleName	:	OneSystem7_DataCollect
;ModuleType	:	Master Module
;Function	:	Data Collection
;-----------------------------------------
;
;Copylight(C) 2011 SEIKO EPSON Corp. All rights reserved.
;<h1/>M/C Infomation Making/装置情報生成
;[Task]
;OneSystem起動中
;RES要求：無し
LD CR2008
RES R46000
LDB CR2008
SET R46000
;[Task]
;ﾊﾞｰｼﾞｮﾝ情報転送
;・ﾌﾟﾛｼﾞｪｸﾄ名称
;・OneSystemﾊﾞｰｼﾞｮﾝ
;・ﾕｰｻﾞｰｿﾌﾄﾊﾞｰｼﾞｮﾝ
LD CR2008
SET R46510
LD CR2002
SMOV CM1740 DM5270
SMOV DM9380 DM5287
SMOV DM9220 DM5292
;[Task]
;生産ｶｳﾝﾀ収集ﾀｲﾐﾝｸﾞ生成
;(AUTO中1minｸﾛｯｸﾊﾟﾙｽ)
LDP R46100
MOV.D #0 @EM0
LD R46100
MPS
ANP CR2006
INC.D @EM0
MPP
AND=.D @EM0 #60
SET R46508
MOV.D #0 @EM0
;[Task]
;AUTO開始時ﾛｯﾄ流動履歴
LDP R46100
SET R46509
;[Task]
;優先ｴﾗｰ発生情報
;通常ｴﾗｰはERROR_DISP、WAIT_***にて実施
;自動ﾘﾄﾗｲはSILENT_ERRORにて実施
;警報はWARNING_DISPにて実施
LDP R46104
MOV DM8100 DM5190
SET R46511
;<h1/>From D/C Reset Request/ﾃﾞｰﾀ収集からのﾘｾｯﾄ要求
;[Task]
;ﾃﾞｰﾀ収集からのﾘｾｯﾄ要求が来たら対応する収集ﾄﾘｶﾞとﾘｾｯﾄ要求をｸﾘｱする
;ﾃﾞｰﾀ収集ｱﾌﾟﾘ起動中
LD R51000
TMR @0 #1
CON
AND @T0
RES R51000
;生産ｶｳﾝﾀ
LD R51001
RES R46508
CON
RES R51001
;ｻｲｸﾙﾀｲﾑ
LD R51002
RES R46512
CON
RES R51002
;通常ｴﾗｰ
LD R51003
RES R46308
CON
RES R51003
LD R51004
RES R46308:#1
CON
RES R51004
LD R51005
RES R46308:#2
CON
RES R51005
LD R51006
RES R46308:#3
CON
RES R51006
LD R51007
RES R46308:#4
CON
RES R51007
LD R51008
RES R46308:#5
CON
RES R51008
LD R51009
RES R46308:#6
CON
RES R51009
LD R51010
RES R46308:#7
CON
RES R51010
;自動ﾘﾄﾗｲ
LD R51011
MOV #0 DM5161
RES R46400
CON
RES R51011
LD R51012
MOV #0 DM5163
RES R46400:#1
CON
RES R51012
LD R51013
MOV #0 DM5165
RES R46400:#2
CON
RES R51013
LD R51014
MOV #0 DM5167
RES R46400:#3
CON
RES R51014
LD R51015
MOV #0 DM5169
RES R46400:#4
CON
RES R51015
LD R51100
MOV #0 DM5171
RES R46400:#5
CON
RES R51100
LD R51101
MOV #0 DM5173
RES R46400:#6
CON
RES R51101
LD R51102
MOV #0 DM5175
RES R46400:#7
CON
RES R51102
;警告
LD R51103
RES R46408
CON
RES R51103
LD R51104
RES R46408:#1
CON
RES R51104
LD R51105
RES R46408:#2
CON
RES R51105
LD R51106
RES R46408:#3
CON
RES R51106
LD R51107
RES R46408:#4
CON
RES R51107
LD R51108
RES R46408:#5
CON
RES R51108
LD R51109
RES R46408:#6
CON
RES R51109
LD R51110
RES R46408:#7
CON
RES R51110
;優先ｴﾗｰ
LD R51111
RES R46511
CON
RES R51111
;生産開始ﾛｯﾄﾛｸﾞ
LD R51112
RES R46509
CON
RES R51112
;ﾌﾟﾛｸﾞﾗﾑ更新履歴
LD R51113
RES R46510
CON
RES R51113
;ﾕｰｻﾞｰﾃﾞｰﾀ
LD R51114
RES R46500
CON
RES R51114
LD R51115
RES R46500:#1
CON
RES R51115
LD R51200
RES R46500:#2
CON
RES R51200
LD R51201
RES R46500:#3
CON
RES R51201
LD R51202
RES R46500:#4
CON
RES R51202
LD R51203
RES R46500:#5
CON
RES R51203
LD R51204
RES R46500:#6
CON
RES R51204
LD R51205
RES R46500:#7
CON
RES R51205
;<h1/>Data Collection/ﾃﾞｰﾀ収集
;[Task]
;ﾋﾞｯﾄﾃﾞﾊﾞｲｽON/OFF状態変化監視→ﾃﾞｰﾀ収集ﾄﾘｶﾞ要求(まとめDMにBOUT)
;OneSystem運転中
LD R46000
BOUT DM5000 #0
;運転ﾓｰﾄﾞ変化
LD R46100
BOUT DM5000 #1
LD R46101
BOUT DM5000 #2
LD R46102
BOUT DM5000 #3
LD R46103
BOUT DM5000 #4
;ERROR状態
LD R46208
BOUT DM5000 #5
LD R46209
BOUT DM5000 #6
LD R46210
BOUT DM5000 #7
LD R46211
BOUT DM5000 #8
LD R46212
BOUT DM5000 #9
LD R46213
BOUT DM5000 #10
LD R46214
BOUT DM5000 #11
LD R46215
BOUT DM5000 #12
;PAUSE状態(安全ｶﾊﾞｰ開状態をPAUSEとする)
LD R46200
BOUT DM5000 #13
LD R46201
BOUT DM5000 #14
LD R46202
BOUT DM5000 #15
LD R46203
BOUT DM5001 #0
LD R46204
BOUT DM5001 #1
LD R46205
BOUT DM5001 #2
LD R46206
BOUT DM5001 #3
LD R46207
BOUT DM5001 #4
;ｴﾘｱｾﾝｻ状態
LD R46300
BOUT DM5001 #5
LD R46301
BOUT DM5001 #6
LD R46302
BOUT DM5001 #7
LD R46303
BOUT DM5001 #8
LD R46304
BOUT DM5001 #9
LD R46305
BOUT DM5001 #10
LD R46306
BOUT DM5001 #11
LD R46307
BOUT DM5001 #12
;元圧低下状態
LD R46008
BOUT DM5001 #13
LD R46009
BOUT DM5001 #14
LD R46010
BOUT DM5001 #15
LD R46011
BOUT DM5002 #0
LD R46012
BOUT DM5002 #1
LD R46013
BOUT DM5002 #2
LD R46014
BOUT DM5002 #3
LD R46015
BOUT DM5002 #4
;ESTOP状態
LD R46104
BOUT DM5002 #5
;生産ｶｳﾝﾀ収集
LD R46508
BOUT DM5002 #6
;ｻｲｸﾙﾀｲﾑ収集
LD R46512
BOUT DM5002 #7
;通常ｴﾗｰ解除
LD R46308
BOUT DM5002 #8
LD R46308:#1
BOUT DM5002 #9
LD R46308:#2
BOUT DM5002 #10
LD R46308:#3
BOUT DM5002 #11
LD R46308:#4
BOUT DM5002 #12
LD R46308:#5
BOUT DM5002 #13
LD R46308:#6
BOUT DM5002 #14
LD R46308:#7
BOUT DM5002 #15
;自動ﾘﾄﾗｲ発生
LD R46400
BOUT DM5003 #0
LD R46400:#1
BOUT DM5003 #1
LD R46400:#2
BOUT DM5003 #2
LD R46400:#3
BOUT DM5003 #3
LD R46400:#4
BOUT DM5003 #4
LD R46400:#5
BOUT DM5003 #5
LD R46400:#6
BOUT DM5003 #6
LD R46400:#7
BOUT DM5003 #7
;警告発生
LD R46408
BOUT DM5003 #8
LD R46408:#1
BOUT DM5003 #9
LD R46408:#2
BOUT DM5003 #10
LD R46408:#3
BOUT DM5003 #11
LD R46408:#4
BOUT DM5003 #12
LD R46408:#5
BOUT DM5003 #13
LD R46408:#6
BOUT DM5003 #14
LD R46408:#7
BOUT DM5003 #15
;優先ｴﾗｰ発生
LD R46511
BOUT DM5004 #0
;生産開始ﾛｯﾄﾛｸﾞ
LD R46509
BOUT DM5004 #1
;ﾌﾟﾛｸﾞﾗﾑ変更履歴
LD R46510
BOUT DM5004 #2
;ﾕｰｻﾞｰﾃﾞｰﾀ
LD R46500
BOUT DM5004 #3
LD R46500:#1
BOUT DM5004 #4
LD R46500:#2
BOUT DM5004 #5
LD R46500:#3
BOUT DM5004 #6
LD R46500:#4
BOUT DM5004 #7
LD R46500:#5
BOUT DM5004 #8
LD R46500:#6
BOUT DM5004 #9
LD R46500:#7
BOUT DM5004 #10
;秒換算積算値格納
;1秒経過でﾃﾞｰﾀ変化が無ければOneSystemPLC未起動かPLC電源断
LD CR2002
SEC CM700 DM5468
;ｴﾗｰ発生中電源遮断に備えてｴﾗｰｺｰﾄﾞ格納
;(通常ｴﾗｰとﾀｲﾑｱｯﾌﾟｴﾗｰのみ)
LD R53100
MOV DM8000 DM5460
LD R55000
MOV DM8080 DM5460
LD R53108
MOV DM8010 DM5461
LD R55001
MOV DM8082 DM5461
LD R53200
MOV DM8020 DM5462
LD R55002
MOV DM8084 DM5462
LD R53208
MOV DM8030 DM5463
LD R55003
MOV DM8086 DM5463
LD R53300
MOV DM8040 DM5464
LD R55004
MOV DM8088 DM5464
LD R53308
MOV DM8050 DM5465
LD R55005
MOV DM8090 DM5465
LD R53400
MOV DM8060 DM5466
LD R55006
MOV DM8092 DM5466
LD R53408
MOV DM8070 DM5467
LD R55007
MOV DM8094 DM5467
END
ENDH
