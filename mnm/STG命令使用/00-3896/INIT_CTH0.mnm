DEVICE:53
;MODULE:INIT_CTH0
;MODULE_TYPE:0
;------------------------------------------------------------------------------------------------------
;-- タイトル								: CPU高速カウンタ設定(CTH0)
;------------------------------------------------------------------------------------------------------
;-- 動作モード							: アップダウンカウント
;-- 入力方式								: 外部入力(位相差(1逓倍))
;-- 入力時定数							: 10μs
;-- カウント範囲							: 32ビット符号あり
;-- カウント方式							: リニアカウンタ
;-- 現在値(CTH0)の初期化					: しない
;------------------------------------------------------------------------------------------------------
;-- コンパレータ							: 使用しない
;------------------------------------------------------------------------------------------------------
;-- プリセット							: 使用しない
;------------------------------------------------------------------------------------------------------
;-- カウンタイネーブル					: 使用しない
;------------------------------------------------------------------------------------------------------
;-- 入力方式								: 外部入力(位相差(1逓倍))
LD CR2008
RES CR2113
CON
SET CR2114
CON
RES CR2115
;-- 入力時定数							: 10μs
LD CR2008
MOV #0 CM1620
SET CR2305
;-- カウント範囲							: 32ビット符号あり
LD CR2008
BSET CM1608 #7
;-- カウント方式							: リニアカウンタ
LD CR2008
RES CR2402
;-- 現在値(CTH0)の初期化					: しない
;-- コンパレータ							: 使用しない
;-- コンパレータ設定を初期化
LD CR2008
RES CR2103
CON
SET CR2104
CON
RES CR2105
CON
RES CR2106
CON
RES CR2107
LD CR2008
RES CR2112
CON
SET CR2108
CON
RES CR2109
CON
RES CR2110
CON
RES CR2111
;-- プリセット							: 使用しない
;-- プリセット設定を初期化
LD CR2008
RES CR2400
CON
RES CR2401
;-- カウンタイネーブル					: 使用しない
;-- カウンタイネーブル設定を初期化
LD CR2008
BRES CM1608 #0
CON
BRES CM1608 #1
CON
BRES CM1608 #2
LD CR2008
BRES CM1608 #4
CON
BRES CM1608 #5
;-- CPU高速カウンタの動作
;-- 入力方式								: 外部入力(位相差(1逓倍))
LD CR2002
CTH.L #0 R010
;送りﾊﾟﾙｽ量
;送り量：450,60mm
;ﾛｰﾗｰ径：Φ20
;ｴﾝｺｰﾀﾞ1回転：400pls
LD CR2002
MPS
LDA.F +20
CON
MUL.F +3.14
CON
DIV.F +400
CON
STA.F @DM0
MRD
LDA.F +446
CON
DIV.F @DM0
CON
INTG.L
CON
MUL.L -1
CON
STA.L FM100
MRD
LDA.F +57
CON
DIV.F @DM0
CON
INTG.L
CON
MUL.L -1
CON
STA.L FM150
MRD
LDA.F +508
CON
DIV.F @DM0
CON
INTG.L
CON
STA.L FM200
MRD
LDA.F +450
CON
DIV.F @DM0
CON
INTG.L
CON
STA.L FM250
MPP
LDA.F +1995
CON
DIV.F @DM0
CON
INTG.L
CON
MUL.L -1
CON
STA.L FM300
END
ENDH
