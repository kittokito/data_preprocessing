DEVICE:53
;MODULE:Group1_Task3
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task3
;ModuleType	:	Main Module
;Line		:	Sanjo組立ﾗｲﾝ
;Cell		:	固定板ｺﾏ転写装置
;Function	:	ｽｷｰｼﾞUT
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000〜@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100〜@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000〜@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000〜@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000〜@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000〜@MR4915		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500〜@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG〜JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104
ZRES @MR100 @MR6415
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM624.U,EM625.U,@MR000.U,@MR3000.U
;
;FOR EM624 = EM624 TO 160 STEP 16
;	IF @MR3000:EM624 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM624 < 160 THEN
;	EM625 = (EM624 / 16) * 100 + DMX(@MR3000:EM624) + #3000
;END IF		
;		
;EM624 = EM624 + 16		
;IF EM624 > 160 THEN		
;	EM624 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM624.U,EM625.U,@MR000.U,@MR3000.U
;
;FOR EM624 = EM624 TO 160 STEP 16
;
LD CR2002
MOV EM624 EM624
LABEL #2000
LD> EM624 #160
CJ #2001
;	IF @MR3000:EM624 <> 0 THEN
;
LD CR2002
LDA EM624
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0
NCJ #2002
;		BREAK
;
LD CR2002
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002
LDA EM624
CON
ADD #16
CON
STA EM624
LDB CR2009
CJ #2000
LABEL #2003
LABEL #2001
;IF EM624 < 160 THEN
;
LD< EM624 #160
NCJ #2004
;	EM625 = (EM624 / 16) * 100 + DMX(@MR3000:EM624) + #3000
;
LD CR2002
LDA EM624
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12
CON
DMX
CON
STA @VM0
CON
LDA EM624
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM625
;END IF		
;
LABEL #2004
;EM624 = EM624 + 16		
;
LD CR2002
LDA EM624
CON
EXT
CON
ADD.L +16
CON
STA EM624
;IF EM624 > 160 THEN		
;
LD> EM624 #160
NCJ #2005
;	EM624 = 0		
;
LD CR2002
MOV #0 EM624
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM626.U,EM627.U,@MR4000.U
;
;FOR EM626 = EM626 TO 80 STEP 16
;	IF @MR4000:EM626 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM626 < 80 THEN
;	EM627 = (EM626 / 16) * 100 + DMX(@MR4000:EM626) + #4000
;END IF
;
;EM626 = EM626 + 16		
;
;IF EM626 > 80 THEN
;	EM626 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM626.U,EM627.U,@MR4000.U
;
;FOR EM626 = EM626 TO 80 STEP 16
;
LD CR2002
MOV EM626 EM626
LABEL #2006
LD> EM626 #80
CJ #2007
;	IF @MR4000:EM626 <> 0 THEN
;
LD CR2002
LDA EM626
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0
NCJ #2008
;		BREAK
;
LD CR2002
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002
LDA EM626
CON
ADD #16
CON
STA EM626
LDB CR2009
CJ #2006
LABEL #2009
LABEL #2007
;IF EM626 < 80 THEN
;
LD< EM626 #80
NCJ #2010
;	EM627 = (EM626 / 16) * 100 + DMX(@MR4000:EM626) + #4000
;
LD CR2002
LDA EM626
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12
CON
DMX
CON
STA @VM3
CON
LDA EM626
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM627
;END IF
;
LABEL #2010
;EM626 = EM626 + 16		
;
LD CR2002
LDA EM626
CON
EXT
CON
ADD.L +16
CON
STA EM626
;IF EM626 > 80 THEN
;
LD> EM626 #80
NCJ #2011
;	EM626 = 0	
;
LD CR2002
MOV #0 EM626
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM628.U,EM629.U,@MR4500.U
;	
;FOR EM628 = EM628 TO 320 STEP 16
;	IF @MR4500:EM628 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM628 < 320 THEN
;	EM629 = (EM628 / 16) * 100 + DMX(@MR4500:EM628) + #4500
;END IF
;		
;EM628 = EM628 + 16	
;
;IF EM628 > 320 THEN
;   EM628 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM628.U,EM629.U,@MR4500.U
;
;FOR EM628 = EM628 TO 320 STEP 16
;
LD CR2002
MOV EM628 EM628
LABEL #2012
LD> EM628 #320
CJ #2013
;	IF @MR4500:EM628 <> 0 THEN
;
LD CR2002
LDA EM628
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0
NCJ #2014
;		BREAK
;
LD CR2002
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002
LDA EM628
CON
ADD #16
CON
STA EM628
LDB CR2009
CJ #2012
LABEL #2015
LABEL #2013
;IF EM628 < 320 THEN
;
LD< EM628 #320
NCJ #2016
;	EM629 = (EM628 / 16) * 100 + DMX(@MR4500:EM628) + #4500
;
LD CR2002
LDA EM628
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12
CON
DMX
CON
STA @VM6
CON
LDA EM628
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM629
;END IF
;
LABEL #2016
;EM628 = EM628 + 16	
;
LD CR2002
LDA EM628
CON
EXT
CON
ADD.L +16
CON
STA EM628
;IF EM628 > 320 THEN
;
LD> EM628 #320
NCJ #2017
;   EM628 = 0	
;
LD CR2002
MOV #0 EM628
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR803
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR403
MPS
AND R46101
JMP LR5203
MRD
AND R46100
JMP LR5403
MPP
AND R46102
JMP LR5603
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR603
RES R41003
CON
ENDS
;<h1/>HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5203
JMP @MR1000
STG @MR1000
SET MR9000
CON
RES MR103
CON
SET @MR1002
CON
JMP @MR1100
STG @MR1100
ANB MR8415
MPS
ANB R44200
RES MR7204
CON
MPS
LDB MR4004
AND R4004
ANL
JMP @MR1101
MPP
LD MR4004
AND R44200
ANL
@SET @MR1900
MPP
AND R44200
@SET @MR1900
STG @MR1101
JMP @MR1102
STG @MR1102
ANB MR8415
MPS
ANB R44200
RES MR7202
CON
MPS
LDB MR4002
AND R4002
ANL
JMP @MR1103
MPP
LD MR4002
AND R44200
ANL
@SET @MR1900
MPP
AND R44200
@SET @MR1900
STG @MR1103
JMP @MR1104
STG @MR1104
ANB MR8415
MPS
ANB R44200
RES MR7204
CON
MPS
LDB MR4004
AND R4004
ANL
JMP @MR1105
MPP
LD MR4004
AND R44200
ANL
@SET @MR1900
MPP
AND R44200
@SET @MR1900
STG @MR1105
SET DM10731.4
JMP @MR1106
;ｽｸﾚｰﾊﾟRB4原点復帰
STG @MR1106
AND MR3003
ANB R35308
ANB R35309
ANB R35310
AND R4002
AND R4004
JMP @MR1107
STG @MR1107
SET R35308
CON
JMP @MR1108
STG @MR1108
ANB R35310
AND R35309
RES R35308
CON
RES R35309
CON
JMP @MR1109
STG @MR1109
MPS
ANB R35303
JMP @MR1110
MPP
AND R35303
JMP @MR4200
STG @MR4200
@SET @MR1900
CON
ANB R39004
SET R39004
CON
DW #1000 @DM9
CON
DW #40 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4201
STG @MR4201
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4202
STG @MR4202
RES R35303
CON
AND @MR105
JMP @MR1106
STG @MR1110
ANB MR8415
MPS
ANB R44200
JMP @MR1111
MPP
AND R44200
@SET @MR1900
STG @MR1111
AND MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
AND R4002
AND R4004
JMP @MR1112
STG @MR1112
DW #1 EM1306
CON
SET R35300
CON
AND R35302
JMP @MR1113
STG @MR1113
ANB R35302
AND R35301
RES R35300
CON
RES R35301
CON
JMP @MR1114
STG @MR1114
MPS
ANB R35303
MPS
AND MR16301
JMP @MR1115
MPP
ANB MR16301
TMR @5 #3
CON
AND @T5
JMP @MR1111
MPP
AND R35303
JMP @MR4203
STG @MR4203
@SET @MR1900
CON
ANB R39004
SET R39004
CON
DW #1000 @DM9
CON
DW #40 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4204
STG @MR4204
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4205
STG @MR4205
RES R35303
CON
AND @MR105
AND T50
JMP @MR1111
STG @MR1115
JMP @MR1200
STG @MR1200
ANB MR8415
MPS
ANB R44200
RES MR7211
CON
SET MR7212
CON
JMP @MR1201
MPP
AND R44200
@SET @MR1900
STG @MR1201
MPS
LDB MR4006
AND R4006
ANL
JMP @MR1202
MPP
LD MR4006
AND R44200
ANL
@SET @MR1900
STG @MR1202
JMP @MR1515
;Task3原点復帰終了処理
STG @MR1514
MPS
ANB R44200
RES @MR1002
CON
SET MR15003
CON
AND MR15000
JMP LR603
MPP
AND R44200
@SET @MR1900
STG @MR1515
MPS
ANB R44200
SET MR103
CON
RES @MR1002
CON
SET MR15003
CON
AND MR15000
JMP LR603
MPP
AND R44200
@SET @MR1900
;<h1/>AUTO/自動動作
STG LR5403
JMP @MR3000
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1〜32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000
SET @MR3002
CON
JMP @MR3003
STG @MR3003
MPS
ANB LR101
JMP @MR3100
MPP
AND LR101
JMP @MR3900
;<h1/>スキーｼﾞ　AUTO　Loop先頭
STG @MR3100
MPS
ANB R44200
MPS
LDB MR8005
AND MR8300
AND R1007
ANL
JMP @MR3200
MPP
AND MR8005
JMP @MR3900
MPP
AND R44200
@SET @MR1900
STG @MR3200
SET MR9000
CON
RES MR8401
CON
SET MR8402
CON
JMP @MR3201
STG @MR3201
MPS
@MOV #0 DM3540
MPP
AND= DM3540 #0
JMP @MR3202
STG @MR3202
JMP @MR3203
STG @MR3203
RES MR7212
CON
RES MR7214
CON
SET MR7211
CON
SET MR7213
CON
MPS
LDB MR4005
ANB MR4007
AND R4005
AND R4007
ANL
JMP @MR3204
MPP
LD MR4005
OR MR4007
AND R44200
ANL
@SET @MR1900
STG @MR3204
ANB MR8415
MPS
ANB R44200
JMP @MR3205
MPP
AND R44200
@SET @MR1900
STG @MR3205
SET MR7204
CON
MPS
LDB MR4003
AND R4003
ANL
JMP @MR3206
MPP
LD MR4003
AND R44200
ANL
@SET @MR1900
STG @MR3206
ANB MR8415
MPS
LDB R44200
AND R4002
ANL
JMP @MR3207
MPP
LD MR4002
AND R44200
ANL
@SET @MR1900
STG @MR3207
AND MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
JMP @MR3208
STG @MR3208
DW #2 EM1306
CON
SET R35300
CON
JMP @MR3209
STG @MR3209
ANB R35302
AND R35301
RES R35300
CON
RES R35301
CON
JMP @MR3210
STG @MR3210
MPS
ANB R35303
MPS
AND MR16302
JMP @MR3211
MPP
ANB MR16302
TMR @6 #3
CON
AND @T6
JMP @MR3207
MPP
AND R35303
JMP @MR4300
STG @MR4300
@SET @MR1900
CON
ANB R39004
SET R39004
CON
DW #1000 @DM9
CON
DW #40 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4301
STG @MR4301
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4302
STG @MR4302
RES R35303
CON
AND @MR105
JMP @MR3207
STG @MR3211
JMP @MR3212
STG @MR3212
ANB MR8415
MPS
ANB R44200
JMP @MR3213
MPP
AND R44200
@SET @MR1900
STG @MR3213
SET MR7202
CON
MPS
LDB MR4001
AND R4001
ANL
JMP @MR3214
MPP
LD MR4001
AND R44200
ANL
@SET @MR1900
STG @MR3214
TMR @10 #5
CON
AND @T10
JMP @MR3215
STG @MR3215
ANB MR8415
MPS
ANB R44200
JMP @MR3300
MPP
AND R44200
@SET @MR1900
STG @MR3300
JMP @MR3301
STG @MR3301
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
JMP @MR3302
STG @MR3302
DW #3 EM1306
CON
SET R35300
CON
JMP @MR3303
STG @MR3303
ANB R35302
AND R35301
RES R35300
CON
RES R35301
CON
JMP @MR3304
STG @MR3304
MPS
ANB R35303
MPS
AND MR16303
JMP @MR3305
MPP
ANB MR16303
TMR @7 #3
CON
AND @T7
JMP @MR3301
MPP
AND R35303
JMP @MR4303
STG @MR4303
@SET @MR1900
CON
ANB R39004
SET R39004
CON
DW #1000 @DM9
CON
DW #40 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4304
STG @MR4304
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4305
STG @MR4305
RES R35303
CON
AND @MR105
JMP @MR3301
STG @MR3305
ANB MR8415
MPS
ANB R44200
RES MR7202
CON
MPS
LDB MR4002
AND R4002
ANL
JMP @MR3306
MPP
LD MR4002
AND R44200
ANL
@SET @MR1900
MPP
AND R44200
@SET @MR1900
STG @MR3306
JMP @MR3307
STG @MR3307
@INC DM3540
JMP @MR3308
STG @MR3308
MPS
AND< DM3540 DM7000
JMP @MR3206
MPP
AND>= DM3540 DM7000
JMP @MR3309
STG @MR3309
ANB MR8415
MPS
ANB R44200
JMP @MR3310
MPP
AND R44200
@SET @MR1900
STG @MR3310
RES MR7204
CON
MPS
LDB MR4004
AND R4002
AND R4004
ANL
JMP @MR3311
MPP
LD MR4004
AND R44200
ANL
@SET @MR1900
STG @MR3311
ANB MR8415
MPS
ANB R44200
JMP @MR3312
MPP
AND R44200
@SET @MR1900
STG @MR3312
AND MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
JMP @MR3313
STG @MR3313
DW #1 EM1306
CON
SET R35300
CON
JMP @MR3314
STG @MR3314
ANB R35302
AND R35301
RES R35300
CON
RES R35301
CON
JMP @MR3315
STG @MR3315
MPS
ANB R35303
MPS
AND MR16301
JMP @MR3400
MPP
ANB MR16301
TMR @8 #3
CON
AND @T8
JMP @MR3312
MPP
AND R35303
JMP @MR4306
STG @MR4306
@SET @MR1900
CON
ANB R39004
SET R39004
CON
DW #1000 @DM9
CON
DW #40 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4307
STG @MR4307
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4308
STG @MR4308
RES R35303
CON
AND @MR105
JMP @MR3312
STG @MR3400
ANB MR8415
MPS
ANB R44200
JMP @MR3401
MPP
AND R44200
@SET @MR1900
STG @MR3401
RES MR7211
CON
RES MR7213
CON
SET MR7212
CON
SET MR7214
CON
MPS
LDB MR4006
ANB MR4008
AND R4006
AND R4008
ANL
JMP @MR3402
MPP
LD MR4006
OR MR4008
AND R44200
ANL
@SET @MR1900
STG @MR3402
MPS
AND R46100
RES MR8402
CON
SET MR8401
CON
ANB MR8300
RES MR8401
CON
JMP @MR3100
MPP
AND R46102
RES MR8402
CON
SET MR8401
CON
JMP @MR3403
STG @MR3403
ENDS
;Auto終了処理
STG @MR3900
RES @MR4001
CON
JMP @MR3915
STG @MR3915
MPS
ANB R44200
RES @MR3002
CON
SET MR15003
CON
AND MR15000
JMP LR603
MPP
AND R44200
@SET @MR1900
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000
SET @MR4002
CON
JMP @MR4003
STG @MR4003
JMP @MR4415
STG @MR4415
SET @MR4001
CON
RES @MR4002
CON
ENDS
;<h1/>MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1〜32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5603
JMP @MR2000
STG @MR2000
SET @MR2002
CON
JMP @MR2003
STG @MR2003
MPS
LD R44200
ANB MR21114
ANL
@SET @MR1900
MPP
ANB R44200
MPS
LD= DM4110 #1
AND CR2003
ANL
JMP @MR2100
MRD
AND= DM4110 #29
@DW #2000 DM3008
CON
AND MR23400
JMP @MR2910
MRD
AND= DM4110 #30
@DW #2150 DM3008
CON
LDP R44915
ORP MR23401
ANL
JMP @MR2910
MPP
AND R47800
JMP @MR2910
;Maintenance　終了
STG @MR2910
MCALL HOLD_REQUEST #1
JMP @MR2915
STG @MR2915
MPS
ANB R44200
SET MR15003
CON
AND MR15000
JMP LR603
MPP
AND R44200
@SET @MR1900
;<h1/> MainTP 表示中ﾍﾟｰｼﾞNo2002
;ｼﾘﾝﾀﾞｰ動作
LD @MR2002
AND= DM3000 #2002
AND T50
MC
LDP MR20100
SET MR7202
LDP MR20101
RES MR7202
LDP MR20102
SET MR7204
LDP MR20103
RES MR7204
LDP MR20108
RES MR7212
CON
SET MR7211
LDP MR20109
RES MR7211
CON
SET MR7212
LDP MR20110
RES MR7214
CON
SET MR7213
LDP MR20111
RES MR7213
CON
SET MR7214
LDP MR20112
RES MR7300
CON
SET MR7215
LDP MR20113
RES MR7215
CON
SET MR7300
;ｽｸﾚｰﾊﾟRB4原点復帰
LD MR3003
ANB R35308
ANB R35309
ANB R35310
AND R4002
ANP MR20104
SET MR9000
CON
SET @MR2200
STG @MR2200
SET R35308
CON
AND R35310
JMP @MR2201
STG @MR2201
ANB R35310
AND R35309
RES MR9000
CON
RES R35308
CON
RES R35309
CON
ENDS
LDB @MR2200
ANB @MR2201
INV
OUT MR21104
;ｽｸﾚｰﾊﾟRB3待機位置移動
LD MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
ANP MR20105
SET MR9000
CON
SET @MR2203
STG @MR2203
DW #1 EM1306
CON
SET R35300
CON
AND R35302
JMP @MR2204
STG @MR2204
ANB R35302
AND R35301
RES MR9000
CON
RES R35300
CON
RES R35301
CON
ENDS
LDB @MR2203
ANB @MR2204
INV
OUT MR21105
;ｽｸﾚｰﾊﾟRB3開始位置移動
LD MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
ANP MR20106
SET MR9000
CON
SET @MR2206
STG @MR2206
DW #2 EM1306
CON
SET R35300
CON
AND R35302
JMP @MR2207
STG @MR2207
ANB R35302
AND R35301
RES MR9000
CON
RES R35300
CON
RES R35301
CON
ENDS
LDB @MR2206
ANB @MR2207
INV
OUT MR21106
;ｽｸﾚｰﾊﾟRB3終了位置移動
LD MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
ANP MR20107
SET MR9000
CON
SET @MR2210
STG @MR2210
DW #3 EM1306
CON
SET R35300
CON
AND R35302
JMP @MR2211
STG @MR2211
ANB R35302
AND R35301
RES MR9000
CON
RES R35300
CON
RES R35301
CON
ENDS
LDB @MR2210
ANB @MR2211
INV
OUT MR21107
;ｽｸﾚｰﾊﾟRB4　1ｻｲｸﾙ
LDP MR20114
ANB MR8402
AND MR3003
AND DM10531.1
ANB R35300
ANB R35301
ANB R35302
SET MR9000
CON
SET @MR2300
STG @MR2300
@SET @MR3200
CON
AND MR8402
ANB MR8401
JMP @MR2301
STG @MR2301
ANB MR8402
AND MR8401
RES MR9000
CON
RES MR8401
CON
ENDS
MCR
LD MR8402
OUT MR21114
LD MR9000
OUT MR1111
;ｽｷｰｼﾞ　ｴﾘｱｾﾝｻｰ異常処理
LD MR9000
ANB R1007
ANB R39004
ANB R44200
@SET @MR4400
STG @MR4400
@SET @MR1900
CON
ANB R39004
SET R39004
CON
SET MR8414
CON
DW #1000 @DM9
CON
DW #41 @DM1
CON
DW #0 @DM2
CON
SET @MR100
CON
JMP @MR4401
STG @MR4401
AND @MR101
RES @MR101
CON
RES @MR1900
CON
RES R39004
CON
JMP @MR4402
STG @MR4402
AND @MR105
AND T50
RES MR8414
CON
ENDS
;<h1/>ERROR
;//*Error Sample
;[使用方法]
;・@DM1にERROR番号を代入
;・@DM2にSensor番号を代入(センサ無しエラーの場合は0)
;・@DM9に復帰SW番号(1〜9、0はSW無し)をdegit単位で4桁入力
;・Task0 ERROR SET(@MR100)でエラー処理開始
;・エラー復帰でTask0 ERROR END(@MR101)がON
;・押下復帰SW番号により左から対応した@MR105,@MR106,@MR107,@MR108のいずれかがON
;・上記ONが成立したらJMPするSTGに対応する処理を記述
;Error0を左側から1,2,3,4の番号に対応した復帰選択SWを出力する
;Error Sample *//
;MyTask Error Process Substance/エラー処理実体
STG @MR100
ANB R39002
MPS
ZRES @MR105 @MR108
CON
LDA @DM9
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #3 @DM0
CON
BMOV @DM0 DM60000 #7
MPP
SET R39000
CON
SET @MR102
CON
JMP @MR103
STG @MR103
AND R39002
AND= DM60008 @DM1
MPS
AND= DM60007 @DM6
SET @MR105
CON
JMP @MR104
MRD
AND= DM60007 @DM5
SET @MR106
CON
JMP @MR104
MRD
AND= DM60007 @DM4
SET @MR107
CON
JMP @MR104
MPP
AND= DM60007 @DM3
SET @MR108
CON
JMP @MR104
STG @MR104
ANB R39002
RES @MR102
CON
SET @MR101
CON
ENDS
;<h1/>SELECT_ACT
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200
ANB R39202
MPS
ZRES @MR205 @MR208
CON
DW #3 @DM30
CON
BMOV @DM30 DM60030 #7
MPP
SET R39200
CON
SET @MR202
CON
JMP @MR203
STG @MR203
AND R39202
AND<> DM60037 #0
MPS
AND= DM60037 #1
SET @MR205
CON
JMP @MR204
MRD
AND= DM60037 #2
SET @MR206
CON
JMP @MR204
MRD
AND= DM60037 #3
SET @MR207
CON
JMP @MR204
MPP
AND= DM60037 #4
SET @MR208
CON
JMP @MR204
STG @MR204
ANB R39202
RES @MR202
CON
SET @MR201
CON
ENDS
;<h1/>SELECT_Y_N
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300
ANB R39102
MPS
ZRES @MR306 @MR307
CON
DW #3 @DM20
CON
BMOV @DM20 DM60020 #3
MPP
SET R39100
CON
SET @MR302
CON
JMP @MR303
STG @MR303
AND R39102
MPS
AND= DM60023 #1
SET @MR306
CON
JMP @MR304
MPP
AND= DM60023 #2
RES @MR306
CON
JMP @MR304
STG @MR304
ANB R39102
RES @MR302
CON
SET @MR301
CON
ENDS
;<h1/>TIMEUP_ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400
ANB R39302
MPS
DW #3 @DM40
CON
BMOV @DM40 DM60040 #2
MPP
SET R39300
CON
SET @MR402
CON
JMP @MR403
STG @MR403
AND R39302
JMP @MR404
STG @MR404
ANB R39302
RES @MR402
CON
SET @MR401
CON
ENDS
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/>HALT
LD R44200
AND @MR1900
LD @MR1901
ORB @MR4002
ANL
TMR @2 #2
CON
AND @T2
@SET R42603
LD R42603
RES @MR1900
CON
RES @MR1901
END
ENDH
