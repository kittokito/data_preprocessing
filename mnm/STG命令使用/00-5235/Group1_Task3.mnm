DEVICE:53
;MODULE:Group1_Task3
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task3
;ModuleType	:	Main Module
;Line		:	
;Cell		:	
;Function	:	フレーム搬送/溶着
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000～@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100～@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000～@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000～@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000～@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000～@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500～@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ　※状況により増設してください。
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG～JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @MR100 @MR6415      ; Task3 ERROR
LD= DM60000 MyTask       ; TaskNo /ERROR_DISP  自ﾀｽｸ番号
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK3　ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM624.U,EM625.U,@MR000.U,@MR3000.U
;
;FOR EM624 = EM624 TO 160 STEP 16
;	IF @MR3000:EM624 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM624 < 160 THEN
;	EM625 = (EM624 / 16) * 100 + DMX(@MR3000:EM624) + #3000
;END IF		
;		
;EM624 = EM624 + 16		
;IF EM624 > 160 THEN		
;	EM624 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM624.U,EM625.U,@MR000.U,@MR3000.U
;
;FOR EM624 = EM624 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM624 EM624          ; Task3 Main1@MR  Task3 Main1@MR
LABEL #2000
LD> EM624 #160           ; Task3 Main1@MR
CJ #2001
;	IF @MR3000:EM624 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM624                ; Task3 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0      ; AUTO Main1
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM624                ; Task3 Main1@MR
CON
ADD #16
CON
STA EM624                ; Task3 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM624 < 160 THEN
;
LD< EM624 #160           ; Task3 Main1@MR
NCJ #2004
;	EM625 = (EM624 / 16) * 100 + DMX(@MR3000:EM624) + #3000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM624                ; Task3 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12          ; AUTO Main1
CON
DMX
CON
STA @VM0
CON
LDA EM624                ; Task3 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM625                ; Task3 Main1@MR
;END IF		
;
LABEL #2004
;EM624 = EM624 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM624                ; Task3 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM624                ; Task3 Main1@MR
;IF EM624 > 160 THEN		
;
LD> EM624 #160           ; Task3 Main1@MR
NCJ #2005
;	EM624 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM624             ; Task3 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM626.U,EM627.U,@MR4000.U
;
;FOR EM626 = EM626 TO 80 STEP 16
;	IF @MR4000:EM626 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM626 < 80 THEN
;	EM627 = (EM626 / 16) * 100 + DMX(@MR4000:EM626) + #4000
;END IF
;
;EM626 = EM626 + 16		
;
;IF EM626 > 80 THEN
;	EM626 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM626.U,EM627.U,@MR4000.U
;
;FOR EM626 = EM626 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM626 EM626          ; Task3 Main2@MR  Task3 Main2@MR
LABEL #2006
LD> EM626 #80            ; Task3 Main2@MR
CJ #2007
;	IF @MR4000:EM626 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM626                ; Task3 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0      ; AUTO Main2
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM626                ; Task3 Main2@MR
CON
ADD #16
CON
STA EM626                ; Task3 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM626 < 80 THEN
;
LD< EM626 #80            ; Task3 Main2@MR
NCJ #2010
;	EM627 = (EM626 / 16) * 100 + DMX(@MR4000:EM626) + #4000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM626                ; Task3 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12          ; AUTO Main2
CON
DMX
CON
STA @VM3
CON
LDA EM626                ; Task3 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM627                ; Task3 Main2@MR
;END IF
;
LABEL #2010
;EM626 = EM626 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM626                ; Task3 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM626                ; Task3 Main2@MR
;IF EM626 > 80 THEN
;
LD> EM626 #80            ; Task3 Main2@MR
NCJ #2011
;	EM626 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM626             ; Task3 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM628.U,EM629.U,@MR4500.U
;	
;FOR EM628 = EM628 TO 320 STEP 16
;	IF @MR4500:EM628 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM628 < 320 THEN
;	EM629 = (EM628 / 16) * 100 + DMX(@MR4500:EM628) + #4500
;END IF
;		
;EM628 = EM628 + 16	
;
;IF EM628 > 320 THEN
;   EM628 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM628.U,EM629.U,@MR4500.U
;
;FOR EM628 = EM628 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM628 EM628          ; Task3 Sub@MR  Task3 Sub@MR
LABEL #2012
LD> EM628 #320           ; Task3 Sub@MR
CJ #2013
;	IF @MR4500:EM628 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM628                ; Task3 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; ①SUB_RB5/Move
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM628                ; Task3 Sub@MR
CON
ADD #16
CON
STA EM628                ; Task3 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM628 < 320 THEN
;
LD< EM628 #320           ; Task3 Sub@MR
NCJ #2016
;	EM629 = (EM628 / 16) * 100 + DMX(@MR4500:EM628) + #4500
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM628                ; Task3 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; ①SUB_RB5/Move
CON
DMX
CON
STA @VM6
CON
LDA EM628                ; Task3 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM629                ; Task3 Sub@MR
;END IF
;
LABEL #2016
;EM628 = EM628 + 16	
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM628                ; Task3 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM628                ; Task3 Sub@MR
;IF EM628 > 320 THEN
;
LD> EM628 #320           ; Task3 Sub@MR
NCJ #2017
;   EM628 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM628             ; Task3 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR803                ; _Grp1_Task3_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR403                ; _Grp1_Task3_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5203               ; _Grp1_Task3_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5403               ; _Grp1_Task3_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5603               ; _Grp1_Task3_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR603                ; _Grp1_Task3_Fin.STG
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB @MR001               ; TASK3　ERROR
ANL
RES R42603               ; Grp1_Task3_ﾎﾟｰｽﾞ許可
CON
RES R41003               ; _Grp1_Task3_起動中ﾌﾗｸﾞ
CON
ENDS
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5203               ; _Grp1_Task3_HOME.STG
JMP @MR1000              ; HOME
STG @MR1000              ; HOME
RES MR20003              ; TASK3復帰完了
CON
SET @MR1002              ; Home中
CON
JMP @MR1003
;自重ｷｬﾝｾﾙON
STG @MR1003
SET MR7303               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON)
CON
RES MR7302               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙOFF
CON
TMR @11 #5               ; wait
CON
AND @T11                 ; wait
JMP @MR1004
;RB5ﾌﾚｰﾑ溶着原点復帰
STG @MR1004
SET @MR4600              ; ②SUB_RB5/Home
CON
JMP @MR1005
STG @MR1005
AND @MR4601              ; ②SUB_RB5/Home完了
RES @MR4601              ; ②SUB_RB5/Home完了
CON
JMP @MR1006
;RB5ﾌﾚｰﾑ溶着 移動 待機位置
STG @MR1006
DW #1 EM1308             ; RB5Target Pos
CON
SET @MR4500              ; ①SUB_RB5/Move
CON
JMP @MR1007
STG @MR1007
AND @MR4501              ; ①SUB_RB5/Move完了
RES @MR4501              ; ①SUB_RB5/Move完了
CON
JMP @MR1008
;板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇
STG @MR1008
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
MPS
LDB MR4211               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
ANB R4210                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
AND R4211                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANL
JMP @MR1009
MPP
LD MR4211                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾋｰﾀｰON
STG @MR1009
SET MR2004               ; ﾋｰﾀｰ1ON
CON
JMP @MR1010
;RB12ﾌﾚｰﾑ反転上下原点復帰
STG @MR1010
SET @MR5100              ; ⑦SUB_RB12Home
CON
JMP @MR1011
STG @MR1011
AND @MR5101              ; ⑦SUB_RB12Home完了
RES @MR5101              ; ⑦SUB_RB12Home完了
CON
JMP @MR1012
;RB12ﾌﾚｰﾑ反転上下 移動 回転位置
STG @MR1012
DW #3 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR1013
STG @MR1013
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR1014
;ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面
STG @MR1014
SET MR7402               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面
CON
RES MR7403               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面
CON
MPS
LDB MR4302               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側ERR
AND R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
ANB R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
JMP @MR1015
MPP
LD MR4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12ﾌﾚｰﾑ反転上下 移動 待機位置
STG @MR1015
DW #1 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR1100
STG @MR1100
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR1101
;TASK2へ復帰許可
STG @MR1101
SET MR20201              ; TASK3→2復帰許可
CON
JMP @MR1102
;RB1ﾌｨﾙﾑ搬送復帰待ち
;RB8ばね搬送復帰待ち
;RB5ﾌｨﾙﾑ剥ぎ取り復帰待ち
STG @MR1102
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20001              ; TASK1復帰完了
AND MR20004              ; TASK4復帰完了
AND MR20006              ; TASK6復帰完了
ANL
RES MR20201              ; TASK3→2復帰許可
CON
JMP @MR1103
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB11ﾌﾚｰﾑ搬送原点復帰
STG @MR1103
SET @MR4900              ; ⑤SUB_RB11/Home
CON
JMP @MR1104
STG @MR1104
AND @MR4901              ; ⑤SUB_RB11/Home完了
RES @MR4901              ; ⑤SUB_RB11/Home完了
CON
JMP @MR1105
;RB11ﾌﾚｰﾑ搬送 移動 待機位置
STG @MR1105
DW #1 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR1106
STG @MR1106
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR1107
;ﾌﾚｰﾑ押さえ上昇
STG @MR1107
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANL
JMP @MR1108
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR1108
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANL
JMP @MR1109
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ有無確認
STG @MR1109
MPS
ANB R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
JMP @MR1112
MPP
AND R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
TMR @12 #5               ; wait
CON
AND @T12                 ; wait
JMP @MR1110
;Error 131 ﾌﾚｰﾑ除材要求(RB11)
STG @MR1110
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #131 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4511 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR1111
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1111
SET MR20106              ; ﾌﾚｰﾑ除材要求
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES MR20106              ; ﾌﾚｰﾑ除材要求
CON
JMP @MR1109
;ﾌﾚｰﾑ浮き確認
STG @MR1112
SET @MR5200              ; ⑧SUB_ﾌﾚｰﾑ浮き確認
CON
JMP @MR1113
STG @MR1113
AND @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
RES @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
CON
JMP @MR1200
;反転ﾁｬｯｸ確認
STG @MR1200
MPS
LDB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR1400
MRD
LD R4304                 ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
ANB R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR1300
MPP
LD R4304                 ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
LDB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
ANB R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ORL
ANL
JMP @MR1201
;Error 132 反転チャック開閉位置異常
STG @MR1201
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #132 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4304 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR1202
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1202
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR1200
;反転チャック閉時
;→フレームを持っている可能性有り
;RB11フレーム搬送 移動 反転位置
STG @MR1300
DW #5 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR1301
STG @MR1301
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR1302
;反転位置決めﾘﾘｰｽ
STG @MR1302
SET MR7406               ; 反転位置決めﾘﾘｰｽ
CON
RES MR7407               ; 反転位置決め
CON
JMP @MR1303
;RB12フレーム反転上下 移動 フレーム受渡し位置
STG @MR1303
DW #2 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR1304
STG @MR1304
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR1305
;反転ﾁｬｯｸ開
STG @MR1305
SET MR7405               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
CON
RES MR7404               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
CON
MPS
LDB MR4305               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
ANB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR1306
MPP
LD MR4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12フレーム反転上下 移動 待機位置
STG @MR1306
DW #2 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR1307
STG @MR1307
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR1308
;RB11フレーム搬送 移動 待機位置から
;※反転チャックのフレーム除材終了
STG @MR1308
JMP @MR1105
;反転ﾁｬｯｸ開
STG @MR1400
SET MR7405               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
CON
RES MR7404               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
CON
MPS
LDB MR4305               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
ANB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR1401
MPP
LD MR4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR1401
JMP @MR1515              ; HOME END
;終了
STG @MR1515              ; HOME END
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB @MR001               ; TASK3　ERROR
ANL
SET MR20003              ; TASK3復帰完了
CON
RES @MR1002              ; Home中
CON
JMP LR603                ; _Grp1_Task3_Fin.STG
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>AUTO/自動動作
STG LR5403               ; _Grp1_Task3_AUTO.STG
RES MR20603              ; Task3 ｽﾀｰﾄﾌﾗｸﾞ
CON
RES MR20611              ; ﾌﾚｰﾑ 反転ﾌﾗｸﾞ
CON
JMP @MR3000              ; AUTO Main1
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1～32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000              ; AUTO Main1
MPS
ANB R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
MPS
ANB R57303               ; Task3 停止要求
RES R46001               ; _装置C/T取得
CON
SET @MR3002              ; AUTO Main1 Busy
CON
JMP @MR3003
MPP
AND R57303               ; Task3 停止要求
JMP @MR3915              ; AUTO END
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR3915              ; AUTO END
;ﾌﾚｰﾑ押さえ上昇
STG @MR3003
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANL
JMP @MR3004
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR3004
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANL
JMP @MR3005
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;<h1/> ﾌﾚｰﾑ投入待ち
LDB MR20105              ; ﾌﾚｰﾑ投入要求
ANB MR20106              ; ﾌﾚｰﾑ除材要求
ANB @MR903               ; ﾌﾚｰﾑ状態異常中
INV
OUT MR20100              ; ﾌﾚｰﾑ給除材中
LD @MR3005
TMR @20 #2               ; wait
STG @MR3005
OUT MR20105              ; ﾌﾚｰﾑ投入要求
MPS
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
OUT MR2000               ; ﾌﾚｰﾑｽﾀｰﾄSWﾗﾝﾌﾟ
MRD
ANB R41203               ; TASK3 PAUSE 要求
MPS
AND R57303               ; Task3 停止要求
JMP @MR3915              ; AUTO END
MPP
LDB R57303               ; Task3 停止要求
LD R4511                 ; ﾌﾚｰﾑ有無検出(ON有り)
ANP R1000                ; ﾌﾚｰﾑｽﾀｰﾄSW
LD DM2000.3              ; ﾄﾞﾗｲ運転有効/無効(ON有効)
AND @T20                 ; wait
ANB LR10004              ; デバッグ用ばねCHECK
ORL
ANL
ANL
SET R47000               ; _処理時間1計測開始
CON
@INC.L DM5020            ; _生産ｶｳﾝﾀ1
CON
JMP @MR3006
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ浮き確認
STG @MR3006
SET @MR5200              ; ⑧SUB_ﾌﾚｰﾑ浮き確認
CON
JMP @MR3007
STG @MR3007
AND @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
RES @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
CON
JMP @MR3008
;ﾌﾚｰﾑ状態確認
STG @MR3008
MPS
LD R4511                 ; ﾌﾚｰﾑ有無検出(ON有り)
LD DM2000.3              ; ﾄﾞﾗｲ運転有効/無効(ON有効)
ANB LR10004              ; デバッグ用ばねCHECK
ORL
ANL
JMP @MR3009
MPP
LDB R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
LDB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
OR LR10004               ; デバッグ用ばねCHECK
ANL
ANL
JMP @MR3005
;ﾌﾚｰﾑ押さえ前進
STG @MR3009
SET MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
RES MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
MPS
LDB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
AND R4112                ; ﾌﾚｰﾑ押さえ左 前進端
ANB R4113                ; ﾌﾚｰﾑ押さえ左 後退端
AND R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANB R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR3010
MPP
LD MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ下降
STG @MR3010
SET MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
RES MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
MPS
LDB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R4108                ; ﾌﾚｰﾑ押さえ左 下降端
ANB R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
AND R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANB R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANL
JMP @MR3011
MPP
LD MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;浮き確認
STG @MR3011
MPS
LD R4512                 ; ﾌﾚｰﾑ浮き検出1(ONOK)
AND R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
JMP @MR3100
MPP
LDB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
ORB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
TMR @13 #10              ; wait
CON
AND @T13                 ; wait
JMP @MR3012
;ﾌﾚｰﾑ押さえ上昇
STG @MR3012
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANL
JMP @MR3013
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR3013
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANL
JMP @MR3014
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;Error 130 フレーム浮き検出
LD @MR3014
ANB R39004               ; ｴﾗｰ中
MPS
ANB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
DW #4512 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
DW #4513 @DM2            ; SensorNo /ERROR_DISP
STG @MR3014
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #130 @DM1             ; ErrorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3015
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3015
SET @MR903               ; ﾌﾚｰﾑ状態異常中
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR903               ; ﾌﾚｰﾑ状態異常中
CON
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3006
;ｽﾀｰﾄﾌﾗｸﾞON
STG @MR3100
SET MR20600              ; Task0 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20601              ; Task1 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20602              ; Task2 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20603              ; Task3 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20604              ; Task4 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20605              ; Task5 ｽﾀｰﾄﾌﾗｸﾞ
CON
SET MR20606              ; Task6 ｽﾀｰﾄﾌﾗｸﾞ
CON
JMP @MR3101
STG @MR3101
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20603              ; Task3 ｽﾀｰﾄﾌﾗｸﾞ
ANL
JMP @MR3102
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> ばね給材位置へ
;RB11ﾌﾚｰﾑ搬送 移動 ばねセット
STG @MR3102
MPS
ANB R41203               ; TASK3 PAUSE 要求
DW #2 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3103
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3103
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3104
;TASK3→4 ばね給材要求ON
STG @MR3104
MPS
ANB R41203               ; TASK3 PAUSE 要求
SET MR20312              ; TASK3→4 ばね給材要求
CON
JMP @MR3105
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3105
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20313              ; TASK4→3 ばね給材完了
ANL
RES MR20312              ; TASK3→4 ばね給材要求
CON
JMP @MR3106
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3106
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB MR20313              ; TASK4→3 ばね給材完了
ANL
MPS
ANB LR10004              ; デバッグ用ばねCHECK
JMP @MR3107
MPP
AND LR10004              ; デバッグ用ばねCHECK
JMP @MR3800
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB11ﾌﾚｰﾑ搬送 移動 溶着位置へ
STG @MR3107
SET MR20408              ; TASK3→2 フィルム搬送許可
CON
DW #4 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3108
STG @MR3108
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3109
;<h1/> ばね着座確認
STG @MR3109
MPS
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR3202
MPP
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND R4412                ; ばね着座ｾﾝｻOUT1
JMP @MR3202
MPP
ANB R4412                ; ばね着座ｾﾝｻOUT1
TMR @14 #20              ; wait
CON
AND @T14                 ; wait
JMP @MR3110
;Error 133.ばね着座センサ未検出
STG @MR3110
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7400 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #133 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4412 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3111
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3111
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3109
MPP
AND @MR106               ; SW2
JMP @MR3112
;ばね除材へ(手が入らないので投入位置へ戻す)
;RB11フレーム搬送 移動 待機位置
STG @MR3112
DW #1 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3113
STG @MR3113
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3114
;Error 136.着座未検出ばね確認要求
STG @MR3114
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7400 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #136 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4412 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3115
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3115
SET MR20110              ; ばね除材中
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
RES MR20110              ; ばね除材中
CON
JMP @MR3107
MPP
AND @MR106               ; SW2
RES MR20110              ; ばね除材中
CON
@DEC.S DM20041           ; ばね投入数(ﾌﾚｰﾑに)
CON
JMP @MR3102
;TASK3→2 フィルム給材要求ON
STG @MR3202
SET MR20308              ; TASK3→2 フィルム給材要求
CON
JMP @MR3203
STG @MR3203
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20309              ; TASK2→3 フィルム給材中
ANL
JMP @MR3204
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3204
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB MR20309              ; TASK2→3 フィルム給材中
ANL
RES MR20308              ; TASK3→2 フィルム給材要求
CON
JMP @MR3205
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> 溶着動作
STG @MR3205
MPS
LDB R41203               ; TASK3 PAUSE 要求
LDB DM2000.5             ; ﾌﾚｰﾑﾋｰﾀｰ有効/無効(OFF有効)
ANB R1007                ; ﾋｰﾀｰ2低温
AND R1008                ; ﾋｰﾀｰ2適温
AND R1009                ; ﾋｰﾀｰ2過昇温(ONOK)
OR DM2000.5              ; ﾌﾚｰﾑﾋｰﾀｰ有効/無効(OFF有効)
ANL
ANL
SET @MR5500              ; ⑩SUB_ﾌﾚｰﾑ溶着動作
CON
JMP @MR3206
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3206
AND @MR5501              ; ⑩SUB_ﾌﾚｰﾑ溶着動作完了
RES @MR5501              ; ⑩SUB_ﾌﾚｰﾑ溶着動作完了
CON
JMP @MR3207
STG @MR3207
MPS
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR3208
MPP
ANB @MR900               ; RBｴﾗｰ停止選択
JMP @MR3209
STG @MR3208
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
RES @MR900               ; RBｴﾗｰ停止選択
CON
SET MR20108              ; 要原点復帰
CON
JMP @MR3915              ; AUTO END
;TASK3→2 溶着後退避要求ON
STG @MR3209
RES MR20408              ; TASK3→2 フィルム搬送許可
CON
SET MR20310              ; TASK3→2 溶着後退避要求
CON
JMP @MR3210
STG @MR3210
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20311              ; TASK2→3 溶着後退避中
ANL
RES MR20310              ; TASK3→2 溶着後退避要求
CON
JMP @MR3211
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3211
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB MR20311              ; TASK2→3 溶着後退避中
ANL
JMP @MR3212
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;溶着不良分岐
STG @MR3212
MPS
ANB @MR904               ; 溶着不良
JMP @MR3303
MPP
AND @MR904               ; 溶着不良
JMP @MR3800
;溶着OKのとき
;RB11ﾌﾚｰﾑ搬送 移動 剥ぎ取り位置へ
STG @MR3303
DW #3 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3304
STG @MR3304
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3305
;剥ぎ取り待ち
STG @MR3305
SET MR20314              ; TASK3→6 フィルム剥ぎ取り要求
CON
JMP @MR3306
STG @MR3306
MPS
LDB R41203               ; TASK3 PAUSE 要求
AND MR20315              ; TASK6→3 フィルム剥ぎ取り中
ANL
RES MR20314              ; TASK3→6 フィルム剥ぎ取り要求
CON
JMP @MR3307
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3307
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB MR20315              ; TASK6→3 フィルム剥ぎ取り中
ANL
MPS
ANB MR20812              ; フィルム剥ぎ取り不良(溶着不良)
JMP @MR3400
MPP
AND MR20812              ; フィルム剥ぎ取り不良(溶着不良)
RES MR20812              ; フィルム剥ぎ取り不良(溶着不良)
CON
JMP @MR3800
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> ﾌﾚｰﾑ反転ﾌﾗｸﾞ分岐
STG @MR3400
MPS
AND DM2000.7             ; 片面溶着有効/無効(ON有効)
JMP @MR3800
MPP
ANB DM2000.7             ; 片面溶着有効/無効(ON有効)
MPS
ANB MR20611              ; ﾌﾚｰﾑ 反転ﾌﾗｸﾞ
JMP @MR3401
MPP
AND MR20611              ; ﾌﾚｰﾑ 反転ﾌﾗｸﾞ
JMP @MR3404
STG @MR3401
SET MR20611              ; ﾌﾚｰﾑ 反転ﾌﾗｸﾞ
CON
JMP @MR3500
STG @MR3404
RES MR20611              ; ﾌﾚｰﾑ 反転ﾌﾗｸﾞ
CON
JMP @MR3800
;<h1/> 反転
;RB11ﾌﾚｰﾑ搬送 移動 反転位置へ
STG @MR3500
DW #5 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3501
STG @MR3501
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3502
;ﾌﾚｰﾑ押さえ上昇
STG @MR3502
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANL
JMP @MR3503
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR3503
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANL
JMP @MR3504
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ反転動作
STG @MR3504
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB MR20406              ; TASK2→3 フレーム反転不可
ANL
TMR @18 #3               ; wait
CON
AND @T18                 ; wait
SET MR20402              ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
CON
SET @MR5300              ; ⑨SUB_ﾌﾚｰﾑ反転動作
CON
JMP @MR3505
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3505
AND @MR5301              ; ⑨SUB_ﾌﾚｰﾑ反転動作完了
RES MR20402              ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
CON
RES @MR5301              ; ⑨SUB_ﾌﾚｰﾑ反転動作完了
CON
JMP @MR3506
;<h1/> 反転後ﾌﾚｰﾑ状態確認
;浮きﾁｪｯｸ
STG @MR3506
MPS
LD R4512                 ; ﾌﾚｰﾑ浮き検出1(ONOK)
AND R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
JMP @MR3509
MPP
LDB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
ORB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
TMR @15 #10              ; wait
CON
AND @T15                 ; wait
JMP @MR3507
;Error 130 フレーム浮き検出
LD @MR3507
ANB R39004               ; ｴﾗｰ中
MPS
ANB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
DW #4512 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
DW #4513 @DM2            ; SensorNo /ERROR_DISP
STG @MR3507
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7800 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #130 @DM1             ; ErrorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3508
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3508
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3506
MPP
AND @MR106               ; SW2
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SET @MR901               ; ﾌﾚｰﾑ再投入
CON
JMP @MR3605
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2601
;有無ﾁｪｯｸ
STG @MR3509
MPS
LD R4511                 ; ﾌﾚｰﾑ有無検出(ON有り)
OR DM2000.3              ; ﾄﾞﾗｲ運転有効/無効(ON有効)
ANL
JMP @MR3600
MPP
LDB R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
ANL
TMR @16 #10              ; wait
CON
AND @T16                 ; wait
JMP @MR3510
;Error 134 フレーム未検出
STG @MR3510
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #134 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4511 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3511
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3511
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3506
;ﾌﾚｰﾑ押さえ前進
STG @MR3600
SET MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
RES MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
MPS
LDB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
AND R4112                ; ﾌﾚｰﾑ押さえ左 前進端
ANB R4113                ; ﾌﾚｰﾑ押さえ左 後退端
AND R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANB R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR3601
MPP
LD MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR3601
SET MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
RES MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
MPS
LDB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R4108                ; ﾌﾚｰﾑ押さえ左 下降端
ANB R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
AND R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANB R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANL
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3602
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2601
MPP
LD MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押え後_ﾌﾚｰﾑ確認
STG @MR3602
MPS
ANB @MR902               ; 押え後ﾌﾚｰﾑ確認
JMP @MR3603
MPP
AND @MR902               ; 押え後ﾌﾚｰﾑ確認
JMP @MR3604
STG @MR3603
SET @MR902               ; 押え後ﾌﾚｰﾑ確認
CON
JMP @MR3506
STG @MR3604
RES @MR902               ; 押え後ﾌﾚｰﾑ確認
CON
JMP @MR3605
;ばね給材位置へもどる
STG @MR3605
MPS
AND @MR901               ; ﾌﾚｰﾑ再投入
JMP @MR3800
MPP
ANB @MR901               ; ﾌﾚｰﾑ再投入
JMP @MR3102
;<h1/> ﾌﾚｰﾑ投入口へ戻る
;RB11ﾌﾚｰﾑ搬送 移動 待機位置へ
STG @MR3800
MPS
ANB R41203               ; TASK3 PAUSE 要求
DW #1 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR3801
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3801
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR3802
;ﾌﾚｰﾑ押さえ上昇
STG @MR3802
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANL
JMP @MR3803
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR3803
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANL
JMP @MR3804
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ再投入分岐
STG @MR3804
MPS
ANB @MR901               ; ﾌﾚｰﾑ再投入
JMP @MR3807
MPP
AND @MR901               ; ﾌﾚｰﾑ再投入
RES @MR901               ; ﾌﾚｰﾑ再投入
CON
JMP @MR3805
;Error 135.フレーム再投入要求
STG @MR3805
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7400 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #135 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3806
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3806
SET @MR903               ; ﾌﾚｰﾑ状態異常中
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR903               ; ﾌﾚｰﾑ状態異常中
CON
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3506
MPP
AND @MR106               ; SW2
JMP @MR3900
;ﾌﾚｰﾑ再投入分岐
STG @MR3807
MPS
ANB @MR904               ; 溶着不良
@INC.L DM5024            ; _生産ｶｳﾝﾀ3
CON
ZRES MR20600 MR20606     ; Task0 ｽﾀｰﾄﾌﾗｸﾞ  Task6 ｽﾀｰﾄﾌﾗｸﾞ
CON
@DW.S +0 DM20040         ; 板押し圧投入数(溶着台に)
CON
@DW.S +0 DM20041         ; ばね投入数(ﾌﾚｰﾑに)
CON
@DW.S +0 DM20042         ; フィルム投入数(吸着冶具に)
CON
JMP @MR3900
MPP
AND @MR904               ; 溶着不良
RES @MR904               ; 溶着不良
CON
JMP @MR3808
;Error 131.フレーム除材要求(RB11)
STG @MR3808
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #131 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4511 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR3809
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3809
SET MR20106              ; ﾌﾚｰﾑ除材要求
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
@INC.L DM5026            ; _生産ｶｳﾝﾀ4
CON
RES MR20106              ; ﾌﾚｰﾑ除材要求
CON
JMP @MR3900
;ﾌﾚｰﾑ除材待ち
LDP @MR3900
TRGD #0
STG @MR3900
MPS
AND R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
SET MR20106              ; ﾌﾚｰﾑ除材要求
MRD
ANB R41203               ; TASK3 PAUSE 要求
@INC.L DM5022            ; _生産ｶｳﾝﾀ2
CON
RES R47000               ; _処理時間1計測開始
CON
ANB R4511                ; ﾌﾚｰﾑ有無検出(ON有り)
AND R1003                ; ｴﾘｱｾﾝｻ状態
TMR @17 #2               ; wait
CON
AND @T17                 ; wait
OUT MR000                ; Cycleﾀｲﾑｶｳﾝﾄ
CON
RES MR20106              ; ﾌﾚｰﾑ除材要求
CON
JMP @MR3000              ; AUTO Main1
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>Auto終了処理
STG @MR3915              ; AUTO END
RES @MR3002              ; AUTO Main1 Busy
CON
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB @MR001               ; TASK3　ERROR
ANB @MR4002              ; Main2 Busy
ANL
ZRES @MR900 @MR915       ; RBｴﾗｰ停止選択
CON
JMP LR603                ; _Grp1_Task3_Fin.STG
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000              ; AUTO Main2
SET @MR4002              ; Main2 Busy
CON
JMP @MR4003
STG @MR4003
JMP @MR4415              ; Main2 END
STG @MR4415              ; Main2 END
SET @MR4001              ; Main2 END
CON
RES @MR4002              ; Main2 Busy
CON
ENDS
;<h1/>MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1～32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5603               ; _Grp1_Task3_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
SET @MR2002              ; ﾒﾝﾃ中
CON
JMP @MR2003
STG @MR2003
MPS
AND= DM4110 #5           ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2100
MRD
AND= DM4110 #6           ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2107
MRD
AND= DM4110 #7           ; _Group1　ﾒﾝﾃ動作番号
DW #9 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
LD<> DM4110 #5           ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #6          ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #7          ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2915              ; Mainte END
STG @MR2100
JMP @MR2101
;フレーム搬送動作
;[[ｸﾗﾝﾌﾟ]]ｸﾗﾝﾌﾟの開閉を切り替えます。
;[[移動]]位置移動します。位置選択画面に切り替わります。
;[[定停止]]動作を終了します。
STG @MR2101
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #7 @DM31              ; ScreenNo /SELECT_ACT
CON
DW #10 @DM32             ; SW1_No /SELECT_ACT
CON
DW #11 @DM33             ; SW2_No /SELECT_ACT
CON
DW #0 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task3 SELECT_ACT
CON
JMP @MR2102
STG @MR2102
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task3 SEL_ACT END
RES @MR201               ; Task3 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #1 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
JMP @MR2103
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;フレーム搬送動作
;[[ﾌﾚｰﾑ投入]]ﾌﾚｰﾑ投入位置へ移動します。
;[[ばねｾｯﾄ]]ばね投入位置へ移動します。
;[[ﾌｨﾙﾑ剥がし]]ﾌｨﾙﾑ剥がし位置へ移動します。
;[[NextPage]]次のﾍﾟｰｼﾞへ
STG @MR2103
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #8 @DM31              ; ScreenNo /SELECT_ACT
CON
DW #12 @DM32             ; SW1_No /SELECT_ACT
CON
DW #13 @DM33             ; SW2_No /SELECT_ACT
CON
DW #14 @DM34             ; SW3_No /SELECT_ACT
CON
DW #2 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task3 SELECT_ACT
CON
JMP @MR2104
STG @MR2104
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task3 SEL_ACT END
RES @MR201               ; Task3 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #2 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #3 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
DW #4 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
AND @MR208               ; SW4
JMP @MR2105
;フレーム搬送動作
;[[溶着]]溶着位置へ移動します。
;[[反転]]ﾌﾚｰﾑ反転位置へ移動します
;[[PrevPage]]前のﾍﾟｰｼﾞへ
;[[定停止]]動作を終了します。
STG @MR2105
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #9 @DM31              ; ScreenNo /SELECT_ACT
CON
DW #15 @DM32             ; SW1_No /SELECT_ACT
CON
DW #16 @DM33             ; SW2_No /SELECT_ACT
CON
DW #1 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task3 SELECT_ACT
CON
JMP @MR2106
STG @MR2106
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task3 SEL_ACT END
RES @MR201               ; Task3 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #5 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #6 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
JMP @MR2103
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;溶着動作
;[[通常]]通常の溶着動作を行います。
;[[測定]]ロードセル測定モードです。
;[[定停止]]動作を終了します。
STG @MR2107
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #17 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #27 @DM32             ; SW1_No /SELECT_ACT
CON
DW #28 @DM33             ; SW2_No /SELECT_ACT
CON
DW #0 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task3 SELECT_ACT
CON
JMP @MR2108
STG @MR2108
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task3 SEL_ACT END
RES @MR201               ; Task3 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #7 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #8 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;ｽﾃｯﾌﾟor通常　か選択
STG @MR2200
MPS
MSTRT SELECT_POST #1 MyTask #0 @MR2005;自ﾀｽｸ番号
MPP
AND @MR2005
RES @MR2005
CON
JMP @MR2202
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
OUT @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK
LD DM11095.1
AND<=.L DM11088 +500     ; RB12 現在位置下位
LDB R4300                ; 圧縮ばね吸着下降端
AND R4301                ; 圧縮ばね吸着上昇端
LD DM11063.1
AND>=.L DM11056 +14200   ; RB8 現在位置
ORL
ANL
LD DM11007.1
LD>=.L DM11000 +7000     ; RB1 現在位置下位
OR<=.L DM11000 +28000    ; RB1 現在位置下位
ANL
LDB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ORL
ANL
AND DM11039.1            ; 原点復帰完了
AND<=.L DM11032 +500     ; RB5 現在位置
AND DM11071.1
AND<=.L DM11064 +29700   ; RB9 現在位置
OUT @MR002               ; RB11移動条件
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
LD DM11087.1
AND>=.L DM11080 +28000   ; RB11 現在位置下位
OR @MR002                ; RB11移動条件
ANL
AND R1003                ; ｴﾘｱｾﾝｻ状態
OUT @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR002               ; RB11移動条件
AND R1003                ; ｴﾘｱｾﾝｻ状態
OUT @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR002               ; RB11移動条件
AND R1003                ; ｴﾘｱｾﾝｻ状態
OUT @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
LD= @DM10 #5             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR002               ; RB11移動条件
AND R1003                ; ｴﾘｱｾﾝｻ状態
OUT @MR504               ; ﾒﾝﾃｺｰﾄﾞ5条件OK
LD= @DM10 #6             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR002               ; RB11移動条件
AND R1003                ; ｴﾘｱｾﾝｻ状態
OUT @MR505               ; ﾒﾝﾃｺｰﾄﾞ6条件OK
LD= @DM10 #7             ; ﾒﾝﾃ動作ｺｰﾄﾞ
OR= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
LD= EM1301 #4            ; RB1Now Pos
AND>=.L DM11000 -50      ; RB1 現在位置下位
AND<=.L DM11000 +50      ; RB1 現在位置下位
LD>=.L DM11000 +9000     ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
ORL
ANL
AND DM11087.1
AND>=.L DM11080 +5450    ; RB11 現在位置下位
AND<=.L DM11080 +5560    ; RB11 現在位置下位
LD R4108                 ; ﾌﾚｰﾑ押さえ左 下降端
OR= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
ANL
LDB R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
AND R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANB R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
OR= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
ANL
OUT @MR506               ; ﾒﾝﾃｺｰﾄﾞ7条件OK
CON
OUT @MR507               ; ﾒﾝﾃｺｰﾄﾞ8条件OK
LD= @DM10 #9             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11087.1
AND DM11007.1
LD>=.L DM11000 +7000     ; RB1 現在位置下位
OR<=.L DM11000 +28000    ; RB1 現在位置下位
ANL
AND<.L DM11032 +3500     ; RB5 現在位置
OUT @MR508               ; ﾒﾝﾃｺｰﾄﾞ9条件OK
STG @MR2202
MPS
TMR @39 #10              ; ﾒﾝﾃ条件NG
CON
AND @T39                 ; ﾒﾝﾃ条件NG
JMP @MR2810
MPP
ANB @T39                 ; ﾒﾝﾃ条件NG
MPS
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK
ANL
JMP @MR2300
MRD
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
ORL
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
ORL
LD= @DM10 #5             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR504               ; ﾒﾝﾃｺｰﾄﾞ5条件OK
ORL
LD= @DM10 #6             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR505               ; ﾒﾝﾃｺｰﾄﾞ6条件OK
ORL
ANL
JMP @MR2400
MRD
LD= @DM10 #7             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR506               ; ﾒﾝﾃｺｰﾄﾞ7条件OK
LD= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR507               ; ﾒﾝﾃｺｰﾄﾞ8条件OK
ORL
ANL
JMP @MR2500
MPP
LD= @DM10 #9             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR508               ; ﾒﾝﾃｺｰﾄﾞ9条件OK
ANL
JMP @MR2600
;<h1/> ﾒﾝﾃｺｰﾄﾞ1動作/Maintenance code 1 Operation
STG @MR2300
MPS
ANB R41203               ; TASK3 PAUSE 要求
MPS
LDB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR2301
MPP
LD R4112                 ; ﾌﾚｰﾑ押さえ左 前進端
ANB R4113                ; ﾌﾚｰﾑ押さえ左 後退端
AND R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANB R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR2304
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ｸﾗﾝﾌﾟ閉
;ﾌﾚｰﾑ押さえ上昇
STG @MR2301
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANL
JMP @MR2302
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ前進
STG @MR2302
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
RES MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
MPS
LDB MR4112               ; ﾌﾚｰﾑ押さえ左 前進端ERR
ANB MR4114               ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R4112                ; ﾌﾚｰﾑ押さえ左 前進端
ANB R4113                ; ﾌﾚｰﾑ押さえ左 後退端
AND R4114                ; ﾌﾚｰﾑ押さえ右 前進端
ANB R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR2303
MPP
LD MR4112                ; ﾌﾚｰﾑ押さえ左 前進端ERR
OR MR4114                ; ﾌﾚｰﾑ押さえ右 前進端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ下降
STG @MR2303
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
RES MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
MPS
LDB MR4108               ; ﾌﾚｰﾑ押さえ左 下降端ERR
ANB MR4110               ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R4108                ; ﾌﾚｰﾑ押さえ左 下降端
ANB R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
AND R4110                ; ﾌﾚｰﾑ押さえ右 下降端
ANB R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANL
JMP @MR2306
MPP
LD MR4108                ; ﾌﾚｰﾑ押さえ左 下降端ERR
OR MR4110                ; ﾌﾚｰﾑ押さえ右 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ｸﾗﾝﾌﾟ開
;ﾌﾚｰﾑ押さえ上昇
STG @MR2304
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7207               ; ﾌﾚｰﾑ押さえ上昇
CON
RES MR7206               ; ﾌﾚｰﾑ押さえ下降
CON
MPS
LDB MR4109               ; ﾌﾚｰﾑ押さえ左 上昇端ERR
ANB MR4111               ; ﾌﾚｰﾑ押さえ右 上昇端ERR
ANB R4108                ; ﾌﾚｰﾑ押さえ左 下降端
AND R4109                ; ﾌﾚｰﾑ押さえ左 上昇端
ANB R4110                ; ﾌﾚｰﾑ押さえ右 下降端
AND R4111                ; ﾌﾚｰﾑ押さえ右 上昇端
ANL
JMP @MR2305
MPP
LD MR4109                ; ﾌﾚｰﾑ押さえ左 上昇端ERR
OR MR4111                ; ﾌﾚｰﾑ押さえ右 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ押さえ後退
STG @MR2305
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7209               ; ﾌﾚｰﾑ押さえ後退
CON
RES MR7208               ; ﾌﾚｰﾑ押さえ前進
CON
MPS
LDB MR4113               ; ﾌﾚｰﾑ押さえ左 後退端ERR
ANB MR4115               ; ﾌﾚｰﾑ押さえ右 後退端ERR
ANB R4112                ; ﾌﾚｰﾑ押さえ左 前進端
AND R4113                ; ﾌﾚｰﾑ押さえ左 後退端
ANB R4114                ; ﾌﾚｰﾑ押さえ右 前進端
AND R4115                ; ﾌﾚｰﾑ押さえ右 後退端
ANL
JMP @MR2306
MPP
LD MR4113                ; ﾌﾚｰﾑ押さえ左 後退端ERR
OR MR4115                ; ﾌﾚｰﾑ押さえ右 後退端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;終了
STG @MR2306
JMP @MR2100
;<h1/> ﾒﾝﾃｺｰﾄﾞ2～6動作/Maintenance code 2～6 Operation
STG @MR2400
MPS
AND= @DM10 #2            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #1 EM1320             ; RB11Target Pos
CON
JMP @MR2401
MRD
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #2 EM1320             ; RB11Target Pos
CON
JMP @MR2401
MRD
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #3 EM1320             ; RB11Target Pos
CON
JMP @MR2401
MRD
AND= @DM10 #5            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #4 EM1320             ; RB11Target Pos
CON
JMP @MR2401
MPP
AND= @DM10 #6            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #5 EM1320             ; RB11Target Pos
CON
JMP @MR2401
;RB11ﾌﾚｰﾑ搬送 位置移動
STG @MR2401
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR2402
STG @MR2402
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR2403
;終了
STG @MR2403
JMP @MR2100
;<h1/> ﾒﾝﾃｺｰﾄﾞ7、8動作/Maintenance code 7、8 Operation
STG @MR2500
MPS
AND R35411               ; RB5原点復帰済
JMP @MR2502
MPP
ANB R35411               ; RB5原点復帰済
SET @MR4600              ; ②SUB_RB5/Home
CON
JMP @MR2501
STG @MR2501
AND @MR4601              ; ②SUB_RB5/Home完了
RES @MR4601              ; ②SUB_RB5/Home完了
CON
JMP @MR2502
;ﾌｨﾙﾑ搬送 位置分岐
STG @MR2502
MPS
LD= EM1301 #4            ; RB1Now Pos
AND>=.L DM11000 -50      ; RB1 現在位置下位
AND<=.L DM11000 +50      ; RB1 現在位置下位
ANL
JMP @MR2503
MPP
LD>=.L DM11000 +9000     ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
ANL
JMP @MR2504
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR2503
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR2504
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑ浮き確認
STG @MR2504
MPS
AND<> @DM10 #8           ; ﾒﾝﾃ動作ｺｰﾄﾞ
SET @MR5200              ; ⑧SUB_ﾌﾚｰﾑ浮き確認
CON
JMP @MR2505
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2506
STG @MR2505
AND @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
RES @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
CON
JMP @MR2506
;ﾌｨﾙﾑ搬送 位置分岐
STG @MR2506
MPS
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
MPS
LD= EM1301 #4            ; RB1Now Pos
AND>=.L DM11000 -50      ; RB1 現在位置下位
AND<=.L DM11000 +50      ; RB1 現在位置下位
ANL
JMP @MR2507
MPP
LD>=.L DM11000 +9000     ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
ANL
JMP @MR2509
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2509
;ﾌｨﾙﾑ搬送 親 下降
STG @MR2507
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANL
JMP @MR2508
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR2508
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
RES MR7601               ; 吸着治具吸着OFF
CON
SET MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
TMS @19 DM7024           ; フレーム溶着_吸着OFFウェイト  装置基礎ﾃﾞｰﾀ13
CON
AND @T19                 ; フレーム溶着_吸着OFFウェイト
JMP @MR2509
;溶着動作
STG @MR2509
SET @MR5500              ; ⑩SUB_ﾌﾚｰﾑ溶着動作
CON
JMP @MR2510
STG @MR2510
AND @MR5501              ; ⑩SUB_ﾌﾚｰﾑ溶着動作完了
RES @MR5501              ; ⑩SUB_ﾌﾚｰﾑ溶着動作完了
CON
JMP @MR2511
STG @MR2511
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
RES @MR904               ; 溶着不良
CON
MPS
ANB @MR900               ; RBｴﾗｰ停止選択
JMP @MR2513
MPP
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR2512
STG @MR2512
RES @MR900               ; RBｴﾗｰ停止選択
CON
JMP @MR2513
;ﾌｨﾙﾑ搬送 位置分岐
STG @MR2513
MPS
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
MPS
LD= EM1301 #4            ; RB1Now Pos
AND>=.L DM11000 -50      ; RB1 現在位置下位
AND<=.L DM11000 +50      ; RB1 現在位置下位
ANL
JMP @MR2514
MPP
LD>=.L DM11000 +9000     ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
ANL
JMP @MR2515
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2515
;ﾌｨﾙﾑ搬送 親 上昇
STG @MR2514
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANL
JMP @MR2515
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;終了
STG @MR2515
JMP @MR2914
;<h1/> ﾒﾝﾃｺｰﾄﾞ9動作/Maintenance code 9 Operation
;ﾌﾚｰﾑ反転
STG @MR2600
JMP @MR3500
STG @MR2601
MPS
ANB R41203               ; TASK3 PAUSE 要求
DW #1 EM1320             ; RB11Target Pos
CON
SET @MR4800              ; ④SUB_RB11/Move
CON
JMP @MR2602
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2602
AND @MR4801              ; ④SUB_RB11/Move完了
RES @MR4801              ; ④SUB_RB11/Move完了
CON
JMP @MR2603
STG @MR2603
JMP @MR2914
;<h1/> ﾒﾝﾃﾅﾝｽｲﾝﾀｰﾛｯｸ
STG @MR2810
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $3000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #52 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR2811
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2811
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
MPS
AND<> DM4110 #9          ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2003
MPP
AND= @DM10 #9            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;Maintenance 終了
STG @MR2914
MCALL MODE_INDI #2
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
DW #211 DM3008           ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
MPS
LD R41203                ; TASK3 PAUSE 要求
ANB @MR001               ; TASK3　ERROR
ANL
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41203               ; TASK3 PAUSE 要求
RES @MR2002              ; ﾒﾝﾃ中
CON
JMP LR603                ; _Grp1_Task3_Fin.STG
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/> ①SUB_RB5/Move
STG @MR4500              ; ①SUB_RB5/Move
SET @MR4502              ; ①SUB_RB5/Move中
CON
JMP @MR4503
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4503
MPS
BSET DM11239 #3          ; RB5 制御信号
CON
BANB DM11039 #3          ; RB5 状態信号
BSET DM11239 #4          ; RB5 制御信号
CON
BAND DM11039 #4          ; RB5 状態信号
BRES DM11239 #3          ; RB5 制御信号
CON
JMP @MR4504
MPP
TMR @0 #20               ; RB5Moveｴﾗｰ
CON
AND @T0                  ; RB5Moveｴﾗｰ
BRES DM11239 #3          ; RB5 制御信号
CON
BRES DM11239 #4          ; RB5 制御信号
CON
JMP @MR4714
STG @MR4504
SET R35400               ; RB5 MOVE
CON
JMP @MR4505
STG @MR4505
AND R35401               ; RB5 MOVE END
RES R35401               ; RB5 MOVE END
CON
JMP @MR4506
STG @MR4506
MPS
ANB R35403               ; RB5 Alarm
JMP @MR4507
MPP
AND R35403               ; RB5 Alarm
RES R35403               ; RB5 Alarm
CON
JMP @MR4714
;END
STG @MR4507
SET @MR4501              ; ①SUB_RB5/Move完了
CON
RES @MR4502              ; ①SUB_RB5/Move中
CON
ENDS
;<h1/> ②SUB_RB5/Home
STG @MR4600              ; ②SUB_RB5/Home
DW #0 EM1309             ; RB5Now Pos
CON
SET @MR4602              ; ②SUB_RB5/Home中
CON
JMP @MR4603
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4603
MPS
BSET DM11239 #3          ; RB5 制御信号
CON
BANB DM11039 #3          ; RB5 状態信号
BSET DM11239 #4          ; RB5 制御信号
CON
BAND DM11039 #4          ; RB5 状態信号
BRES DM11239 #3          ; RB5 制御信号
CON
JMP @MR4604
MPP
TMR @1 #20               ; RB5Homeｴﾗｰ
CON
AND @T1                  ; RB5Homeｴﾗｰ
BRES DM11239 #3          ; RB5 制御信号
CON
BRES DM11239 #4          ; RB5 制御信号
CON
JMP @MR4714
STG @MR4604
MPS
LD CR2003                ; 常時OFF
BAND DM11039 #1          ; RB5 状態信号
ANL
JMP @MR4607
MPP
BLDB DM11039 #1          ; RB5 状態信号
OR CR2002                ; 常時ON
ANL
SET R35408               ; RB5 HOME
CON
JMP @MR4605
STG @MR4605
AND R35409               ; RB5 HOME END
RES R35409               ; RB5 HOME END
CON
JMP @MR4606
STG @MR4606
MPS
ANB R35403               ; RB5 Alarm
JMP @MR4607
MPP
AND R35403               ; RB5 Alarm
RES R35403               ; RB5 Alarm
CON
JMP @MR4714
;END
STG @MR4607
SET @MR4601              ; ②SUB_RB5/Home完了
CON
RES @MR4602              ; ②SUB_RB5/Home中
CON
ENDS
;<h1/> ③SUB_RB5/Push
STG @MR4700              ; ③SUB_RB5/Push
SET @MR4702              ; ③SUB_RB5/Push中
CON
JMP @MR4703
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4703
MPS
BSET DM11239 #3          ; RB5 制御信号
CON
BANB DM11039 #3          ; RB5 状態信号
BSET DM11239 #4          ; RB5 制御信号
CON
BAND DM11039 #4          ; RB5 状態信号
BRES DM11239 #3          ; RB5 制御信号
CON
JMP @MR4704
MPP
TMR @2 #20               ; RB5Pushｴﾗｰ
CON
AND @T2                  ; RB5Pushｴﾗｰ
BRES DM11239 #3          ; RB5 制御信号
CON
BRES DM11239 #4          ; RB5 制御信号
CON
JMP @MR4714
STG @MR4704
SET R35404               ; RB5 PUSH
CON
JMP @MR4705
STG @MR4705
AND R35405               ; RB5 PUSH END
RES R35405               ; RB5 PUSH END
CON
JMP @MR4706
STG @MR4706
MPS
ANB R35403               ; RB5 Alarm
JMP @MR4707
MPP
AND R35403               ; RB5 Alarm
MPS
ANB DM11039.5            ; 押付動作空振り
RES R35403               ; RB5 Alarm
CON
JMP @MR4714
MPP
AND DM11039.5            ; 押付動作空振り
RES R35403               ; RB5 Alarm
CON
JMP @MR4712
;END
STG @MR4707
SET @MR4701              ; ③SUB_RB5/Push完了
CON
RES @MR4702              ; ③SUB_RB5/Push中
CON
ENDS
;Error 5 RB5動作異常
STG @MR4712
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1300 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #203 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR4713
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11038              ; RB5 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4713
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
JMP @MR4703
MPP
AND @MR106               ; SW2
SET @MR900               ; RBｴﾗｰ停止選択
CON
JMP @MR4707
;Error 5 RB5動作異常
STG @MR4714
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #5 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR4715
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11038              ; RB5 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4715
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR4602              ; ②SUB_RB5/Home中
JMP @MR4603
MRD
AND @MR4502              ; ①SUB_RB5/Move中
JMP @MR4503
MPP
AND @MR4702              ; ③SUB_RB5/Push中
JMP @MR4703
;<h1/> ④SUB_RB11/Move
STG @MR4800              ; ④SUB_RB11/Move
SET @MR4802              ; ④SUB_RB11/Move中
CON
JMP @MR4803
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4803
MPS
BSET DM11287 #3          ; RB11 制御信号
CON
BANB DM11087 #3          ; RB11 状態信号
BSET DM11287 #4          ; RB11 制御信号
CON
BAND DM11087 #4          ; RB11 状態信号
BRES DM11287 #3          ; RB11 制御信号
CON
JMP @MR4804
MPP
TMR @3 #20               ; RB11Moveｴﾗｰ
CON
AND @T3                  ; RB11Moveｴﾗｰ
BRES DM11287 #3          ; RB11 制御信号
CON
BRES DM11287 #4          ; RB11 制御信号
CON
JMP @MR4914
STG @MR4804
MPS
LDB R41203               ; TASK3 PAUSE 要求
LDB MR20101              ; ｴﾘｱｾﾝｻ遮光検出
OR CR2002                ; 常時ON
ANL
ANL
SET R36000               ; RB11 MOVE
CON
JMP @MR4805
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4805
AND R36001               ; RB11 MOVE END
RES R36001               ; RB11 MOVE END
CON
JMP @MR4806
STG @MR4806
MPS
ANB R36003               ; RB11 Alarm
JMP @MR4807
MPP
AND R36003               ; RB11 Alarm
RES R36003               ; RB11 Alarm
CON
JMP @MR4914
;END
STG @MR4807
SET @MR4801              ; ④SUB_RB11/Move完了
CON
RES @MR4802              ; ④SUB_RB11/Move中
CON
ENDS
;<h1/> ⑤SUB_RB11/Home
STG @MR4900              ; ⑤SUB_RB11/Home
DW #0 EM1321             ; RB11Now Pos
CON
SET @MR4902              ; ⑤SUB_RB11/Home中
CON
JMP @MR4903
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4903
MPS
BSET DM11287 #3          ; RB11 制御信号
CON
BANB DM11087 #3          ; RB11 状態信号
BSET DM11287 #4          ; RB11 制御信号
CON
BAND DM11087 #4          ; RB11 状態信号
BRES DM11287 #3          ; RB11 制御信号
CON
JMP @MR4904
MPP
TMR @4 #20               ; RB11Homeｴﾗｰ
CON
AND @T4                  ; RB11Homeｴﾗｰ
BRES DM11287 #3          ; RB11 制御信号
CON
BRES DM11287 #4          ; RB11 制御信号
CON
JMP @MR4914
STG @MR4904
MPS
BAND DM11087 #1          ; RB11 状態信号
JMP @MR4907
MPP
BANB DM11087 #1          ; RB11 状態信号
SET R36008               ; RB11 HOME
CON
JMP @MR4905
STG @MR4905
AND R36009               ; RB11 HOME END
RES R36009               ; RB11 HOME END
CON
JMP @MR4906
STG @MR4906
MPS
ANB R36003               ; RB11 Alarm
JMP @MR4907
MPP
AND R36003               ; RB11 Alarm
RES R36003               ; RB11 Alarm
CON
JMP @MR4914
;END
STG @MR4907
SET @MR4901              ; ⑤SUB_RB11/Home完了
CON
RES @MR4902              ; ⑤SUB_RB11/Home中
CON
ENDS
;Error 11 RB11動作異常
STG @MR4914
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #11 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR4915
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11086              ; RB11 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4915
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR4902              ; ⑤SUB_RB11/Home中
JMP @MR4903
MPP
AND @MR4802              ; ④SUB_RB11/Move中
JMP @MR4803
;<h1/> ⑥SUB_RB12/Move
STG @MR5000              ; ⑥SUB_RB12/Move
SET @MR5002              ; ⑥SUB_RB12/Move中
CON
JMP @MR5003
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR5003
MPS
BSET DM11295 #3          ; RB12 制御信号
CON
BANB DM11095 #3          ; RB12 状態信号
BSET DM11295 #4          ; RB12 制御信号
CON
BAND DM11095 #4          ; RB12 状態信号
BRES DM11295 #3          ; RB12 制御信号
CON
JMP @MR5004
MPP
TMR @5 #20               ; RB12Moveｴﾗｰ
CON
AND @T5                  ; RB12Moveｴﾗｰ
BRES DM11295 #3          ; RB12 制御信号
CON
BRES DM11295 #4          ; RB12 制御信号
CON
JMP @MR5114
STG @MR5004
SET R36100               ; RB12 MOVE
CON
JMP @MR5005
STG @MR5005
AND R36101               ; RB12 MOVE END
RES R36101               ; RB12 MOVE END
CON
JMP @MR5006
STG @MR5006
MPS
ANB R36103               ; RB12 Alarm
JMP @MR5007
MPP
AND R36103               ; RB12 Alarm
RES R36103               ; RB12 Alarm
CON
JMP @MR5114
;END
STG @MR5007
SET @MR5001              ; ⑥SUB_RB12/Move完了
CON
RES @MR5002              ; ⑥SUB_RB12/Move中
CON
ENDS
;<h1/> ⑦SUB_RB12Home
STG @MR5100              ; ⑦SUB_RB12Home
DW #0 EM1323             ; RB12Now Pos
CON
SET @MR5102              ; ⑦SUB_RB12Home中
CON
JMP @MR5103
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR5103
MPS
BSET DM11295 #3          ; RB12 制御信号
CON
BANB DM11095 #3          ; RB12 状態信号
BSET DM11295 #4          ; RB12 制御信号
CON
BAND DM11095 #4          ; RB12 状態信号
BRES DM11295 #3          ; RB12 制御信号
CON
JMP @MR5104
MPP
TMR @6 #20               ; RB12Homeｴﾗｰ
CON
AND @T6                  ; RB12Homeｴﾗｰ
BRES DM11295 #3          ; RB12 制御信号
CON
BRES DM11295 #4          ; RB12 制御信号
CON
JMP @MR5114
STG @MR5104
MPS
BAND DM11095 #1          ; RB12 状態信号
JMP @MR5107
MPP
BANB DM11095 #1          ; RB12 状態信号
SET R36108               ; RB12 HOME
CON
JMP @MR5105
STG @MR5105
AND R36109               ; RB12 HOME END
RES R36109               ; RB12 HOME END
CON
JMP @MR5106
STG @MR5106
MPS
ANB R36103               ; RB12 Alarm
JMP @MR5107
MPP
AND R36103               ; RB12 Alarm
RES R36103               ; RB12 Alarm
CON
JMP @MR5114
;END
STG @MR5107
SET @MR5101              ; ⑦SUB_RB12Home完了
CON
RES @MR5102              ; ⑦SUB_RB12Home中
CON
ENDS
;Error 12 RB12動作異常
STG @MR5114
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #12 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR5115
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11094              ; RB12 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5115
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR5102              ; ⑦SUB_RB12Home中
JMP @MR5103
MPP
AND @MR5002              ; ⑥SUB_RB12/Move中
JMP @MR5003
;<h1/> ⑧SUB_ﾌﾚｰﾑ浮き確認
STG @MR5200              ; ⑧SUB_ﾌﾚｰﾑ浮き確認
SET @MR5202              ; ⑧SUB_ﾌﾚｰﾑ浮き確認中
CON
JMP @MR5203
;浮き確認
STG @MR5203
MPS
LD R4512                 ; ﾌﾚｰﾑ浮き検出1(ONOK)
AND R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
JMP @MR5215
MPP
LDB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
ORB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
ANL
TMR @7 #10               ; wait
CON
AND @T7                  ; wait
JMP @MR5204
;Error 130 フレーム浮き検出
LD @MR5204
ANB R39004               ; ｴﾗｰ中
MPS
ANB R4512                ; ﾌﾚｰﾑ浮き検出1(ONOK)
DW #4512 @DM2            ; SensorNo /ERROR_DISP
MPP
ANB R4513                ; ﾌﾚｰﾑ浮き検出2(ONOK)
DW #4513 @DM2            ; SensorNo /ERROR_DISP
STG @MR5204
ANB R39900               ; RB動作中
MPS
LDB R41203               ; TASK3 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #130 @DM1             ; ErrorNo /ERROR_DISP
CON
SET @MR100               ; Task3 ERROR
CON
JMP @MR5205
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR5205
SET @MR903               ; ﾌﾚｰﾑ状態異常中
CON
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task3 ERROR_End
RES @MR903               ; ﾌﾚｰﾑ状態異常中
CON
RES @MR101               ; Task3 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR5203
;END
STG @MR5215
SET @MR5201              ; ⑧SUB_ﾌﾚｰﾑ浮き確認完了
CON
RES @MR5202              ; ⑧SUB_ﾌﾚｰﾑ浮き確認中
CON
ENDS
;<h1/> ⑨SUB_ﾌﾚｰﾑ反転動作
STG @MR5300              ; ⑨SUB_ﾌﾚｰﾑ反転動作
SET @MR5302              ; ⑨SUB_ﾌﾚｰﾑ反転動作中
CON
JMP @MR5303
;反転ﾁｬｯｸ開
STG @MR5303
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7405               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
CON
RES MR7404               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
CON
MPS
LDB MR4305               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
ANB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR5304
MPP
LD MR4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12フレーム反転上下 移動 フレーム受渡し位置
STG @MR5304
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
DW #2 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR5305
STG @MR5305
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR5306
;反転ﾁｬｯｸ閉
STG @MR5306
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7404               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
CON
RES MR7405               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
CON
MPS
LDB MR4304               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉ERR
AND R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
ANB R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR5307
MPP
LD MR4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12フレーム反転上下 移動 回転位置
STG @MR5307
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
DW #3 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR5308
STG @MR5308
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR5309
;回転方向分岐
STG @MR5309
MPS
ANB R41203               ; TASK3 PAUSE 要求
MPS
LD R4302                 ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
ANB R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
JMP @MR5310
MPP
LDB R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
AND R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
JMP @MR5311
MPP
AND R41203               ; TASK3 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面
STG @MR5310
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7403               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面
CON
RES MR7402               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面
CON
MPS
LDB MR4303               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側ERR
ANB R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
AND R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
JMP @MR5312
MPP
LD MR4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面
STG @MR5311
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7402               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面
CON
RES MR7403               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面
CON
MPS
LDB MR4302               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側ERR
AND R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
ANB R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
JMP @MR5312
MPP
LD MR4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12フレーム反転上下 移動 フレーム受渡し位置
STG @MR5312
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
DW #2 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR5313
STG @MR5313
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR5314
;反転ﾁｬｯｸ開
STG @MR5314
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7405               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
CON
RES MR7404               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
CON
MPS
LDB MR4305               ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
ANB R4304                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ閉
AND R4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開
ANL
JMP @MR5315
MPP
LD MR4305                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞﾁｬｯｸ開ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB12フレーム反転上下 移動 待機位置
STG @MR5315
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
DW #1 EM1322             ; RB12Target Pos
CON
SET @MR5000              ; ⑥SUB_RB12/Move
CON
JMP @MR5400
STG @MR5400
AND @MR5001              ; ⑥SUB_RB12/Move完了
RES @MR5001              ; ⑥SUB_RB12/Move完了
CON
JMP @MR5415
;END
STG @MR5415
SET @MR5301              ; ⑨SUB_ﾌﾚｰﾑ反転動作完了
CON
RES @MR5302              ; ⑨SUB_ﾌﾚｰﾑ反転動作中
CON
ENDS
;<h1/> ⑩SUB_ﾌﾚｰﾑ溶着動作
STG @MR5500              ; ⑩SUB_ﾌﾚｰﾑ溶着動作
SET MR20801              ; 調査用 フレーム溶着中フラグ
CON
SET @MR5502              ; ⑩SUB_ﾌﾚｰﾑ溶着動作中
CON
JMP @MR5503
;ロギング用
LDP @MR5500              ; ⑩SUB_ﾌﾚｰﾑ溶着動作
FMOV.L +0 DM30000 #14    ; A面 接触点位置
LD MR20801               ; 調査用 フレーム溶着中フラグ
TMS @21 #20000           ; 溶着時間管理用
LD @T21                  ; 溶着時間管理用
SET MR20811              ; フレーム溶着時無応答
;ﾌﾚｰﾑ溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON
;ｴｽｹｰﾌﾟ下降
STG @MR5503
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7303               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON)
CON
RES MR7302               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙOFF
CON
SET MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
RES MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
JMP @MR5504
;ｴｽｹｰﾌﾟ下降
STG @MR5504
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
RES MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
MPS
LDB MR4210               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端ERR
AND R4210                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
ANB R4211                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANL
JMP @MR5505
MPP
LD MR4210                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB5 フレーム溶着 移動 溶着前位置
STG @MR5505
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
DW #2 EM1308             ; RB5Target Pos
CON
JMP @MR5506
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #2 EM1308             ; RB5Target Pos
CON
JMP @MR5506
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #6 EM1308             ; RB5Target Pos
CON
JMP @MR5506
STG @MR5506
SET @MR4500              ; ①SUB_RB5/Move
CON
JMP @MR5507
STG @MR5507
AND @MR4501              ; ①SUB_RB5/Move完了
RES @MR4501              ; ①SUB_RB5/Move完了
CON
JMP @MR5508
;測定動作分岐
STG @MR5508
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR5509
MPP
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR5600
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR5509
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR5600
;RB5 フレーム溶着 移動 接触点
STG @MR5509
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
LDA.D @T21               ; 溶着時間管理用
CON
STA.D DM30024            ; 時間計測用tmp
CON
DW #3 EM1308             ; RB5Target Pos
CON
SET @MR4700              ; ③SUB_RB5/Push
CON
JMP @MR5510
LD @MR5510
AND R35403               ; RB5 Alarm
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
SET @MR904               ; 溶着不良
STG @MR5510
AND @MR4701              ; ③SUB_RB5/Push完了
RES @MR4701              ; ③SUB_RB5/Push完了
CON
JMP @MR5511
LDP @MR5511
MPS
ANB R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30000            ; A面 接触点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30002            ; A面 接触点時間
MPP
AND R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30012            ; B面 接触点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30014            ; B面 接触点時間
;RB5 フレーム溶着 移動 溶融点
STG @MR5511
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
LDA.D @T21               ; 溶着時間管理用
CON
STA.D DM30024            ; 時間計測用tmp
CON
DW #4 EM1308             ; RB5Target Pos
CON
SET @MR4700              ; ③SUB_RB5/Push
CON
JMP @MR5512
LD @MR5512
AND R35403               ; RB5 Alarm
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
SET @MR904               ; 溶着不良
STG @MR5512
AND @MR4701              ; ③SUB_RB5/Push完了
RES @MR4701              ; ③SUB_RB5/Push完了
CON
JMP @MR5600
LDP @MR5600
MPS
ANB R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30004            ; A面 溶融点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30006            ; A面 溶融点時間
MPP
AND R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30016            ; B面 溶融点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30018            ; B面 溶融点時間
;RB5 フレーム溶着 溶着
STG @MR5600
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
DW #5 EM1308             ; RB5Target Pos
CON
JMP @MR5601
MPP
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR5608
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #5 EM1308             ; RB5Target Pos
CON
JMP @MR5601
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #7 EM1308             ; RB5Target Pos
CON
JMP @MR5601
;溶着方法選択(位置/押付)
;選択機能は削除。常に位置。
STG @MR5601
MPS
LD DM2000.8              ; ﾌﾚｰﾑ溶着方法(ON押付/OFF位置)
AND CR2003               ; 常時OFF
ANL
JMP @MR5602
MPP
LDB DM2000.8             ; ﾌﾚｰﾑ溶着方法(ON押付/OFF位置)
OR CR2002                ; 常時ON
ANL
JMP @MR5604
;溶着(押付)
STG @MR5602
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
LDA.D @T21               ; 溶着時間管理用
CON
STA.D DM30024            ; 時間計測用tmp
CON
SET @MR4700              ; ③SUB_RB5/Push
CON
JMP @MR5603
STG @MR5603
AND @MR4701              ; ③SUB_RB5/Push完了
RES @MR4701              ; ③SUB_RB5/Push完了
CON
JMP @MR5608
;溶着完了位置計算
STG @MR5604
MPS
ANB R4514                ; A/B面判定
MPS
ANB R4515                ; CAV検出
LDA.L DM11032            ; RB5 現在位置
CON
ADD.L DM7026             ; 装置基礎ﾃﾞｰﾀ14
CON
STA.L EM18442            ; RB5 P8 POS(LO)
CON
JMP @MR5605
MPP
AND R4515                ; CAV検出
LDA.L DM11032            ; RB5 現在位置
CON
ADD.L DM7028             ; 装置基礎ﾃﾞｰﾀ15
CON
STA.L EM18442            ; RB5 P8 POS(LO)
CON
JMP @MR5605
MPP
AND R4514                ; A/B面判定
MPS
ANB R4515                ; CAV検出
LDA.L DM11032            ; RB5 現在位置
CON
ADD.L DM7030             ; 装置基礎ﾃﾞｰﾀ16
CON
STA.L EM18442            ; RB5 P8 POS(LO)
CON
JMP @MR5605
MPP
AND R4515                ; CAV検出
LDA.L DM11032            ; RB5 現在位置
CON
ADD.L DM7032             ; 装置基礎ﾃﾞｰﾀ17
CON
STA.L EM18442            ; RB5 P8 POS(LO)
CON
JMP @MR5605
;溶着位置移動
STG @MR5605
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
LDA.D @T21               ; 溶着時間管理用
CON
STA.D DM30024            ; 時間計測用tmp
CON
DW #8 EM1308             ; RB5Target Pos
CON
SET @MR4500              ; ①SUB_RB5/Move
CON
JMP @MR5606
STG @MR5606
AND @MR4501              ; ①SUB_RB5/Move完了
RES @MR4501              ; ①SUB_RB5/Move完了
CON
JMP @MR5608
;溶着不良監視
LD @MR5603
OR @MR5606
AND R35403               ; RB5 Alarm
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
SET @MR904               ; 溶着不良
;フレーム溶着時間待機
STG @MR5608
MPS
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR5609
MPP
ANB @MR900               ; RBｴﾗｰ停止選択
MPS
LDB R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
AND R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
LDB R4302                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
ANB R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ORL
ANL
TMS @8 DM7004            ; ﾌﾚｰﾑ溶着時間(A)  基礎装置ﾃﾞｰﾀ3
CON
AND @T8                  ; ﾌﾚｰﾑ溶着時間(A)
JMP @MR5609
MPP
LD R4302                 ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転B面側
ANB R4303                ; ﾌﾚｰﾑﾊﾞﾙﾌﾞ反転A面側
ANL
TMS @9 DM7006            ; ﾌﾚｰﾑ溶着時間(B)  装置基礎ﾃﾞｰﾀ4
CON
AND @T9                  ; ﾌﾚｰﾑ溶着時間(B)
JMP @MR5609
LDP @MR5609
MPS
ANB R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30008            ; A面 終了点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30010            ; A面 終了点時間
MPP
AND R4514                ; A/B面判定
LDA.L DM11032            ; RB5 現在位置
CON
STA.L DM30020            ; B面 終了点位置
CON
LDA.D DM30024            ; 時間計測用tmp
CON
SUB.D @T21               ; 溶着時間管理用
CON
STA.D DM30022            ; B面 終了点時間
;RB5 フレーム溶着 移動 待機位置
STG @MR5609
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
DW #1 EM1308             ; RB5Target Pos
CON
SET @MR4500              ; ①SUB_RB5/Move
CON
JMP @MR5610
STG @MR5610
AND @MR4501              ; ①SUB_RB5/Move完了
RES @MR4501              ; ①SUB_RB5/Move完了
CON
JMP @MR5611
;ｴｽｹｰﾌﾟ上昇
STG @MR5611
SET MR7305               ; (ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7304               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
MPS
LDB MR4211               ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
ANB R4210                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
AND R4211                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANL
JMP @MR5615
MPP
LD MR4211                ; ﾌﾚｰﾑ溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R41203               ; TASK3 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;END
STG @MR5615
RES MR20801              ; 調査用 フレーム溶着中フラグ
CON
SET @MR5501              ; ⑩SUB_ﾌﾚｰﾑ溶着動作完了
CON
RES @MR5502              ; ⑩SUB_ﾌﾚｰﾑ溶着動作中
CON
ENDS
;<h1/>-----------------------------------------------------------
;<h1/>*ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Task3 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
DW MyTask @DM0           ; 自ﾀｽｸ番号  TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task3 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task3 ERROR Busy
CON
SET @MR101               ; Task3 ERROR_End
CON
ENDS
;<h1/>*Select_Y_N 
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task3 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task3 Y/N
CON
DW #0 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task3 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task3 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task3 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task3 Y_N Busy
CON
SET @MR301               ; Task3 Y/N END
CON
ENDS
;<h1/>*TIMEUP ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task3 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #0 @DM40
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task3 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task3 TIMEUP Busy
CON
SET @MR401               ; Task3 TIMEUP_END
CON
ENDS
;<h1/>*Select_ACT 
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task3 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #0 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT  TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task3 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task3 SEL_ACT Busy
CON
SET @MR201               ; Task3 SEL_ACT END
CON
ENDS
;<h1/>※機能Macro呼出し見本- 削除して下さい。-------------------------------------
;<h1/>※Error:記述見本
;ERR163 "****Error"
;<h1/>※SELECT_ACT　:記述見本
;画面番号33をブザー有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
;<h1/>※ SELECT_Y_N　記述見本
;//*Select_Y_N
;<h1/>HALT
LD R41203                ; TASK3 PAUSE 要求
AND @MR1900              ; Main1 HALT許可
LD @MR1901               ; Main2 HALT許可
ORB @MR4002              ; Main2 Busy
ANL
TMR @40 #5               ; HALT許可 遅延
CON
AND @T40                 ; HALT許可 遅延
SET R42603               ; Grp1_Task3_ﾎﾟｰｽﾞ許可
LD R42603                ; Grp1_Task3_ﾎﾟｰｽﾞ許可
ORB R41203               ; TASK3 PAUSE 要求
ANB @MR001               ; TASK3　ERROR
RES @MR1900              ; Main1 HALT許可
CON
RES @MR1901              ; Main2 HALT許可
END
ENDH
