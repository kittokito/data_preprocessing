DEVICE:53
;MODULE:F_Error
;MODULE_TYPE:0
;OneSystem Sub Module
;---------------------------------------
;ModuleName	:	F_Error
;ModuleType	:	Sub Module
;Function	:	F_Error条件を記入　1~64
;---------------------------------------
LD= DM3008 #10           ; _MainTP　切替ﾍﾟｰｼﾞNo
SET @MR000
LD @MR000
OR R58500                ; DEVICEﾈｯﾄ登録ﾉｰﾄﾞ一致
TMR #10 #50              ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
;Ethernet Error
LDB CR2002               ; 常時ON
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #63
MPP
ANP @MR001
MOV #63 DM20104          ; F_Error時 Error番号
;RB1フィルム搬送インターロック
LDB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
INV
LD>=.L DM11032 +500      ; RB5 現在位置
AND>=.L DM11000 -2000    ; RB1 現在位置下位
AND<=.L DM11000 +2800    ; RB1 現在位置下位
ORL
LD>=.L DM11088 +100      ; RB12 現在位置下位
AND>=.L DM11000 +200     ; RB1 現在位置下位
AND<=.L DM11000 +8000    ; RB1 現在位置下位
ORL
LDB R4002                ; ﾌｨﾙﾑ押さえ前進端
AND R4003                ; ﾌｨﾙﾑ押さえ後退端
INV
AND>=.L DM11000 +6500    ; RB1 現在位置下位
AND<=.L DM11000 +12000   ; RB1 現在位置下位
ORL
LDB R4010                ; 切出し位置決めｾﾝｻ下降端
AND R4011                ; 切出し位置決めｾﾝｻ上昇端
INV
AND>=.L DM11000 +7500    ; RB1 現在位置下位
AND<=.L DM11000 +13500   ; RB1 現在位置下位
ORL
LD>=.L DM11040 +500      ; RB6 現在位置
LDB R4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
AND R4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
INV
ORL
AND>=.L DM11000 +14900   ; RB1 現在位置下位
AND<=.L DM11000 +21000   ; RB1 現在位置下位
ORL
LD<=.L DM11072 +20000    ; RB10 現在位置
AND>=.L DM11000 +24000   ; RB1 現在位置下位
ORL
OUT MR20700              ; RB1移動不可
CON
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
AND DM11007.2
SET @MR001
CON
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #1
MPP
ANP @MR001
MOV #1 DM20104           ; F_Error時 Error番号
;RB2フィルムカットインターロック
LD R4004                 ; 切出し台連結ﾋﾟﾝ下降端
ANB R4005                ; 切出し台連結ﾋﾟﾝ上昇端
INV
TMR #14 #3
LD T14
LD R4006                 ; ﾌｨﾙﾑ押え下降端
ORB R4007                ; ﾌｨﾙﾑ押え上昇端
ANL
LDB R4004                ; 切出し台連結ﾋﾟﾝ下降端
AND R4005                ; 切出し台連結ﾋﾟﾝ上昇端
INV
AND<.L DM21290 +7500     ; 軸1 現在座標
AND>=.L DM21290 +7000    ; 軸1 現在座標
ANB R4002                ; ﾌｨﾙﾑ押さえ前進端
AND R4003                ; ﾌｨﾙﾑ押さえ後退端
LD MR22004               ; JOG+
OR>.L DM21292 DM21290    ; 軸1 指令座標  軸1 現在座標
ANL
ORL
OUT MR20701              ; RB2移動不可
LD MR20701               ; RB2移動不可
LD>=.L DM21290 +8300     ; 軸1 現在座標
AND MR22004              ; JOG+
ORL
LD R26404                ; 軸1 軸制御中
OR R26500                ; 軸1 JOG中
ANL
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #2
MPP
ANP @MR001
MOV #2 DM20104           ; F_Error時 Error番号
;RB3板押圧トレイ搬送インターロック
LD R4213                 ; 板押圧吸着上昇端
ANB R4212                ; 板押圧吸着下降端
INV
AND<.L DM11016 +31500    ; RB3 現在位置
AND<=.L DM11048 +25000   ; RB7 現在位置
LDB R4100                ; 板押圧ﾄﾚｲ押え左 下降端
AND R4101                ; 板押圧ﾄﾚｲ押え左 上昇端
ANB R4102                ; 板押圧ﾄﾚｲ押え右 下降端
AND R4103                ; 板押圧ﾄﾚｲ押え右 上昇端
INV
ORL
OUT MR20702              ; RB3移動不可
CON
AND DM11023.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #3
MPP
ANP @MR001
MOV #3 DM20104           ; F_Error時 Error番号
;RB4圧縮ばねトレイ搬送インターロック
LDB R4300                ; 圧縮ばね吸着下降端
AND R4301                ; 圧縮ばね吸着上昇端
INV
AND<.L DM11024 +28000    ; RB4 現在位置
AND>=.L DM11056 +17500   ; RB8 現在位置
OUT MR20703              ; RB4移動不可
CON
AND DM11031.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #4
MPP
ANP @MR001
MOV #4 DM20104           ; F_Error時 Error番号
;RB5フレーム溶着インターロック
LD>=.L DM11032 +500      ; RB5 現在位置
AND>=.L DM11000 -2000    ; RB1 現在位置下位
AND<=.L DM11000 +2400    ; RB1 現在位置下位
LD>=.L DM11000 +50       ; RB1 現在位置下位
OR<=.L DM11000 -50       ; RB1 現在位置下位
ANL
OUT MR20704              ; RB5移動不可
CON
ANB R35410               ; During RB5 HOME
AND DM11039.2            ; 移動中
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #5
MPP
ANP @MR001
MOV #5 DM20104           ; F_Error時 Error番号
;RB6板押圧溶着インターロック
LD>=.L DM11040 +500      ; RB6 現在位置
AND>=.L DM11000 +14900   ; RB1 現在位置下位
AND<=.L DM11000 +21000   ; RB1 現在位置下位
LD>=.L DM11000 +18100    ; RB1 現在位置下位
OR<=.L DM11000 +17900    ; RB1 現在位置下位
ANL
OUT MR20705              ; RB6移動不可
CON
ANB R35510               ; During RB6 HOME
AND DM11047.2            ; 移動中
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #6
MPP
ANP @MR001
MOV #6 DM20104           ; F_Error時 Error番号
;RB7板押圧搬送PPインターロック
LD R4213                 ; 板押圧吸着上昇端
ANB R4212                ; 板押圧吸着下降端
INV
TMH #11 #10
CON
AND T11
OUT MR20706              ; RB7移動不可
CON
AND DM11055.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #7
MPP
ANP @MR001
MOV #7 DM20104           ; F_Error時 Error番号
LD R4213                 ; 板押圧吸着上昇端
ANB R4212                ; 板押圧吸着下降端
INV
TMH #13 #5
CON
AND T13
AND DM11055.2
ANB MR20706              ; RB7移動不可
OUT MR20009
LD R4213                 ; 板押圧吸着上昇端
ANB R4212                ; 板押圧吸着下降端
INV
AND DM11055.2
ANB MR20706              ; RB7移動不可
DW #1 DM20051
CON
OUT MR20008              ; F発生ﾄﾘｶﾞ
;上昇端監視
LD DM11055.2
OUT MR20007              ; RB7移動中
LDB R4213                ; 板押圧吸着上昇端
MPS
LDB R7306                ; 板押圧吸着下降
AND DM11055.2
ANB R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND= DM20050 #0          ; Ｆｴﾗｰ用
ANL
DW #1 DM20050            ; Ｆｴﾗｰ用
MPP
LD R7306                 ; 板押圧吸着下降
AND DM11055.2
ANL
DW #6 DM20050            ; Ｆｴﾗｰ用
;RB8ばね搬送PPインターロック
LDB R4300                ; 圧縮ばね吸着下降端
AND R4301                ; 圧縮ばね吸着上昇端
INV
TMH #12 #5
CON
AND T12
OUT MR20707              ; RB8移動不可
CON
AND DM11063.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #8
MPP
ANP @MR001
MOV #8 DM20104           ; F_Error時 Error番号
;RB9フィルム剥がしインターロック
LD>=.L DM11080 +22524    ; RB11 現在位置下位
AND<=.L DM11080 +23549   ; RB11 現在位置下位
OUT @MR002               ; RB11フィルム剥がし位置
LDB R4308                ; ﾌｨﾙﾑﾁｬｯｸ下降側
AND R4309                ; ﾌｨﾙﾑﾁｬｯｸ上昇側
INV
AND<=.L DM11064 +13500   ; RB9 現在位置
AND<=.L DM11072 +2300    ; RB10 現在位置
LD R4306                 ; ﾌｨﾙﾑﾁｬｯｸ前進側
ANB R4307                ; ﾌｨﾙﾑﾁｬｯｸ後退側
AND R4308                ; ﾌｨﾙﾑﾁｬｯｸ下降側
ANB R4309                ; ﾌｨﾙﾑﾁｬｯｸ上昇側
INV
AND<=.L DM11064 -9600    ; RB9 現在位置
AND<=.L DM11072 +0       ; RB10 現在位置
ORL
LD @MR002                ; RB11フィルム剥がし位置
AND>=.L DM11264 +33800   ; RB9 目標位置
ORL
LD>=.L DM11080 +11684    ; RB11 現在位置下位
AND<=.L DM11080 +34524   ; RB11 現在位置下位
ANB @MR002               ; RB11フィルム剥がし位置
AND>=.L DM11264 +31500   ; RB9 目標位置
ORL
OUT MR20708              ; RB9移動不可
CON
AND DM11071.2
ANB R35810               ; During RB9 HOME
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #9
MPP
ANP @MR001
MOV #9 DM20104           ; F_Error時 Error番号
;RB10フィルム回収上下インターロック
LD>=.L DM11000 +24000    ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
LD>=.L DM11000 +27100    ; RB1 現在位置下位
OR<=.L DM11000 +26900    ; RB1 現在位置下位
AND<=.L DM11072 +13000   ; RB10 現在位置
OR<=.L DM11072 +11000    ; RB10 現在位置
ANL
LD<=.L DM11000 -5800     ; RB1 現在位置下位
AND>=.L DM11000 -11000   ; RB1 現在位置下位
LD>=.L DM11000 -9100     ; RB1 現在位置下位
OR<=.L DM11000 -8900     ; RB1 現在位置下位
AND<=.L DM11072 +13000   ; RB10 現在位置
OR<=.L DM11072 +11000    ; RB10 現在位置
ANL
ORL
LDB R4308                ; ﾌｨﾙﾑﾁｬｯｸ下降側
AND R4309                ; ﾌｨﾙﾑﾁｬｯｸ上昇側
INV
AND<=.L DM11064 +13500   ; RB9 現在位置
AND<=.L DM11072 +2400    ; RB10 現在位置
ORL
OUT MR20709              ; RB10移動不可
CON
LD<> EM1318 #1           ; RB10Target Pos
OR R35910                ; During RB10 HOME
ANL
AND DM11079.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #10
MPP
ANP @MR001
MOV #10 DM20104          ; F_Error時 Error番号
;RB11フレーム搬送インターロック
LDB R4300                ; 圧縮ばね吸着下降端
AND R4301                ; 圧縮ばね吸着上昇端
INV
AND<=.L DM11056 +9900    ; RB8 現在位置
AND>=.L DM11080 +19000   ; RB11 現在位置下位
AND<=.L DM11080 +44000   ; RB11 現在位置下位
LD>=.L DM11064 +30000    ; RB9 現在位置
AND>=.L DM11080 +10000   ; RB11 現在位置下位
AND<=.L DM11080 +35000   ; RB11 現在位置下位
ORL
LD>=.L DM11032 +500      ; RB5 現在位置
OR>=.L DM11088 +14000    ; RB12 現在位置下位
AND<=.L DM11080 +13000   ; RB11 現在位置下位
ORL
LD<=.L DM11000 +6500     ; RB1 現在位置下位
AND MR7210               ; ﾌｨﾙﾑ搬送 親 下降
AND MR7212               ; ﾌｨﾙﾑ搬送 子 下降
ORL
OUT MR20710              ; RB11移動不可
CON
AND DM11087.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #11
MPP
ANP @MR001
MOV #11 DM20104          ; F_Error時 Error番号
;RB12フレーム反転上下インターロック
LD>=.L DM11088 +100      ; RB12 現在位置下位
AND>=.L DM11000 +200     ; RB1 現在位置下位
AND<=.L DM11000 +7000    ; RB1 現在位置下位
LD<=.L DM11080 +13000    ; RB11 現在位置下位
AND>=.L DM11088 +16200   ; RB12 現在位置下位
ORL
LD<=.L DM11080 +3462     ; RB11 現在位置下位
AND>=.L DM11080 +337     ; RB11 現在位置下位
OR<=.L DM11080 +45       ; RB11 現在位置下位
AND>=.L DM11088 +15200   ; RB12 現在位置下位
ORL
OUT MR20711              ; RB12移動不可
CON
ANB R36110               ; During RB12 HOME
AND DM11095.2
AND T10                  ; ﾃﾞﾊﾞｲｽﾈｯﾄWAIT
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #12
MPP
ANP @MR001
MOV #12 DM20104          ; F_Error時 Error番号
;溶着無応答
LDP MR20810              ; 板押圧溶着時無応答
ORP MR20811              ; フレーム溶着時無応答
SET @MR001
CON
MPS
MSTRT F_ERROR_DISP #13
MPP
ANP @MR001
MOV #13 DM20104          ; F_Error時 Error番号
;F_Error時の状態ロギング
LDP @MR001
BMOV R4000 DM20060 #10   ; ﾀﾞﾝｻｰﾛｰﾗｰ下降端  F_Error時 入力状態 4000
BMOV R7000 DM20070 #10   ; ﾀﾞﾝｻｰﾛｰﾗｰ下降  F_Error時 出力状態 7000
MOV.L DM11000 DM20080    ; RB1 現在位置下位  F_Error時 RB1位置
MOV.L DM21290 DM20082    ; 軸1 現在座標  F_Error時 RB2位置
MOV.L DM11016 DM20084    ; RB3 現在位置  F_Error時 RB3位置
MOV.L DM11024 DM20086    ; RB4 現在位置  F_Error時 RB4位置
MOV.L DM11032 DM20088    ; RB5 現在位置  F_Error時 RB5位置
MOV.L DM11040 DM20090    ; RB6 現在位置  F_Error時 RB6位置
MOV.L DM11048 DM20092    ; RB7 現在位置  F_Error時 RB7位置
MOV.L DM11056 DM20094    ; RB8 現在位置  F_Error時 RB8位置
MOV.L DM11064 DM20096    ; RB9 現在位置  F_Error時 RB9位置
MOV.L DM11072 DM20098    ; RB10 現在位置  F_Error時 RB10位置
MOV.L DM11080 DM20100    ; RB11 現在位置下位  F_Error時 RB11位置
MOV.L DM11088 DM20102    ; RB12 現在位置下位  F_Error時 RB12位置
END
ENDH
