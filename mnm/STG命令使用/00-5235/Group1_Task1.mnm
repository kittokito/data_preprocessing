DEVICE:53
;MODULE:Group1_Task1
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task1
;ModuleType	:	Main Module
;Line		:	
;Cell		: 
;Function	: 板押圧溶着
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000～@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100～@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000～@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000～@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000～@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000～@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500～@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ　※状況により増設してください。
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG～JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @MR100 @MR6415      ; Task1 ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
LD= DM60000 MyTask       ; TaskNo /ERROR_DISP  自ﾀｽｸ番号
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK1 ERROR
;ON STG Main1
;TYPE EM608.U,EM609.U,@MR000.U,@MR3000.U
;
;FOR EM608 = EM608 TO 160 STEP 16
;	IF @MR3000:EM608 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM608 < 160 THEN
;	EM609 = (EM608 / 16) * 100 + DMX(@MR3000:EM608) + #3000
;END IF		
;		
;EM608 = EM608 + 16		
;IF EM608 > 160 THEN		
;	EM608 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM608.U,EM609.U,@MR000.U,@MR3000.U
;
;FOR EM608 = EM608 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM608 EM608          ; Task1 Main1@MR  Task1 Main1@MR
LABEL #2000
LD> EM608 #160           ; Task1 Main1@MR
CJ #2001
;	IF @MR3000:EM608 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM608                ; Task1 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0      ; AUTO Main1
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM608                ; Task1 Main1@MR
CON
ADD #16
CON
STA EM608                ; Task1 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM608 < 160 THEN
;
LD< EM608 #160           ; Task1 Main1@MR
NCJ #2004
;	EM609 = (EM608 / 16) * 100 + DMX(@MR3000:EM608) + #3000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM608                ; Task1 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12          ; AUTO Main1
CON
DMX
CON
STA @VM0
CON
LDA EM608                ; Task1 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM609                ; Task1 Main1@MR
;END IF		
;
LABEL #2004
;EM608 = EM608 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM608                ; Task1 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM608                ; Task1 Main1@MR
;IF EM608 > 160 THEN		
;
LD> EM608 #160           ; Task1 Main1@MR
NCJ #2005
;	EM608 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM608             ; Task1 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM610.U,EM611.U,@MR4000.U
;
;FOR EM610 = EM610 TO 80 STEP 16
;	IF @MR4000:EM610 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM610 < 80 THEN
;	EM611 = (EM610 / 16) * 100 + DMX(@MR4000:EM610) + #4000
;END IF
;
;EM610 = EM610 + 16		
;
;IF EM610 > 80 THEN
;	EM610 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM610.U,EM611.U,@MR4000.U
;
;FOR EM610 = EM610 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM610 EM610          ; Task1 Main2@MR  Task1 Main2@MR
LABEL #2006
LD> EM610 #80            ; Task1 Main2@MR
CJ #2007
;	IF @MR4000:EM610 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM610                ; Task1 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0      ; AUTO Main2
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM610                ; Task1 Main2@MR
CON
ADD #16
CON
STA EM610                ; Task1 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM610 < 80 THEN
;
LD< EM610 #80            ; Task1 Main2@MR
NCJ #2010
;	EM611 = (EM610 / 16) * 100 + DMX(@MR4000:EM610) + #4000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM610                ; Task1 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12          ; AUTO Main2
CON
DMX
CON
STA @VM3
CON
LDA EM610                ; Task1 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM611                ; Task1 Main2@MR
;END IF
;
LABEL #2010
;EM610 = EM610 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM610                ; Task1 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM610                ; Task1 Main2@MR
;IF EM610 > 80 THEN
;
LD> EM610 #80            ; Task1 Main2@MR
NCJ #2011
;	EM610 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM610             ; Task1 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM612.U,EM613.U,@MR4500.U
;	
;FOR EM612 = EM612 TO 320 STEP 16
;	IF @MR4500:EM612 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM612 < 320 THEN
;	EM613 = (EM612 / 16) * 100 + DMX(@MR4500:EM612) + #4500
;END IF
;		
;EM612 = EM612 + 16	
;
;IF EM612 > 320 THEN
;   EM612 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM612.U,EM613.U,@MR4500.U
;
;FOR EM612 = EM612 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM612 EM612          ; Task1 Sub@MR  Task1 Sub@MR
LABEL #2012
LD> EM612 #320           ; Task1 Sub@MR
CJ #2013
;	IF @MR4500:EM612 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM612                ; Task1 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; ①SUB_RB6/Move
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM612                ; Task1 Sub@MR
CON
ADD #16
CON
STA EM612                ; Task1 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM612 < 320 THEN
;
LD< EM612 #320           ; Task1 Sub@MR
NCJ #2016
;	EM613 = (EM612 / 16) * 100 + DMX(@MR4500:EM612) + #4500
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM612                ; Task1 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; ①SUB_RB6/Move
CON
DMX
CON
STA @VM6
CON
LDA EM612                ; Task1 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM613                ; Task1 Sub@MR
;END IF
;
LABEL #2016
;EM612 = EM612 + 16	
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM612                ; Task1 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM612                ; Task1 Sub@MR
;IF EM612 > 320 THEN
;
LD> EM612 #320           ; Task1 Sub@MR
NCJ #2017
;   EM612 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM612             ; Task1 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR801                ; _Grp1_Task1_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR401                ; _Grp1_Task1_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5201               ; _Grp1_Task1_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5401               ; _Grp1_Task1_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5601               ; _Grp1_Task1_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR601                ; _Grp1_Task1_Fin.STG
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB @MR001               ; TASK1 ERROR
ANL
RES R42601               ; Grp1_Task1_ﾎﾟｰｽﾞ許可
CON
RES R41001               ; _Grp1_Task1_起動中ﾌﾗｸﾞ
CON
ENDS
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5201               ; _Grp1_Task1_HOME.STG
JMP @MR1000              ; HOME
STG @MR1000              ; HOME
RES MR20001              ; TASK1復帰完了
CON
SET @MR1002              ; HOME中
CON
JMP @MR1003
;自重ｷｬﾝｾﾙON
STG @MR1003
SET MR7215               ; (板押圧溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON)
CON
RES MR7214               ; 板押圧溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙOFF
CON
TMR @4 #5                ; wait
CON
AND @T4                  ; wait
JMP @MR1004
;RB6_板押圧溶着/原点復帰
STG @MR1004
MPS
ANB R41201               ; TASK1 PAUSE 要求
SET @MR4600              ; ②SUB_RB6/Home
CON
JMP @MR1005
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1005
AND @MR4601              ; ②SUB_RB6/Home完了
RES @MR4601              ; ②SUB_RB6/Home完了
CON
JMP @MR1006
;RB6_板押圧溶着/待機位置
STG @MR1006
MPS
ANB R41201               ; TASK1 PAUSE 要求
DW #1 EM1310             ; RB6Target Pos
CON
SET @MR4500              ; ①SUB_RB6/Move
CON
JMP @MR1007
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1007
AND @MR4501              ; ①SUB_RB6/Move完了
RES @MR4501              ; ①SUB_RB6/Move完了
CON
JMP @MR1008
;板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇
;※RB1ﾌｨﾙﾑ搬送復帰用の退避
STG @MR1008
SET MR7301               ; (板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7300               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
MPS
LDB MR4207               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANB R4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
ANL
JMP @MR1009
MPP
LD MR4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾋｰﾀｰON
STG @MR1009
SET MR2005               ; ﾋｰﾀｰ2ON
CON
JMP @MR1104
;TASK0_板押圧搬送復帰待ち
STG @MR1104
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20000              ; TASK0復帰完了
ANL
JMP @MR1105
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台下降
STG @MR1105
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
MPS
LDB MR4107               ; 板押圧溶着台 下降端ERR
ANB R4106                ; 板押圧溶着台 上昇端
AND R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR1106
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;TASK2へRB1ﾌｨﾙﾑ搬送復帰許可
STG @MR1106
SET MR20200              ; TASK1→2復帰許可
CON
JMP @MR1107
;RB1ﾌｨﾙﾑ搬送復帰待ち
STG @MR1107
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20002              ; TASK2復帰完了
ANL
RES MR20200              ; TASK1→2復帰許可
CON
JMP @MR1108
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_受取側
STG @MR1108
SET MR7203               ; 板押圧溶着台_受取側
CON
RES MR7202               ; 板押圧溶着台_溶着側
CON
MPS
LDB MR4105               ; 板押圧溶着台 受取側ERR
ANB R4104                ; 板押圧溶着台 溶着側
AND R4105                ; 板押圧溶着台 受取側
ANL
JMP @MR1109
MPP
LD MR4105                ; 板押圧溶着台 受取側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台上昇
STG @MR1109
SET MR7204               ; 板押圧溶着台上昇
CON
RES MR7205               ; 板押圧溶着台下降
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
ANB R4107                ; 板押圧溶着台 下降端
AND R4106                ; 板押圧溶着台 上昇端
ANL
JMP @MR1111
MPP
LD MR4106                ; 板押圧溶着台 上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_板押圧有無確認
STG @MR1111
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ④SUB_溶着台_板押圧無確認
CON
JMP @MR1112
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1112
AND @MR4901              ; ④SUB_溶着台_板押圧無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_溶着台_板押圧無確認完了
CON
JMP @MR1113
;溶着台_板押圧有無_吸着OFF
STG @MR1113
SET MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7606               ; 溶着台_板押圧有無吸着ON
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
JMP @MR1114
STG @MR1114
MPS
AND= DM20032 #1          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR1115
MPP
AND= DM20032 #0          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR1515              ; HOME END
;Error 111 板押圧除材要求(溶着台)
STG @MR1115
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #111 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4608 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR1200
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1200
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR1111
;終了
STG @MR1515              ; HOME END
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB @MR001               ; TASK1 ERROR
ANL
SET MR20001              ; TASK1復帰完了
CON
RES @MR1002              ; HOME中
CON
JMP LR601                ; _Grp1_Task1_Fin.STG
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>AUTO/自動動作
STG LR5401               ; _Grp1_Task1_AUTO.STG
RES MR20601              ; Task1 ｽﾀｰﾄﾌﾗｸﾞ
CON
JMP @MR3000              ; AUTO Main1
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1～32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000              ; AUTO Main1
MPS
ANB R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
MPS
ANB R57301               ; Task1 停止要求
SET @MR3002              ; AUTO Main1 Busy
CON
JMP @MR3003
MPP
AND R57301               ; Task1 停止要求
JMP @MR3915              ; AUTO END
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR3915              ; AUTO END
STG @MR3003
MPS
ANB R41201               ; TASK1 PAUSE 要求
MPS
LD R57301                ; Task1 停止要求
ANB R41003               ; _Grp1_Task3_起動中ﾌﾗｸﾞ
ANL
JMP @MR3915              ; AUTO END
MPP
LDB R57301               ; Task1 停止要求
OR R41003                ; _Grp1_Task3_起動中ﾌﾗｸﾞ
AND MR20601              ; Task1 ｽﾀｰﾄﾌﾗｸﾞ
ANL
JMP @MR3005
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> 板押圧給材
;溶着台受け取り側
STG @MR3005
SET MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
CON
SET MR7203               ; 板押圧溶着台_受取側
CON
RES MR7202               ; 板押圧溶着台_溶着側
CON
MPS
LDB MR4105               ; 板押圧溶着台 受取側ERR
ANB MR4104               ; 板押圧溶着台 溶着側ERR
AND R4105                ; 板押圧溶着台 受取側
ANB R4104                ; 板押圧溶着台 溶着側
ANL
JMP @MR3006
MPP
LD MR4105                ; 板押圧溶着台 受取側ERR
OR MR4104                ; 板押圧溶着台 溶着側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;溶着台上昇
STG @MR3006
RES MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
CON
SET MR7204               ; 板押圧溶着台上昇
CON
RES MR7205               ; 板押圧溶着台下降
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
ANB MR4107               ; 板押圧溶着台 下降端ERR
AND R4106                ; 板押圧溶着台 上昇端
ANB R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR3007
MPP
LD MR4106                ; 板押圧溶着台 上昇端ERR
OR MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;給材
STG @MR3007
MPS
ANB R41201               ; TASK1 PAUSE 要求
SET MR20300              ; TASK1→0 板押圧給材要求
CON
JMP @MR3008
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3008
MPS
ANB R41201               ; TASK1 PAUSE 要求
MPS
LD R57301                ; Task1 停止要求
ANB R41000               ; _Grp1_Task0_起動中ﾌﾗｸﾞ
ANL
RES MR20300              ; TASK1→0 板押圧給材要求
CON
JMP @MR3915              ; AUTO END
MPP
LDB R57301               ; Task1 停止要求
OR R41000                ; _Grp1_Task0_起動中ﾌﾗｸﾞ
AND MR20301              ; TASK0→1 板押圧給材完了
ANL
JMP @MR3010
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;溶着台_板押圧有無吸着ON
STG @MR3009
SET MR7606               ; 溶着台_板押圧有無吸着ON
CON
RES MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
TMR @10 #5
CON
AND @T5                  ; wait
SET MR20503              ; TASK1→0 溶着台吸着中
CON
JMP @MR3010
STG @MR3010
MPS
ANB R41201               ; TASK1 PAUSE 要求
RES MR20300              ; TASK1→0 板押圧給材要求
CON
JMP @MR3011
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3011
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20301              ; TASK0→1 板押圧給材完了
ANL
JMP @MR3012
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;吸着確認
STG @MR3012
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4800              ; ④SUB_溶着台_板押圧有確認
CON
JMP @MR3013
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3013
AND @MR4801              ; ④SUB_溶着台_板押圧有確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4801              ; ④SUB_溶着台_板押圧有確認完了
CON
JMP @MR3014
STG @MR3014
MPS
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR3106
MPP
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND= DM20032 #1          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3106
MPP
AND= DM20032 #0          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3015
;Error 112.板押圧未検出(溶着台)
STG @MR3015
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7400 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #112 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4608 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR3100
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3100
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3012
MPP
AND @MR106               ; SW2
@DEC.S DM20040           ; 板押し圧投入数(溶着台に)
CON
JMP @MR3101
;除材選択後吸着確認
STG @MR3101
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ④SUB_溶着台_板押圧無確認
CON
JMP @MR3102
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3102
AND @MR4901              ; ④SUB_溶着台_板押圧無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_溶着台_板押圧無確認完了
CON
JMP @MR3103
STG @MR3103
MPS
AND= DM20032 #1          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3104
MPP
AND= DM20032 #0          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3007
;除材選択後  Error 111.板押圧除材要求(溶着台)
STG @MR3104
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #111 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4609 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR3105
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3105
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3101
;<h1/> 溶着側へ移動
;溶着側移動
STG @MR3106
SET MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
CON
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
MPS
LDB MR4107               ; 板押圧溶着台 下降端ERR
ANB MR4106               ; 板押圧溶着台 上昇端ERR
AND R4107                ; 板押圧溶着台 下降端
ANB R4106                ; 板押圧溶着台 上昇端
ANL
JMP @MR3107
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
OR MR4106                ; 板押圧溶着台 上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR3107
RES MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
CON
SET MR7202               ; 板押圧溶着台_溶着側
CON
RES MR7203               ; 板押圧溶着台_受取側
CON
MPS
LDB MR4104               ; 板押圧溶着台 溶着側ERR
ANB MR4105               ; 板押圧溶着台 受取側ERR
AND R4104                ; 板押圧溶着台 溶着側
ANB R4105                ; 板押圧溶着台 受取側
ANL
JMP @MR3200
MPP
LD MR4104                ; 板押圧溶着台 溶着側ERR
OR MR4105                ; 板押圧溶着台 受取側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;フィルム給材要求
STG @MR3200
SET MR20302              ; TASK1→2 フィルム給材要求
CON
JMP @MR3201
STG @MR3201
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20303              ; TASK2→1 フィルム給材中
ANL
RES MR20302              ; TASK1→2 フィルム給材要求
CON
JMP @MR3202
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台上昇
STG @MR3202
ANB MR20303              ; TASK2→1 フィルム給材中
SET MR7204               ; 板押圧溶着台上昇
CON
RES MR7205               ; 板押圧溶着台下降
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
ANB MR4107               ; 板押圧溶着台 下降端ERR
AND R4106                ; 板押圧溶着台 上昇端
ANB R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR3203
MPP
LD MR4106                ; 板押圧溶着台 上昇端ERR
OR MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;溶着台_板押圧有無吸着OFF
STG @MR3203
RES MR7606               ; 溶着台_板押圧有無吸着ON
CON
SET MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
TMR @5 #5                ; wait
CON
AND @T5                  ; wait
JMP @MR3204
;<h1/> 溶着
STG @MR3204
MPS
LDB R41201               ; TASK1 PAUSE 要求
LDB DM2000.4             ; 板押圧ﾋｰﾀｰ有効/無効(OFF有効)
ANB R1004                ; ﾋｰﾀｰ1低温
AND R1005                ; ﾋｰﾀｰ1適温
AND R1006                ; ﾋｰﾀｰ1過昇温(ONOK）
OR DM2000.4              ; 板押圧ﾋｰﾀｰ有効/無効(OFF有効)
ANL
ANL
SET @MR5300              ; ⑤SUB_板押圧溶着動作
CON
JMP @MR3205
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3205
AND @MR5301              ; ⑤SUB_板押圧溶着動作完了
RES @MR5301              ; ⑤SUB_板押圧溶着動作完了
CON
JMP @MR3206
;溶着不良分岐
STG @MR3206
MPS
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR3207
MPP
ANB @MR900               ; RBｴﾗｰ停止選択
MPS
AND @MR901               ; 溶着不良
DW #0 DM20043            ; 溶着状態(1=OK)
CON
JMP @MR3208
MPP
ANB @MR901               ; 溶着不良
DW #1 DM20043            ; 溶着状態(1=OK)
CON
JMP @MR3208
STG @MR3207
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
RES @MR900               ; RBｴﾗｰ停止選択
CON
SET MR20108              ; 要原点復帰
CON
JMP @MR3915              ; AUTO END
;TASK1→2 溶着済み搬送要求
STG @MR3208
MPS
ANB R41201               ; TASK1 PAUSE 要求
SET MR20304              ; TASK1→2 溶着済み搬送要求
CON
JMP @MR3209
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3209
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20305              ; TASK2→1 溶着済み搬送完了
ANL
RES MR20304              ; TASK1→2 溶着済み搬送要求
CON
JMP @MR3210
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3210
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20305              ; TASK2→1 溶着済み搬送完了
ANL
JMP @MR3211
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_板押圧有無確認(溶着動作後_受渡し後)
STG @MR3211
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ④SUB_溶着台_板押圧無確認
CON
JMP @MR3212
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3212
AND @MR4901              ; ④SUB_溶着台_板押圧無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_溶着台_板押圧無確認完了
CON
JMP @MR3213
;板押圧溶着台_残留状態書込み
STG @MR3213
SET MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7606               ; 溶着台_板押圧有無吸着ON
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
MPS
AND= DM20032 #1          ; 溶着台板押圧有無記憶(1=有り)
SET @MR902               ; 溶着後残検出
CON
DW #0 DM20043            ; 溶着状態(1=OK)
CON
JMP @MR3214
MPP
AND= DM20032 #0          ; 溶着台板押圧有無記憶(1=有り)
RES @MR902               ; 溶着後残検出
CON
DW #1 DM20043            ; 溶着状態(1=OK)
CON
JMP @MR3214
;TASK1→2 板押圧状態通知ON
STG @MR3214
SET MR20404              ; TASK1→2 板押圧状態通知
CON
JMP @MR3215
STG @MR3215
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20405              ; TASK2→1 板押圧状態確認
ANL
RES MR20404              ; TASK1→2 板押圧状態通知
CON
JMP @MR3300
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3300
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20405              ; TASK2→1 板押圧状態確認
ANL
JMP @MR3301
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台下降
STG @MR3301
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
MPS
LDB MR4107               ; 板押圧溶着台 下降端ERR
AND R4107                ; 板押圧溶着台 下降端
ANB R4106                ; 板押圧溶着台 上昇端
ANL
JMP @MR3302
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_受取側
STG @MR3302
SET MR7203               ; 板押圧溶着台_受取側
CON
RES MR7202               ; 板押圧溶着台_溶着側
CON
MPS
LDB MR4105               ; 板押圧溶着台 受取側ERR
ANB MR4104               ; 板押圧溶着台 溶着側ERR
AND R4105                ; 板押圧溶着台 受取側
ANB R4104                ; 板押圧溶着台 溶着側
ANL
JMP @MR3303
MPP
LD MR4105                ; 板押圧溶着台 受取側ERR
OR MR4104                ; 板押圧溶着台 溶着側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;溶着後残検出分岐
STG @MR3303
MPS
ANB @MR902               ; 溶着後残検出
JMP @MR3500
MPP
AND @MR902               ; 溶着後残検出
JMP @MR3314
;搬送PP位置確認
STG @MR3314
ANB DM11055.2
TMR @7 #10               ; wait
CON
AND @T7                  ; wait
MPS
AND<.L DM11048 +35000    ; RB7 現在位置
JMP @MR3400
MPP
AND>=.L DM11048 +35000   ; RB7 現在位置
SET MR20413              ; TASK1→0 PP退避要求
CON
JMP @MR3315
;搬送PP退避待ち
STG @MR3315
MPS
LDB R41201               ; TASK1 PAUSE 要求
AND MR20414              ; TASK0→1 PP退避完了
ANL
JMP @MR3400
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;Error 111 板押圧除材要求(溶着台)
STG @MR3400
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #111 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4608 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR3401
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3401
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3402
;有無確認
STG @MR3402
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20301              ; TASK0→1 板押圧給材完了
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ④SUB_溶着台_板押圧無確認
CON
JMP @MR3403
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3403
AND @MR4901              ; ④SUB_溶着台_板押圧無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_溶着台_板押圧無確認完了
CON
JMP @MR3404
STG @MR3404
MPS
AND= DM20032 #1          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3400
MPP
AND= DM20032 #0          ; 溶着台板押圧有無記憶(1=有り)
JMP @MR3405
;TASK1→0 PP退避要求OFF
STG @MR3405
RES MR20413              ; TASK1→0 PP退避要求
CON
JMP @MR3406
;TASK0→1 PP退避完了OFF待ち
STG @MR3406
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB MR20414              ; TASK0→1 PP退避完了
ANL
RES MR20415              ; TASK1板押圧除材動作有り
CON
@DEC.S DM20040           ; 板押し圧投入数(溶着台に)
CON
JMP @MR3500
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;先頭へ
STG @MR3500
JMP @MR3005
;<h1/>Auto終了処理
STG @MR3915              ; AUTO END
RES @MR3002              ; AUTO Main1 Busy
CON
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB @MR001               ; TASK1 ERROR
ANB @MR4002              ; Main2 Busy
ANL
ZRES @MR900 @MR915       ; RBｴﾗｰ停止選択
CON
JMP LR601                ; _Grp1_Task1_Fin.STG
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000              ; AUTO Main2
SET @MR4002              ; Main2 Busy
CON
JMP @MR4003
STG @MR4003
JMP @MR4415              ; Main2 END
STG @MR4415              ; Main2 END
SET @MR4001              ; Main2 END
CON
RES @MR4002              ; Main2 Busy
CON
ENDS
;<h1/>MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1～32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5601               ; _Grp1_Task1_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
SET @MR2002              ; Mainte中
CON
JMP @MR2003
STG @MR2003
MPS
AND= DM4110 #9           ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2100
MRD
AND= DM4110 #10          ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2103
MPP
LD<> DM4110 #9           ; _Group1　ﾒﾝﾃ動作番号
AND<> DM4110 #10         ; _Group1　ﾒﾝﾃ動作番号
ANL
JMP @MR2915              ; Mainte END
STG @MR2100
JMP @MR2101
;板押圧溶着台動作
;[[給材側]]板押圧給材側へ移動します。
;[[溶着側]]板押圧溶着側へ移動します。
;[[定停止]]動作を終了します。
STG @MR2101
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #11 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #19 @DM32             ; SW1_No /SELECT_ACT
CON
DW #20 @DM33             ; SW2_No /SELECT_ACT
CON
DW #0 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task1 SELECT_ACT
CON
JMP @MR2102
STG @MR2102
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task1 SEL_ACT END
RES @MR201               ; Task1 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #1 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #2 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;溶着動作
;[[通常]]通常の溶着動作を行います。
;[[測定]]ロードセル測定モードです。
;[[定停止]]動作を終了します。
STG @MR2103
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #17 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #27 @DM32             ; SW1_No /SELECT_ACT
CON
DW #28 @DM33             ; SW2_No /SELECT_ACT
CON
DW #0 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task1 SELECT_ACT
CON
JMP @MR2104
STG @MR2104
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task1 SEL_ACT END
RES @MR201               ; Task1 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #3 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #4 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;ｽﾃｯﾌﾟor通常　か選択
STG @MR2200
MPS
MSTRT SELECT_POST #1 MyTask #0 @MR2005;自ﾀｽｸ番号
MPP
AND @MR2005
RES @MR2005
CON
JMP @MR2202
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
LDB R4212                ; 板押圧吸着下降端
AND R4213                ; 板押圧吸着上昇端
LD<=.L DM11048 +27000    ; RB7 現在位置
AND DM11055.1
ORL
ANL
AND DM11047.1            ; 原点復帰完了
AND<=.L DM11040 +500     ; RB6 現在位置
LD DM11007.1
LD<=.L DM11000 +15000    ; RB1 現在位置下位
OR>=.L DM11000 +25000    ; RB1 現在位置下位
ANL
LDB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ORL
ANL
OUT @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
LDB R4212                ; 板押圧吸着下降端
AND R4213                ; 板押圧吸着上昇端
LD<=.L DM11048 +27000    ; RB7 現在位置
AND DM11055.1
ORL
ANL
AND DM11047.1            ; 原点復帰完了
AND<=.L DM11040 +500     ; RB6 現在位置
LD DM11007.1
LD<=.L DM11000 +15000    ; RB1 現在位置下位
OR>=.L DM11000 +25000    ; RB1 現在位置下位
ANL
LDB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ORL
ANL
OUT @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17950   ; RB1 現在位置下位
AND<=.L DM11000 +18050   ; RB1 現在位置下位
OR<=.L DM11000 +15000    ; RB1 現在位置下位
OR>=.L DM11000 +23000    ; RB1 現在位置下位
ANL
AND R4104                ; 板押圧溶着台 溶着側
ANB R4105                ; 板押圧溶着台 受取側
OUT @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17950   ; RB1 現在位置下位
AND<=.L DM11000 +18050   ; RB1 現在位置下位
OR<=.L DM11000 +15000    ; RB1 現在位置下位
OR>=.L DM11000 +23000    ; RB1 現在位置下位
ANL
AND R4104                ; 板押圧溶着台 溶着側
ANB R4105                ; 板押圧溶着台 受取側
OUT @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
STG @MR2202
MPS
TMR @39 #10              ; ﾒﾝﾃ条件NG
CON
AND @T39                 ; ﾒﾝﾃ条件NG
JMP @MR2810
MPP
ANB @T39                 ; ﾒﾝﾃ条件NG
MPS
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK
ANL
JMP @MR2300
MRD
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
ANL
JMP @MR2400
MPP
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
ORL
ANL
JMP @MR2500
;<h1/> ﾒﾝﾃｺｰﾄﾞ1動作/Maintenance code 1 Operation
;板押圧溶着台下降
STG @MR2300
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
MPS
LDB MR4107               ; 板押圧溶着台 下降端ERR
ANB R4106                ; 板押圧溶着台 上昇端
AND R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR2301
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_受取側
STG @MR2301
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7203               ; 板押圧溶着台_受取側
CON
RES MR7202               ; 板押圧溶着台_溶着側
CON
MPS
LDB MR4105               ; 板押圧溶着台 受取側ERR
ANB R4104                ; 板押圧溶着台 溶着側
AND R4105                ; 板押圧溶着台 受取側
ANL
JMP @MR2302
MPP
LD MR4105                ; 板押圧溶着台 受取側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台上昇
STG @MR2302
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7204               ; 板押圧溶着台上昇
CON
RES MR7205               ; 板押圧溶着台下降
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
AND R4106                ; 板押圧溶着台 上昇端
ANB R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR2303
MPP
LD MR4106                ; 板押圧溶着台 上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;終了
STG @MR2303
JMP @MR2100
;<h1/> ﾒﾝﾃｺｰﾄﾞ2動作/Maintenance code 2 Operation
;板押圧溶着台下降
STG @MR2400
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
MPS
LDB MR4107               ; 板押圧溶着台 下降端ERR
ANB R4106                ; 板押圧溶着台 上昇端
AND R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR2401
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;板押圧溶着台_溶着側
STG @MR2401
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7202               ; 板押圧溶着台_溶着側
CON
RES MR7203               ; 板押圧溶着台_受取側
CON
MPS
LDB MR4104               ; 板押圧溶着台 溶着側ERR
AND R4104                ; 板押圧溶着台 溶着側
ANB R4105                ; 板押圧溶着台 受取側
ANL
JMP @MR2402
MPP
LD MR4104                ; 板押圧溶着台 溶着側ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;終了
STG @MR2402
JMP @MR2100
;<h1/> ﾒﾝﾃｺｰﾄﾞ3、4動作/Maintenance code 3、4 Operation
STG @MR2500
MPS
AND R35511               ; RB6原点復帰済
JMP @MR2502
MPP
ANB R35511               ; RB6原点復帰済
SET @MR4600              ; ②SUB_RB6/Home
CON
JMP @MR2501
STG @MR2501
AND @MR4601              ; ②SUB_RB6/Home完了
RES @MR4601              ; ②SUB_RB6/Home完了
CON
JMP @MR2502
;ﾌｨﾙﾑ搬送 位置分岐
STG @MR2502
MPS
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
MPS
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17950   ; RB1 現在位置下位
AND<=.L DM11000 +18050   ; RB1 現在位置下位
ANL
JMP @MR2503
MPP
LD<> EM1301 #3           ; RB1Now Pos
LD<=.L DM11000 +15850    ; RB1 現在位置下位
OR>=.L DM11000 +200      ; RB1 現在位置下位
ANL
ANL
JMP @MR2504
MPP
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2504
;ﾌｨﾙﾑ搬送 親&子 下降
STG @MR2503
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR2504
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
OR MR4202                ; ﾌｨﾙﾑ搬送 子 下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;吸着治具吸着OFF
STG @MR2504
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
TMS @8 DM7022            ; 板押圧溶着_吸着OFFウェイト  装置基礎ﾃﾞｰﾀ12
CON
AND @T8                  ; 板押圧溶着_吸着OFFウェイト
JMP @MR2505
;板押圧溶着台上昇
STG @MR2505
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7204               ; 板押圧溶着台上昇
CON
RES MR7205               ; 板押圧溶着台下降
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
AND R4106                ; 板押圧溶着台 上昇端
ANB R4107                ; 板押圧溶着台 下降端
ANL
JMP @MR2506
MPP
LD MR4106                ; 板押圧溶着台 上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;溶着
STG @MR2506
MPS
ANB R41201               ; TASK1 PAUSE 要求
SET @MR5300              ; ⑤SUB_板押圧溶着動作
CON
JMP @MR2507
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2507
AND @MR5301              ; ⑤SUB_板押圧溶着動作完了
RES @MR5301              ; ⑤SUB_板押圧溶着動作完了
CON
JMP @MR2508
STG @MR2508
RES @MR901               ; 溶着不良
CON
MPS
ANB @MR900               ; RBｴﾗｰ停止選択
JMP @MR2510
MPP
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR2509
STG @MR2509
RES @MR900               ; RBｴﾗｰ停止選択
CON
JMP @MR2510
;ﾌｨﾙﾑ搬送 位置分岐
STG @MR2510
MPS
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
MPS
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17950   ; RB1 現在位置下位
AND<=.L DM11000 +18050   ; RB1 現在位置下位
ANL
JMP @MR2511
MPP
LD<> EM1301 #3           ; RB1Now Pos
AND>=.L DM11000 +0       ; RB1 現在位置下位
AND<=.L DM11000 +29000   ; RB1 現在位置下位
ANL
JMP @MR2515
MPP
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2515
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR2511
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR2515
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;終了
STG @MR2515
JMP @MR2914
;<h1/> ﾒﾝﾃﾅﾝｽｲﾝﾀｰﾛｯｸ
STG @MR2810
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $3000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #52 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR2811
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2811
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
MPS
AND<> @DM10 #3           ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2003
MPP
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
JMP @MR2914
;Maintenance 終了
STG @MR2914
MCALL MODE_INDI #2
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
DW #211 DM3008           ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
MPS
LD R41201                ; TASK1 PAUSE 要求
ANB @MR001               ; TASK1 ERROR
ANL
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41201               ; TASK1 PAUSE 要求
RES @MR2002              ; Mainte中
CON
JMP LR601                ; _Grp1_Task1_Fin.STG
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/> ①SUB_RB6/Move
STG @MR4500              ; ①SUB_RB6/Move
SET @MR4502              ; ①SUB_RB6/Move中
CON
JMP @MR4503
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4503
MPS
BSET DM11247 #3          ; RB6 制御信号
CON
BANB DM11047 #3          ; RB6 状態信号
BSET DM11247 #4          ; RB6 制御信号
CON
BAND DM11047 #4          ; RB6 状態信号
BRES DM11247 #3          ; RB6 制御信号
CON
JMP @MR4504
MPP
TMR @0 #100              ; RB6Moveｴﾗｰ
CON
AND @T0                  ; RB6Moveｴﾗｰ
BRES DM11247 #3          ; RB6 制御信号
CON
BRES DM11247 #4          ; RB6 制御信号
CON
JMP @MR4714
STG @MR4504
SET R35500               ; RB6 MOVE
CON
JMP @MR4505
STG @MR4505
AND R35501               ; RB6 MOVE END
RES R35501               ; RB6 MOVE END
CON
JMP @MR4506
STG @MR4506
MPS
ANB R35503               ; RB6 Alarm
JMP @MR4507
MPP
AND R35503               ; RB6 Alarm
RES R35503               ; RB6 Alarm
CON
JMP @MR4714
;END
STG @MR4507
SET @MR4501              ; ①SUB_RB6/Move完了
CON
RES @MR4502              ; ①SUB_RB6/Move中
CON
ENDS
;<h1/> ②SUB_RB6/Home
STG @MR4600              ; ②SUB_RB6/Home
DW #0 EM1311             ; RB6Now Pos
CON
SET @MR4602              ; ②SUB_RB6/Home中
CON
JMP @MR4603
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4603
MPS
BSET DM11247 #3          ; RB6 制御信号
CON
BANB DM11047 #3          ; RB6 状態信号
BSET DM11247 #4          ; RB6 制御信号
CON
BAND DM11047 #4          ; RB6 状態信号
BRES DM11247 #3          ; RB6 制御信号
CON
JMP @MR4604
MPP
TMR @1 #20               ; RB6Homeｴﾗｰ
CON
AND @T1                  ; RB6Homeｴﾗｰ
BRES DM11247 #3          ; RB6 制御信号
CON
BRES DM11247 #4          ; RB6 制御信号
CON
JMP @MR4714
STG @MR4604
MPS
LD CR2003                ; 常時OFF
BAND DM11047 #1          ; RB6 状態信号
ANL
JMP @MR4607
MPP
BLDB DM11047 #1          ; RB6 状態信号
OR CR2002                ; 常時ON
ANL
SET R35508               ; RB6 HOME
CON
JMP @MR4605
STG @MR4605
AND R35509               ; RB6 HOME END
RES R35509               ; RB6 HOME END
CON
JMP @MR4606
STG @MR4606
MPS
ANB R35503               ; RB6 Alarm
JMP @MR4607
MPP
AND R35503               ; RB6 Alarm
RES R35503               ; RB6 Alarm
CON
JMP @MR4714
;END
STG @MR4607
SET @MR4601              ; ②SUB_RB6/Home完了
CON
RES @MR4602              ; ②SUB_RB6/Home中
CON
ENDS
;<h1/> ③SUB_RB6/Push
STG @MR4700              ; ③SUB_RB6/Push
SET @MR4702              ; ③SUB_RB6/Push中
CON
JMP @MR4703
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4703
MPS
BSET DM11247 #3          ; RB6 制御信号
CON
BANB DM11047 #3          ; RB6 状態信号
BSET DM11247 #4          ; RB6 制御信号
CON
BAND DM11047 #4          ; RB6 状態信号
BRES DM11247 #3          ; RB6 制御信号
CON
JMP @MR4704
MPP
TMR @2 #20               ; RB6Pushｴﾗｰ
CON
AND @T2                  ; RB6Pushｴﾗｰ
BRES DM11247 #3          ; RB6 制御信号
CON
BRES DM11247 #4          ; RB6 制御信号
CON
JMP @MR4714
STG @MR4704
SET R35504               ; RB6 PUSH
CON
JMP @MR4705
STG @MR4705
AND R35505               ; RB6 PUSH END
RES R35505               ; RB6 PUSH END
CON
JMP @MR4706
STG @MR4706
MPS
ANB R35503               ; RB6 Alarm
JMP @MR4707
MPP
AND R35503               ; RB6 Alarm
MPS
ANB DM11047.5            ; 押付動作空振り
RES R35503               ; RB6 Alarm
CON
JMP @MR4714
MPP
AND DM11047.5            ; 押付動作空振り
RES R35503               ; RB6 Alarm
CON
JMP @MR4712
;END
STG @MR4707
SET @MR4701              ; ③SUB_RB6/Push完了
CON
RES @MR4702              ; ③SUB_RB6/Push中
CON
ENDS
;Error 6 RB6動作異常
STG @MR4712
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1300 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #204 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR4713
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11046              ; RB6 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4713
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
JMP @MR4703
MPP
AND @MR106               ; SW2
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
SET @MR900               ; RBｴﾗｰ停止選択
CON
JMP @MR4707
;Error 6 RB6動作異常
STG @MR4714
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #6 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR4715
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11046              ; RB6 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4715
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR4602              ; ②SUB_RB6/Home中
JMP @MR4603
MRD
AND @MR4502              ; ①SUB_RB6/Move中
JMP @MR4503
MPP
AND @MR4702              ; ③SUB_RB6/Push中
SET @MR901               ; 溶着不良
CON
SET MR7301               ; (板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7300               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
JMP @MR4707
;<h1/> ④-1SUB_溶着台_板押圧有確認
STG @MR4800              ; ④SUB_溶着台_板押圧有確認
SET @MR4802              ; ④SUB_溶着台_板押圧有確認中
CON
JMP @MR4803
;溶着台吸着ON
STG @MR4803
SET MR7606               ; 溶着台_板押圧有無吸着ON
CON
RES MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
JMP @MR4804
;吸着圧力確認
LD @MR4804
TMR @3 #5                ; wait
STG @MR4804
MPS
AND R4608                ; 溶着台_板押圧有無OUT1
JMP @MR4805
MPP
LDB R4608                ; 溶着台_板押圧有無OUT1
AND @T3                  ; wait
ANL
JMP @MR4806
;有無状態書込み
STG @MR4805
DW #1 DM20032            ; 溶着台板押圧有無記憶(1=有り)
CON
JMP @MR4815
STG @MR4806
DW #0 DM20032            ; 溶着台板押圧有無記憶(1=有り)
CON
JMP @MR4815
;Error 110 吸着圧力異常(板押圧溶着台)
STG @MR4807
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #110 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4608 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR4808
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4808
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR4804
;END
STG @MR4815
SET @MR4801              ; ④SUB_溶着台_板押圧有確認完了
CON
RES @MR4802              ; ④SUB_溶着台_板押圧有確認中
CON
ENDS
;<h1/> ④-2SUB_溶着台_板押圧無確認
STG @MR4900              ; ④SUB_溶着台_板押圧無確認
SET @MR4902              ; ④SUB_溶着台_板押圧無確認中
CON
JMP @MR4903
;溶着台吸着ON
STG @MR4903
SET MR7606               ; 溶着台_板押圧有無吸着ON
CON
RES MR7607               ; 溶着台_板押圧有無吸着OFF
CON
RES MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
JMP @MR4904
;吸着圧力確認
LD @MR4904
TMR @12 #5               ; wait
STG @MR4904
MPS
LDB R4609                ; 溶着台_板押圧有無OUT2
AND @T12                 ; wait
ANL
JMP @MR4905
MPP
AND R4609                ; 溶着台_板押圧有無OUT2
TMR @11 #5
CON
AND @T11
JMP @MR4906
;有無状態書込み
STG @MR4905
DW #1 DM20032            ; 溶着台板押圧有無記憶(1=有り)
CON
JMP @MR4915
STG @MR4906
DW #0 DM20032            ; 溶着台板押圧有無記憶(1=有り)
CON
JMP @MR4915
;Error 110 吸着圧力異常(板押圧溶着台)
STG @MR4907
ANB R39900               ; RB動作中
MPS
LDB R41201               ; TASK1 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #110 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4608 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task1 ERROR
CON
JMP @MR4908
MPP
AND R41201               ; TASK1 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4908
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task1 ERROR_End
RES @MR101               ; Task1 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR4904
;END
STG @MR4915
SET @MR4901              ; ④SUB_溶着台_板押圧無確認完了
CON
RES @MR4902              ; ④SUB_溶着台_板押圧無確認中
CON
ENDS
;<h1/> ⑤SUB_板押圧溶着動作
STG @MR5300              ; ⑤SUB_板押圧溶着動作
SET MR20800              ; 調査用 板押圧溶着中フラグ
CON
SET @MR5302              ; ⑤SUB_板押圧溶着動作中
CON
JMP @MR5303
LD MR20800               ; 調査用 板押圧溶着中フラグ
TMS @21 #20000           ; 溶着時間管理用
LD @T21                  ; 溶着時間管理用
SET MR20810              ; 板押圧溶着時無応答
;板押圧溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON
STG @MR5303
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7215               ; (板押圧溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙON)
CON
RES MR7214               ; 板押圧溶着ﾍｯﾄﾞ上下自重ｷｬﾝｾﾙOFF
CON
TMR @9 #5                ; wait
CON
AND @T9                  ; wait
JMP @MR5304
;ｴｽｹｰﾌﾟ下降
STG @MR5304
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7300               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
RES MR7301               ; (板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
MPS
LDB MR4206               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端ERR
AND R4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
ANB R4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANL
JMP @MR5305
MPP
LD MR4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB6 板押圧溶着 移動 溶着前位置
STG @MR5305
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
DW #2 EM1310             ; RB6Target Pos
CON
JMP @MR5306
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #2 EM1310             ; RB6Target Pos
CON
JMP @MR5306
MPP
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #4 EM1310             ; RB6Target Pos
CON
JMP @MR5306
STG @MR5306
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET @MR4500              ; ①SUB_RB6/Move
CON
JMP @MR5307
STG @MR5307
AND @MR4501              ; ①SUB_RB6/Move完了
RES @MR4501              ; ①SUB_RB6/Move完了
CON
JMP @MR5400
;RB6 板押圧溶着 移動 溶着位置
STG @MR5400
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
DW #3 EM1310             ; RB6Target Pos
CON
JMP @MR5401
MPP
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR5405
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
MPS
AND= @DM10 #3            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #3 EM1310             ; RB6Target Pos
CON
JMP @MR5401
MPP
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #5 EM1310             ; RB6Target Pos
CON
JMP @MR5401
STG @MR5401
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET @MR4700              ; ③SUB_RB6/Push
CON
JMP @MR5402
STG @MR5402
AND @MR4701              ; ③SUB_RB6/Push完了
RES @MR4701              ; ③SUB_RB6/Push完了
CON
JMP @MR5403
STG @MR5403
MPS
ANB @MR900               ; RBｴﾗｰ停止選択
JMP @MR5405
MPP
AND @MR900               ; RBｴﾗｰ停止選択
JMP @MR5406
;溶着時間待機
STG @MR5405
TMS @6 DM7002            ; 板押圧溶着時間  装置基礎ﾃﾞｰﾀ2
CON
AND @T6                  ; 板押圧溶着時間
JMP @MR5406
;RB6 板押圧溶着 移動 待機位置
STG @MR5406
DW #1 EM1310             ; RB6Target Pos
CON
SET @MR4500              ; ①SUB_RB6/Move
CON
JMP @MR5407
STG @MR5407
AND @MR4501              ; ①SUB_RB6/Move完了
RES @MR4501              ; ①SUB_RB6/Move完了
CON
JMP @MR5408
;ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇
STG @MR5408
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7301               ; (板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇)
CON
RES MR7300               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降
CON
MPS
LDB MR4207               ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANB R4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
ANL
JMP @MR5415
MPP
LD MR4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端ERR
AND R41201               ; TASK1 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB6 復帰
STG @MR5409
SET @MR4600              ; ②SUB_RB6/Home
CON
JMP @MR5410
STG @MR5410
AND @MR4601              ; ②SUB_RB6/Home完了
RES @MR4601              ; ②SUB_RB6/Home完了
CON
JMP @MR5415
;END
STG @MR5415
RES MR20800              ; 調査用 板押圧溶着中フラグ
CON
SET @MR5301              ; ⑤SUB_板押圧溶着動作完了
CON
RES @MR5302              ; ⑤SUB_板押圧溶着動作中
CON
ENDS
;<h1/>-----------------------------------------------------------
;<h1/>*ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Task1 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
DW MyTask @DM0           ; 自ﾀｽｸ番号  TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task1 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task1 ERROR Busy
CON
SET @MR101               ; Task1 ERROR_End
CON
ENDS
;<h1/>*Select_Y_N 
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task1 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task1 Y/N
CON
DW #0 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task1 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task1 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task1 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task1 Y_N Busy
CON
SET @MR301               ; Task1 Y/N END
CON
ENDS
;<h1/>*TIMEUP ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task1 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #0 @DM40
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task1 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task1 TIMEUP Busy
CON
SET @MR401               ; Task1 TIMEUP_END
CON
ENDS
;<h1/>*Select_ACT 
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task1 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #0 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT  TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task1 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task1 SEL_ACT Busy
CON
SET @MR201               ; Task1 SEL_ACT END
CON
ENDS
;<h1/>※機能Macro呼出し見本- 削除して下さい。-------------------------------------
;<h1/>※Error:記述見本
;ERR163 "****Error"
;<h1/>※SELECT_ACT　:記述見本
;画面番号33をブザー有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
;<h1/>※ SELECT_Y_N　記述見本
;//*Select_Y_N
;<h1/>HALT
LD R41201                ; TASK1 PAUSE 要求
AND @MR1900              ; Main1 HALT許可
LD @MR1901               ; Main2 HALT許可
ORB @MR4002              ; Main2 Busy
ANL
TMR @40 #5               ; HALT許可 遅延
CON
AND @T40                 ; HALT許可 遅延
SET R42601               ; Grp1_Task1_ﾎﾟｰｽﾞ許可
LD R42601                ; Grp1_Task1_ﾎﾟｰｽﾞ許可
ORB R41201               ; TASK1 PAUSE 要求
ANB @MR001               ; TASK1 ERROR
RES @MR1900              ; Main1 HALT許可
CON
RES @MR1901              ; Main2 HALT許可
END
ENDH
