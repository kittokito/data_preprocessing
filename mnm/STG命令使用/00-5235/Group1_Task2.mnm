DEVICE:53
;MODULE:Group1_Task2
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Main-Module
;
;-----------------------------------------
;ModuleName	:	Group1_Task2
;ModuleType	:	Main Module
;Line		:	
;Cell		:	
;Function	:	フィルム搬送
;-----------------------------------------
;<<Task LocalDevice>>
;/*項目			/*割付ｴﾘｱ				/*備考
;---------------------------------------------------------------------			
;Emergency		@MR000～@MR015			Emergency処理時RESET禁止ｴﾘｱ
;Free			@MR100～@MR915			ﾕｰｻﾞｰﾌﾘｰｴﾘｱ
;HOME			@MR1000～@MR1515		HOME動作時使用ｴﾘｱ
;MAINTENANCE		@MR2000～@MR2915		MAINTE動作時使用ｴﾘｱ
;AUTO(Main1)		@MR3000～@MR3915		AUTO(Main1)動作時使用ｴﾘｱ
;	(Main2)		@MR4000～@MR4415		AUTO(Main2)動作時使用ｴﾘｱ
;SubRoutine		@MR4500～@MR6415		ｻﾌﾞﾙｰﾁﾝ共通動作使用ｴﾘｱ　※状況により増設してください。
;----------------------------------------------------------------------
;<h1/>Device_Init/ﾃﾞﾊﾞｲｽ初期化
;[内容]
;・非常停止、優先ｴﾗｰ発生時に初期化したいﾃﾞﾊﾞｲｽを指定して下さい
;※本Taskで使用するﾛｰｶﾙﾃﾞﾊﾞｲｽなど
;※STG～JMPにて使用しているﾃﾞﾊﾞｲｽは必須
LDP R46104               ; _非常停止中　ﾓｰﾄﾞﾌﾗｸﾞ
ZRES @MR100 @MR6415      ; Task2 ERROR
LD= DM60000 MyTask       ; TaskNo /ERROR_DISP  自ﾀｽｸ番号
AND R46208               ; _Group1　ｴﾗｰ発生中
OUT @MR001               ; TASK2　ERROR
;<h1/>Task_Monitor/ﾀｽｸﾓﾆﾀｰ
LD CR2002                ; 常時ON
FLIK #50 #50 @MR000
;ON STG Main1
;TYPE EM616.U,EM617.U,@MR000.U,@MR3000.U
;
;FOR EM616 = EM616 TO 160 STEP 16
;	IF @MR3000:EM616 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;	
;IF EM616 < 160 THEN
;	EM617 = (EM616 / 16) * 100 + DMX(@MR3000:EM616) + #3000
;END IF		
;		
;EM616 = EM616 + 16		
;IF EM616 > 160 THEN		
;	EM616 = 0		
;END IF
LDP @MR000
NCJ #1000
;TYPE EM616.U,EM617.U,@MR000.U,@MR3000.U
;
;FOR EM616 = EM616 TO 160 STEP 16
;
LD CR2002                ; 常時ON
MOV EM616 EM616          ; Task2 Main1@MR  Task2 Main1@MR
LABEL #2000
LD> EM616 #160           ; Task2 Main1@MR
CJ #2001
;	IF @MR3000:EM616 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
STA.L Z12
LD<> @MR3000:Z12 #0      ; AUTO Main1
NCJ #2002
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2003
;	END IF	
;
LABEL #2002
;NEXT
;
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
ADD #16
CON
STA EM616                ; Task2 Main1@MR
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2003
LABEL #2001
;IF EM616 < 160 THEN
;
LD< EM616 #160           ; Task2 Main1@MR
NCJ #2004
;	EM617 = (EM616 / 16) * 100 + DMX(@MR3000:EM616) + #3000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR3000:Z12          ; AUTO Main1
CON
DMX
CON
STA @VM0
CON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM1
CON
LDA @VM0
CON
EXT
CON
ADD.L @VM1
CON
ADD.L +3000
CON
STA EM617                ; Task2 Main1@MR
;END IF		
;
LABEL #2004
;EM616 = EM616 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM616                ; Task2 Main1@MR
CON
EXT
CON
ADD.L +16
CON
STA EM616                ; Task2 Main1@MR
;IF EM616 > 160 THEN		
;
LD> EM616 #160           ; Task2 Main1@MR
NCJ #2005
;	EM616 = 0		
;
LD CR2002                ; 常時ON
MOV #0 EM616             ; Task2 Main1@MR
;END IF
LABEL #2005
LABEL #1000
;
;ON STG Main2
;TYPE EM618.U,EM619.U,@MR4000.U
;
;FOR EM618 = EM618 TO 80 STEP 16
;	IF @MR4000:EM618 <> 0 THEN
;		BREAK
;	END IF	
;NEXT	
;
;IF EM618 < 80 THEN
;	EM619 = (EM618 / 16) * 100 + DMX(@MR4000:EM618) + #4000
;END IF
;
;EM618 = EM618 + 16		
;
;IF EM618 > 80 THEN
;	EM618 = 0	
;END IF
LDP @MR000
NCJ #1001
;TYPE EM618.U,EM619.U,@MR4000.U
;
;FOR EM618 = EM618 TO 80 STEP 16
;
LD CR2002                ; 常時ON
MOV EM618 EM618          ; Task2 Main2@MR  Task2 Main2@MR
LABEL #2006
LD> EM618 #80            ; Task2 Main2@MR
CJ #2007
;	IF @MR4000:EM618 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4000:Z12 #0      ; AUTO Main2
NCJ #2008
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2009
;	END IF	
;
LABEL #2008
;NEXT	
;
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
ADD #16
CON
STA EM618                ; Task2 Main2@MR
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2009
LABEL #2007
;IF EM618 < 80 THEN
;
LD< EM618 #80            ; Task2 Main2@MR
NCJ #2010
;	EM619 = (EM618 / 16) * 100 + DMX(@MR4000:EM618) + #4000
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4000:Z12          ; AUTO Main2
CON
DMX
CON
STA @VM3
CON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM4
CON
LDA @VM3
CON
EXT
CON
ADD.L @VM4
CON
ADD.L +4000
CON
STA EM619                ; Task2 Main2@MR
;END IF
;
LABEL #2010
;EM618 = EM618 + 16		
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM618                ; Task2 Main2@MR
CON
EXT
CON
ADD.L +16
CON
STA EM618                ; Task2 Main2@MR
;IF EM618 > 80 THEN
;
LD> EM618 #80            ; Task2 Main2@MR
NCJ #2011
;	EM618 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM618             ; Task2 Main2@MR
;END IF
LABEL #2011
LABEL #1001
;
;ON STG SubRoutine
;TYPE EM620.U,EM621.U,@MR4500.U
;	
;FOR EM620 = EM620 TO 320 STEP 16
;	IF @MR4500:EM620 <> 0 THEN
;		BREAK
;	END IF	
;NEXT
;		
;IF EM620 < 320 THEN
;	EM621 = (EM620 / 16) * 100 + DMX(@MR4500:EM620) + #4500
;END IF
;		
;EM620 = EM620 + 16	
;
;IF EM620 > 320 THEN
;   EM620 = 0	
;END IF
LDP @MR000
NCJ #1002
;TYPE EM620.U,EM621.U,@MR4500.U
;
;FOR EM620 = EM620 TO 320 STEP 16
;
LD CR2002                ; 常時ON
MOV EM620 EM620          ; Task2 Sub@MR  Task2 Sub@MR
LABEL #2012
LD> EM620 #320           ; Task2 Sub@MR
CJ #2013
;	IF @MR4500:EM620 <> 0 THEN
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
STA.L Z12
LD<> @MR4500:Z12 #0      ; ①SUB_RB1/Move
NCJ #2014
;		BREAK
;
LD CR2002                ; 常時ON
CJ #2015
;	END IF	
;
LABEL #2014
;NEXT
;
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
ADD #16
CON
STA EM620                ; Task2 Sub@MR
LDB CR2009               ; 演算結果が負
CJ #2012
LABEL #2015
LABEL #2013
;IF EM620 < 320 THEN
;
LD< EM620 #320           ; Task2 Sub@MR
NCJ #2016
;	EM621 = (EM620 / 16) * 100 + DMX(@MR4500:EM620) + #4500
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
STA.L Z12
CON
LDA @MR4500:Z12          ; ①SUB_RB1/Move
CON
DMX
CON
STA @VM6
CON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
EXT.L
CON
DIV.L +16
CON
MUL.L +100
CON
STA.L @VM7
CON
LDA @VM6
CON
EXT
CON
ADD.L @VM7
CON
ADD.L +4500
CON
STA EM621                ; Task2 Sub@MR
;END IF
;
LABEL #2016
;EM620 = EM620 + 16	
;
;;Warning[1103]: "=": (符号付き32ビット整数型->符号無し16ビット整数型) 代入によりデータが欠落する可能性があります。
LD CR2002                ; 常時ON
LDA EM620                ; Task2 Sub@MR
CON
EXT
CON
ADD.L +16
CON
STA EM620                ; Task2 Sub@MR
;IF EM620 > 320 THEN
;
LD> EM620 #320           ; Task2 Sub@MR
NCJ #2017
;   EM620 = 0	
;
LD CR2002                ; 常時ON
MOV #0 EM620             ; Task2 Sub@MR
;END IF
LABEL #2017
LABEL #1002
;
;<h1/>Task_Init/ﾀｽｸ初期化
;[本STG内容]
;・本Task起動時に必要な初期化処理を記述して下さい
;・起動Taskの全Init処理終了後、Task_StartのSTGが起動します
STG LR802                ; _Grp1_Task2_Init.STG
ENDS
;<h1/>Task_Start/ﾀｽｸ開始
;[本STG内容]
;・Task起動後、以下運転ﾓｰﾄﾞに従い、各STGにJMPします
;【HOME】	→	LR5200
;【AUTO】	→	LR5400
;【MAINTE】	→	LR5600
;・本STGは追記、修正不要です
STG LR402                ; _Grp1_Task2_Start.STG
MPS
AND R46101               ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5202               ; _Grp1_Task2_HOME.STG
MRD
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5402               ; _Grp1_Task2_AUTO.STG
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP LR5602               ; _Grp1_Task2_MAINTE.STG
;<h1/>Task_Finish/ﾀｽｸ終了
;[本STG内容]
;・各Taskの終了STGになります
;・運転ﾓｰﾄﾞに係わらず終了時は本STGを経由して終了して下さい
;・本STGは追記、修正不要です
STG LR602                ; _Grp1_Task2_Fin.STG
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
RES R42602               ; Grp1_Task2_ﾎﾟｰｽﾞ許可
CON
RES R41002               ; Grp1_Task2_起動中ﾌﾗｸﾞ
CON
ENDS
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>HOME/原点復帰
;[本STG内容]
;・STG @MR1000の続きから各Taskの原点復帰動作を記述する
;・動作終了時は@MR1515にJMPする事
STG LR5202               ; _Grp1_Task2_HOME.STG
JMP @MR1000              ; HOME
STG @MR1000              ; HOME
RES MR20002              ; TASK2復帰完了
CON
SET @MR1002              ; Home中
CON
JMP @MR1003
;RB1ﾌｨﾙﾑ搬送復帰条件待ち
LD MR20200               ; TASK1→2復帰許可
AND MR20201              ; TASK3→2復帰許可
AND MR20202              ; TASK5→2復帰許可
AND MR20203              ; TASK6→2復帰許可
OUT @MR002               ; RB1ﾌｨﾙﾑ搬送復帰OK
STG @MR1003
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
AND @MR002               ; RB1ﾌｨﾙﾑ搬送復帰OK
JMP @MR1200
MPP
ANB @MR002               ; RB1ﾌｨﾙﾑ搬送復帰OK
MPS
LD MR20204               ; TASK6→2正方向退避要求
ANB MR20205              ; TASK6→2負方向退避要求
ANL
JMP @MR1100
MPP
LDB MR20204              ; TASK6→2正方向退避要求
AND MR20205              ; TASK6→2負方向退避要求
ANL
JMP @MR1101
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB10ﾌｨﾙﾑ回収上下の干渉域に居る時
STG @MR1100
AND MR20204              ; TASK6→2正方向退避要求
LDA.L DM11000            ; RB1 現在位置下位
CON
ADD #50
CON
STA.L EM10031            ; RB1 P6 POS(HI)
CON
JMP @MR1102
STG @MR1101
AND MR20205              ; TASK6→2負方向退避要求
LDA.L DM11000            ; RB1 現在位置下位
CON
SUB #50
CON
STA.L EM10031            ; RB1 P6 POS(HI)
CON
JMP @MR1102
;RB1ﾌｨﾙﾑ搬送 移動 退避位置
STG @MR1102
DW #6 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR1103
STG @MR1103
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR1104
;RB1ﾌｨﾙﾑ搬送 退避完了
STG @MR1104
SET MR20206              ; TASK2→6退避完了
CON
JMP @MR1105
STG @MR1105
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20204              ; TASK6→2正方向退避要求
ANB MR20205              ; TASK6→2負方向退避要求
ANL
RES MR20206              ; TASK2→6退避完了
CON
JMP @MR1106
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> RB1ﾌｨﾙﾑ搬送 復帰へ
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR1200
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR1201
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;RB1ﾌｨﾙﾑ搬送 座標確認
;※0以下のときJOGで正方向に移動してから復帰する。
;(ｹｰﾌﾞﾙのねじれ対策)
STG @MR1201
MPS
AND>=.L DM11000 +0       ; RB1 現在位置下位
JMP @MR1300
MPP
AND<.L DM11000 +0        ; RB1 現在位置下位
JMP @MR1202
;RB1ﾌｨﾙﾑ搬送 移動 退避位置
STG @MR1202
LDA.L DM11000            ; RB1 現在位置下位
CON
ADD #50
CON
STA.L EM10031            ; RB1 P6 POS(HI)
CON
JMP @MR1203
STG @MR1203
DW #6 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR1204
STG @MR1204
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR1201
;RB1ﾌｨﾙﾑ搬送 原点復帰
STG @MR1300
SET @MR4600              ; ②SUB_RB1/Home
CON
JMP @MR1301
STG @MR1301
AND @MR4601              ; ②SUB_RB1/Home完了
RES @MR4601              ; ②SUB_RB1/Home完了
CON
JMP @MR1302
;RB1ﾌｨﾙﾑ搬送 移動 待機位置
STG @MR1302
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR1303
STG @MR1303
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR1304
;ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有無確認
STG @MR1304
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認
CON
JMP @MR1305
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1305
AND @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
CON
JMP @MR1306
STG @MR1306
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR1307
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR1400
;RB1ﾌｨﾙﾑ搬送 移動 ﾌｨﾙﾑ除材位置
STG @MR1307
DW #7 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR1308
STG @MR1308
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR1309
;ERR122 フィルム除材要求(RB1フィルム搬送)
STG @MR1309
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #122 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR1310
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR1310
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR1304
;吸着治具吸着OFF
STG @MR1400
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR1401
;RB1ﾌｨﾙﾑ搬送 移動 待機位置
STG @MR1401
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR1402
STG @MR1402
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR1403
STG @MR1403
JMP @MR1515
;終了
STG @MR1515
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
SET MR20002              ; TASK2復帰完了
CON
RES @MR1002              ; Home中
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>AUTO/自動動作
STG LR5402               ; _Grp1_Task2_AUTO.STG
RES MR20602              ; Task2 ｽﾀｰﾄﾌﾗｸﾞ
CON
JMP @MR3000              ; AUTO Main1
;<h1/>Auto-Main1/Autoﾒｲﾝﾙｰﾁﾝ1
;[本STG内容]
;・各TaskのAUTO動作を記述して下さい
;・動作ﾓｰﾄﾞは「AUTOAC」に格納されています(1～32)
;・@MR3000:AUTO_Main1開始、@MR3001:AUTO_Main1完了、@MR3002:AUTO_Main1動作中
STG @MR3000              ; AUTO Main1
MPS
ANB R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
MPS
ANB R57302               ; Task2 停止要求
SET @MR3002              ; AUTO Main1 Busy
CON
JMP @MR3003
MPP
AND R57302               ; Task2 停止要求
JMP @MR3915              ; AUTO END
MPP
AND R47800               ; _Group1　ﾒﾝﾃ動作定停止移行中
JMP @MR3915              ; AUTO END
;ｽﾀｰﾄﾌﾗｸﾞ待ち
STG @MR3003
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
LD R57302                ; Task2 停止要求
ANB R41003               ; _Grp1_Task3_起動中ﾌﾗｸﾞ
ANL
JMP @MR3915              ; AUTO END
MPP
LDB R57302               ; Task2 停止要求
OR R41003                ; _Grp1_Task3_起動中ﾌﾗｸﾞ
AND MR20602              ; Task2 ｽﾀｰﾄﾌﾗｸﾞ
ANL
JMP @MR3004
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;TASK5→2 フィルム受取要求 待ち
STG @MR3004
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20306              ; TASK5→2 ﾌｨﾙﾑ受取要求
ANL
SET MR20307              ; TASK2→5 ﾌｨﾙﾑ受取中
CON
JMP @MR3005
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;フィルム受取位置へ移動
STG @MR3005
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20306              ; TASK5→2 ﾌｨﾙﾑ受取要求
ANB MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
ANL
DW #2 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3006
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3006
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3007
;ﾌｨﾙﾑ搬送 親&子 下降
STG @MR3007
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR3008
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
OR MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4202                ; ﾌｨﾙﾑ搬送 子 下降端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;吸着治具吸着ON
;ﾌｨﾙﾑｶｯﾄ台真空OFF
;不良ﾌｨﾙﾑ検出真空OFF
STG @MR3008
SET MR7600               ; 吸着治具吸着ON
CON
RES MR7601               ; 吸着治具吸着OFF
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
SET MR7704               ; ﾌｨﾙﾑｶｯﾄ台吸着OFF
CON
RES MR7703               ; ﾌｨﾙﾑｶｯﾄ台吸着ON
CON
RES MR7705               ; ﾌｨﾙﾑｶｯﾄ台真空破壊ON
CON
SET MR7710               ; 不良ﾌｨﾙﾑ検出吸着OFF
CON
RES MR7709               ; 不良ﾌｨﾙﾑ検出吸着ON
CON
RES MR7711               ; 不良ﾌｨﾙﾑ検出真空破壊ON
CON
TMR @4 #5                ; wait
CON
AND @T4                  ; wait
JMP @MR3011
;ﾌｨﾙﾑｶｯﾄ台吸着破壊
;不良ﾌｨﾙﾑ検出吸着破壊
STG @MR3011
SET MR7705               ; ﾌｨﾙﾑｶｯﾄ台真空破壊ON
CON
RES MR7703               ; ﾌｨﾙﾑｶｯﾄ台吸着ON
CON
SET MR7704               ; ﾌｨﾙﾑｶｯﾄ台吸着OFF
CON
SET MR7711               ; 不良ﾌｨﾙﾑ検出真空破壊ON
CON
RES MR7709               ; 不良ﾌｨﾙﾑ検出吸着ON
CON
SET MR7710               ; 不良ﾌｨﾙﾑ検出吸着OFF
CON
TMR @12 #10              ; wait
CON
AND @T12                 ; wait
JMP @MR3013
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR3013
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR3015
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;有無確認
STG @MR3015
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
CON
JMP @MR3100
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3100
AND @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
JMP @MR3101
STG @MR3101
MPS
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3200
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2302
MPP
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3200
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES LR10003              ; 切出しフィルム有り
CON
JMP @MR2302
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR3102
;ERR120 ﾌｨﾙﾑ吸着失敗
STG @MR3102
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7240 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #120 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3103
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3103
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3015
MRD
AND @MR106               ; SW2
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR3007
MPP
AND @MR107               ; SW3
JMP @MR3104
STG @MR3104
MPS
AND R4605                ; 吸着治具真空OUT2
@DEC.S DM20042           ; フィルム投入数(吸着冶具に)
CON
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR3105
MPP
ANB R4605                ; 吸着治具真空OUT2
JMP @MR3102
;RB1フィルム搬送 移動 待機位置
STG @MR3105
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3106
STG @MR3106
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3107
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
RES LR10003              ; 切出しフィルム有り
CON
JMP @MR2302
;TASK2→5 フィルム受取中ﾘｾｯﾄ
STG @MR3107
RES MR20307              ; TASK2→5 ﾌｨﾙﾑ受取中
CON
JMP @MR3108
;ﾌｨﾙﾑ準備待ちへ
STG @MR3108
JMP @MR3004
;<h1/> ﾌｨﾙﾑ受取成功
;ﾌｨﾙﾑ良品判定
STG @MR3200
MPS
AND= DM20034 #1          ; ﾌｨﾙﾑ不良有無(1=良/0=不良)
MPS
AND MR20302              ; TASK1→2 フィルム給材要求
JMP @MR3203
MPP
ANB MR20302              ; TASK1→2 フィルム給材要求
JMP @MR3201
MPP
AND= DM20034 #0          ; ﾌｨﾙﾑ不良有無(1=良/0=不良)
JMP @MR3700
;<h1/> 板押圧溶着動作
;RB1フィルム搬送 移動 待機位置
STG @MR3201
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3202
STG @MR3202
AND @MR4501              ; ①SUB_RB1/Move完了
RES MR20307              ; TASK2→5 ﾌｨﾙﾑ受取中
CON
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3203
;TASK1→2 フィルム給材要求 待ち
STG @MR3203
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
LDB R57302               ; Task2 停止要求
OR R41003                ; _Grp1_Task3_起動中ﾌﾗｸﾞ
AND MR20302              ; TASK1→2 フィルム給材要求
ANL
SET MR20303              ; TASK2→1 フィルム給材中
CON
JMP @MR3204
MPP
LD R57302                ; Task2 停止要求
ANB R41003               ; _Grp1_Task3_起動中ﾌﾗｸﾞ
ANB MR20302              ; TASK1→2 フィルム給材要求
ANL
JMP @MR3915              ; AUTO END
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3204
ANB MR20302              ; TASK1→2 フィルム給材要求
JMP @MR3205
;<h1/> 板押圧溶着へ
;RB1ﾌｨﾙﾑ搬送 移動 板押圧溶着位置
STG @MR3205
DW #3 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3206
STG @MR3206
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3207
;TASK2→5 ﾌｨﾙﾑ受取中ﾘｾｯﾄ
STG @MR3207
RES MR20307              ; TASK2→5 ﾌｨﾙﾑ受取中
CON
JMP @MR3210
;ﾌｨﾙﾑ搬送 親&子 下降
STG @MR3210
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR3211
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
OR MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4202                ; ﾌｨﾙﾑ搬送 子 下降端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;吸着治具吸着OFF
STG @MR3211
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7602               ; 吸着治具真空破壊ON
CON
TMS @5 DM7022            ; 板押圧溶着_吸着OFFウェイト  装置基礎ﾃﾞｰﾀ12
CON
AND @T5                  ; 板押圧溶着_吸着OFFウェイト
JMP @MR3212
;TASK2→1 フィルム給材中 ﾘｾｯﾄ
STG @MR3212
RES MR7602               ; 吸着治具真空破壊ON
CON
RES MR20303              ; TASK2→1 フィルム給材中
CON
JMP @MR3213
;TASK1→2 溶着済み搬送要求待ち
STG @MR3213
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20304              ; TASK1→2 溶着済み搬送要求
ANL
MPS
AND= DM20043 #1          ; 溶着状態(1=OK)
JMP @MR3214
MPP
AND= DM20043 #0          ; 溶着状態(1=OK)
SET MR7602               ; 吸着治具真空破壊ON
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7601               ; 吸着治具吸着OFF
CON
JMP @MR3300
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;溶着台_板押圧有無真空破壊ON
;吸着治具吸着ON
STG @MR3214
SET MR7600               ; 吸着治具吸着ON
CON
RES MR7601               ; 吸着治具吸着OFF
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
SET MR7608               ; 溶着台_板押圧有無真空破壊ON
CON
RES MR7606               ; 溶着台_板押圧有無吸着ON
CON
SET MR7607               ; 溶着台_板押圧有無吸着OFF
CON
TMR @6 #15               ; wait
CON
LD @T6                   ; wait
OR R4604                 ; 吸着治具真空OUT1
ANL
TMR @13 #5               ; wait
CON
AND @T13                 ; wait
ANB MR20109              ; 吸着確認中
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
JMP @MR3215
STG @MR3215
MPS
ANB R41202               ; TASK2 PAUSE 要求
SET MR20109              ; 吸着確認中
CON
SET MR7205               ; 板押圧溶着台下降
CON
RES MR7204               ; 板押圧溶着台上昇
CON
AND R4107                ; 板押圧溶着台 下降端
ANB R4106                ; 板押圧溶着台 上昇端
MPS
ANB MR4107               ; 板押圧溶着台 下降端ERR
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
JMP @MR3300
MPP
LD MR4107                ; 板押圧溶着台 下降端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3300
RES MR20109              ; 吸着確認中
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
MPS
LD R4201                 ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
ANL
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
JMP @MR3301
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌｨﾙﾑ搬送 子 上昇
;ﾌｨﾙﾑ搬送 親 上昇
;吸着確認
STG @MR3301
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
CON
JMP @MR3302
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3302
AND @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
JMP @MR3303
STG @MR3303
MPS
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3307
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2302
MPP
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR3307
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2302
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
MPS
LD= DM20043 #1           ; 溶着状態(1=OK)
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR3304
MPP
LD= DM20043 #0           ; 溶着状態(1=OK)
ANB R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANL
JMP @MR3307
;ERR120 ﾌｨﾙﾑ吸着失敗
STG @MR3304
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7240 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #120 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3305
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3305
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3301
MRD
AND @MR106               ; SW2
JMP @MR3306
MPP
AND @MR107               ; SW3
MPS
AND R46100               ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
SET @MR900               ; ﾌｨﾙﾑ除材選択
CON
JMP @MR3307
MPP
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
JMP @MR2302
;↓ﾘﾄﾗｲ処理
;ﾌｨﾙﾑ搬送 親&子 下降
STG @MR3306
RES MR7205               ; 板押圧溶着台下降
CON
SET MR7204               ; 板押圧溶着台上昇
CON
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4106               ; 板押圧溶着台 上昇端ERR
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4107                ; 板押圧溶着台 下降端
AND R4106                ; 板押圧溶着台 上昇端
ANL
JMP @MR3214
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
OR MR4106                ; 板押圧溶着台 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;↑ﾘﾄﾗｲ処理終了
;TASK2→1 溶着済み搬送完了
STG @MR3307
SET MR20305              ; TASK2→1 溶着済み搬送完了
CON
JMP @MR3308
;TASK2→1 溶着済み搬送中OFF
STG @MR3308
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20304              ; TASK1→2 溶着済み搬送要求
ANL
RES MR20305              ; TASK2→1 溶着済み搬送完了
CON
JMP @MR3309
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;TASK1→2 板押圧状態通知待ち
STG @MR3309
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20404              ; TASK1→2 板押圧状態通知
ANL
SET MR20405              ; TASK2→1 板押圧状態確認
CON
JMP @MR3310
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;TASK1→2 板押圧状態通知OFF待ち
STG @MR3310
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20404              ; TASK1→2 板押圧状態通知
ANL
RES MR20405              ; TASK2→1 板押圧状態確認
CON
JMP @MR3311
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;溶着状態分岐
STG @MR3311
MPS
LD= DM20043 #1           ; 溶着状態(1=OK)
ANB @MR900               ; ﾌｨﾙﾑ除材選択
ANL
RES @MR902               ; ﾌｨﾙﾑNG
CON
JMP @MR3500
MPP
LD= DM20043 #0           ; 溶着状態(1=OK)
OR @MR900                ; ﾌｨﾙﾑ除材選択
ANL
RES @MR900               ; ﾌｨﾙﾑ除材選択
CON
SET @MR902               ; ﾌｨﾙﾑNG
CON
JMP @MR3400
;<h1/> 溶着動作後ﾌｨﾙﾑ除材へ
;吸着確認
STG @MR3400
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認
CON
JMP @MR3401
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3401
AND @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
CON
JMP @MR3402
STG @MR3402
MPS
AND DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
JMP @MR3407
MPP
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR3403
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
@DEC.S DM20040           ; 板押し圧投入数(溶着台に)
CON
@DEC.S DM20042           ; フィルム投入数(吸着冶具に)
CON
JMP @MR3407
;RB1ﾌｨﾙﾑ搬送 移動 ﾌｨﾙﾑ除材位置位置
STG @MR3403
DW #7 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3404
STG @MR3404
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3405
;ERR125.溶着不良フィルム除材要求
STG @MR3405
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $4000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #125 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3406
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3406
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR3400
;吸着治具吸着OFF
STG @MR3407
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7603               ; 板押圧吸着ﾊﾟｯﾄﾞ吸着ON
CON
JMP @MR3004
;<h1/> ﾌﾚｰﾑ溶着へ
;TASK1→2 ﾌｨﾙﾑ搬送移動不可分岐
STG @MR3500
MPS
LD MR20401               ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
OR MR20402               ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
ANL
JMP @MR3501
MPP
LDB MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
ANB MR20402              ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
ANL
JMP @MR3503
;RB1ﾌｨﾙﾑ搬送 移動 待機位置
STG @MR3501
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3502
STG @MR3502
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3503
;TASK1→2 ﾌｨﾙﾑ搬送移動不可OFF待ち
STG @MR3503
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
ANB MR20402              ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
ANL
JMP @MR3507
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB1フィルム搬送 移動 フレーム溶着位置
STG @MR3507
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20403              ; TASK5→2 フィルムカット通過不可
AND MR20408              ; TASK3→2 フィルム搬送許可
ANB MR20401              ; TASK1→2 ﾌｨﾙﾑ搬送移動不可
ANB MR20402              ; TASK3→2 ﾌﾚｰﾑ反転中移動不可
ANL
TMR @9 #5                ; wait
CON
AND @T9                  ; wait
SET MR20407              ; TASK2→5 フィルム搬送通過中
CON
SET MR20406              ; TASK2→3 フレーム反転不可
CON
DW #4 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3508
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3508
AND @MR4501              ; ①SUB_RB1/Move完了
RES MR20407              ; TASK2→5 フィルム搬送通過中
CON
RES MR20406              ; TASK2→3 フレーム反転不可
CON
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3509
;TASK3→2 フィルム給材要求待ち
STG @MR3509
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20308              ; TASK3→2 フィルム給材要求
ANL
SET MR20309              ; TASK2→3 フィルム給材中
CON
JMP @MR3510
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3510
MPS
ANB R41202               ; TASK2 PAUSE 要求
JMP @MR3511
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3511
SET @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
CON
JMP @MR3512
STG @MR3512
AND @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
RES @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
JMP @MR3513
STG @MR3513
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR3605
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR3514
;フィルム無し時、フィルム除材位置へ移動
STG @MR3514
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20403              ; TASK5→2 フィルムカット通過不可
ANL
SET MR20407              ; TASK2→5 フィルム搬送通過中
CON
DW #7 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3515
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3515
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3600
;ERR126 フィルム未検出(RB1フィルム搬送)
STG @MR3600
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7400 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #126 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3601
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3601
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3602
MPP
AND @MR106               ; SW2
RES MR20407              ; TASK2→5 フィルム搬送通過中
CON
JMP @MR3604
STG @MR3602
DW #4 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3603
STG @MR3603
AND @MR4501              ; ①SUB_RB1/Move完了
RES MR20407              ; TASK2→5 フィルム搬送通過中
CON
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3511
STG @MR3604
MPS
AND R4605                ; 吸着治具真空OUT2
@DEC.S DM20040           ; 板押し圧投入数(溶着台に)
CON
@DEC.S DM20042           ; フィルム投入数(吸着冶具に)
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR3004
MPP
ANB R4605                ; 吸着治具真空OUT2
JMP @MR3600
;ﾌｨﾙﾑ搬送 親子 下降
STG @MR3605
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANL
JMP @MR3606
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;吸着治具真空OFF
STG @MR3606
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7602               ; 吸着治具真空破壊ON
CON
TMS @7 DM7024            ; フレーム溶着_吸着OFFウェイト  装置基礎ﾃﾞｰﾀ13
CON
AND @T7                  ; フレーム溶着_吸着OFFウェイト
JMP @MR3607
;TASK2→3 フィルム給材中OFF
STG @MR3607
RES MR7602               ; 吸着治具真空破壊ON
CON
RES MR20309              ; TASK2→3 フィルム給材中
CON
JMP @MR3608
;TASK3→2 溶着後退避要求待ち
STG @MR3608
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20310              ; TASK3→2 溶着後退避要求
ANL
SET MR20311              ; TASK2→3 溶着後退避中
CON
JMP @MR3609
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;吸着治具真空破壊ON
STG @MR3609
SET MR7602               ; 吸着治具真空破壊ON
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7601               ; 吸着治具吸着OFF
CON
TMR @10 #5               ; wait
CON
AND @T10                 ; wait
JMP @MR3610
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR3610
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR3611
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;TASK2→3 溶着後退避中OFF
STG @MR3611
RES MR20311              ; TASK2→3 溶着後退避中
CON
JMP @MR3612
;TASK5→2 フィルム受取要求 待ち
STG @MR3612
MPS
ANB R41202               ; TASK2 PAUSE 要求
MPS
LD R57302                ; Task2 停止要求
ANB R41005               ; _Grp1_Task5_起動中ﾌﾗｸﾞ
ANL
JMP @MR3900
MPP
LDB R57302               ; Task2 停止要求
OR R41005                ; _Grp1_Task5_起動中ﾌﾗｸﾞ
AND MR20306              ; TASK5→2 ﾌｨﾙﾑ受取要求
ANB MR20403              ; TASK5→2 フィルムカット通過不可
ANL
JMP @MR3613
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB1フィルム搬送 移動 ﾌｨﾙﾑ受取位置
STG @MR3613
DW #2 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3614
STG @MR3614
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3815
;<h1/> 不良ﾌｨﾙﾑ廃棄
;TASK2→5 ﾌｨﾙﾑ受取中OFF
;RB1ﾌｨﾙﾑ搬送 移動 待機位置
STG @MR3700
RES MR20307              ; TASK2→5 ﾌｨﾙﾑ受取中
CON
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3701
STG @MR3701
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3702
;TASK2→6 不良ﾌｨﾙﾑ廃棄要求ON
STG @MR3702
SET MR20212              ; TASK2→6 不良フィルム廃棄要求
CON
JMP @MR3703
STG @MR3703
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20213              ; TASK6→2 不良フィルム廃棄中
ANL
JMP @MR3704
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;RB1フィルム搬送 移動 不良フィルム廃棄
STG @MR3704
DW #5 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3705
STG @MR3705
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3706
;TASK2→6 不良フィルム廃棄要求OFF
STG @MR3706
RES MR20212              ; TASK2→6 不良フィルム廃棄要求
CON
JMP @MR3707
STG @MR3707
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20214              ; TASK6→2 不良フィルム廃棄完了
ANL
JMP @MR3708
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有無確認
STG @MR3708
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4900              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認
CON
JMP @MR3709
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3709
AND @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
CON
JMP @MR3710
STG @MR3710
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR3711
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
MPS
ANB DM2000.3             ; ﾄﾞﾗｲ運転有効/無効(ON有効)
INC.L DM20037            ; RB10フィルム回収枚数
MPP
@DEC.S DM20042           ; フィルム投入数(吸着冶具に)
CON
JMP @MR3714
;ERR122 フィルム除材要求(RB1フィルム搬送)
STG @MR3711
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7200 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #124 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR3712
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR3712
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR3708
MPP
AND @MR106               ; SW2
JMP @MR3702
;廃棄OK
;RB1フィルム搬送 移動 待機位置
STG @MR3714
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3715
STG @MR3715
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3800
STG @MR3800
SET MR20215              ; TASK2→6 不良フィルム廃棄後退避
CON
JMP @MR3801
STG @MR3801
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20214              ; TASK6→2 不良フィルム廃棄完了
ANL
@DEC.S DM20042           ; フィルム投入数(吸着冶具に)
CON
RES MR20215              ; TASK2→6 不良フィルム廃棄後退避
CON
JMP @MR3815
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/> 先頭へ
STG @MR3815
JMP @MR3003
;<h1/>Auto終了退避処理
STG @MR3900
MPS
AND MR20108              ; 要原点復帰
JMP @MR3915              ; AUTO END
MPP
ANB MR20108              ; 要原点復帰
JMP @MR3901
;RB1ﾌｨﾙﾑ搬送 移動 待機位置
STG @MR3901
DW #1 EM1300             ; RB1Target Pos
CON
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR3902
STG @MR3902
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR3915              ; AUTO END
;<h1/>Auto終了処理
STG @MR3915              ; AUTO END
RES @MR3002              ; AUTO Main1 Busy
CON
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANB @MR4002              ; Main2 Busy
ANL
ZRES @MR900 @MR915       ; ﾌｨﾙﾑ除材選択
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;<h1/>Auto-Main2/Autoﾒｲﾝﾙｰﾁﾝ2
;[本STG内容]
;・@MR4000の起動はMain1にて行う事
;・@MR4000:AUTO_Main2開始、@MR4001:AUTO_Main2完了、@MR4002:AUTO_Main2動作中
STG @MR4000              ; AUTO Main2
SET @MR4002              ; Main2 Busy
CON
JMP @MR4003
STG @MR4003
JMP @MR4415              ; Main2 END
STG @MR4415              ; Main2 END
SET @MR4001              ; Main2 END
CON
RES @MR4002              ; Main2 Busy
CON
ENDS
;<h1/>MAINTE/ﾒﾝﾃﾅﾝｽ動作
;[本STG内容]
;・各TaskのMAINTE動作を記述して下さい
;・動作ﾓｰﾄﾞは「MAINTEAC*」に格納されています(1～32)
;・動作終了時は@MR2915にJMPして下さい
STG LR5602               ; _Grp1_Task2_MAINTE.STG
JMP @MR2000              ; Mainte
STG @MR2000              ; Mainte
SET @MR2002              ; ﾒﾝﾃ中
CON
JMP @MR2003
STG @MR2003
MPS
AND= DM4110 #11          ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2100
MPP
AND<> DM4110 #11         ; _Group1　ﾒﾝﾃ動作番号
JMP @MR2915              ; Mainte END
STG @MR2100
JMP @MR2101
;フィルム搬送動作
;[[移動]]位置移動します。位置選択画面に切り替わります。
;[[受取]]フィルムの受取動作をします。
;[[NextPage]]次のﾍﾟｰｼﾞへ
;[[定停止]]動作を終了します。
STG @MR2101
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #12 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #11 @DM32             ; SW1_No /SELECT_ACT
CON
DW #21 @DM33             ; SW2_No /SELECT_ACT
CON
DW #2 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task2 SELECT_ACT
CON
JMP @MR2102
STG @MR2102
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task2 SEL_ACT END
RES @MR201               ; Task2 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
JMP @MR2105
MRD
AND @MR206               ; SW2
DW #1 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
JMP @MR2103
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;フィルム搬送動作
;[[受渡し]]フィルムの受渡し動作をします。
;[[廃棄]]フィルムの廃棄動作をします。
;[[PrevPage]]前のﾍﾟｰｼﾞへ
;[[定停止]]動作を終了します。
STG @MR2103
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #13 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #9 @DM32              ; SW1_No /SELECT_ACT
CON
DW #18 @DM33             ; SW2_No /SELECT_ACT
CON
DW #1 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task2 SELECT_ACT
CON
JMP @MR2104
STG @MR2104
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task2 SEL_ACT END
RES @MR201               ; Task2 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #2 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #3 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
JMP @MR2101
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;フィルム搬送動作
;[[待機]]待機位置へ移動します。
;[[ﾌｨﾙﾑｶｯﾄ]]ﾌｨﾙﾑｶｯﾄ位置へ移動します。
;[[NextPage]]次のﾍﾟｰｼﾞへ
;[[定停止]]動作を終了します。
STG @MR2105
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #14 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #22 @DM32             ; SW1_No /SELECT_ACT
CON
DW #23 @DM33             ; SW2_No /SELECT_ACT
CON
DW #2 @DM34              ; SW3_No /SELECT_ACT
CON
DW #3 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task2 SELECT_ACT
CON
JMP @MR2106
STG @MR2106
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task2 SEL_ACT END
RES @MR201               ; Task2 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #4 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #5 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
JMP @MR2107
MPP
AND @MR208               ; SW4
DW #0 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2914
;フィルム搬送動作
;[[板押圧]]板押圧溶着位置へ移動します。
;[[フレーム]]フレーム溶着位置へ移動します。
;[[廃棄]]NGフィルム廃棄位置へ移動します。
;[[PrevPage]]前のﾍﾟｰｼﾞへ
STG @MR2107
ANB R39204               ; SELECT_ACT Interlock
SET R39204               ; SELECT_ACT Interlock
CON
MPS
SET @MR1900              ; Main1 HALT許可
CON
DW #15 @DM31             ; ScreenNo /SELECT_ACT
CON
DW #24 @DM32             ; SW1_No /SELECT_ACT
CON
DW #25 @DM33             ; SW2_No /SELECT_ACT
CON
DW #18 @DM34             ; SW3_No /SELECT_ACT
CON
DW #1 @DM35              ; SW4_No /SELECT_ACT
CON
DW #0 @DM36              ; Bz_Use /SELECT_ACT
MPP
SET @MR200               ; Task2 SELECT_ACT
CON
JMP @MR2108
STG @MR2108
SET @MR1900              ; Main1 HALT許可
CON
AND @MR201               ; Task2 SEL_ACT END
RES @MR201               ; Task2 SEL_ACT END
CON
RES R39204               ; SELECT_ACT Interlock
CON
MPS
AND @MR205               ; SW1
DW #6 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR206               ; SW2
DW #7 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MRD
AND @MR207               ; SW3
DW #8 @DM10              ; ﾒﾝﾃ動作ｺｰﾄﾞ
CON
JMP @MR2200
MPP
AND @MR208               ; SW4
JMP @MR2105
;ｽﾃｯﾌﾟor通常　か選択
STG @MR2200
MPS
MSTRT SELECT_POST #1 MyTask #0 @MR2005;自ﾀｽｸ番号
MPP
AND @MR2005
RES @MR2005
CON
JMP @MR2202
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
LD= EM1301 #2            ; RB1Now Pos
AND>=.L DM11000 +8050    ; RB1 現在位置下位
AND<=.L DM11000 +9050    ; RB1 現在位置下位
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17900   ; RB1 現在位置下位
AND<=.L DM11000 +18100   ; RB1 現在位置下位
ORL
ANL
OUT @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK(ﾌｨﾙﾑ受取)
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17950   ; RB1 現在位置下位
AND<=.L DM11000 +18050   ; RB1 現在位置下位
LD= EM1301 #4            ; RB1Now Pos
AND>=.L DM11000 -50      ; RB1 現在位置下位
AND<=.L DM11000 +50      ; RB1 現在位置下位
ORL
ANL
OUT @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND DM11007.1
AND= EM1301 #5           ; RB1Now Pos
AND>=.L DM11000 +26950   ; RB1 現在位置下位
AND<=.L DM11000 +27050   ; RB1 現在位置下位
OUT @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
LD DM11039.1             ; 原点復帰完了
AND<=.L DM11032 +500     ; RB5 現在位置
AND DM11047.1            ; 原点復帰完了
AND<=.L DM11040 +500     ; RB6 現在位置
AND DM11079.1
AND>=.L DM11072 +20000   ; RB10 現在位置
AND DM11095.1
AND<=.L DM11088 +500     ; RB12 現在位置下位
ANB R4206                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ下降端
AND R4207                ; 板押圧溶着ﾍｯﾄﾞｴｽｹｰﾌﾟ上昇端
ANB R4010                ; 切出し位置決めｾﾝｻ下降端
AND R4011                ; 切出し位置決めｾﾝｻ上昇端
ANB R4002                ; ﾌｨﾙﾑ押さえ前進端
AND R4003                ; ﾌｨﾙﾑ押さえ後退端
OUT @MR901               ; ﾌｨﾙﾑ搬送干渉無し
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR901               ; ﾌｨﾙﾑ搬送干渉無し
OUT @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
LD= @DM10 #5             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR901               ; ﾌｨﾙﾑ搬送干渉無し
OUT @MR504               ; ﾒﾝﾃｺｰﾄﾞ5条件OK
LD= @DM10 #6             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR901               ; ﾌｨﾙﾑ搬送干渉無し
OUT @MR505               ; ﾒﾝﾃｺｰﾄﾞ6条件OK
LD= @DM10 #7             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR901               ; ﾌｨﾙﾑ搬送干渉無し
OUT @MR506               ; ﾒﾝﾃｺｰﾄﾞ7条件OK
LD= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR901               ; ﾌｨﾙﾑ搬送干渉無し
OUT @MR507               ; ﾒﾝﾃｺｰﾄﾞ8条件OK
STG @MR2202
MPS
TMR @39 #10              ; ﾒﾝﾃ条件NG
CON
AND @T39                 ; ﾒﾝﾃ条件NG
JMP @MR2810
MPP
ANB @T39                 ; ﾒﾝﾃ条件NG
MPS
LD= @DM10 #1             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR500               ; ﾒﾝﾃｺｰﾄﾞ1条件OK(ﾌｨﾙﾑ受取)
ANL
JMP @MR2300
MRD
LD= @DM10 #2             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR501               ; ﾒﾝﾃｺｰﾄﾞ2条件OK
ANL
JMP @MR2400
MRD
LD= @DM10 #3             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR502               ; ﾒﾝﾃｺｰﾄﾞ3条件OK
ANL
JMP @MR2500
MPP
LD= @DM10 #4             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR503               ; ﾒﾝﾃｺｰﾄﾞ4条件OK
LD= @DM10 #5             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR504               ; ﾒﾝﾃｺｰﾄﾞ5条件OK
ORL
LD= @DM10 #6             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR505               ; ﾒﾝﾃｺｰﾄﾞ6条件OK
ORL
LD= @DM10 #7             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR506               ; ﾒﾝﾃｺｰﾄﾞ7条件OK
ORL
LD= @DM10 #8             ; ﾒﾝﾃ動作ｺｰﾄﾞ
AND @MR507               ; ﾒﾝﾃｺｰﾄﾞ8条件OK
ORL
ANL
JMP @MR2600
;<h1/> ﾒﾝﾃｺｰﾄﾞ1動作/ﾌｨﾙﾑ受取動作
STG @MR2300
MPS
LD= EM1301 #2            ; RB1Now Pos
AND>=.L DM11000 +8050    ; RB1 現在位置下位
AND<=.L DM11000 +9050    ; RB1 現在位置下位
ANL
JMP @MR3007
MPP
LD= EM1301 #3            ; RB1Now Pos
AND>=.L DM11000 +17900   ; RB1 現在位置下位
AND<=.L DM11000 +18100   ; RB1 現在位置下位
ANL
JMP @MR2301
;板押圧溶着台からの受取
STG @MR2301
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANL
JMP @MR3214
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
OR MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4202                ; ﾌｨﾙﾑ搬送 子 下降端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
STG @MR2302
JMP @MR2100
;<h1/> ﾒﾝﾃｺｰﾄﾞ2動作/Maintenance code 2 Operation
;ﾌｨﾙﾑ搬送 親&子 下降
STG @MR2400
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
RES MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
SET MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
RES MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
MPS
LDB MR4200               ; ﾌｨﾙﾑ搬送 親 下降端ERR
ANB MR4202               ; ﾌｨﾙﾑ搬送 子 下降端ERR
ANB R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
AND R4200                ; ﾌｨﾙﾑ搬送 親 下降端
ANB R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
AND R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR2401
MPP
LD MR4200                ; ﾌｨﾙﾑ搬送 親 下降端ERR
OR MR4202                ; ﾌｨﾙﾑ搬送 子 下降端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;ﾌｨﾙﾑ搬送 吸着破壊
STG @MR2401
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7602               ; 吸着治具真空破壊ON
CON
RES MR7600               ; 吸着治具吸着ON
CON
SET MR7601               ; 吸着治具吸着OFF
CON
JMP @MR2402
STG @MR2402
TMR @8 #5                ; wait
CON
AND @T8                  ; wait
JMP @MR2403
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR2403
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR2404
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;上昇後吸着確認
STG @MR2404
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
CON
JMP @MR2405
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2405
AND @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
JMP @MR2406
STG @MR2406
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR2407
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR2409
;ERR123 フィルム受渡し失敗(RB1フィルム搬送)
STG @MR2407
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7200 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #123 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR2408
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2408
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR2404
MPP
AND @MR106               ; SW2
JMP @MR2400
;ﾌｨﾙﾑ搬送 吸着OFF
STG @MR2409
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR2410
;終了
STG @MR2410
JMP @MR2103
;<h1/> ﾒﾝﾃｺｰﾄﾞ3動作/Maintenance code 3 Operation
;TASK6へﾒﾝﾃ_ﾌｨﾙﾑ回収要求
STG @MR2500
SET MR20500              ; TASK2→6 ﾒﾝﾃ_ﾌｨﾙﾑ回収要求
CON
JMP @MR2501
STG @MR2501
MPS
LDB R41202               ; TASK2 PAUSE 要求
AND MR20501              ; TASK6→2 ﾒﾝﾃ_ﾌｨﾙﾑ回収中
ANL
JMP @MR2502
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
;ﾌｨﾙﾑ回収完了待ち
STG @MR2502
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20501              ; TASK6→2 ﾒﾝﾃ_ﾌｨﾙﾑ回収中
ANL
JMP @MR2503
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2503
RES MR20500              ; TASK2→6 ﾒﾝﾃ_ﾌｨﾙﾑ回収要求
CON
JMP @MR2504
;上昇後吸着確認
STG @MR2504
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB MR20109              ; 吸着確認中
ANL
SET MR20109              ; 吸着確認中
CON
SET @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
CON
JMP @MR2505
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2505
AND @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
RES MR20109              ; 吸着確認中
CON
RES @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
JMP @MR2506
STG @MR2506
MPS
AND= DM20033 #1          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR2507
MPP
AND= DM20033 #0          ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
JMP @MR2509
;ERR123 フィルム受渡し失敗(RB1フィルム搬送)
STG @MR2507
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7200 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #123 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR2508
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2508
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
MPS
AND @MR105               ; SW1
JMP @MR2504
MPP
AND @MR106               ; SW2
JMP @MR2500
;ﾌｨﾙﾑ搬送 吸着OFF
STG @MR2509
SET MR7601               ; 吸着治具吸着OFF
CON
RES MR7600               ; 吸着治具吸着ON
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR2510
;ﾌｨﾙﾑ回収枚数INC
STG @MR2510
INC.L DM20037            ; RB10フィルム回収枚数
CON
JMP @MR2511
;終了
STG @MR2511
JMP @MR2103
;<h1/> ﾒﾝﾃｺｰﾄﾞ4～動作/Maintenance code 4～ Operation
;ﾌｨﾙﾑ搬送 親&子 上昇
STG @MR2600
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET MR7211               ; ﾌｨﾙﾑ搬送 親 上昇
CON
RES MR7210               ; ﾌｨﾙﾑ搬送 親 下降
CON
SET MR7213               ; ﾌｨﾙﾑ搬送 子 上昇
CON
RES MR7212               ; ﾌｨﾙﾑ搬送 子 下降
CON
MPS
LDB MR4201               ; ﾌｨﾙﾑ搬送 親 上昇端ERR
ANB MR4203               ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R4201                ; ﾌｨﾙﾑ搬送 親 上昇端
ANB R4200                ; ﾌｨﾙﾑ搬送 親 下降端
AND R4203                ; ﾌｨﾙﾑ搬送 子 上昇端
ANB R4202                ; ﾌｨﾙﾑ搬送 子 下降端
ANL
JMP @MR2601
MPP
LD MR4201                ; ﾌｨﾙﾑ搬送 親 上昇端ERR
OR MR4203                ; ﾌｨﾙﾑ搬送 子 上昇端ERR
AND R41202               ; TASK2 PAUSE 要求
ANL
SET @MR1900              ; Main1 HALT許可
;目標位置書込み
STG @MR2601
MPS
AND= @DM10 #4            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #1 EM1300             ; RB1Target Pos
CON
JMP @MR2602
MRD
AND= @DM10 #5            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #2 EM1300             ; RB1Target Pos
CON
JMP @MR2602
MRD
AND= @DM10 #6            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #3 EM1300             ; RB1Target Pos
CON
JMP @MR2602
MRD
AND= @DM10 #7            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #4 EM1300             ; RB1Target Pos
CON
JMP @MR2602
MPP
AND= @DM10 #8            ; ﾒﾝﾃ動作ｺｰﾄﾞ
DW #5 EM1300             ; RB1Target Pos
CON
JMP @MR2602
STG @MR2602
MPS
ANB R41202               ; TASK2 PAUSE 要求
SET R47600               ; _Group1　動作区切り開始
CON
AND R47608               ; _Group1　動作区切り完了
SET @MR4500              ; ①SUB_RB1/Move
CON
JMP @MR2603
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2603
AND @MR4501              ; ①SUB_RB1/Move完了
RES @MR4501              ; ①SUB_RB1/Move完了
CON
JMP @MR2604
;終了
STG @MR2604
JMP @MR2100
;<h1/> ﾒﾝﾃﾅﾝｽｲﾝﾀｰﾛｯｸ
STG @MR2810
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $3000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #52 @DM1              ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR2811
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR2811
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR2003
;Maintenance 終了
STG @MR2914
MCALL MODE_INDI #2
MCALL HOLD_REQUEST MyGroup;自ｸﾞﾙｰﾌﾟ番号
DW #211 DM3008           ; _MainTP　切替ﾍﾟｰｼﾞNo
CON
JMP @MR2915              ; Mainte END
STG @MR2915              ; Mainte END
MPS
LD R41202                ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
ANL
SET @MR1900              ; Main1 HALT許可
MPP
ANB R41202               ; TASK2 PAUSE 要求
RES @MR2002              ; ﾒﾝﾃ中
CON
JMP LR602                ; _Grp1_Task2_Fin.STG
;<h1/>SubRoutines/ｻﾌﾞﾙｰﾁﾝ
;[記述方法]
;・ｻﾌﾞﾙｰﾁﾝは本ﾌﾞｯｸﾏｰｸから下に記述していって下さい
;・ｻﾌﾞﾙｰﾁﾝは必ずﾌﾞｯｸﾏｰｸを挿入して処理内容を明確にする事
;<h1/> ①SUB_RB1/Move
STG @MR4500              ; ①SUB_RB1/Move
SET @MR4502              ; ①SUB_RB1/Move中
CON
JMP @MR4503
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4503
MPS
BSET DM11207 #3          ; RB1 制御信号
CON
BANB DM11007 #3          ; RB1 状態信号
BSET DM11207 #4          ; RB1 制御信号
CON
BAND DM11007 #4          ; RB1 状態信号
BRES DM11207 #3          ; RB1 制御信号
CON
JMP @MR4504
MPP
TMR @0 #20               ; RB1Moveｴﾗｰ
CON
AND @T0                  ; RB1Moveｴﾗｰ
BRES DM11207 #3          ; RB1 制御信号
CON
BRES DM11207 #4          ; RB1 制御信号
CON
JMP @MR4614
STG @MR4504
SET R35000               ; RB1 MOVE
CON
JMP @MR4505
STG @MR4505
AND R35001               ; RB1 MOVE END
RES R35001               ; RB1 MOVE END
CON
JMP @MR4506
STG @MR4506
MPS
ANB R35003               ; RB1 Alarm
JMP @MR4507
MPP
AND R35003               ; RB1 Alarm
RES R35003               ; RB1 Alarm
CON
JMP @MR4614
;END
STG @MR4507
SET @MR4501              ; ①SUB_RB1/Move完了
CON
RES @MR4502              ; ①SUB_RB1/Move中
CON
ENDS
;<h1/> ②SUB_RB1/Home
STG @MR4600              ; ②SUB_RB1/Home
DW #0 EM1301             ; RB1Now Pos
CON
SET @MR4602              ; ②SUB_RB1/Home中
CON
JMP @MR4603
;ｱﾗｰﾑﾘｾｯﾄ &ｻｰﾎﾞON　ｱﾗｰﾑﾘｾｯﾄできない場合は、ｻｰﾎﾞOFFしError発生
STG @MR4603
MPS
BSET DM11207 #3          ; RB1 制御信号
CON
BANB DM11007 #3          ; RB1 状態信号
BSET DM11207 #4          ; RB1 制御信号
CON
BAND DM11007 #4          ; RB1 状態信号
BRES DM11207 #3          ; RB1 制御信号
CON
JMP @MR4604
MPP
TMR @1 #20               ; RB1Homeｴﾗｰ
CON
AND @T1                  ; RB1Homeｴﾗｰ
BRES DM11207 #3          ; RB1 制御信号
CON
BRES DM11207 #4          ; RB1 制御信号
CON
JMP @MR4614
STG @MR4604
MPS
BAND DM11007 #1          ; RB1 状態信号
JMP @MR4607
MPP
BANB DM11007 #1          ; RB1 状態信号
SET R35008               ; RB1 HOME
CON
JMP @MR4605
STG @MR4605
AND R35009               ; RB1 HOME END
RES R35009               ; RB1 HOME END
CON
JMP @MR4606
STG @MR4606
MPS
ANB R35003               ; RB1 Alarm
JMP @MR4607
MPP
AND R35003               ; RB1 Alarm
RES R35003               ; RB1 Alarm
CON
JMP @MR4614
;END
STG @MR4607
SET @MR4601              ; ②SUB_RB1/Home完了
CON
RES @MR4602              ; ②SUB_RB1/Home中
CON
ENDS
;Error 1 RB1動作異常
STG @MR4614
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
MPS
DW $1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #1 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM2               ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR4615
MPP
SET B3990                ; ｱﾗｰﾑ詳細表示
CON
LDA DM11006              ; RB1 ｱﾗｰﾑｺｰﾄﾞ
CON
STA DM50310              ; RB ｱﾗｰﾑ表示
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4615
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
RES B3990                ; ｱﾗｰﾑ詳細表示
CON
DW #0 DM50310            ; RB ｱﾗｰﾑ表示
CON
MPS
AND @MR4602              ; ②SUB_RB1/Home中
JMP @MR4603
MPP
AND @MR4502              ; ①SUB_RB1/Move中
JMP @MR4503
;<h1/> ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有無確認
STG @MR4800              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認
SET @MR4802              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認中
CON
JMP @MR4803
;吸着ON
STG @MR4803
SET MR7600               ; 吸着治具吸着ON
CON
RES MR7601               ; 吸着治具吸着OFF
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR4804
;吸着圧力確認
LD @MR4804
TMR @3 #5                ; wait
STG @MR4804
MPS
AND R4604                ; 吸着治具真空OUT1
JMP @MR4805
MPP
LDB R4604                ; 吸着治具真空OUT1
AND @T3                  ; wait
ANL
JMP @MR4806
;有無状態書込み
STG @MR4805
DW #1 DM20033            ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
CON
JMP @MR4815
STG @MR4806
DW #0 DM20033            ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
CON
JMP @MR4815
;Error 121 吸着圧力異常(フィルム搬送)
STG @MR4807
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #121 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR4808
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4808
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR4804
;END
STG @MR4815
SET @MR4801              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認完了
CON
RES @MR4802              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有確認中
CON
ENDS
;<h1/> ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ有無確認
STG @MR4900              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認
SET @MR4902              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認中
CON
JMP @MR4903
;吸着ON
STG @MR4903
SET MR7600               ; 吸着治具吸着ON
CON
RES MR7601               ; 吸着治具吸着OFF
CON
RES MR7602               ; 吸着治具真空破壊ON
CON
JMP @MR4904
;吸着圧力確認
LD @MR4904
TMR @14 #15              ; wait
STG @MR4904
MPS
LDB R4605                ; 吸着治具真空OUT2
AND @T14                 ; wait
ANL
JMP @MR4905
MPP
AND R4605                ; 吸着治具真空OUT2
TMR @15 #5               ; 安定待ち
CON
AND @T15                 ; 安定待ち
JMP @MR4906
;有無状態書込み
STG @MR4905
DW #1 DM20033            ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
CON
JMP @MR4915
STG @MR4906
DW #0 DM20033            ; ﾌｨﾙﾑ搬送有無記憶(1=有り)
CON
JMP @MR4915
;Error 121 吸着圧力異常(フィルム搬送)
STG @MR4907
ANB R39900               ; RB動作中
MPS
LDB R41202               ; TASK2 PAUSE 要求
ANB R39004               ; ｴﾗｰ中
ANL
SET R39004               ; ｴﾗｰ中
CON
DW $7000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #121 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #4604 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100               ; Task2 ERROR
CON
JMP @MR4908
MPP
AND R41202               ; TASK2 PAUSE 要求
SET @MR1900              ; Main1 HALT許可
STG @MR4908
SET @MR1900              ; Main1 HALT許可
CON
AND @MR101               ; Task2 ERROR_End
RES @MR101               ; Task2 ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
AND @MR105               ; SW1
JMP @MR4904
;END
STG @MR4915
SET @MR4901              ; ④SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認完了
CON
RES @MR4902              ; ③SUB_ﾌｨﾙﾑ搬送_ﾌｨﾙﾑ無確認中
CON
ENDS
;<h1/>-----------------------------------------------------------
;<h1/>-----------------------------------------------------------
;<h1/>*ERROR
;MyTask Error Process Substance/エラー処理実体
STG @MR100               ; Task2 ERROR
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108       ; SW1  SW4
CON
DISN @DM9 @DM3 #4        ; ReturnSW /ERROR_DISP
MRD
DW MyTask @DM0           ; 自ﾀｽｸ番号  TaskNo /ERROR_DISP
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP  TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102               ; Task2 ERROR Busy
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105               ; SW1
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106               ; SW2
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107               ; SW3
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108               ; SW4
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102               ; Task2 ERROR Busy
CON
SET @MR101               ; Task2 ERROR_End
CON
ENDS
;<h1/>*Select_Y_N 
;MyTask Select_Y_N Process Substance/SELECT_Y_N処理実体
STG @MR300               ; Task2 SELECT_Y_N
ANB R39102               ; SELECT_Y_N Busy
MPS
ZRES @MR306 @MR307       ; Task2 Y/N
CON
DW #0 @DM20              ; TaskNo /SELECT_Y_N
CON
BMOV @DM20 DM60020 #3    ; TaskNo /SELECT_Y_N  TaskNo /SELECT_Y_N
MPP
SET R39100               ; SELECT_Y_N Start
CON
SET @MR302               ; Task2 Y_N Busy
CON
JMP @MR303
STG @MR303
AND R39102               ; SELECT_Y_N Busy
MPS
AND= DM60023 #1          ; Y_N /SELECT_Y_N
SET @MR306               ; Task2 Y/N
CON
JMP @MR304
MPP
AND= DM60023 #2          ; Y_N /SELECT_Y_N
RES @MR306               ; Task2 Y/N
CON
JMP @MR304
STG @MR304
ANB R39102               ; SELECT_Y_N Busy
RES @MR302               ; Task2 Y_N Busy
CON
SET @MR301               ; Task2 Y/N END
CON
ENDS
;<h1/>*TIMEUP ERROR
;MyTask TIMEUP_ERROR Process Substance/TIMEUP_ERROR処理実体
STG @MR400               ; Task2 TIMEUP_ERR
ANB R39302               ; TIMEUP_ERR Busy
MPS
DW #0 @DM40              ; TaskNo /TIMEUP_ERR
CON
BMOV @DM40 DM60040 #2    ; TaskNo /TIMEUP_ERR  TaskNo /TIMEUP_ERR
MPP
SET R39300               ; TIMEUP_ERR Start
CON
SET @MR402               ; Task2 TIMEUP Busy
CON
JMP @MR403
STG @MR403
AND R39302               ; TIMEUP_ERR Busy
JMP @MR404
STG @MR404
ANB R39302               ; TIMEUP_ERR Busy
RES @MR402               ; Task2 TIMEUP Busy
CON
SET @MR401               ; Task2 TIMEUP_END
CON
ENDS
;<h1/>*Select_ACT 
;MyTask Select_ACT Process Substance/SELECT_ACT処理実体
STG @MR200               ; Task2 SELECT_ACT
ANB R39202               ; SELECT_ACT Busy
MPS
ZRES @MR205 @MR208       ; SW1  SW4
CON
DW #0 @DM30              ; TaskNo /SELECT_ACT
CON
BMOV @DM30 DM60030 #7    ; TaskNo /SELECT_ACT  TaskNo /SELECT_ACT
MPP
SET R39200               ; SELECT_ACT Start
CON
SET @MR202               ; Task2 SEL_ACT Busy
CON
JMP @MR203
STG @MR203
AND R39202               ; SELECT_ACT Busy
AND<> DM60037 #0         ; SelectSW /SELECT_ACT
MPS
AND= DM60037 #1          ; SelectSW /SELECT_ACT
SET @MR205               ; SW1
CON
JMP @MR204
MRD
AND= DM60037 #2          ; SelectSW /SELECT_ACT
SET @MR206               ; SW2
CON
JMP @MR204
MRD
AND= DM60037 #3          ; SelectSW /SELECT_ACT
SET @MR207               ; SW3
CON
JMP @MR204
MPP
AND= DM60037 #4          ; SelectSW /SELECT_ACT
SET @MR208               ; SW4
CON
JMP @MR204
STG @MR204
ANB R39202               ; SELECT_ACT Busy
RES @MR202               ; Task2 SEL_ACT Busy
CON
SET @MR201               ; Task2 SEL_ACT END
CON
ENDS
;<h1/>※機能Macro呼出し見本- 削除して下さい。-------------------------------------
;<h1/>※Error:記述見本
;ERR163 "****Error"
;<h1/>※SELECT_ACT　:記述見本
;画面番号33をブザー有りで選択SW番号を左から#5,#10,#0(無し),#34の並びで表示する
;<h1/>※ SELECT_Y_N　記述見本
;//*Select_Y_N
;<h1/>HALT
LD R41202                ; TASK2 PAUSE 要求
AND @MR1900              ; Main1 HALT許可
LD @MR1901               ; Main2 HALT許可
ORB @MR4002              ; Main2 Busy
ANL
TMR @40 #5               ; HALT許可 遅延
CON
AND @T40                 ; HALT許可 遅延
SET R42602               ; Grp1_Task2_ﾎﾟｰｽﾞ許可
LD R42602                ; Grp1_Task2_ﾎﾟｰｽﾞ許可
ORB R41202               ; TASK2 PAUSE 要求
ANB @MR001               ; TASK2　ERROR
RES @MR1900              ; Main1 HALT許可
CON
RES @MR1901              ; Main2 HALT許可
END
ENDH
