DEVICE:53
;MODULE:Model_Change
;MODULE_TYPE:0
;機種切り替えは、ﾈｯﾄﾜｰｸに接続しているすべての機械が定停止状態であることが条件とする。
;そのため機種変更時、装置状態を監視し
;ﾀｯﾁﾊﾟﾈﾙ側、機種切り替え画面にｲﾝﾀｰﾛｯｸをかけておくこと。
;Set Model Infomation / 機種情報セット
;機種切り替え-IC名2：11520=0x2D00=4500(ASCII)
LD MR000                 ; 他装置通信無し=ON
MOV DM10000 DM200        ; 機種番号 from Host  機種番号
BMOV DM10015 DM215 #3    ; 機種名 1 from Host  機種名 1
BMOV DM10018 DM218 #2    ; 色 1 from Host  色 1
BMOV DM10020 DM220 #2    ; 仕向け 1 from Host  仕向け 1
BMOV DM10022 DM222 #2    ; ｻｲｽﾞ 1 from Host  ｻｲｽﾞ 1
BMOV DM10001 DM201 #10   ; 外ﾗﾍﾞﾙﾊﾞｰｺｰﾄﾞ 1 from Host  外ﾗﾍﾞﾙﾊﾞｰｺｰﾄﾞ 1
BMOV DM10024 DM224 #10   ; I/P ﾊﾞｰｺｰﾄﾞ 1 from Host  I/P ﾊﾞｰｺｰﾄﾞ 1
BMOV DM10011 DM211 #3    ; IC名 1-1 from Host  IC名 1-1
BMOV DM10034 DM234 #2    ; ﾘﾌﾞ 1 from Host  ﾘﾌﾞ 1
BMOV DM10040 DM240 #10   ; 個装箱ﾊﾞｰｺｰﾄﾞ 1 from Host  個装箱ﾊﾞｰｺｰﾄﾞ 1
BMOV DM10050 DM250 #9    ; 外装箱ﾊﾞｰｺｰﾄﾞ 1 from Host  外装箱ﾊﾞｰｺｰﾄﾞ 1
BMOV DM10059 DM259 #1    ; 外箱１・  個箱入り数  外箱１・  個箱入り数
BMOV DM10060 DM260 #9    ; 外装箱２   ﾊﾞｰｺｰﾄﾞ 1  外装箱２   ﾊﾞｰｺｰﾄﾞ 1
BMOV DM10069 DM269 #1    ; 外箱２・  個箱入り数  個製箱なし 入り数
LDB MR000                ; 他装置通信無し=ON
AND= DM10283 #1          ; 装置      起動指令
@MOV DM10200 DM200       ; 機種番号 from Host  機種番号
@BMOV DM10215 DM215 #3   ; 機種名 1 from Host  機種名 1
@BMOV DM10218 DM218 #2   ; 色 1 from Host  色 1
@BMOV DM10220 DM220 #2   ; 仕向け 1 from Host  仕向け 1
@BMOV DM10222 DM222 #2   ; ｻｲｽﾞ 1 from Host  ｻｲｽﾞ 1
@BMOV DM10201 DM201 #10  ; 外ﾗﾍﾞﾙﾊﾞｰｺｰﾄﾞ 1 from Host  外ﾗﾍﾞﾙﾊﾞｰｺｰﾄﾞ 1
@BMOV DM10224 DM224 #10  ; I/P ﾊﾞｰｺｰﾄﾞ 1 from Host  I/P ﾊﾞｰｺｰﾄﾞ 1
@BMOV DM10211 DM211 #3   ; IC名 1-1 from Host  IC名 1-1
@BMOV DM10234 DM234 #2   ; ﾘﾌﾞ 1 from Host  ﾘﾌﾞ 1
@BMOV DM10240 DM240 #10  ; 個装箱ﾊﾞｰｺｰﾄﾞ 1 from Host  個装箱ﾊﾞｰｺｰﾄﾞ 1
@BMOV DM10250 DM250 #9   ; 外装箱ﾊﾞｰｺｰﾄﾞ 1 from Host  外装箱ﾊﾞｰｺｰﾄﾞ 1
@BMOV DM10259 DM259 #1   ; 外箱１・  個箱入り数  外箱１・  個箱入り数
@BMOV DM10260 DM260 #9   ; 外装箱２   ﾊﾞｰｺｰﾄﾞ 1  外装箱２   ﾊﾞｰｺｰﾄﾞ 1
@BMOV DM10269 DM269 #1   ; 外箱２・  個箱入り数  個製箱なし 入り数
;Clear Model Infomation / 機種情報クリア
LD MR000                 ; 他装置通信無し=ON
AND= DM10013 #11520      ; IC名 2 from Host
LDB MR000                ; 他装置通信無し=ON
AND= DM10213 #11520      ; IC名 2 from Host
ORL
@FMOV #0 DM201 #99       ; 外ﾗﾍﾞﾙﾊﾞｰｺｰﾄﾞ 1
@MOV #0 DM200            ; 機種番号
LD= DM5023 #1            ; F-DATA     転送設定
AND CR2003               ; 常時OFF
@MOV DM5025 DM200        ; F-DATA     ﾌﾞﾛｯｸ番号  機種番号
LD= DM5023 #1            ; F-DATA     転送設定
TMR @0 #30
LD @T0
RES R41409               ; TPﾌｧｲﾘﾝｸﾞﾃﾞｰﾀ転送完了
CON
DW #0 DM5023             ; F-DATA     転送設定
;M/C Condition / 装置状態
LDB R50001               ; AUTO
ANB R50002               ; STEP
ANB R50003               ; HOME
MOV #0 DM10080           ; 装置状態
LD R50001                ; AUTO
OR R50002                ; STEP
OR R50003                ; HOME
MOV #1 DM10080           ; 装置状態
LD MR000                 ; 他装置通信無し=ON
@MOV #0 DM10081          ; 装置ｵﾝﾗｲﾝ
LDB MR000                ; 他装置通信無し=ON
@MOV #1 DM10081          ; 装置ｵﾝﾗｲﾝ
LDB R50007               ; 原点復帰　完了
@MOV #0 DM10082          ; 装置原点  復帰完了
LD R50007                ; 原点復帰　完了
@MOV #1 DM10082          ; 装置原点  復帰完了
LD= DM10180 #1           ; 装置状態
AND= DM10280 #1          ; 装置状態
LD= DM10180 #0           ; 装置状態
AND= DM10280 #1          ; 装置状態
ORL
LD= DM10180 #1           ; 装置状態
AND= DM10280 #0          ; 装置状態
ORL
ANB MR000                ; 他装置通信無し=ON
OUT MR300                ; 他装置動作中
LD>= DM200 #101          ; 機種番号
AND<= DM200 #168         ; 機種番号
AND CR2003               ; 常時OFF
OUT MR301                ; Gere=ON
LD>= DM200 #165          ; 機種番号
AND<= DM200 #168         ; 機種番号
OUT MR302                ; 初期充填用=ON
END
ENDH
