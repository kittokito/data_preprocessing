DEVICE:53
;MODULE:AlwaysMonitor
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	AlwaysMonitor
;ModuleType	:	Sub Module
;Function	:	常時監視
;---------------------------------------
;<使用方法>
;常時監視が必要な物は本ﾓｼﾞｭｰﾙ内に記述して下さい
;・ﾋｰﾀｰ過昇温検知による非常停止
;・ﾁｬﾝﾊﾞｰ排気量低下によるｴﾗｰ出力
;など
;<h1/>上流 H/S I/L ERROR
LDB DM2000.14            ; 上流H/S 無効(ON=無効)
ANB B2012                ; 上流ｾﾙよりインターロック信号
AND B2003                ; 上流ｾﾙへ動作開始通知
MPS
AND CR2002               ; 常時ON
MSTRT F_ERROR_DISP #0
MPP
@INC EM1180
;<h1/>下流 H/S I/L ERROR
LDB DM2000.15            ; 下流H/S 無効(ON=無効)
ANB B2022                ; 下流ｾﾙよりインターロック信号
AND B2023                ; 下流ｾﾙより動作開始通知
LD R36300                ; RB14 MOVE
OR R8805                 ; 下流ｾﾙ間ｽﾗｲﾀﾞｰ 前後 受取側
ANL
MPS
AND CR2002               ; 常時ON
MSTRT F_ERROR_DISP #1
MPP
@INC EM1182
;<h1/>常時監視異常
;　　真空圧低下異常
;　　照明エラー
LD R5400                 ; 画像検査OC
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #211 @DM1             ; ErrorNo /ERROR_DISP
CON
DW #5400 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
;<h1/>エアークリーンUT異常
LD CR2002                ; 常時ON
TMR @10 #100
CON
AND @T10
OUT MR100                ; エラー監視条件_ON監視
LD R3805                 ; ｵﾝﾗｲﾝ状態
AND MR100                ; エラー監視条件_ON監視
MC
LDB R4010                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(上流側)ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #4010 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R4011                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(上流側)ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #4011 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R4012                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(塗布1)ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #4012 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R4013                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(塗布1)ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #4013 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5612                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(NG排出) ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5612 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5613                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(NG排出) ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5613 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5614                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(搬送下流) ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5614 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5615                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(搬送下流) ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5615 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5700                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(検査) ALM1
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5700 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
LDB R5701                ; ｴｱｸﾘｰﾝﾕﾆｯﾄ(検査) ALM2
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
DW #3 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #5701 @DM2            ; SensorNo /ERROR_DISP
CON
SET @MR100
CON
SET @MR500
MCR
STG @MR500
AND @MR101
RES @MR101
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;<h1/>▽_異常処理
STG @MR100
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @MR105 @MR108
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #6 @DM0
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @MR102
CON
JMP @MR103
STG @MR103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
MPS
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @MR105
CON
JMP @MR104
MRD
AND= DM60007 @DM5        ; ReturnSW /ERROR_DISP
SET @MR106
CON
JMP @MR104
MRD
AND= DM60007 @DM4        ; ReturnSW /ERROR_DISP
SET @MR107
CON
JMP @MR104
MPP
AND= DM60007 @DM3        ; ReturnSW /ERROR_DISP
SET @MR108
CON
JMP @MR104
STG @MR104
ANB R39002               ; ERROR_DISP Busy
RES @MR102
CON
SET @MR101
CON
ENDS
;<h1/>ﾒｯｾｰｼﾞ表示
LD MR200                 ; 上流 I/L信号 待ち
MSTRT MSG_DISP #1 #0 #1 #0
LDF MR200                ; 上流 I/L信号 待ち
MSTRT MSG_DEL #1 #0
LD MR201                 ; 下流 I/L信号 待ち
MSTRT MSG_DISP #1 #1 #1 #0
LDF MR201                ; 下流 I/L信号 待ち
MSTRT MSG_DEL #1 #1
;<h1/>画像検査結果表示処理
;'画像検査結果処理
;
;IF D41000.U <= #0 THEN
;   D41000.U = 1
;END IF
;
;D41001.U = ( D41000.U - 1 ) * 10
;BMOV( D41020:D41001, D41010 , #10 )
;
;
;
;
LD CR2002                ; 常時ON
NCJ #1000
;'画像検査結果処理
;
;IF D41000.U <= #0 THEN
;
LD<= DM41000 #0          ; 画像履歴ﾍﾟｰｼﾞ
NCJ #2000
;   D41000.U = 1
;
LD CR2002                ; 常時ON
MOV #1 DM41000           ; 画像履歴ﾍﾟｰｼﾞ
;END IF
;
LABEL #2000
;D41001.U = ( D41000.U - 1 ) * 10
;
LD CR2002                ; 常時ON
LDA DM41000              ; 画像履歴ﾍﾟｰｼﾞ
CON
EXT
CON
SUB.L +1
CON
MUL.L +10
CON
STA DM41001
;BMOV( D41020:D41001, D41010 , #10 )
;
LD CR2002                ; 常時ON
LDA DM41001
CON
EXT
CON
STA.L Z12
BMOV DM41020:Z12 DM41010 #10;画像検査結果1  画像履歴表示ｴﾘｱ
LABEL #1000
;
END
ENDH
