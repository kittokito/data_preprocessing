DEVICE:53
;MODULE:RB_CON
;MODULE_TYPE:0
;SCRIPT_TYPE:
;IAI CON系コントロール
;
;使用例
;RB入力(PLC<-RB)DeviceNet割り付け先頭 : DM2000
;RB出力(PLC->RB)DeviceNet割り付け先頭 : DM2200
;
;DM1100-1101 : 現在値格納DM
;DM1102-1103 : Point1座標値
;DM1104-1105 : Point2座標値
;DM1106-1107 : Point3座標値
;…
;DM1120-1121 : Point10座標値
;
;使用方法概要
;１．各マクロ引数設定
;２．マクロ実行
;３．完了フラグON待ち
;４．完了コード20→正常終了　21以外→異常終了
;速度ﾃﾞｰﾀが6以上の時、強制的に6へ変更
;When the velocity data is six or more, it changes compulsorily to six.
LD> DM2704 #6            ; RB6移動速度
AND CR2003               ; 常時OFF
DW #6 DM2704             ; RB6移動速度
LD> DM2754 #6            ; RB7移動速度
AND CR2003               ; 常時OFF
DW #6 DM2754             ; RB7移動速度
LD> DM2804 #6            ; RB8移動速度
AND CR2003               ; 常時OFF
DW #6 DM2804             ; RB8移動速度
LD> DM2854 #6            ; RB9移動速度
AND CR2003               ; 常時OFF
DW #6 DM2854             ; RB9移動速度
LD> DM519 #6             ; STL Data09 注入 速度
AND CR2003               ; 常時OFF
DW #6 DM519              ; STL Data09 注入 速度
;注入RB下限値設定 / Infusion RB Lower Limit Setting
;速度 -> 0以下の場合1へ設定 / Speed -> If under the 0, will change 1.
;注入量 -> ﾊﾞｯｸﾗｯｼｭ量以下の場合、ﾊﾞｯｸﾗｯｼｭ量+100と同等に設定 / Infusion -> If under the Backrush value, Change the value, Backrush + 100.
LD<= DM2704 #0           ; RB6移動速度
DW #1 DM2704             ; RB6移動速度
LD<= DM2754 #0           ; RB7移動速度
DW #1 DM2754             ; RB7移動速度
LD<= DM2804 #0           ; RB8移動速度
DW #1 DM2804             ; RB8移動速度
LD<= DM2854 #0           ; RB9移動速度
DW #1 DM2854             ; RB9移動速度
LD<= DM519 #0            ; STL Data09 注入 速度
DW #1 DM519              ; STL Data09 注入 速度
LD< DM510 DM2740         ; STL Data00 注入1前進限PT  RB6_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
LDA DM2740               ; RB6_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
CON
ADD #100
CON
STA DM510                ; STL Data00 注入1前進限PT
LD< DM511 DM2790         ; STL Data01 注入2前進限PT  RB7_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
LDA DM2790               ; RB7_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
CON
ADD #100
CON
STA DM511                ; STL Data01 注入2前進限PT
LD< DM512 DM2840         ; STL Data02 注入3前進限PT  RB8_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
LDA DM2840               ; RB8_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
CON
ADD #100
CON
STA DM512                ; STL Data02 注入3前進限PT
LD< DM513 DM2890         ; STL Data03 注入4前進限PT  RB9_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
LDA DM2890               ; RB9_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)
CON
ADD #100
CON
STA DM513                ; STL Data03 注入4前進限PT
;注入時の	・RB目標位置（ﾊﾞｯｸﾗｯｼｭ量を加味した値)
;			・RBの位置決め完了幅
;			・速度
;をﾀｯﾁﾊﾟﾈﾙより設定できる。
;DM510 = DM3110				'STL Data00 注入1前進限PT
;DM511 = DM3116				'STL Data01 注入2前進限PT
;DM512 = DM3122				'STL Data02 注入3前進限PT
;DM513 = DM3128				'STL Data03 注入4前進限PT
;
;'DM514 = INTG(DM3112.F*1000)	'STL Data04 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;'DM515 = INTG(DM3118.F*1000)	'STL Data05 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;'DM516 = INTG(DM3124.F*1000)	'STL Data06 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;'DM517 = INTG(DM3130.F*1000)	'STL Data07 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;DM514 = INTG(DM3112.F)			'STL Data04 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;DM515 = INTG(DM3118.F)			'STL Data05 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;DM516 = INTG(DM3124.F)			'STL Data06 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;DM517 = INTG(DM3130.F)			'STL Data07 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;DM518 = #4					'STL Data08 注入位置決め幅
;DM519 = DM3114				'STL Data09 注入速度
LDB R59803               ; OfflineMode
NCJ #1000
;DM510 = DM3110				'STL Data00 注入1前進限PT
;
LD CR2002                ; 常時ON
MOV DM3110 DM510         ; RB6移動量1  STL Data00 注入1前進限PT
;DM511 = DM3116				'STL Data01 注入2前進限PT
;
LD CR2002                ; 常時ON
MOV DM3116 DM511         ; RB7移動量1  STL Data01 注入2前進限PT
;DM512 = DM3122				'STL Data02 注入3前進限PT
;
LD CR2002                ; 常時ON
MOV DM3122 DM512         ; RB8 Point1-1  STL Data02 注入3前進限PT
;DM513 = DM3128				'STL Data03 注入4前進限PT
;
LD CR2002                ; 常時ON
MOV DM3128 DM513         ; RB9 Point1-1  STL Data03 注入4前進限PT
;'DM514 = INTG(DM3112.F*1000)	'STL Data04 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
;'DM515 = INTG(DM3118.F*1000)	'STL Data05 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
;'DM516 = INTG(DM3124.F*1000)	'STL Data06 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
;'DM517 = INTG(DM3130.F*1000)	'STL Data07 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
;DM514 = INTG(DM3112.F)			'STL Data04 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
LD CR2002                ; 常時ON
LDA.F DM3112             ; RB6大気開放位置1
CON
INTG.L
CON
STA DM514                ; STL Data04 注入1大気開放(0.1%)
;DM515 = INTG(DM3118.F)			'STL Data05 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
LD CR2002                ; 常時ON
LDA.F DM3118             ; RB7大気開放位置1
CON
INTG.L
CON
STA DM515                ; STL Data05 注入2大気開放(0.1%)
;DM516 = INTG(DM3124.F)			'STL Data06 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
LD CR2002                ; 常時ON
LDA.F DM3124             ; RB8 Point2-1
CON
INTG.L
CON
STA DM516                ; STL Data06 注入3大気開放(0.1%)
;DM517 = INTG(DM3130.F)			'STL Data07 注入1大気開放ﾀｲﾐﾝｸﾞ0.1%
;
LD CR2002                ; 常時ON
LDA.F DM3130             ; RB9 Point2-1
CON
INTG.L
CON
STA DM517                ; STL Data07 注入4大気開放(0.1%)
;DM518 = #4					'STL Data08 注入位置決め幅
;
LD CR2002                ; 常時ON
MOV #4 DM518             ; STL Data08 注入 位置決め幅
;DM519 = DM3114				'STL Data09 注入速度
LD CR2002                ; 常時ON
MOV DM3114 DM519         ; RB6速度1  STL Data09 注入 速度
LABEL #1000
;
;<h1/>RB6
;HOME
LD MR14400               ; RB6 PCON原点復帰開始
@DW #0 @DM0
CON
MSTRT IAI_CON_HOME DM706 DM2000 DM2200 MR14402 @DM0 R50010 #50;RB6現在位置No.  RB6現在位置  RB6 目標位置  RB6 PCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14401              ; RB6 PCON原点復帰完了
CON
RES MR14400              ; RB6 PCON原点復帰開始
CON
SET MR14403              ; RB6 PCON   10703
STG MR14403              ; RB6 PCON   10703
AND MR14402              ; RB6 PCON原点復帰ﾏｸﾛ終了
AND= @DM0 #20
SET MR14401              ; RB6 PCON原点復帰完了
CON
RES MR14402              ; RB6 PCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND>.S DM2706 +20        ; RB6 RB補正値
DW.S +60 DM2706          ; RB6 RB補正値
MPP
AND<.S DM2706 -20        ; RB6 RB補正値
DW.S -60 DM2706          ; RB6 RB補正値
LD CR2002                ; 常時ON
MPS
ANB R59803               ; OfflineMode
MPS
LDA.D DM3110             ; RB6移動量1
CON
ADD.S DM2706             ; RB6 RB補正値
CON
STA.D DM2720             ; RB6_P2 位置ﾃﾞｰﾀ
MPP
LDA DM3114               ; RB6速度1
CON
STA DM2724               ; RB6_P2 速度ﾃﾞｰﾀ
MRD
AND R59803               ; OfflineMode
MPS
LDA DM510                ; STL Data00 注入1前進限PT
CON
EXT
CON
STA DM2720               ; RB6_P2 位置ﾃﾞｰﾀ
MPP
LDA DM519                ; STL Data09 注入 速度
CON
STA DM2724               ; RB6_P2 速度ﾃﾞｰﾀ
MPP
LDA DM518                ; STL Data08 注入 位置決め幅
CON
EXT
CON
STA DM2722               ; RB6_P2 位置決め完了幅ﾃﾞｰﾀ
LD MR14405               ; RB6 PCON移動開始
@DW #0 @DM1
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_1 DM2700 DM2702 DM2704 DM2000 DM2200 MR14407 @DM1 R50010 #50;RB6移動目標位置  RB6位置決め完了幅  RB6移動速度  RB6現在位置  RB6 目標位置  RB6 PCON移動中  Emergency　Stop
RES MR14405              ; RB6 PCON移動開始
CON
SET MR14408              ; RB6 PCON   10708
STG MR14408              ; RB6 PCON   10708
AND MR14407              ; RB6 PCON移動中
ANB _IAI_CON_MOVE_1
MPS
AND= @DM1 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14409              ; RB6 PCON移動NG
CON
SET MR14406              ; RB6 PCON移動完了
CON
RES MR14407              ; RB6 PCON移動中
CON
ENDS
MPP
AND<> @DM1 #20
SET MR14409              ; RB6 PCON移動NG
CON
SET MR14406              ; RB6 PCON移動完了
CON
RES MR14407              ; RB6 PCON移動中
CON
ENDS
;<h1/>RB7
;HOME
LD MR14500               ; RB7 PCON原点復帰開始
@DW #0 @DM2
CON
MSTRT IAI_CON_HOME DM708 DM2008 DM2208 MR14502 @DM2 R50010 #50;RB7現在位置No.  RB7 現在位置  RB7 目標位置  RB7 PCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14501              ; RB7 PCON原点復帰完了
CON
RES MR14500              ; RB7 PCON原点復帰開始
CON
SET MR14503              ; RB7 PCON   10703
STG MR14503              ; RB7 PCON   10703
AND MR14502              ; RB7 PCON原点復帰ﾏｸﾛ終了
AND= @DM2 #20
SET MR14501              ; RB7 PCON原点復帰完了
CON
RES MR14502              ; RB7 PCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;注入時の	・RB目標位置（ﾊﾞｯｸﾗｯｼｭ量を加味した値)
;			・RBの位置決め完了幅
;			・速度
;をﾀｯﾁﾊﾟﾈﾙより設定できる。
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND>.S DM2756 +3000      ; RB7 RB補正値
DW.S +60 DM2756          ; RB7 RB補正値
MPP
AND<.S DM2756 -3000      ; RB7 RB補正値
DW.S -60 DM2756          ; RB7 RB補正値
LD CR2002                ; 常時ON
MPS
ANB R59803               ; OfflineMode
MPS
LDA.D DM3116             ; RB7移動量1
CON
ADD.S DM2756             ; RB7 RB補正値
CON
STA.D DM2770             ; RB7_P2 位置ﾃﾞｰﾀ
MPP
LDA DM3120               ; RB7速度1
CON
STA DM2774               ; RB7_P2 速度ﾃﾞｰﾀ
MRD
AND R59803               ; OfflineMode
MPS
LDA DM511                ; STL Data01 注入2前進限PT
CON
EXT
CON
STA DM2770               ; RB7_P2 位置ﾃﾞｰﾀ
MPP
LDA DM519                ; STL Data09 注入 速度
CON
STA DM2774               ; RB7_P2 速度ﾃﾞｰﾀ
MPP
LDA DM518                ; STL Data08 注入 位置決め幅
CON
EXT
CON
STA DM2772               ; RB7_P2 位置決め完了幅ﾃﾞｰﾀ
LD MR14505               ; RB7 PCON移動開始
@DW #0 @DM3
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_2 DM2750 DM2752 DM2754 DM2008 DM2208 MR14507 @DM3 R50010 #50;RB7移動目標位置  RB7位置決め完了幅  RB7移動速度  RB7 現在位置  RB7 目標位置  RB7 PCON移動中  Emergency　Stop
RES MR14505              ; RB7 PCON移動開始
CON
SET MR14508              ; RB7 PCON   10708
STG MR14508              ; RB7 PCON   10708
AND MR14507              ; RB7 PCON移動中
ANB _IAI_CON_MOVE_2
MPS
AND= @DM3 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14509              ; RB7 PCON移動NG
CON
SET MR14506              ; RB7 PCON移動完了
CON
RES MR14507              ; RB7 PCON移動中
CON
ENDS
MPP
AND<> @DM3 #20
SET MR14509              ; RB7 PCON移動NG
CON
SET MR14506              ; RB7 PCON移動完了
CON
RES MR14507              ; RB7 PCON移動中
CON
ENDS
;<h1/>RB8
;HOME
LD MR14600               ; RB8 PCON原点復帰開始
@DW #0 @DM4
CON
MSTRT IAI_CON_HOME DM710 DM2016 DM2216 MR14602 @DM4 R50010 #50;RB8現在位置No.  RB8現在位置  RB8 目標位置  RB8 PCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14601              ; RB8 PCON原点復帰完了
CON
RES MR14600              ; RB8 PCON原点復帰開始
CON
SET MR14603              ; RB8 PCON   10703
STG MR14603              ; RB8 PCON   10703
AND MR14602              ; RB8 PCON原点復帰ﾏｸﾛ終了
AND= @DM4 #20
SET MR14601              ; RB8 PCON原点復帰完了
CON
RES MR14602              ; RB8 PCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;注入時の	・RB目標位置（ﾊﾞｯｸﾗｯｼｭ量を加味した値)
;			・RBの位置決め完了幅
;			・速度
;をﾀｯﾁﾊﾟﾈﾙより設定できる。
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND>.S DM2806 +3000      ; RB8 RB補正値
DW.S +60 DM2806          ; RB8 RB補正値
MPP
AND<.S DM2806 -3000      ; RB8 RB補正値
DW.S -60 DM2806          ; RB8 RB補正値
LD CR2002                ; 常時ON
MPS
ANB R59803               ; OfflineMode
MPS
LDA.D DM3122             ; RB8 Point1-1
CON
ADD.S DM2806             ; RB8 RB補正値
CON
STA.D DM2820             ; RB8_P2 位置ﾃﾞｰﾀ
MPP
LDA DM3126               ; RB8 V1
CON
STA DM2824               ; RB8_P2 速度ﾃﾞｰﾀ
MRD
AND R59803               ; OfflineMode
MPS
LDA DM512                ; STL Data02 注入3前進限PT
CON
EXT
CON
STA DM2820               ; RB8_P2 位置ﾃﾞｰﾀ
MPP
LDA DM519                ; STL Data09 注入 速度
CON
STA DM2824               ; RB8_P2 速度ﾃﾞｰﾀ
MPP
LDA DM518                ; STL Data08 注入 位置決め幅
CON
EXT
CON
STA DM2822               ; RB8_P2 位置決め完了幅ﾃﾞｰﾀ
LD MR14605               ; RB8 PCON移動開始
@DW #0 @DM5
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_3 DM2800 DM2802 DM2804 DM2016 DM2216 MR14607 @DM5 R50010 #50;RB8移動目標位置  RB8位置決め完了幅  RB8移動速度  RB8現在位置  RB8 目標位置  RB8 PCON移動中  Emergency　Stop
RES MR14605              ; RB8 PCON移動開始
CON
SET MR14608              ; RB8 PCON   10708
STG MR14608              ; RB8 PCON   10708
AND MR14607              ; RB8 PCON移動中
ANB _IAI_CON_MOVE_3
MPS
AND= @DM5 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14609              ; RB8 PCON移動NG
CON
SET MR14606              ; RB8 PCON移動完了
CON
RES MR14607              ; RB8 PCON移動中
CON
ENDS
MPP
AND<> @DM5 #20
SET MR14609              ; RB8 PCON移動NG
CON
SET MR14606              ; RB8 PCON移動完了
CON
RES MR14607              ; RB8 PCON移動中
CON
ENDS
;<h1/>RB9
;HOME
LD MR14700               ; RB9 PCON原点復帰開始
@DW #0 @DM6
CON
MSTRT IAI_CON_HOME DM712 DM2024 DM2224 MR14702 @DM6 R50010 #50;RB9現在位置No.  RB9 現在位置  RB9 目標位置  RB9 PCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14701              ; RB9 PCON原点復帰完了
CON
RES MR14700              ; RB9 PCON原点復帰開始
CON
SET MR14703              ; RB9 PCON   10703
STG MR14703              ; RB9 PCON   10703
AND MR14702              ; RB9 PCON原点復帰ﾏｸﾛ終了
AND= @DM6 #20
SET MR14701              ; RB9 PCON原点復帰完了
CON
RES MR14702              ; RB9 PCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;注入時の	・RB目標位置（ﾊﾞｯｸﾗｯｼｭ量を加味した値)
;			・RBの位置決め完了幅
;			・速度
;をﾀｯﾁﾊﾟﾈﾙより設定できる。
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND>.S DM2856 +3000      ; RB9 RB補正値
DW.S +60 DM2856          ; RB9 RB補正値
MPP
AND<.S DM2856 -3000      ; RB9 RB補正値
DW.S -60 DM2856          ; RB9 RB補正値
LD CR2002                ; 常時ON
MPS
ANB R59803               ; OfflineMode
MPS
LDA.D DM3128             ; RB9 Point1-1
CON
ADD.S DM2856             ; RB9 RB補正値
CON
STA.D DM2870             ; RB9_P2 位置ﾃﾞｰﾀ
MPP
LDA DM3132               ; RB9 V1
CON
STA DM2874               ; RB9_P2 速度ﾃﾞｰﾀ
MRD
AND R59803               ; OfflineMode
MPS
LDA DM513                ; STL Data03 注入4前進限PT
CON
EXT
CON
STA DM2870               ; RB9_P2 位置ﾃﾞｰﾀ
MPP
LDA DM519                ; STL Data09 注入 速度
CON
STA DM2874               ; RB9_P2 速度ﾃﾞｰﾀ
MPP
LDA DM518                ; STL Data08 注入 位置決め幅
CON
EXT
CON
STA DM2872               ; RB9_P2 位置決め完了幅ﾃﾞｰﾀ
LD MR14705               ; RB9 PCON移動開始
@DW #0 @DM7
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_4 DM2850 DM2852 DM2854 DM2024 DM2224 MR14707 @DM7 R50010 #50;RB9移動目標位置  RB9位置決め完了幅  RB9移動速度  RB9 現在位置  RB9 目標位置  RB9 PCON移動中  Emergency　Stop
RES MR14705              ; RB9 PCON移動開始
CON
SET MR14708              ; RB9 PCON   10708
STG MR14708              ; RB9 PCON   10708
AND MR14707              ; RB9 PCON移動中
ANB _IAI_CON_MOVE_4
MPS
AND= @DM7 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14709              ; RB9 PCON移動NG
CON
SET MR14706              ; RB9 PCON移動完了
CON
RES MR14707              ; RB9 PCON移動中
CON
ENDS
MPP
AND<> @DM7 #20
SET MR14709              ; RB9 PCON移動NG
CON
SET MR14706              ; RB9 PCON移動完了
CON
RES MR14707              ; RB9 PCON移動中
CON
ENDS
;<h1/>RB10
;HOME
LD MR14800               ; RB10 PCON原点復帰開始
@DW #0 @DM8
CON
MSTRT IAI_CON_HOME DM714 DM2032 DM2232 MR14802 @DM8 R50010 #50;RB10現在位置No.  RB10現在位置  RB10 目標位置  RB10 PCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14801              ; RB10 PCON原点復帰完了
CON
RES MR14800              ; RB10 PCON原点復帰開始
CON
SET MR14803              ; RB10 PCON   10703
STG MR14803              ; RB10 PCON   10703
AND MR14802              ; RB10 PCON原点復帰ﾏｸﾛ終了
AND= @DM8 #20
SET MR14801              ; RB10 PCON原点復帰完了
CON
RES MR14802              ; RB10 PCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND= DM2910 #1           ; RB10 目標No.
LDA DM500                ; ST2 ﾘｰｸﾍｯﾄﾞﾒﾝﾃﾅﾝｽ高さ
CON
EXT
CON
STA DM2900               ; RB10移動目標位置
MRD
AND= DM2910 #2           ; RB10 目標No.
LDA DM501                ; ST2 ﾘｰｸﾍｯﾄﾞ待機高さ
CON
EXT
CON
STA DM2900               ; RB10移動目標位置
MRD
AND= DM2910 #3           ; RB10 目標No.
LDA DM502                ; ST2 ﾘｰｸﾍｯﾄﾞｸﾗﾝﾌﾟ高さ
CON
EXT
CON
STA DM2900               ; RB10移動目標位置
MRD
DW.D #4 DM2902           ; RB10位置決め完了幅
MPP
LDA DM503                ; ST2 ﾘｰｸﾍｯﾄﾞ移動速度
CON
STA DM2904               ; RB10移動速度
LD MR14805               ; RB10 PCON移動開始
@DW #0 @DM9
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_6 DM2900 DM2902 DM2904 DM2032 DM2232 MR14807 @DM9 R50010 #50;RB10移動目標位置  RB10位置決め完了幅  RB10移動速度  RB10現在位置  RB10 目標位置  RB10 PCON移動中  Emergency　Stop
RES MR14805              ; RB10 PCON移動開始
CON
SET MR14808              ; RB10 PCON   移動中
STG MR14808              ; RB10 PCON   移動中
AND MR14807              ; RB10 PCON移動中
ANB _IAI_CON_MOVE_6
MPS
AND= @DM9 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14809              ; RB10 PCON移動NG
CON
SET MR14806              ; RB10 PCON移動完了
CON
RES MR14807              ; RB10 PCON移動中
CON
ENDS
MPP
AND<> @DM9 #20
SET MR14809              ; RB10 PCON移動NG
CON
SET MR14806              ; RB10 PCON移動完了
CON
RES MR14807              ; RB10 PCON移動中
CON
ENDS
;<h1/>RB11
;HOME
LD MR14900               ; RB11 SCON原点復帰開始
@DW #0 @DM10
CON
MSTRT IAI_CON_HOME DM716 DM2040 DM2240 MR14902 @DM10 R50010 #50;RB11現在位置No.  RB11 現在位置  RB11 目標位置  RB11 SCON原点復帰ﾏｸﾛ終了  Emergency　Stop
RES MR14901              ; RB11 SCON原点復帰完了
CON
RES MR14900              ; RB11 SCON原点復帰開始
CON
SET MR14903              ; RB11 SCON   10703
STG MR14903              ; RB11 SCON   10703
AND MR14902              ; RB11 SCON原点復帰ﾏｸﾛ終了
AND= @DM10 #20
SET MR14901              ; RB11 SCON原点復帰完了
CON
RES MR14902              ; RB11 SCON原点復帰ﾏｸﾛ終了
CON
ENDS
;MOVE
;RB移動量補正
;RB movement amount correction
LD CR2002                ; 常時ON
MPS
AND= DM2960 #1           ; RB11 目標No.
LDA DM533                ; ST4 ｶｰﾄﾘｯｼﾞ1溶着位置(0.01mm)
CON
EXT
CON
STA DM2950               ; RB11移動目標位置
MRD
AND= DM2960 #2           ; RB11 目標No.
LDA DM534                ; ST4 ｶｰﾄﾘｯｼﾞ2溶着位置(0.01mm)
CON
EXT
CON
STA DM2950               ; RB11移動目標位置
MRD
AND= DM2960 #3           ; RB11 目標No.
LDA DM535                ; ST4 ｶｰﾄﾘｯｼﾞ3溶着位置(0.01mm)
CON
EXT
CON
STA DM2950               ; RB11移動目標位置
MRD
AND= DM2960 #4           ; RB11 目標No.
LDA DM536                ; ST4 ｶｰﾄﾘｯｼﾞ4溶着位置(0.01mm)
CON
EXT
CON
STA DM2950               ; RB11移動目標位置
MRD
AND< DM537 #1            ; ST4 供給孔ｼﾌﾄ速度(mm/s)
DW #1 DM537              ; ST4 供給孔ｼﾌﾄ速度(mm/s)
MRD
AND> DM537 #600          ; ST4 供給孔ｼﾌﾄ速度(mm/s)
DW #537 DM537            ; ST4 供給孔ｼﾌﾄ速度(mm/s)
MRD
DW.D #4 DM2952           ; RB11位置決め完了幅
MPP
LDA DM537                ; ST4 供給孔ｼﾌﾄ速度(mm/s)
CON
STA DM2954               ; RB11移動速度
LD MR14905               ; RB11 SCON移動開始
@DW #0 @DM11
CON
LDA DM1081               ; ？
CON
STA @DM20
CON
MSTRT IAI_CON_MOVE_7 DM2950 DM2952 DM2954 DM2040 DM2240 MR14907 @DM11 R50010 #50;RB11移動目標位置  RB11位置決め完了幅  RB11移動速度  RB11 現在位置  RB11 目標位置  RB11 SCON移動終了  Emergency　Stop
RES MR14905              ; RB11 SCON移動開始
CON
SET MR14908              ; RB11 SCON   移動中
STG MR14908              ; RB11 SCON   移動中
AND MR14907              ; RB11 SCON移動終了
ANB _IAI_CON_MOVE_7
MPS
AND= @DM11 #20
LDA DM1081               ; ？
CON
STA DM1080               ; ？
CON
RES MR14909              ; RB11 SCON移動NG
CON
SET MR14906              ; RB11 SCON移動完了
CON
RES MR14907              ; RB11 SCON移動終了
CON
ENDS
MPP
AND<> @DM11 #20
SET MR14909              ; RB11 SCON移動NG
CON
SET MR14906              ; RB11 SCON移動完了
CON
RES MR14907              ; RB11 SCON移動終了
CON
ENDS
;位置ﾌﾗｸﾞ Position flag
LD DM2047.4
AND DM2047.1
AND DM2047.0
ANB DM2047.2
MPS
LD>=.L DM2040 +900       ; RB11 現在位置
AND<.L DM2040 +1200      ; RB11 現在位置
ANL
OUT MR14911              ; RB11 P1
MRD
LD>=.L DM2040 +6100      ; RB11 現在位置
AND<.L DM2040 +6400      ; RB11 現在位置
ANL
OUT MR14912              ; RB11 P2
MRD
LD>=.L DM2040 +11300     ; RB11 現在位置
AND<.L DM2040 +11600     ; RB11 現在位置
ANL
OUT MR14913              ; RB11 P3
MPP
LD>=.L DM2040 +16500     ; RB11 現在位置
AND<.L DM2040 +16800     ; RB11 現在位置
ANL
OUT MR14914              ; RB11 P4
END
ENDH
