DEVICE:53
;MODULE:DataCollection
;MODULE_TYPE:0
LD R50010                ; Emergency　Stop
OR @MR015
ZRES @MR001 @MR215
CON
ANB @T6
OUT @MR015
TMR @6 #5
;
LD CR2002                ; 常時ON
MOV #4 W1B61             ; CellID
OUT B05B1                ; ON Line Flag
;Model Infomation
LD CR2002                ; 常時ON
MPS
AND= W1B6C $2D53         ; サイズ2_from Host
MPS
AND> W1BCD #12000        ; 注入ｻｲｽﾞ1_from Host
OUT R25000               ; S (>12000gr)
MRD
LD<= W1BCD #12000        ; 注入ｻｲｽﾞ1_from Host
AND> W1BCD #9000         ; 注入ｻｲｽﾞ1_from Host
ANL
OUT R25001               ; S (<=12000gr and >9000gr)
MPP
AND<= W1BCD #9000        ; 注入ｻｲｽﾞ1_from Host
OUT R25002               ; S (<=9000gr)
MRD
AND= W1B6C $2D4C         ; サイズ2_from Host
MPS
AND>= W1BCD #46000       ; 注入ｻｲｽﾞ1_from Host
OUT R25003               ; L (>=46000gr)
MPP
LD< W1BCD #46000         ; 注入ｻｲｽﾞ1_from Host
AND> W1BCD #12000        ; 注入ｻｲｽﾞ1_from Host
ANL
OUT R25004               ; L (<46000gr and >12000gr)
MPP
LD= W1B6C $4C4C          ; サイズ2_from Host
AND>= W1BCD #60000       ; 注入ｻｲｽﾞ1_from Host
ANL
OUT R25005               ; LL (>=60000gr)
;↓調整用/支給されたワークのQRに書き換えして使用
LD MR915                 ; 仮NAT
MPS
AND MR111                ; Sｻｲｽﾞ
SMOV "T05D4" W1B6D       ; QRｺｰﾄﾞ1-1_from Host
SMOV "T05D4" W1B71       ; QRｺｰﾄﾞ2-1_from Host
SMOV "LC" W1BA0          ; LotNo3_from Host
MPP
AND MR112                ; Lｻｲｽﾞ
SMOV "T3591" W1B6D       ; QRｺｰﾄﾞ1-1_from Host
SMOV "T3591" W1B71       ; QRｺｰﾄﾞ2-1_from Host
SMOV "ND" W1BA0          ; LotNo3_from Host
;
LD CR2002                ; 常時ON
BMOV W1B62 DM3000 #100   ; 機種番号_from Host  機種番号
MPS
AND MR15415              ; ON=Opus 
MPS
LDA DM31522
CON
SUB #95
CON
STA DM31530
MRD
LDA DM31523
CON
SUB #20224
CON
STA DM31531
MRD
LDA DM31512
CON
SUB #95
CON
STA DM31532
MRD
LDA DM31513
CON
SUB #20224
CON
STA DM31533
MRD
LDA DM35522
CON
SUB #95
CON
STA DM31534
MRD
LDA DM35523
CON
SUB #20224
CON
STA DM31535
MRD
LDA DM35512
CON
SUB #95
CON
STA DM31536
MPP
LDA DM35513
CON
SUB #20224
CON
STA DM31537
MRD
BMOV W1BC6 DM3100 #18    ; ｻﾃﾗｲﾄNo_from Host  ｻﾃﾗｲﾄNo
MRD
BMOV W1BD4 DM3114 #4     ; RB6速度1_from Host  RB6速度1
MRD
BMOV W1BDA DM3120 #4     ; RB7速度1_from Host  RB7速度1
MRD
BMOV W1BE0 DM3126 #4     ; RB8速度1_from Host  RB8 V1
MRD
BMOV W1BE6 DM3132 #4     ; RB9速度1_from Host  RB9 V1
MRD
AND= W1B6C $2D53         ; サイズ2_from Host
MPS
AND R25000               ; S (>12000gr)
BMOV W1BE8 DM3112 #2     ; S Size Air Release Posion  RB6大気開放位置1
BMOV W1BE8 DM3118 #2     ; S Size Air Release Posion  RB7大気開放位置1
BMOV W1BE8 DM3124 #2     ; S Size Air Release Posion  RB8 Point2-1
BMOV W1BE8 DM3130 #2     ; S Size Air Release Posion  RB9 Point2-1
MOV.F +80 DM3112         ; RB6大気開放位置1
MOV.F +80 DM3118         ; RB7大気開放位置1
MOV.F +80 DM3124         ; RB8 Point2-1
MOV.F +80 DM3130         ; RB9 Point2-1
MRD
AND R25001               ; S (<=12000gr and >9000gr)
MOV.F +60 DM3112         ; RB6大気開放位置1
MOV.F +60 DM3118         ; RB7大気開放位置1
MOV.F +60 DM3124         ; RB8 Point2-1
MOV.F +60 DM3130         ; RB9 Point2-1
MPP
AND R25002               ; S (<=9000gr)
MOV.F +30 DM3112         ; RB6大気開放位置1
MOV.F +30 DM3118         ; RB7大気開放位置1
MOV.F +30 DM3124         ; RB8 Point2-1
MOV.F +30 DM3130         ; RB9 Point2-1
MRD
AND= W1B6C $2D4C         ; サイズ2_from Host
MPS
AND R25003               ; L (>=46000gr)
BMOV W1BEA DM3112 #2     ; L Size Air Release Posion  RB6大気開放位置1
BMOV W1BEA DM3118 #2     ; L Size Air Release Posion  RB7大気開放位置1
BMOV W1BEA DM3124 #2     ; L Size Air Release Posion  RB8 Point2-1
BMOV W1BEA DM3130 #2     ; L Size Air Release Posion  RB9 Point2-1
MOV.F +60 DM3112         ; RB6大気開放位置1
MOV.F +60 DM3118         ; RB7大気開放位置1
MOV.F +60 DM3124         ; RB8 Point2-1
MOV.F +60 DM3130         ; RB9 Point2-1
MPP
AND R25004               ; L (<46000gr and >12000gr)
MOV.F +80 DM3112         ; RB6大気開放位置1
MOV.F +80 DM3118         ; RB7大気開放位置1
MOV.F +80 DM3124         ; RB8 Point2-1
MOV.F +80 DM3130         ; RB9 Point2-1
MPP
LD= W1B6C $4C4C          ; サイズ2_from Host
AND R25005               ; LL (>=60000gr)
ANL
BMOV W1BEA DM3112 #2     ; L Size Air Release Posion  RB6大気開放位置1
BMOV W1BEA DM3118 #2     ; L Size Air Release Posion  RB7大気開放位置1
BMOV W1BEA DM3124 #2     ; L Size Air Release Posion  RB8 Point2-1
BMOV W1BEA DM3130 #2     ; L Size Air Release Posion  RB9 Point2-1
MOV.F +60 DM3112         ; RB6大気開放位置1
MOV.F +60 DM3118         ; RB7大気開放位置1
MOV.F +60 DM3124         ; RB8 Point2-1
MOV.F +60 DM3130         ; RB9 Point2-1
;<h1/>エラー発生
;Error Occurs
LD R50108                ; ｴﾗｰ中
MOV DM400 W03E8          ; ﾒｯｾｰｼﾞNo.
MPS
AND R50110               ; Err INDEX
MOV #1 W03E9
MRD
AND R50111               ; Err ST1
MOV #2 W03E9
MRD
AND R50112               ; Err ST2
MOV #3 W03E9
MRD
AND R50113               ; Err ST3
MOV #4 W03E9
MRD
AND R50114               ; Err ST4
MOV #5 W03E9
MRD
AND R51400               ; Err IND2
MOV #6 W03E9
MRD
AND R51401               ; Err IND2ST1
MOV #7 W03E9
MRD
AND R51402               ; Err IND2ST2
MOV #8 W03E9
MRD
AND R51403               ; Err IND2ST3
MOV #9 W03E9
MRD
AND R51404               ; Err IND2ST4
MOV #9 W03E9
MRD
AND R51600               ; Err IND3
MOV #10 W03E9
MRD
AND R51601               ; Err IND3ST1
MOV #11 W03E9
MRD
AND R51601               ; Err IND3ST1
MOV #12 W03E9
MRD
AND R51602               ; Err IND3ST2
MOV #13 W03E9
MRD
AND R51603               ; Err IND3ST3
MOV #14 W03E9
MRD
LDB R50110               ; Err INDEX
ANB R50111               ; Err ST1
ANB R50112               ; Err ST2
ANB R50113               ; Err ST3
ANB R50114               ; Err ST4
ANB R51400               ; Err IND2
ANB R51401               ; Err IND2ST1
ANB R51402               ; Err IND2ST2
ANB R51403               ; Err IND2ST3
ANB R51404               ; Err IND2ST4
ANB R51600               ; Err IND3
ANB R51601               ; Err IND3ST1
ANB R51602               ; Err IND3ST2
ANB R51603               ; Err IND3ST3
ANB R51604               ; Err IND3ST4
ANL
MOV #0 W03E9
MPP
MOV DM409 W03EA          ; ｾﾝｻｰｴﾗｰ No.
LD R50108                ; ｴﾗｰ中
ANB @MR014
TMS @0 #6
LD @T0
MPS
ANB _MCR_ERROR_1
MSTRT MCR_ERROR_1 R50108 @MR001 W03E8 B05B1 @MR002 B05A0 #1;ｴﾗｰ中  ON Line Flag
MPP
AND _MCR_ERROR_1
@SET @MR014
STG @MR014
ANB _MCR_ERROR_1
RES @MR002
CON
ENDS
;<h1/>Error Output
LD R50108                ; ｴﾗｰ中
OUT B0642
;<h1/>装置状態
;M/C Condition
LD R50008                ; Error
@MOV #7 W03F1
LDB R50008               ; Error
MPS
AND R50300               ; Pause
@MOV #5 W03F1
MPP
ANB R50300               ; Pause
MPS
AND R50003               ; HOME
@MOV #1 W03F1
MPP
ANB R50003               ; HOME
MPS
AND R50001               ; AUTO
@MOV #2 W03F1
MPP
ANB R50001               ; AUTO
MPS
AND R50002               ; STEP
@MOV #3 W03F1
MPP
ANB R50002               ; STEP
MPS
AND R50007               ; 原点復帰　完了
@MOV #4 W03F1
MPP
ANB R50007               ; 原点復帰　完了
@MOV #11 W03F1
LD<> W03F1 DM9600
SET B05A8
MOV W03F1 DM9600
;<h1/>ｻｲｸﾙﾀｲﾑ出力
;Cycle Time Output
LDP R50209               ; IND1     動作開始
MPS
LD>= DM5181 #80          ; Total to panel
AND<= DM5181 #400        ; Total to panel
ANL
SET B05A9                ; C/T to DC
MRD
@MOV DM5181 W03F3        ; Total to panel
MRD
@MOV DM5183 W03F4        ; ST1 to panel
MRD
@MOV DM5185 W03F5        ; ST2 to panel
MRD
@MOV DM5187 W03F6        ; ST3 to panel
MRD
@MOV DM5189 W03F7        ; ST4 to panel
MPP
@MOV DM5199 W0400        ; INDEX to panel
LDP R51300               ; IND2     動作開始
OR R20015                ; C/T2
ANB R23515               ; C/T2 FromHost
SET B05B2
@MOV DM6001 W03F8
@MOV DM6003 W03F9
@MOV DM6007 W03FA
@MOV DM6009 W03FB
@MOV DM6011 W0401
LDP R51500               ; IND3     動作開始
OR R20207                ; C/T3
ANB R23707               ; C/T3 from Host
SET B05B3
@MOV DM6021 W03FC
@MOV DM6025 W03FD
@MOV DM6027 W03FE
@MOV DM6029 W03FF
@MOV DM6031 W0402
;溶着データ
;剥離F
LDP R51303               ; IND2 ST3   1ｻｲｸﾙ終了
SET B05B4
@BMOV DM3220 W041E #10   ; IND2-ST3 QRID-1
@BMOV DM10506 W0428 #6   ; 剥離F 接触点ﾃﾞｰﾀ  R-F Touch Point Data
@MOV DM262 W042E         ; R-F temperture
@MOV DM7000 W042F        ; RB1_終了ｺｰﾄﾞ  R-F Welding Result
;供給孔F
LDP MR808
MPS
RES MR808
CON
SET B05B5
MRD
@BMOV DM10500 W0442 #6   ; 供給孔 接触点ﾃﾞｰﾀ  S-F Touch Point Data
MRD
@MOV DM260 W0448         ; S-F Temperture
MPP
@MOV DM7001 W0449        ; RB2_PSEL_終了ｺｰﾄﾞ  S-F Welding Result
;Inkweight / 重量出力
LD MR809
MPS
RES MR809
CON
SET B05B7
MRD
BMOV DM10450 W0472 #10   ; SR2_Tｺｰﾄﾞﾃﾞｰﾀ
MRD
MOV W1BC6 W047C          ; ｻﾃﾗｲﾄNo_from Host
MRD
MOV DM3772 W0486         ; SCALE ﾘｰｸ検査PNo.
MRD
BMOV DM3190 W047D #6     ; Ink Lot No.[1]
MRD
LDA.D DM1037             ; Ink Weight Data
CON
STA W0483
MRD
LDA.D DM1040             ; Judgment USL
CON
STA W0484
MPP
LDA.D DM1042             ; Judgment LSL
CON
STA W0485
;Input & Output & NG Count Output / 入力数・出力数・NG数出力
LD MR20000               ; 入力ｶｳﾝﾄ for DC 1
OR R20004                ; Input1
ANB R23504               ; Input1 FromHost
OUT B05A4
RES MR20000              ; 入力ｶｳﾝﾄ for DC 1
LD MR20002               ; 出力ｶｳﾝﾄ for DC 1
OR R20006                ; Output1
ANB R23506               ; Output1 FromHost
OUT B05A5
RES MR20002              ; 出力ｶｳﾝﾄ for DC 1
LD MR20004               ; NGｶｳﾝﾄ for DC 1
OR R20008                ; NG1
ANB R23508               ; NG1 FromHost
OUT B05A6
RES MR20004              ; NGｶｳﾝﾄ for DC 1
LD CR2002                ; 常時ON
MOV DM5000 W03EE         ; Input数
MOV DM5001 W03EF         ; Output数
MOV DM5002 W03F0         ; NG数
;CurrentProgram Data Output / プログラムデータ出力
LD CR2002                ; 常時ON
BMOV CM1740 W0404 #16    ; ﾗﾀﾞｰﾌﾟﾛｼﾞｪｸﾄ名
LD CR2008                ; 運転開始時1ｽｷｬﾝON
ORP R50004               ; TASKDO
OR R20102                ; ProgramInfo1
ANB R23602               ; ProgramInfo1 FromHost
OUT B05AA
;Model Change NG
LDB R22108               ; 機種照合NG FromHost
BORB DM19736 #5          ; ﾉｰﾄﾞｽﾃｰﾀｽ一覧(9-12)
ORB LR200                ; 機種切替NG有効
RES @MR200
CON
OUT R50700               ; 機種切替OK
BLD DM19736 #5           ; ﾉｰﾄﾞｽﾃｰﾀｽ一覧(9-12)
AND R22108               ; 機種照合NG FromHost
ANB R50001               ; AUTO
ANB R50002               ; STEP
ANB R50003               ; HOME
TMR @5 #20
CON
AND @T5
AND LR200                ; 機種切替NG有効
SET @MR200
LDP @MR200
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50111               ; Err ST1
CON
SET LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
SET @MR201
MOV #185 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR201
AND R50008               ; Error
JMP @MR202
STG @MR202
ANB R50008               ; Error
ENDS
;Satelite Change 
;****ErrCode*****
;00:OK
;01:Host通信ﾀｲﾑｱｳﾄ
;02:ｲﾝｸｺｰﾄﾞNG
;03:ｻﾃﾗｲﾄNo異常
STG MR20200              ; Sub:ｻﾃﾗｲﾄ情報切替開始
SET MR20202              ; Sub:ｻﾃﾗｲﾄ情報切替中
CON
RES MR20204              ; ｻﾃﾗｲﾄ情報切替OK
CON
DW #0 DM1280             ; ｻﾃﾗｲﾄ切替ErrCode
CON
JMP @MR100
STG @MR100
MPS
AND> DM1275 #0           ; ｻﾃﾗｲﾄNo
MOV DM1275 W1BB0         ; ｻﾃﾗｲﾄNo
FMOV #0 DM3100 #40       ; ｻﾃﾗｲﾄNo
SET B05AD
CON
JMP @MR101
MPP
AND<= DM1275 #0          ; ｻﾃﾗｲﾄNo
DW #3 DM1280             ; ｻﾃﾗｲﾄ切替ErrCode
CON
JMP @MR108
STG @MR101
MPS
AND B05AE
RES B05AE
CON
JMP @MR102
MPP
TMR @3 #50
CON
AND @T3
RES B05AE
CON
DW #1 DM1280             ; ｻﾃﾗｲﾄ切替ErrCode
CON
JMP @MR108
STG @MR102
MPS
ANB B05AE
JMP @MR103
MPP
TMR @4 #50
CON
AND @T4
DW #1 DM1280             ; ｻﾃﾗｲﾄ切替ErrCode
CON
JMP @MR108
STG @MR103
MPS
LD= DM3034 DM3101        ; ｲﾝｸｺｰﾄﾞ1(Model Master)  ｲﾝｸｺｰﾄﾞ1
AND= DM3035 DM3102       ; ｲﾝｸｺｰﾄﾞ2(Model Master)  ｲﾝｸｺｰﾄﾞ2
AND= DM3036 DM3103       ; ｲﾝｸｺｰﾄﾞ3(Model Master)  ｲﾝｸｺｰﾄﾞ3
AND= DM3037 DM3104       ; ｲﾝｸｺｰﾄﾞ4(Model Master)  ｲﾝｸｺｰﾄﾞ4
AND= DM3038 DM3105       ; ｲﾝｸｺｰﾄﾞ5(Model Master)  ｲﾝｸｺｰﾄﾞ5
AND=.D DM3028 DM3107     ; 注入サイズ1  注入ｻｲｽﾞ1
ANL
JMP @MR104
MPP
LD<> DM3034 DM3101       ; ｲﾝｸｺｰﾄﾞ1(Model Master)  ｲﾝｸｺｰﾄﾞ1
OR<> DM3035 DM3102       ; ｲﾝｸｺｰﾄﾞ2(Model Master)  ｲﾝｸｺｰﾄﾞ2
OR<> DM3036 DM3103       ; ｲﾝｸｺｰﾄﾞ3(Model Master)  ｲﾝｸｺｰﾄﾞ3
OR<> DM3037 DM3104       ; ｲﾝｸｺｰﾄﾞ4(Model Master)  ｲﾝｸｺｰﾄﾞ4
OR<> DM3038 DM3105       ; ｲﾝｸｺｰﾄﾞ5(Model Master)  ｲﾝｸｺｰﾄﾞ5
OR<>.D DM3028 DM3107     ; 注入サイズ1  注入ｻｲｽﾞ1
ANL
DW #2 DM1280             ; ｻﾃﾗｲﾄ切替ErrCode
CON
JMP @MR108
STG @MR104
SET MR20204              ; ｻﾃﾗｲﾄ情報切替OK
CON
JMP @MR108
STG @MR108
SET MR20201              ; Sub:ｻﾃﾗｲﾄ情報切替完了
CON
RES MR20202              ; Sub:ｻﾃﾗｲﾄ情報切替中
CON
ENDS
;Sub tank pressure
LD= DM3034 $3837         ; ｲﾝｸｺｰﾄﾞ1(Model Master)
AND= DM3035 $3142        ; ｲﾝｸｺｰﾄﾞ2(Model Master)
AND= DM3036 $4750        ; ｲﾝｸｺｰﾄﾞ3(Model Master)
AND= DM3037 $0000        ; ｲﾝｸｺｰﾄﾞ4(Model Master)
AND= DM3038 $0000        ; ｲﾝｸｺｰﾄﾞ5(Model Master)
AND= DM3039 $0000        ; ｲﾝｸｺｰﾄﾞ6(Model Master)
OUT R9500                ; Pressurized Subtank Detection FL
END
ENDH
