DEVICE:53
;MODULE:IND3ST2
;MODULE_TYPE:0
;***************************************
; 非常停止
; Emergency Stop 
;***************************************
LD R50010                ; Emergency　Stop
OR @MR000                ; Emergency STOP
ZRES @MR001 @MR1315
CON
OUT @MR000               ; Emergency STOP
TMR @39 #5
LD @T39
MDSTOP IND3ST2
;RB動作許可ﾌﾗｸﾞ
;RB Move permission Flag
;ﾜｰｸ有無ﾌﾗｸﾞ
;Work Existence Flag
LDB R6000                ; IND3 ST2 ﾜｰｸ有無検出
OUT @MR010               ; IND3ST2   全ﾜｰｸ無し
LD @MR010                ; IND3ST2   全ﾜｰｸ無し
ANB R6005                ; IND3 ST3 ﾜｰｸ有無検出
AND R6006                ; IND3 ST3 ﾜｰｸ浮き検出1(供給孔側)
AND R6007                ; IND3 ST3 ﾜｰｸ浮き検出2(ﾌｨﾙﾑ側)
ANB R6008                ; IND3 ST4 ﾜｰｸ有無検出
OUT @MR006               ; IND3全STﾜｰｸ無し
;INDEX3 各ST動作完了確認
;INDEX3 Each ST Operation Finish Check
LDB R50911               ; IND3 ST3  ｻｲｸﾙ動作中
ANB R50912               ; IND3 ST4  ｻｲｸﾙ動作中
OUT @MR005               ; IND3 各ST動作完了
;動作ﾊﾟﾗﾒｰﾀ
;Operation Parameter
LDB LR41100              ; AUTO-0 全ﾕﾆｯﾄ動作
ANB LR41101              ; AUTO-1 IND1 2UT
ANB LR41102              ; AUTO-2 IND1 3UT
ANB LR41103              ; AUTO-3 IND1 4UT
ANB LR41104              ; AUTO-4 IND2 3UT
ANB LR41105              ; AUTO-5 IND3 3UT
ANB LR41106              ; AUTO-6
ANB LR41107              ; AUTO-7
ANB LR41108              ; AUTO-8
OUB @MR013               ; IND3 ST2  AUTO Parameter OK
;***************************************
; ﾎﾟｰｽﾞ ･ ｴﾗｰ 監視
; Pause ･ Error Check 
;***************************************
LDB R50300               ; Pause
ANB R51602               ; Err IND3ST2
ANB R51600               ; Err IND3
OUT @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
;<h1/>原点復帰動作
;HOME RETURN OPERATION 
LD R50003                ; HOME
ANB R51510               ; IND3 ST2  動作中
SET R51510               ; IND3 ST2  動作中
CON
SET @MR500               ; 原点復帰  開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR501               ; 原点復帰  終了
RES R51510               ; IND3 ST2  動作中
CON
RES @MR501               ; 原点復帰  終了
STG @MR500               ; 原点復帰  開始
SET R50910               ; IND3 ST2  ｻｲｸﾙ動作中
CON
JMP @MR515               ; 原点復帰終了処理
;
STG @MR515               ; 原点復帰終了処理
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR602                ; IND3      ｻｲｸﾙ動作中
RES R50910               ; IND3 ST2  ｻｲｸﾙ動作中
CON
SET R51502               ; IND3 ST2   1ｻｲｸﾙ終了
CON
SET @MR501               ; 原点復帰  終了
CON
ENDS
;<h1/>自動運転
;AUTO OPERATION
LD R50001                ; AUTO
ANB R51510               ; IND3 ST2  動作中
DW #0 @DM2
CON
SET R51510               ; IND3 ST2  動作中
CON
SET @MR1000              ; AUTO開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR1001              ; AUTO終了
RES R51510               ; IND3 ST2  動作中
CON
RES @MR1001              ; AUTO終了
; 動作パラメーター確認
; Operating Parameter Check
STG @MR1000              ; AUTO開始
MPS
AND R51500               ; IND3     動作開始
SET R50910               ; IND3 ST2  ｻｲｸﾙ動作中
CON
MPS
AND R50210               ; Model OK
JMP @MR1002              ; 3002
MPP
LDB R50210               ; Model OK
AND R50000               ; HOLD
ANL
JMP @MR1300              ; AUTO終了処理
MPP
LDB R51500               ; IND3     動作開始
AND R50000               ; HOLD
AND R51508               ; IND3     払出し完了
ANL
JMP @MR1300              ; AUTO終了処理
STG @MR1002              ; 3002
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR013               ; IND3 ST2  AUTO Parameter OK
JMP @MR1008              ; 3008
MPP
ANB @MR013               ; IND3 ST2  AUTO Parameter OK
JMP @MR1300              ; AUTO終了処理
;動作選択
STG @MR1008              ; 3008
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
JMP @MR1100              ; AUTO main
;AUTO動作開始
;AUTO Operation Start
STG @MR1100              ; AUTO main
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR010               ; IND3ST2   全ﾜｰｸ無し
RES MR8508               ; IND3 ST2治具1(縦) 閉じ
CON
SET MR8509               ; IND3 ST2治具1(縦) 開き
CON
RES MR8510               ; IND3 ST2治具2(横) 閉じ
CON
SET MR8511               ; IND3 ST2治具2(横) 開き
CON
JMP @MR1104
MPP
ANB @MR010               ; IND3ST2   全ﾜｰｸ無し
SET @MR104               ; Err2 ST1 Err2
CON
JMP @MR1102              ; Err2
;Err12 ﾜｰｸ除材要求 / Cartridge Remove Demand
STG @MR1102              ; Err2
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR107               ; Err2 ST1 Err2解除完了
JMP @MR1103              ; 3103
STG @MR1103              ; 3103
RES @MR107               ; Err2 ST1 Err2解除完了
CON
JMP @MR1100              ; AUTO main
;治具確認 / Jig check
STG @MR1104
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND>= @DM2 #4
JMP @MR1108              ; 3108
MPP
AND< @DM2 #4
MPS
LD MR111                 ; Sｻｲｽﾞ
AND R6003                ; IND3 ST2 Sｻｲｽﾞ用ｶﾞｲﾄﾞ検出
LD MR112                 ; Lｻｲｽﾞ
ANB R6003                ; IND3 ST2 Sｻｲｽﾞ用ｶﾞｲﾄﾞ検出
ORL
ANL
INC @DM2
CON
JMP @MR1108              ; 3108
MPP
LD MR111                 ; Sｻｲｽﾞ
ANB R6003                ; IND3 ST2 Sｻｲｽﾞ用ｶﾞｲﾄﾞ検出
LD MR112                 ; Lｻｲｽﾞ
AND R6003                ; IND3 ST2 Sｻｲｽﾞ用ｶﾞｲﾄﾞ検出
ORL
ANL
SET @MR200               ; Err223
CON
JMP @MR1105
;Err223 Index3 Sｶﾞｲﾄﾞ治具検出異常 / Index3 S-guide Jig error
STG @MR1105
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR203               ; Err223解除完了
RES @MR203               ; Err223解除完了
CON
JMP @MR1104
;Supply Flg. ON
STG @MR1108              ; 3108
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR15012              ; IND3_給材要求
ANB MR15013              ; IND3_給材中
SET MR15012              ; IND3_給材要求
CON
JMP @MR1110              ; 3109
;給材完了待ち / Waiting for Case supply
STG @MR1110              ; 3109
ANB R50111               ; Err ST1
MPS
AND MR15013              ; IND3_給材中
JMP @MR1112              ; 3111
MPP
ANB MR15013              ; IND3_給材中
MPS
TMR #300 #9999           ; IND3 移載上流ﾜｰｸ待ち時間
CON
AND T300                 ; IND3 移載上流ﾜｰｸ待ち時間
AND @MR005               ; IND3 各ST動作完了
ANB @MR006               ; IND3全STﾜｰｸ無し
RES MR15012              ; IND3_給材要求
CON
JMP @MR1111              ; 3110
MPP
LD R50000                ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
TMH @2 #10
CON
AND @T2
RES MR15012              ; IND3_給材要求
CON
JMP @MR1111              ; 3110
STG @MR1111              ; 3110
ANB R50111               ; Err ST1
ANB MR15012              ; IND3_給材要求
MPS
AND MR15013              ; IND3_給材中
JMP @MR1112              ; 3111
MPP
ANB MR15013              ; IND3_給材中
TMH @1 #2
CON
AND @T1
JMP @MR1300              ; AUTO終了処理
STG @MR1112              ; 3111
ANB R50111               ; Err ST1
ANB MR15013              ; IND3_給材中
MPS
AND MR15014              ; IND3_給材完了
JMP @MR1200              ; ﾜｰｸ確認
MPP
AND MR15015              ; IND3_給材異常完了
RES MR15015              ; IND3_給材異常完了
CON
RES MR15012              ; IND3_給材要求
CON
JMP @MR1100              ; AUTO main
STG @MR1200              ; ﾜｰｸ確認
RES MR15012              ; IND3_給材要求
CON
RES MR15014              ; IND3_給材完了
CON
ANB MR15012              ; IND3_給材要求
ANB MR15014              ; IND3_給材完了
MPS
ANB @MR010               ; IND3ST2   全ﾜｰｸ無し
JMP @MR1208
MPP
AND @MR010               ; IND3ST2   全ﾜｰｸ無し
SET @MR108               ; Err3 ST1 Err3
CON
JMP @MR1201
;Err3 ﾜｰｸ異常 / Cartridge stats Error
STG @MR1201
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR111               ; Err3 ST1 Err3解除完了
JMP @MR1202
STG @MR1202
RES @MR111               ; Err3 ST1 Err3解除完了
CON
JMP @MR1203
STG @MR1203
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
ANB @MR010               ; IND3ST2   全ﾜｰｸ無し
JMP @MR1208
MPP
AND @MR010               ; IND3ST2   全ﾜｰｸ無し
JMP @MR1108              ; 3108
;ｶｰﾄﾘｯｼﾞｸﾗﾝﾌﾟ / Case Jig close
STG @MR1208
RES @MR003               ; ｸﾗﾝﾌﾟ2回目
CON
JMP @MR1209
STG @MR1209
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR8509               ; IND3 ST2治具1(縦) 開き
CON
SET MR8508               ; IND3 ST2治具1(縦) 閉じ
CON
TMH @5 #10
CON
AND @T5
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR1210
STG @MR1210
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR8511               ; IND3 ST2治具2(横) 開き
CON
SET MR8510               ; IND3 ST2治具2(横) 閉じ
CON
ANB R6004                ; IND3 ST2 ﾜｰｸｸﾗﾝﾌﾟ開確認
TMH @6 #10
CON
AND @T6
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR1211
STG @MR1211
MPS
ANB @MR003               ; ｸﾗﾝﾌﾟ2回目
JMP @MR1212
MPP
AND @MR003               ; ｸﾗﾝﾌﾟ2回目
JMP @MR1213
STG @MR1212
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR8509               ; IND3 ST2治具1(縦) 開き
CON
RES MR8508               ; IND3 ST2治具1(縦) 閉じ
CON
SET MR8511               ; IND3 ST2治具2(横) 開き
CON
RES MR8510               ; IND3 ST2治具2(横) 閉じ
CON
AND R6004                ; IND3 ST2 ﾜｰｸｸﾗﾝﾌﾟ開確認
TMH @8 #10
CON
AND @T8
SET @MR003               ; ｸﾗﾝﾌﾟ2回目
CON
JMP @MR1209
STG @MR1213
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R6001                 ; IND3 ST2 ﾜｰｸ浮き検出1(供給孔側)
AND R6002                ; IND3 ST2 ﾜｰｸ浮き検出2(ﾌｨﾙﾑ側)
ANL
RES @MR003               ; ｸﾗﾝﾌﾟ2回目
CON
JMP @MR1300              ; AUTO終了処理
MPP
LDB R6001                ; IND3 ST2 ﾜｰｸ浮き検出1(供給孔側)
ORB R6002                ; IND3 ST2 ﾜｰｸ浮き検出2(ﾌｨﾙﾑ側)
ANL
TMR @7 #20
CON
AND @T7
RES MR8508               ; IND3 ST2治具1(縦) 閉じ
CON
SET MR8509               ; IND3 ST2治具1(縦) 開き
CON
RES MR8510               ; IND3 ST2治具2(横) 閉じ
CON
SET MR8511               ; IND3 ST2治具2(横) 開き
CON
SET @MR112               ; Err124
CON
JMP @MR1214
;Err124 ｶｰﾄﾘｯｼﾞ浮き / Cartridge floating
STG @MR1214
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR115               ; Err124解除完了
RES @MR115               ; Err124解除完了
CON
JMP @MR1208
;AUTO 1ｻｲｸﾙ終了処理
;AUTO 1Cycle end Operation
STG @MR1300              ; AUTO終了処理
AND MR602                ; IND3      ｻｲｸﾙ動作中
SET R51502               ; IND3 ST2   1ｻｲｸﾙ終了
CON
JMP @MR1302              ; 3902
STG @MR1302              ; 3902
RES R50910               ; IND3 ST2  ｻｲｸﾙ動作中
CON
ANB R51500               ; IND3     動作開始
AND R51507               ; IND3      ｻｲｸﾙ完了
JMP @MR1308
STG @MR1308
MPS
LDB R50000               ; HOLD
ORB R51508               ; IND3     払出し完了
ANL
JMP @MR1000              ; AUTO開始
MPP
LD R50000                ; HOLD
AND R51508               ; IND3     払出し完了
ANL
JMP @MR1303              ; AUTO終了処理
;AUTO 終了処理
;AUTO Finish Operation
STG @MR1303              ; AUTO終了処理
DW #0 @DM2
CON
SET @MR1001              ; AUTO終了
CON
ENDS
;<h1/>ｽﾃｯﾌﾟ運転
;STEP OERATION
LD R50002                ; STEP
ANB R51510               ; IND3 ST2  動作中
SET R51510               ; IND3 ST2  動作中
CON
SET @MR700               ; STEP開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR701               ; STEP終了
RES R51510               ; IND3 ST2  動作中
CON
RES @MR701               ; STEP終了
LDB CR2003               ; 常時OFF
OUB @MR014               ; STEP Parameter OK
STG @MR700               ; STEP開始
AND R51510               ; IND3 ST2  動作中
MPS
LD LR42508               ; IND3_ST2 STEP-01 通常動作
AND CR2003               ; 常時OFF
ANL
JMP @MR708               ; STEP終了処理
MPP
ANB @MR014               ; STEP Parameter OK
JMP @MR708               ; STEP終了処理
;STEP終了処理
STG @MR708               ; STEP終了処理
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R50009               ; HOLDRQ
CON
JMP @MR709               ; 2009
STG @MR709               ; 2009
AND @MR015               ; ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R50000               ; HOLD
SET R51502               ; IND3 ST2   1ｻｲｸﾙ終了
CON
SET @MR701               ; STEP終了
CON
ENDS
;<h1/>Err
;Err122 ﾜｰｸ残
;Err122 Cartridge remain
STG @MR104               ; Err2 ST1 Err2
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R51602               ; Err IND3ST2
CON
JMP @MR105               ; 105
MOV #122 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR105               ; 105
AND R50008               ; Error
JMP @MR106               ; 106
STG @MR106               ; 106
ANB R50008               ; Error
SET @MR107               ; Err2 ST1 Err2解除完了
CON
ENDS
;Err123 ﾜｰｸ確認異常
;Err123 Cartridge Detection Error
STG @MR108               ; Err3 ST1 Err3
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R51602               ; Err IND3ST2
CON
JMP @MR109               ; 109
MOV #123 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR109               ; 109
AND R50008               ; Error
JMP @MR110               ; 110
STG @MR110               ; 110
ANB R50008               ; Error
SET @MR111               ; Err3 ST1 Err3解除完了
CON
ENDS
;Err124 ｶｰﾄﾘｯｼﾞ浮き
;Err124 Cartridge floating
STG @MR112               ; Err124
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R51602               ; Err IND3ST2
CON
JMP @MR113               ; 113
MOV #124 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR113               ; 113
AND R50008               ; Error
JMP @MR114               ; 114
STG @MR114               ; 114
ANB R50008               ; Error
SET @MR115               ; Err124解除完了
CON
ENDS
;Err223 Index3 Sｶﾞｲﾄﾞ治具検出異常
;Err223 Index3S-guide Jig error
STG @MR200               ; Err223
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R51602               ; Err IND3ST2
CON
JMP @MR201               ; 201
MOV #223 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR201               ; 201
AND R50008               ; Error
JMP @MR202               ; 202
STG @MR202               ; 202
ANB R50008               ; Error
SET R50009               ; HOLDRQ
CON
SET @MR203               ; Err223解除完了
CON
ENDS
;Err4
;未使用
;Err5 
;Err5 
;未使用
;Err6 
;Err6 
;未使用
;Err7 
;Err7 
;未使用
;Err8
;未使用
;Err9 
;Err9 
;未使用
;PACKｾｯﾄ
;Pack Set
LD CR2003                ; 常時OFF
OUT R51608               ; PACK IND3_ST2
END
ENDH
