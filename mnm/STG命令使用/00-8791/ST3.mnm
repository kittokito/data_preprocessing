DEVICE:53
;MODULE:ST3
;MODULE_TYPE:0
;SCRIPT_TYPE:
;***************************************
; 非常停止
; Emergency Stop 
;***************************************
LD R50010                ; Emergency　Stop
OR @MR000                ; Emergency STOP
ZRES @MR001 @MR4815
CON
RES DM741                ; 連続吐出、循環確認ﾊﾟｽﾓｰﾄﾞ表示
CON
OUT @MR000               ; Emergency STOP
TMR @39 #5
LD @T39
MDSTOP ST3
MDSTOP PLUNGER
MDSTOP SATELLITE
;
LD @MR100                ; ﾜｰｸ1処理有
AND R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
LDB @MR100               ; ﾜｰｸ1処理有
LDB R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
LD R4206                 ; IND1 ST3 ﾜｰｸ1検出(ST2側)
AND<> DM3451 #0          ; ST3-No1 NGﾜｰｸ 0=OK
ORL
ANL
ORL
LD @MR101                ; ﾜｰｸ2処理有
AND R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
LDB @MR101               ; ﾜｰｸ2処理有
LDB R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
LD R4207                 ; IND1 ST3 ﾜｰｸ2検出(中1側)
AND<> DM3471 #0          ; ST3-No2 NGﾜｰｸ 0=OK
ORL
ANL
ORL
ANL
LD @MR102                ; ﾜｰｸ3処理有
AND R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
LDB @MR102               ; ﾜｰｸ3処理有
LDB R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
LD R4208                 ; IND1 ST3 ﾜｰｸ3検出(中2側)
AND<> DM3491 #0          ; ST3-No3 NGﾜｰｸ 0=OK
ORL
ANL
ORL
ANL
LD @MR103                ; ﾜｰｸ4処理有
AND R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
LDB @MR103               ; ﾜｰｸ4処理有
LDB R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
LD R4209                 ; IND1 ST3 ﾜｰｸ4検出(ST4側)
AND<> DM3511 #0          ; ST3-No4 NGﾜｰｸ 0=OK
ORL
ANL
ORL
ANL
OUT @MR011               ; ﾜｰｸ状態OK
LD<> DM828 #0            ; ST3_1ｲﾝｸ注入有無(0=無)
AND= DM3451 #0           ; ST3-No1 NGﾜｰｸ 0=OK
LD R50002                ; STEP
AND R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
ORL
OUT @MR100               ; ﾜｰｸ1処理有
LD<> DM829 #0            ; ST3_2ｲﾝｸ注入有無(0=無)
AND= DM3471 #0           ; ST3-No2 NGﾜｰｸ 0=OK
LD R50002                ; STEP
AND R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
ORL
OUT @MR101               ; ﾜｰｸ2処理有
LD<> DM830 #0            ; ST3_3ｲﾝｸ注入有無(0=無)
AND= DM3491 #0           ; ST3-No3 NGﾜｰｸ 0=OK
LD R50002                ; STEP
AND R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
ORL
OUT @MR102               ; ﾜｰｸ3処理有
LD<> DM831 #0            ; ST3_4ｲﾝｸ注入有無(0=無)
AND= DM3511 #0           ; ST3-No4 NGﾜｰｸ 0=OK
LD R50002                ; STEP
AND R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
ORL
OUT @MR103               ; ﾜｰｸ4処理有
;動作ﾊﾟﾗﾒｰﾀ
;Operation Parameter
LD LR41100               ; AUTO-0 全ﾕﾆｯﾄ動作
OR LR41102               ; AUTO-2 IND1 3UT
OUT @MR013               ; ST3 AUTO Parameter OK
;***************************************
; ﾎﾟｰｽﾞ ･ ｴﾗｰ 監視
; Pause ･ Error Check 
;***************************************
LDB R50300               ; Pause
ANB R50113               ; Err ST3
ANB R50110               ; Err INDEX
OUT @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
;<h1/>原点復帰動作
;HOME RETURN OPERATION 
LD R50003                ; HOME
ANB R50203               ; ST3 動作中
MPS
SET R50203               ; ST3 動作中
CON
SET @MR1000              ; ST3 原点復帰開始
MRD
MDSTRT PLUNGER
MPP
MDSTRT SATELLITE
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR1001              ; ST3 原点復帰終了
RES R50203               ; ST3 動作中
CON
RES @MR1001              ; ST3 原点復帰終了
STG @MR1000              ; ST3 原点復帰開始
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R50903               ; IND1 ST3  ｻｲｸﾙ動作中
CON
JMP @MR1002              ; 1002
STG @MR1002              ; 1002
MPS
AND R4601                ; 注入ﾍｯﾄﾞ 上限
JMP @MR1003
MPP
ANB R4601                ; 注入ﾍｯﾄﾞ 上限
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
SET MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
JMP @MR1003
STG @MR1003
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB MR12211              ; ｻﾃﾗｲﾄ無し
AND MR12209              ; ｱｷｭﾑﾚｰﾀｰ ｲﾝｸ供給OK
ANL
JMP @MR1004
MPP
AND MR12211              ; ｻﾃﾗｲﾄ無し
TMR @30 #10
CON
AND @T30
MPS
ANB MR109                ; ｻﾃﾗｲﾄ無しﾌﾟﾗﾝｼﾞｬ動作有り
JMP @MR1100              ; 注入UT上昇へ
MPP
AND MR109                ; ｻﾃﾗｲﾄ無しﾌﾟﾗﾝｼﾞｬ動作有り
JMP @MR1005
STG @MR1004
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR8609               ; ｻﾃﾗｲﾄA ｲﾝｸ開閉 1 開
CON
SET MR8611               ; ｻﾃﾗｲﾄA ｲﾝｸ開閉 2  開
CON
SET MR8700               ; ｻﾃﾗｲﾄA ｻﾌﾞﾀﾝｸ大気開放
CON
SET MR8809               ; ｻﾃﾗｲﾄB ｲﾝｸ開閉 1 開
CON
SET MR8811               ; ｻﾃﾗｲﾄB ｲﾝｸ開閉 2  開
CON
SET MR8900               ; ｻﾃﾗｲﾄB ｻﾌﾞﾀﾝｸ大気開放
CON
JMP @MR1005
STG @MR1005
BMOV DM2710 DM2700 #5    ; RB6_P1 位置ﾃﾞｰﾀ(原点)  RB6移動目標位置
BMOV DM2760 DM2750 #5    ; RB7_P1 位置ﾃﾞｰﾀ(原点)  RB7移動目標位置
BMOV DM2810 DM2800 #5    ; RB8_P1 位置ﾃﾞｰﾀ(原点)  RB8移動目標位置
MPS
BMOV DM2860 DM2850 #5    ; RB9_P1 位置ﾃﾞｰﾀ(原点)  RB9移動目標位置
MPP
LD R18300                ; A-RB6 電源ON
AND R18302               ; A-RB7 電源ON
AND R18400               ; A-RB8 電源ON
AND R18402               ; A-RB9 電源ON
ANL
TMR @15 #150
CON
AND @T15
JMP @MR1006
STG @MR1006
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET DM2207.4
CON
SET DM2215.4
CON
SET DM2223.4
CON
SET DM2231.4
CON
SET MR14405              ; RB6 PCON移動開始
CON
SET MR14505              ; RB7 PCON移動開始
CON
SET MR14605              ; RB8 PCON移動開始
CON
SET MR14705              ; RB9 PCON移動開始
CON
JMP @MR1007
STG @MR1007
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR14406              ; RB6 PCON移動完了
AND MR14506              ; RB7 PCON移動完了
AND MR14606              ; RB8 PCON移動完了
AND MR14706              ; RB9 PCON移動完了
RES MR14406              ; RB6 PCON移動完了
CON
RES MR14506              ; RB7 PCON移動完了
CON
RES MR14606              ; RB8 PCON移動完了
CON
RES MR14706              ; RB9 PCON移動完了
CON
JMP @MR1013
;ﾊﾞｯｸﾗｯｼｭ動作追加 2011/10/15 SEC Sato
STG @MR1013
JMP @MR1014
BMOV DM2740 DM2700 #5    ; RB6_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)  RB6移動目標位置
BMOV DM2790 DM2750 #5    ; RB7_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)  RB7移動目標位置
BMOV DM2840 DM2800 #5    ; RB8_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)  RB8移動目標位置
BMOV DM2890 DM2850 #5    ; RB9_P4 位置ﾃﾞｰﾀ(ﾊﾞｯｸﾗｯｼｭ量)  RB9移動目標位置
STG @MR1014
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR14405              ; RB6 PCON移動開始
CON
SET MR14505              ; RB7 PCON移動開始
CON
SET MR14605              ; RB8 PCON移動開始
CON
SET MR14705              ; RB9 PCON移動開始
CON
JMP @MR1015              ; UT3 原点復帰完了
STG @MR1015              ; UT3 原点復帰完了
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR14406              ; RB6 PCON移動完了
AND MR14506              ; RB7 PCON移動完了
AND MR14606              ; RB8 PCON移動完了
AND MR14706              ; RB9 PCON移動完了
RES MR8609               ; ｻﾃﾗｲﾄA ｲﾝｸ開閉 1 開
CON
RES MR8611               ; ｻﾃﾗｲﾄA ｲﾝｸ開閉 2  開
CON
RES MR8700               ; ｻﾃﾗｲﾄA ｻﾌﾞﾀﾝｸ大気開放
CON
RES MR8809               ; ｻﾃﾗｲﾄB ｲﾝｸ開閉 1 開
CON
RES MR8811               ; ｻﾃﾗｲﾄB ｲﾝｸ開閉 2  開
CON
RES MR8900               ; ｻﾃﾗｲﾄB ｻﾌﾞﾀﾝｸ大気開放
CON
RES MR14406              ; RB6 PCON移動完了
CON
RES MR14506              ; RB7 PCON移動完了
CON
RES MR14606              ; RB8 PCON移動完了
CON
RES MR14706              ; RB9 PCON移動完了
CON
JMP @MR1100              ; 注入UT上昇へ
;***** 注入UT 上昇 / Infusion UT up *****
STG @MR1100              ; 注入UT上昇へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
SET MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
ANB R4600                ; 注入ﾍｯﾄﾞ 下限
AND R4601                ; 注入ﾍｯﾄﾞ 上限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR1101
;***** 大気開放ﾁｪｯｸ / air rerease check *****
STG @MR1101
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR4000              ; 大気開放ﾁｪｯｸ
CON
JMP @MR1102
STG @MR1102
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4001              ; 大気開放ﾁｪｯｸ 完了
RES @MR4001              ; 大気開放ﾁｪｯｸ 完了
CON
JMP @MR1110
;***** 供給孔クランプ　開 / Supply hole clamping Open *****
STG @MR1110
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
JMP @MR1111
;***** 供給孔クランプ　上昇 / Supply hole clamping Up *****
STG @MR1111
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
AND R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
JMP @MR1112
STG @MR1112
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR600                ; IND1      ｻｲｸﾙ動作中
ANB R5804                ; ｻﾃﾗｲﾄA ｾﾊﾟﾚﾙ 真空検出1
ANB R5805                ; ｻﾃﾗｲﾄA ｾﾊﾟﾚﾙ 真空検出2
ANB R5904                ; ｻﾃﾗｲﾄB ｾﾊﾟﾚﾙ 真空検出1
ANB R5905                ; ｻﾃﾗｲﾄB ｾﾊﾟﾚﾙ 真空検出2
JMP @MR1115
STG @MR1115
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES R50903               ; IND1 ST3  ｻｲｸﾙ動作中
CON
SET R50413               ; IND1 ST3   1ｻｲｸﾙ終了
CON
SET @MR1001              ; ST3 原点復帰終了
CON
ENDS
;<h1/>自動運転
;AUTO OERATION
LD R50001                ; AUTO
ANB R50203               ; ST3 動作中
SET R50203               ; ST3 動作中
CON
SET @MR3000              ; ST3 AUTO開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR3001              ; ST3 AUTO終了
RES R50203               ; ST3 動作中
CON
RES @MR3001              ; ST3 AUTO終了
; 動作パラメーター確認
; Operating Parameter Check
STG @MR3000              ; ST3 AUTO開始
MPS
AND R50209               ; IND1     動作開始
SET R50903               ; IND1 ST3  ｻｲｸﾙ動作中
CON
MPS
AND R50210               ; Model OK
JMP @MR3002              ; 3002
MPP
LDB R50210               ; Model OK
AND R50000               ; HOLD
ANL
TMR @16 #10
CON
AND @T16
SET R50413               ; IND1 ST3   1ｻｲｸﾙ終了
CON
JMP @MR3902              ; 3902
MPP
LDB R50209               ; IND1     動作開始
AND R50000               ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
JMP @MR3902              ; 3902
STG @MR3002              ; 3002
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR013               ; ST3 AUTO Parameter OK
JMP @MR3100              ; KDｲﾝｸ循環確認へ
MPP
ANB @MR013               ; ST3 AUTO Parameter OK
TMR @28 #1
CON
AND @T28
JMP @MR3900              ; AUTO終了処理
;AUTO動作開始
;AUTO Operation Start
;***** KDｲﾝｸ循環完了確認 /consective discharge finishing check *****
STG @MR3100              ; KDｲﾝｸ循環確認へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7909               ; IND1 ST3治具 開き
CON
SET MR7908               ; IND1 ST3治具 閉じ
CON
MPS
ANB MR12211              ; ｻﾃﾗｲﾄ無し
MPS
AND MR2901               ; KDｲﾝｸ循環完了FLG
JMP @MR3104
MPP
ANB MR2901               ; KDｲﾝｸ循環完了FLG
MPS
AND MR12114              ; KDﾄﾞﾗﾑ交換検出FLG
JMP @MR3104
MPP
ANB MR12114              ; KDﾄﾞﾗﾑ交換検出FLG
SET @MR104               ; Err62 KDｲﾝｸ循環未完了
CON
JMP @MR3102
MPP
AND MR12211              ; ｻﾃﾗｲﾄ無し
JMP @MR3200              ; ｻﾃﾗｲﾄ有無選択へ
STG @MR3102
AND @MR107               ; Err62 ST3 Err2解除完了
RES @MR107               ; Err62 ST3 Err2解除完了
CON
JMP @MR3103
STG @MR3103
MPS
ANB MR2903               ; 吐出、循環確認OK
@SET R50009              ; HOLDRQ
CON
JMP @MR3900              ; AUTO終了処理
MPP
AND MR2903               ; 吐出、循環確認OK
SET MR2901               ; KDｲﾝｸ循環完了FLG
CON
RES MR2903               ; 吐出、循環確認OK
CON
JMP @MR3104
;ｻﾌﾞﾀﾝｸｲﾝｸ循環確認/循環完了FlgのみOFFなら循環動作へ
STG @MR3104
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND MR2902               ; ｻﾌﾞﾀﾝｸｲﾝｸ循環完了FLG
JMP @MR3108              ; 連続吐出完了確認へ
MPP
ANB MR2902               ; ｻﾌﾞﾀﾝｸｲﾝｸ循環完了FLG
SET @MR600
CON
JMP @MR3106
STG @MR3105
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR2902               ; ｻﾌﾞﾀﾝｸｲﾝｸ循環完了FLG
RES MR2904
CON
JMP @MR3108              ; 連続吐出完了確認へ
;Error
STG @MR3106
AND @MR603
RES @MR603
CON
JMP @MR3107
STG @MR3107
MPS
ANB MR2903               ; 吐出、循環確認OK
@SET R50009              ; HOLDRQ
CON
JMP @MR3900              ; AUTO終了処理
MPP
AND MR2903               ; 吐出、循環確認OK
SET MR2902               ; ｻﾌﾞﾀﾝｸｲﾝｸ循環完了FLG
CON
RES MR2903               ; 吐出、循環確認OK
CON
JMP @MR3108              ; 連続吐出完了確認へ
;***** 連続吐出完了確認 /consective discharge finishing check *****
STG @MR3108              ; 連続吐出完了確認へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND MR2900               ; 連続吐出完了FLG
JMP @MR3200              ; ｻﾃﾗｲﾄ有無選択へ
MPP
ANB MR2900               ; 連続吐出完了FLG
SET @MR108               ; Err63 連続吐出未完了
CON
JMP @MR3109
STG @MR3109
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR111               ; Err63 ST3 Err3解除完了
RES @MR111               ; Err63 ST3 Err3解除完了
CON
JMP @MR3110
STG @MR3110
MPS
ANB MR2903               ; 吐出、循環確認OK
@SET R50009              ; HOLDRQ
CON
JMP @MR3900              ; AUTO終了処理
MPP
AND MR2903               ; 吐出、循環確認OK
SET MR2900               ; 連続吐出完了FLG
CON
RES MR2903               ; 吐出、循環確認OK
CON
JMP @MR3200              ; ｻﾃﾗｲﾄ有無選択へ
;***** ｻﾃﾗｲﾄ有無選択 /Satellite check *****
STG @MR3200              ; ｻﾃﾗｲﾄ有無選択へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LDB MR12211              ; ｻﾃﾗｲﾄ無し
AND MR12209              ; ｱｷｭﾑﾚｰﾀｰ ｲﾝｸ供給OK
ANL
JMP @MR3201              ; ﾜｰｸﾁｪｯｸへ
MPP
AND MR12211              ; ｻﾃﾗｲﾄ無し
TMR @26 #10
CON
AND @T26
MPS
ANB MR109                ; ｻﾃﾗｲﾄ無しﾌﾟﾗﾝｼﾞｬ動作有り
JMP @MR3900              ; AUTO終了処理
MPP
AND MR109                ; ｻﾃﾗｲﾄ無しﾌﾟﾗﾝｼﾞｬ動作有り
JMP @MR3201              ; ﾜｰｸﾁｪｯｸへ
;***** ﾜｰｸ有ﾁｪｯｸ / Work check *****
STG @MR3201              ; ﾜｰｸﾁｪｯｸへ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
AND @MR011               ; ﾜｰｸ状態OK
MPS
LD R4206                 ; IND1 ST3 ﾜｰｸ1検出(ST2側)
AND @MR100               ; ﾜｰｸ1処理有
LD R4207                 ; IND1 ST3 ﾜｰｸ2検出(中1側)
AND @MR101               ; ﾜｰｸ2処理有
ORL
LD R4208                 ; IND1 ST3 ﾜｰｸ3検出(中2側)
AND @MR102               ; ﾜｰｸ3処理有
ORL
LD R4209                 ; IND1 ST3 ﾜｰｸ4検出(ST4側)
AND @MR103               ; ﾜｰｸ4処理有
ORL
ANB LR300                ; 搬送ﾃﾞﾊﾞｯｸﾞbit
ANL
SET MR708                ; 3UT動作中
CON
JMP @MR3203              ; 浮きﾁｪｯｸへ
MPP
LDB @MR100               ; ﾜｰｸ1処理有
ANB @MR101               ; ﾜｰｸ2処理有
ANB @MR102               ; ﾜｰｸ3処理有
ANB @MR103               ; ﾜｰｸ4処理有
LDB R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
ANB R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
ANB R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
ANB R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
ORL
OR LR300                 ; 搬送ﾃﾞﾊﾞｯｸﾞbit
ANL
JMP @MR3900              ; AUTO終了処理
MPP
ANB @MR011               ; ﾜｰｸ状態OK
SET @MR400               ; Err73 ST3 Err13
CON
JMP @MR3202
;ﾜｰｸ状態異常の時
;When Case State NG
STG @MR3202
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR403               ; Err73 ST3 Err13解除完了
RES @MR403               ; Err73 ST3 Err13解除完了
CON
JMP @MR3201              ; ﾜｰｸﾁｪｯｸへ
;***** ﾜｰｸ浮きﾁｪｯｸ / Work flotage check *****
STG @MR3203              ; 浮きﾁｪｯｸへ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R4210                 ; IND1 ST3 ﾜｰｸ浮き検出(外側)
AND R4211                ; IND1 ST3 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3205
MPP
LDB R4210                ; IND1 ST3 ﾜｰｸ浮き検出(外側)
ORB R4211                ; IND1 ST3 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR312               ; Err72 ST3 Err12
CON
JMP @MR3204              ; ﾜｰｸ浮き
;***** ﾜｰｸ浮きの時 / When Work flotage check  *****
STG @MR3204              ; ﾜｰｸ浮き
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR315               ; Err72 ST3 Err12解除完了
RES @MR315               ; Err72 ST3 Err12解除完了
CON
JMP @MR3203              ; 浮きﾁｪｯｸへ
;
STG @MR3205
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7909               ; IND1 ST3治具 開き
CON
SET MR7908               ; IND1 ST3治具 閉じ
CON
TMH @1 #10
CON
AND @T1
JMP @MR3206
;***** ﾃﾞｼｹｰﾀUT 圧確認 /DC-UT pressure check *****
STG @MR3206
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD R5805                 ; ｻﾃﾗｲﾄA ｾﾊﾟﾚﾙ 真空検出2
AND R5905                ; ｻﾃﾗｲﾄB ｾﾊﾟﾚﾙ 真空検出2
OR MR12211               ; ｻﾃﾗｲﾄ無し
ANL
JMP @MR3300
MPP
LDB MR12211              ; ｻﾃﾗｲﾄ無し
LDB R5805                ; ｻﾃﾗｲﾄA ｾﾊﾟﾚﾙ 真空検出2
ORB R5905                ; ｻﾃﾗｲﾄB ｾﾊﾟﾚﾙ 真空検出2
ANL
ANL
SET @MR200               ; Err65 ST3 Err5
CON
JMP @MR3207              ; ﾃﾞｼｹｰﾀ圧NG
;***** ﾃﾞｼｹｰﾀ圧NGの時 / When NG pressure of DC-UT *****
;
STG @MR3207              ; ﾃﾞｼｹｰﾀ圧NG
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR203               ; Err65 ST3 Err5解除完了
RES @MR203               ; Err65 ST3 Err5解除完了
CON
JMP @MR3206
;***** 供給孔クランプ動作 / Supply hole clamping *****
;<h1/>AUTO 供給孔クランプ動作 / Supply hole clamping
STG @MR3300
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43300               ; ｻｲｸﾙﾀｲﾑ計測用3-1
CON
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR3301
STG @MR3301
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
AND R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR3302
STG @MR3302
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
AND R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
ANB R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
AND R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
RES R43300               ; ｻｲｸﾙﾀｲﾑ計測用3-1
CON
JMP @MR3303              ; 注入UT 下降
;**** 注入UT 下降 / Infusion UT down ***
;@T10 10→0 へ変更 / @T10 timer value change Before 10 → After 0
;<h1/>AUTO 注入UT 下降 / Infusion UT down
STG @MR3303              ; 注入UT 下降
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET R43301               ; ｻｲｸﾙﾀｲﾑ計測用3-2
CON
RES MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
SET MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
MPS
LDB MR4600               ; Cylinder Error 4600
ANB R4601                ; 注入ﾍｯﾄﾞ 上限
AND R4600                ; 注入ﾍｯﾄﾞ 下限
ANL
TMH @10 #10
CON
AND @T10
JMP @MR3307
MPP
AND MR4600               ; Cylinder Error 4600
JMP @MR3304
STG @MR3304
RES MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
SET MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
ANB R4600                ; 注入ﾍｯﾄﾞ 下限
AND R4601                ; 注入ﾍｯﾄﾞ 上限
JMP @MR3305
STG @MR3305
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
JMP @MR3306
STG @MR3306
SET MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
AND R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR4600               ; Cylinder Error 4600
RES R43301               ; ｻｲｸﾙﾀｲﾑ計測用3-2
CON
JMP @MR3300
STG @MR3307
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
RES R43301               ; ｻｲｸﾙﾀｲﾑ計測用3-2
CON
JMP @MR3400              ; 真空引き & 真空保持へ
;<h1/>AUTO 真空引き&保持 / Vacuum and Keep
STG @MR3400              ; 真空引き & 真空保持へ
SET R43302               ; ｻｲｸﾙﾀｲﾑ計測用3-3
CON
SET R50103               ; PACK ST3
CON
JMP @MR3401
STG @MR3401
SET @MR4100              ; 真空引き&真空保持
CON
JMP @MR3402
STG @MR3402
AND @MR4101              ; 真空引き&真空保持 完了
RES R43302               ; ｻｲｸﾙﾀｲﾑ計測用3-3
CON
RES @MR4101              ; 真空引き&真空保持 完了
CON
JMP @MR3413              ; 注入前ﾜｰｸﾁｪｯｸ
;注入前ﾜｰｸ確認 / Before infusion case check
STG @MR3411
MPS
LD @MR4108               ; 真空到達1OK
AND @MR4109              ; 真空到達2OK
AND @MR4110              ; 真空到達3OK
AND @MR4111              ; 真空到達4OK
AND @MR4112              ; 真空保持ﾁｪｯｸ1OK
AND @MR4113              ; 真空保持ﾁｪｯｸ2OK
AND @MR4114              ; 真空保持ﾁｪｯｸ3OK
AND @MR4115              ; 真空保持ﾁｪｯｸ4OK
ANL
JMP @MR3413              ; 注入前ﾜｰｸﾁｪｯｸ
MPP
TMR @12 #10
CON
AND @T12
SET @MR4000              ; 大気開放ﾁｪｯｸ
CON
JMP @MR3412
STG @MR3412
AND @MR4001              ; 大気開放ﾁｪｯｸ 完了
RES @MR4001              ; 大気開放ﾁｪｯｸ 完了
CON
JMP @MR3608              ; 注入UT上昇
;
STG @MR3413              ; 注入前ﾜｰｸﾁｪｯｸ
MPS
LD @MR100                ; ﾜｰｸ1処理有
AND R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
ORB @MR100               ; ﾜｰｸ1処理有
LD @MR101                ; ﾜｰｸ2処理有
AND R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
ORB @MR101               ; ﾜｰｸ2処理有
ANL
LD @MR102                ; ﾜｰｸ3処理有
AND R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
ORB @MR102               ; ﾜｰｸ3処理有
ANL
LD @MR103                ; ﾜｰｸ4処理有
AND R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
ORB @MR103               ; ﾜｰｸ4処理有
ANL
ANL
JMP @MR3500              ; 注入前準備
MPP
TMR @38 #10
CON
AND @T38
SET @MR308               ; Err71 ST3 Err11
CON
JMP @MR3414
;***** ﾜｰｸ検出異常の時 / Case detection  erorr ***
STG @MR3414
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR311               ; Err71 ST3 Err11解除完了
RES @MR311               ; Err71 ST3 Err11解除完了
CON
JMP @MR3413              ; 注入前ﾜｰｸﾁｪｯｸ
;注入動作前準備 / Before infusion ready
STG @MR3500              ; 注入前準備
ANB MR11802              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 実行中
ANB MR11810              ; ﾌﾟﾗﾝｼﾞｬｰ 2 後退call 実行中
ANB MR11806              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 実行中
ANB MR11814              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 実行中
ANB MR11902              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 実行中
ANB MR11910              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 実行中
ANB MR11906              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 実行中
ANB MR11914              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 実行中
ZRES MR11800 MR11915     ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call FLG
CON
SET @MR3501              ; 中間大気解放位置計算
CON
ENDS
;'?v?‰?“?W???[1
;TM12.L= DM2720.L-DM2000.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;TM14.F= DM514/100.F		'?S?a?|?a“?
;TM12.L= TM12.L*TM14.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;TM12.L= TM12.L+DM2000.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;TM10.L= TM12.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;'?v?‰?“?W???[2
;TM22.L= DM2770.L-DM2008.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;TM24.F= DM516/100.F		'?S?a?|?a“?
;TM22.L= TM22.L*TM24.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;TM22.L= TM22.L+DM2008.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;TM20.L= TM22.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;'?v?‰?“?W???[3
;TM32.L= DM2820.L-DM2016.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;TM34.F= DM515/100.F		'?S?a?|?a“?
;TM32.L= TM32.L*TM34.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;TM32.L= TM32.L+DM2016.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;TM30.L= TM32.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;'?v?‰?“?W???[4
;TM42.L= DM2870.L-DM2024.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;TM44.F= DM517/100.F 		'?S?a?|?a“?
;TM42.L= TM42.L*TM44.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;TM42.L= TM42.L+DM2024.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;TM40.L= TM42.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;'?X?e?[?W?U“R
;RES (@MR3501)
;SET (@MR3502)
LDP @MR3501              ; 中間大気解放位置計算
NCJ #1000
;'?v?‰?“?W???[1
;
;TM12.L= DM2720.L-DM2000.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;
LD CR2002                ; 常時ON
LDA.L DM2720             ; RB6_P2 位置ﾃﾞｰﾀ
CON
SUB.L DM2000             ; RB6現在位置
CON
STA.L TM12
;TM14.F= DM514/100.F		'?S?a?|?a“?
;
LD CR2002                ; 常時ON
LDA DM514                ; STL Data04 注入1大気開放(0.1%)
CON
FLOAT
CON
DIV.F +100
CON
STA.F TM14
;TM12.L= TM12.L*TM14.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;
LD CR2002                ; 常時ON
LDA.L TM12
CON
FLOAT.L
CON
MUL.F TM14
CON
INTG.L
CON
STA.L TM12
;TM12.L= TM12.L+DM2000.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;
LD CR2002                ; 常時ON
LDA.L TM12
CON
ADD.L DM2000             ; RB6現在位置
CON
STA.L TM12
;TM10.L= TM12.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;
LD CR2002                ; 常時ON
MOV.L TM12 TM10          ; Inf-1 Vacuum release point
;'?v?‰?“?W???[2
;
;TM22.L= DM2770.L-DM2008.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;
LD CR2002                ; 常時ON
LDA.L DM2770             ; RB7_P2 位置ﾃﾞｰﾀ
CON
SUB.L DM2008             ; RB7 現在位置
CON
STA.L TM22
;TM24.F= DM516/100.F		'?S?a?|?a“?
;
LD CR2002                ; 常時ON
LDA DM516                ; STL Data06 注入3大気開放(0.1%)
CON
FLOAT
CON
DIV.F +100
CON
STA.F TM24
;TM22.L= TM22.L*TM24.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;
LD CR2002                ; 常時ON
LDA.L TM22
CON
FLOAT.L
CON
MUL.F TM24
CON
INTG.L
CON
STA.L TM22
;TM22.L= TM22.L+DM2008.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;
LD CR2002                ; 常時ON
LDA.L TM22
CON
ADD.L DM2008             ; RB7 現在位置
CON
STA.L TM22
;TM20.L= TM22.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;
LD CR2002                ; 常時ON
MOV.L TM22 TM20          ; Inf-2 Vacuum release point
;'?v?‰?“?W???[3
;
;TM32.L= DM2820.L-DM2016.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;
LD CR2002                ; 常時ON
LDA.L DM2820             ; RB8_P2 位置ﾃﾞｰﾀ
CON
SUB.L DM2016             ; RB8現在位置
CON
STA.L TM32
;TM34.F= DM515/100.F		'?S?a?|?a“?
;
LD CR2002                ; 常時ON
LDA DM515                ; STL Data05 注入2大気開放(0.1%)
CON
FLOAT
CON
DIV.F +100
CON
STA.F TM34
;TM32.L= TM32.L*TM34.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;
LD CR2002                ; 常時ON
LDA.L TM32
CON
FLOAT.L
CON
MUL.F TM34
CON
INTG.L
CON
STA.L TM32
;TM32.L= TM32.L+DM2016.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;
LD CR2002                ; 常時ON
LDA.L TM32
CON
ADD.L DM2016             ; RB8現在位置
CON
STA.L TM32
;TM30.L= TM32.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;
LD CR2002                ; 常時ON
MOV.L TM32 TM30          ; Inf-3 Vacuum release point
;'?v?‰?“?W???[4
;
;TM42.L= DM2870.L-DM2024.L	'?U?WPT?A?≫?YPT?I?・?d?a“?
;
LD CR2002                ; 常時ON
LDA.L DM2870             ; RB9_P2 位置ﾃﾞｰﾀ
CON
SUB.L DM2024             ; RB9 現在位置
CON
STA.L TM42
;TM44.F= DM517/100.F 		'?S?a?|?a“?
;
LD CR2002                ; 常時ON
LDA DM517                ; STL Data07 注入4大気開放(0.1%)
CON
FLOAT
CON
DIV.F +100
CON
STA.F TM44
;TM42.L= TM42.L*TM44.F		'‘a?C?J?u?U?A?I?U“R?E?d?S?a?|‰‰?Z
;
LD CR2002                ; 常時ON
LDA.L TM42
CON
FLOAT.L
CON
MUL.F TM44
CON
INTG.L
CON
STA.L TM42
;TM42.L= TM42.L+DM2024.L		'‘a?C?J?u?U?A?I?U“R?E?E?≫?YPT?d‰A?Z	
;
LD CR2002                ; 常時ON
LDA.L TM42
CON
ADD.L DM2024             ; RB9 現在位置
CON
STA.L TM42
;TM40.L= TM42.L				'?!?”‰n?AU°，?，?Z?Z?o?p
;
LD CR2002                ; 常時ON
MOV.L TM42 TM40          ; Inf-4 Vacuum release point
;'?X?e?[?W?U“R
;
;RES (@MR3501)
;
LD CR2002                ; 常時ON
RES @MR3501              ; 中間大気解放位置計算
;SET (@MR3502)
LD CR2002                ; 常時ON
SET @MR3502
LABEL #1000
;
;Case1 → PP1  ,  Case1 → PP3  ,  Case1 → PP2  ,  Case1 → PP4
STG @MR3502
MPS
SET R43303               ; ｻｲｸﾙﾀｲﾑ計測用3-4
CON
SET MR19000              ; 注入中
CON
JMP @MR3503
MRD
AND @MR100               ; ﾜｰｸ1処理有
SET @MR4500              ; PP1 注入
MRD
AND @MR101               ; ﾜｰｸ2処理有
SET @MR4700              ; PP3 注入
MRD
AND @MR102               ; ﾜｰｸ3処理有
SET @MR4600              ; PP2 注入
MPP
AND @MR103               ; ﾜｰｸ4処理有
SET @MR4800              ; PP4 注入
;注入NGﾜｰｸ記憶
LD MR19000               ; 注入中
MPS
AND MR19001              ; 注入1異常
DW #3 DM3451             ; ST3-No1 NGﾜｰｸ 0=OK
MRD
AND MR19002              ; 注入2異常
DW #3 DM3471             ; ST3-No2 NGﾜｰｸ 0=OK
MRD
AND MR19007              ; 注入3異常
DW #3 DM3491             ; ST3-No3 NGﾜｰｸ 0=OK
MPP
AND MR19008              ; 注入4異常
DW #3 DM3511             ; ST3-No4 NGﾜｰｸ 0=OK
STG @MR3503
LD @MR4501               ; PP1 注入完了
ORB @MR100               ; ﾜｰｸ1処理有
ANL
LD @MR4701               ; PP3 注入完了
ORB @MR101               ; ﾜｰｸ2処理有
ANL
LD @MR4601               ; PP2 注入完了
ORB @MR102               ; ﾜｰｸ3処理有
ANL
LD @MR4801               ; PP4 注入完了
ORB @MR103               ; ﾜｰｸ4処理有
ANL
RES @MR4501              ; PP1 注入完了
CON
RES @MR4601              ; PP2 注入完了
CON
RES @MR4701              ; PP3 注入完了
CON
RES @MR4801              ; PP4 注入完了
CON
RES R43303               ; ｻｲｸﾙﾀｲﾑ計測用3-4
CON
JMP @MR3608              ; 注入UT上昇
;***** 注入UT 上昇 / Infusion UT up *****
;
;<h1/>AUTO 注入UT 上昇
STG @MR3608              ; 注入UT上昇
SET R43304               ; ｻｲｸﾙﾀｲﾑ計測用3-5
CON
LDB MR7204               ; ﾘｰｸ検査ﾍｯﾄﾞ 下降
OR R50008                ; Error
ANL
RES MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
SET MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
JMP @MR3609
STG @MR3609
ANB R4600                ; 注入ﾍｯﾄﾞ 下限
SET @MR3800              ; 供給孔ｸﾗﾝﾌﾟ解除
CON
JMP @MR3610
STG @MR3610
AND R4601                ; 注入ﾍｯﾄﾞ 上限
TMH @13 #10
CON
AND @T13
JMP @MR3611
STG @MR3611
RES R43304               ; ｻｲｸﾙﾀｲﾑ計測用3-5
CON
SET R43305               ; ｻｲｸﾙﾀｲﾑ計測用3-6
CON
SET @MR4000              ; 大気開放ﾁｪｯｸ
CON
JMP @MR3612
STG @MR3612
AND @MR4001              ; 大気開放ﾁｪｯｸ 完了
RES @MR4001              ; 大気開放ﾁｪｯｸ 完了
CON
JMP @MR3613
STG @MR3613
RES R50103               ; PACK ST3
CON
RES R43305               ; ｻｲｸﾙﾀｲﾑ計測用3-6
CON
JMP @MR3700
;真空到達 NG & 真空保持 NG ﾌﾗｸﾞ確認
;Check the Flag of Vacuum reach & Vacuum Hold
;Case 1 
STG @MR3700
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD= DM828 #0             ; ST3_1ｲﾝｸ注入有無(0=無)
LD @MR4108               ; 真空到達1OK
AND @MR4112              ; 真空保持ﾁｪｯｸ1OK
ORL
ANL
JMP @MR3703
MPP
AND<> DM828 #0           ; ST3_1ｲﾝｸ注入有無(0=無)
MPS
ANB @MR4108              ; 真空到達1OK
SET @MR204               ; Err66
CON
JMP @MR3701
MPP
LD @MR4108               ; 真空到達1OK
ANB @MR4112              ; 真空保持ﾁｪｯｸ1OK
ANL
SET @MR212               ; Err68
CON
JMP @MR3702
STG @MR3701
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR207               ; Err66解除完了
RES @MR207               ; Err66解除完了
CON
JMP @MR3703
STG @MR3702
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR215               ; Err68解除完了
RES @MR215               ; Err68解除完了
CON
JMP @MR3703
;Case 2
STG @MR3703
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD= DM829 #0             ; ST3_2ｲﾝｸ注入有無(0=無)
LD @MR4109               ; 真空到達2OK
AND @MR4113              ; 真空保持ﾁｪｯｸ2OK
ORL
ANL
JMP @MR3706
MPP
AND<> DM829 #0           ; ST3_2ｲﾝｸ注入有無(0=無)
MPS
ANB @MR4109              ; 真空到達2OK
SET @MR208               ; Err67
CON
JMP @MR3704
MPP
LD @MR4109               ; 真空到達2OK
ANB @MR4113              ; 真空保持ﾁｪｯｸ2OK
ANL
SET @MR300               ; Err69
CON
JMP @MR3705
STG @MR3704
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR211               ; Err67解除完了
RES @MR211               ; Err67解除完了
CON
JMP @MR3706
STG @MR3705
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR303               ; Err69解除完了
RES @MR303               ; Err69解除完了
CON
JMP @MR3706
;Case 3
STG @MR3706
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD= DM830 #0             ; ST3_3ｲﾝｸ注入有無(0=無)
LD @MR4110               ; 真空到達3OK
AND @MR4114              ; 真空保持ﾁｪｯｸ3OK
ORL
ANL
JMP @MR3709
MPP
AND<> DM830 #0           ; ST3_3ｲﾝｸ注入有無(0=無)
MPS
ANB @MR4110              ; 真空到達3OK
SET @MR408               ; Err73
CON
JMP @MR3707
MPP
LD @MR4110               ; 真空到達3OK
ANB @MR4114              ; 真空保持ﾁｪｯｸ3OK
ANL
SET @MR500               ; Err75
CON
JMP @MR3708
STG @MR3707
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR411               ; Err73解除完了
RES @MR411               ; Err73解除完了
CON
JMP @MR3709
STG @MR3708
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR503               ; Err75解除完了
RES @MR503               ; Err75解除完了
CON
JMP @MR3709
;Case 4
STG @MR3709
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
LD= DM831 #0             ; ST3_4ｲﾝｸ注入有無(0=無)
LD @MR4111               ; 真空到達4OK
AND @MR4115              ; 真空保持ﾁｪｯｸ4OK
ORL
ANL
JMP @MR3712
MPP
AND<> DM831 #0           ; ST3_4ｲﾝｸ注入有無(0=無)
MPS
ANB @MR4111              ; 真空到達4OK
SET @MR412               ; Err74
CON
JMP @MR3710
MPP
LD @MR4111               ; 真空到達4OK
ANB @MR4115              ; 真空保持ﾁｪｯｸ4OK
ANL
SET @MR504               ; Err76
CON
JMP @MR3711
STG @MR3710
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR415               ; Err74解除完了
RES @MR415               ; Err74解除完了
CON
JMP @MR3712
STG @MR3711
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR507               ; Err76解除完了
RES @MR507               ; Err76解除完了
CON
JMP @MR3712
;
STG @MR3712
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR002               ; 真空到達&保持Flg.確認完了
CON
ENDS
;***** 供給孔クランプ　開放 / Supply hole clamping Release *****
;@T8 20→10へ変更 / @T8 timer value change Before 20 → After 10
;<h1/>AUTO 供給孔クランプ　開放
STG @MR3800              ; 供給孔ｸﾗﾝﾌﾟ解除
SET R43306               ; ｻｲｸﾙﾀｲﾑ計測用3-7
CON
TMH @8 #0
CON
AND @T8
JMP @MR3801
STG @MR3801
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR7204               ; ﾘｰｸ検査ﾍｯﾄﾞ 下降
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
JMP @MR3802
STG @MR3802
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
AND R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
RES R43306               ; ｻｲｸﾙﾀｲﾑ計測用3-7
CON
JMP @MR3803              ; 浮きﾁｪｯｸ
;***** ﾜｰｸ浮きﾁｪｯｸ / Work flotage check *****
;
STG @MR3803              ; 浮きﾁｪｯｸ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND R4601                ; 注入ﾍｯﾄﾞ 上限
MPS
LD R4210                 ; IND1 ST3 ﾜｰｸ浮き検出(外側)
AND R4211                ; IND1 ST3 ﾜｰｸ浮き検出(Index側)
ANL
JMP @MR3815
MPP
LDB R4210                ; IND1 ST3 ﾜｰｸ浮き検出(外側)
ORB R4211                ; IND1 ST3 ﾜｰｸ浮き検出(Index側)
ANL
SET @MR312               ; Err72 ST3 Err12
CON
JMP @MR3804              ; ﾜｰｸ浮き
;***** ﾜｰｸ浮きの時 / When Work flotage check  *****
;
STG @MR3804              ; ﾜｰｸ浮き
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR315               ; Err72 ST3 Err12解除完了
JMP @MR3805
STG @MR3805
RES @MR315               ; Err72 ST3 Err12解除完了
CON
JMP @MR3803              ; 浮きﾁｪｯｸ
;
STG @MR3815
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR002               ; 真空到達&保持Flg.確認完了
JMP @MR3900              ; AUTO終了処理
;AUTO 1ｻｲｸﾙ終了処理
;AUTO 1Cycle end Operation
STG @MR3900              ; AUTO終了処理
RES @MR002               ; 真空到達&保持Flg.確認完了
CON
MPS
LD R50001                ; AUTO
AND MR600                ; IND1      ｻｲｸﾙ動作中
ANL
SET R50413               ; IND1 ST3   1ｻｲｸﾙ終了
CON
JMP @MR3902              ; 3902
MPP
ANB R50001               ; AUTO
JMP @MR2008              ; STEP終了処理
STG @MR3902              ; 3902
RES R50903               ; IND1 ST3  ｻｲｸﾙ動作中
CON
RES R50903               ; IND1 ST3  ｻｲｸﾙ動作中
CON
ANB R50209               ; IND1     動作開始
AND R50409               ; IND1      ｻｲｸﾙ完了
MPS
LDB R50000               ; HOLD
ORB R50213               ; IND1　　　払出し完了
ANL
JMP @MR3000              ; ST3 AUTO開始
MPP
LD R50000                ; HOLD
AND R50213               ; IND1　　　払出し完了
ANL
JMP @MR3903              ; 3903
;AUTO 終了処理
;AUTO Finish Operation
STG @MR3903              ; 3903
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR3001              ; ST3 AUTO終了
CON
ENDS
;<h1/>ｽﾃｯﾌﾟ運転
;STEP OERATION
LD R50002                ; STEP
ANB R50203               ; ST3 動作中
SET R50203               ; ST3 動作中
CON
SET @MR2000              ; ST3 STEP開始
LDB R50003               ; HOME
ANB R50001               ; AUTO
ANB R50002               ; STEP
AND @MR2001              ; ST3 STEP終了
RES R50203               ; ST3 動作中
CON
RES @MR2001              ; ST3 STEP終了
LDB LR40400              ; IND1_ST3 STEP-01 通常動作
ANB LR40401              ; IND1_ST3 STEP-02 ﾊﾞﾌﾞﾘﾝｸﾞ中止
ANB LR40402              ; IND1_ST3 STEP-03 ｲﾝｸ吐出1-2
ANB LR40403              ; IND1_ST3 STEP-04 ｲﾝｸ吐出1
ANB LR40404              ; IND1_ST3 STEP-05 ｲﾝｸ吐出2
ANB LR40405              ; IND1_ST3 STEP-06 ｲﾝｸ吐出3
ANB LR40406              ; IND1_ST3 STEP-07 ｲﾝｸ吐出4
ANB LR40408              ; IND1_ST3 STEP-09 1Cycle
OUB @MR014               ; ST3 STEP Parameter OK
STG @MR2000              ; ST3 STEP開始
AND R50203               ; ST3 動作中
MPS
LD LR41100               ; AUTO-0 全ﾕﾆｯﾄ動作
OR LR41101               ; AUTO-1 IND1 2UT
OR LR41102               ; AUTO-2 IND1 3UT
OR LR41103               ; AUTO-3 IND1 4UT
OR LR41104               ; AUTO-4 IND2 3UT
OR LR41105               ; AUTO-5 IND3 3UT
OR LR41106               ; AUTO-6
ANL
MPS
AND LR40400              ; IND1_ST3 STEP-01 通常動作
JMP @MR3100              ; KDｲﾝｸ循環確認へ
MRD
AND LR40401              ; IND1_ST3 STEP-02 ﾊﾞﾌﾞﾘﾝｸﾞ中止
JMP @MR2208              ; ﾊﾞﾌﾞﾘﾝｸﾞ回避
MRD
AND LR40402              ; IND1_ST3 STEP-03 ｲﾝｸ吐出1-2
JMP @MR2100              ; ｲﾝｸ吐出選択 1-4へ
MRD
AND LR40403              ; IND1_ST3 STEP-04 ｲﾝｸ吐出1
JMP @MR2108              ; ｲﾝｸ吐出選択PP1へ
MRD
AND LR40404              ; IND1_ST3 STEP-05 ｲﾝｸ吐出2
JMP @MR2600              ; ｲﾝｸ吐出選択PP3へ
MRD
AND LR40405              ; IND1_ST3 STEP-06 ｲﾝｸ吐出3
JMP @MR2200              ; ｲﾝｸ吐出選択PP2へ
MRD
AND LR40406              ; IND1_ST3 STEP-07 ｲﾝｸ吐出4
JMP @MR2608              ; ｲﾝｸ吐出選択PP4へ
MPP
AND LR40408              ; IND1_ST3 STEP-09 1Cycle
SET R50313               ; STEP中CallPost回避
CON
JMP @MR3100              ; KDｲﾝｸ循環確認へ
MRD
AND LR41109              ; 背面SW有効
JMP @MR2008              ; STEP終了処理
MRD
LD LR41115               ; 真空ﾁｪｯｸ1-4(調整用)
OR LR41110               ; 真空ﾁｪｯｸ1
OR LR41111               ; 真空ﾁｪｯｸ2
OR LR41112               ; 真空ﾁｪｯｸ3
OR LR41113               ; 真空ﾁｪｯｸ4
ANL
MPS
AND LR40400              ; IND1_ST3 STEP-01 通常動作
RES MR7909               ; IND1 ST3治具 開き
CON
SET MR7908               ; IND1 ST3治具 閉じ
CON
TMR @2 #2
CON
AND @T2
JMP @MR2300              ; 注入UT 下降
MPP
ANB LR40400              ; IND1_ST3 STEP-01 通常動作
JMP @MR2008              ; STEP終了処理
MRD
AND LR41114              ; 真空ﾁｪｯｸ1-4(日常点検用)
MPS
AND LR40400              ; IND1_ST3 STEP-01 通常動作
RES MR7909               ; IND1 ST3治具 開き
CON
SET MR7908               ; IND1 ST3治具 閉じ
CON
TMR @5 #2
CON
AND @T5
SET R50313               ; STEP中CallPost回避
CON
JMP @MR2300              ; 注入UT 下降
MPP
ANB LR40400              ; IND1_ST3 STEP-01 通常動作
JMP @MR2008              ; STEP終了処理
MRD
LD LR41107               ; AUTO-7
OR LR41108               ; AUTO-8
ANL
JMP @MR2008              ; STEP終了処理
MPP
ANB @MR014               ; ST3 STEP Parameter OK
JMP @MR2008              ; STEP終了処理
;STEP終了処理
STG @MR2008              ; STEP終了処理
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7908               ; IND1 ST3治具 閉じ
CON
SET MR7909               ; IND1 ST3治具 開き
CON
TMR @4 #2
CON
AND @T4
SET R50009               ; HOLDRQ
CON
JMP @MR2009              ; 2009
STG @MR2009              ; 2009
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7909               ; IND1 ST3治具 開き
CON
RES MR7908               ; IND1 ST3治具 閉じ
CON
AND R50000               ; HOLD
ZRES DM3200 DM3799       ; IND2-ST2 QRID-1  排出時読込 
CON
SET R50413               ; IND1 ST3   1ｻｲｸﾙ終了
CON
RES R50313               ; STEP中CallPost回避
CON
SET @MR2001              ; ST3 STEP終了
CON
ENDS
;***** ｲﾝｸ吐出選択 1-4  / Ink discharge select 1-4 *****
STG @MR2100              ; ｲﾝｸ吐出選択 1-4へ
SET @MR2101              ; PP1 動作
CON
SET @MR2102              ; PP2 動作
CON
SET @MR2103              ; PP3 動作
CON
SET @MR2104              ; PP4 動作
CON
SET @MR2108              ; ｲﾝｸ吐出選択PP1へ
CON
SET @MR2600              ; ｲﾝｸ吐出選択PP3へ
CON
SET @MR2200              ; ｲﾝｸ吐出選択PP2へ
CON
SET @MR2608              ; ｲﾝｸ吐出選択PP4へ
CON
JMP @MR2105              ; 全PP吐出
STG @MR2105              ; 全PP吐出
ANB @MR2101              ; PP1 動作
ANB @MR2102              ; PP2 動作
ANB @MR2103              ; PP3 動作
ANB @MR2104              ; PP4 動作
JMP @MR2008              ; STEP終了処理
;***** ｲﾝｸ吐出選択 1  / Ink discharge select  1 *****
STG @MR2108              ; ｲﾝｸ吐出選択PP1へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
JMP @MR2109              ; PP1 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +6000      ; RB6_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +7000      ; RB6_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +7000      ; RB6_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2720 DM2726      ; RB6_P2 位置ﾃﾞｰﾀ  PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR2109              ; PP1 前進
SET MR11804              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call FLG
CON
JMP @MR2110              ; 3403
STG @MR2110              ; 3403
AND MR11805              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 完了
RES MR11805              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 完了
CON
JMP @MR2111              ; 3404
STG @MR2111              ; 3404
SET MR11800              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call FLG
CON
JMP @MR2112
STG @MR2112
AND MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
RES MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
CON
JMP @MR2113
STG @MR2113
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
STA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2114
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2114
MPP
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2114
STG @MR2114
MPS
AND>.L DM2726 +0         ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
JMP @MR2109              ; PP1 前進
MPP
AND<=.L DM2726 +0        ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPS
ANB @MR2105              ; 全PP吐出
JMP @MR2008              ; STEP終了処理
MPP
AND @MR2105              ; 全PP吐出
RES @MR2101              ; PP1 動作
CON
ENDS
;***** ｲﾝｸ吐出選択  2  / Ink discharge select  2 *****
STG @MR2200              ; ｲﾝｸ吐出選択PP2へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
JMP @MR2201              ; PP2 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +6000      ; RB7_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +7000      ; RB7_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +7000      ; RB7_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2770 DM2776      ; RB7_P2 位置ﾃﾞｰﾀ  PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR2201              ; PP2 前進
SET MR11812              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call FLG
CON
JMP @MR2202              ; 3603
STG @MR2202              ; 3603
AND MR11813              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 完了
RES MR11813              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 完了
CON
JMP @MR2203              ; 3604
STG @MR2203              ; 3604
SET MR11808              ; ﾌﾟﾗﾝｼﾞｬｰ 2 後退call FLG
CON
JMP @MR2204
STG @MR2204
AND MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
RES MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
CON
JMP @MR2205
STG @MR2205
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
STA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2206
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2206
MPP
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2206
STG @MR2206
MPS
AND>.L DM2776 +0         ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
JMP @MR2201              ; PP2 前進
MPP
AND<=.L DM2776 +0        ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPS
ANB @MR2105              ; 全PP吐出
JMP @MR2008              ; STEP終了処理
MPP
AND @MR2105              ; 全PP吐出
RES @MR2102              ; PP2 動作
CON
ENDS
;***** ｲﾝｸ吐出選択 3  / Ink discharge select  3 *****
STG @MR2600              ; ｲﾝｸ吐出選択PP3へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
JMP @MR2601              ; PP3 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +6000      ; RB8_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +7000      ; RB8_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +7000      ; RB8_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2820 DM2826      ; RB8_P2 位置ﾃﾞｰﾀ  PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR2601              ; PP3 前進
SET MR11904              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call FLG
CON
JMP @MR2602
STG @MR2602
AND MR11905              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 完了
RES MR11905              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 完了
CON
JMP @MR2603
STG @MR2603
SET MR11900              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call FLG
CON
JMP @MR2604
STG @MR2604
AND MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
RES MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
CON
JMP @MR2605
STG @MR2605
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
STA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2606
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2606
MPP
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2606
STG @MR2606
MPS
AND>.L DM2826 +0         ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
JMP @MR2601              ; PP3 前進
MPP
AND<=.L DM2826 +0        ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPS
ANB @MR2105              ; 全PP吐出
JMP @MR2008              ; STEP終了処理
MPP
AND @MR2105              ; 全PP吐出
RES @MR2103              ; PP3 動作
CON
ENDS
;***** ｲﾝｸ吐出選択  4  / Ink discharge select  4 *****
STG @MR2608              ; ｲﾝｸ吐出選択PP4へ
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
MPS
JMP @MR2609              ; PP4 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +6000      ; RB9_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +7000      ; RB9_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +7000      ; RB9_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2870 DM2876      ; RB9_P2 位置ﾃﾞｰﾀ  PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR2609              ; PP4 前進
SET MR11912              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call FLG
CON
JMP @MR2610
STG @MR2610
AND MR11913              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 完了
RES MR11913              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 完了
CON
JMP @MR2611
STG @MR2611
SET MR11908              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call FLG
CON
JMP @MR2612
STG @MR2612
AND MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
RES MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
CON
JMP @MR2613
STG @MR2613
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
STA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2614
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2614
MPP
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
STA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
JMP @MR2614
STG @MR2614
MPS
AND>.L DM2876 +0         ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
JMP @MR2609              ; PP4 前進
MPP
AND<=.L DM2876 +0        ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPS
ANB @MR2105              ; 全PP吐出
JMP @MR2008              ; STEP終了処理
MPP
AND @MR2105              ; 全PP吐出
RES @MR2104              ; PP4 動作
CON
ENDS
;***** ﾊﾞﾌﾞﾘﾝｸﾞ回避 / babring stop *****
;
STG @MR2208              ; ﾊﾞﾌﾞﾘﾝｸﾞ回避
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR12115              ; ﾊﾞﾌﾞﾘﾝｸﾞ回避
CON
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2209
STG @MR2209
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
ANB MR12310              ; KDﾄﾞﾗﾑ攪拌中
ANB MR12302              ; ｻﾌﾞﾀﾝｸ攪拌中
JMP @MR2210
STG @MR2210
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR12115              ; ﾊﾞﾌﾞﾘﾝｸﾞ回避
CON
JMP @MR2008              ; STEP終了処理
;***** STEP 真空ﾁｪｯｸ ﾓｰﾄﾞ / Vacuum check mode *****
;
;***** 注入UT下降  / Infusion UT down *****
;
STG @MR2300              ; 注入UT 下降
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
JMP @MR2301              ; 7001
STG @MR2301              ; 7001
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
AND R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
JMP @MR2302              ; 7002
STG @MR2302              ; 7002
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
AND R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
ANB R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
AND R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2303              ; 7003
STG @MR2303              ; 7003
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
SET MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
ANB R4601                ; 注入ﾍｯﾄﾞ 上限
AND R4600                ; 注入ﾍｯﾄﾞ 下限
TMR @11 #1
CON
AND @T11
JMP @MR2304              ; 7004
STG @MR2304              ; 7004
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2308              ; 真空引き&真空保持
;***** 真空引き&真空保持 / Vacuum & Vaccum keep *****
;
STG @MR2308              ; 真空引き&真空保持
SET @MR4100              ; 真空引き&真空保持
CON
JMP @MR2309              ; 7101
STG @MR2309              ; 7101
AND @MR4101              ; 真空引き&真空保持 完了
RES @MR4101              ; 真空引き&真空保持 完了
CON
JMP @MR2400              ; ﾍｯﾄﾞ真空開
;*****  ﾍｯﾄﾞ真空 開 /  Head vacuum open *****
;
STG @MR2400              ; ﾍｯﾄﾞ真空開
MPS
LD LR41100               ; AUTO-0 全ﾕﾆｯﾄ動作
OR LR41115               ; 真空ﾁｪｯｸ1-4(調整用)
OR LR41103               ; AUTO-3 IND1 4UT
OR LR41106               ; AUTO-6
OR LR41114               ; 真空ﾁｪｯｸ1-4(日常点検用)
ANL
MPS
AND @MR100               ; ﾜｰｸ1処理有
SET MR7212               ; 注入部 真空引き1
MRD
AND @MR101               ; ﾜｰｸ2処理有
SET MR7214               ; 注入部 真空引き2
MRD
AND @MR102               ; ﾜｰｸ3処理有
SET MR7300               ; 注入部 真空引き3
MPP
AND @MR103               ; ﾜｰｸ4処理有
SET MR7302               ; 注入部 真空引き4
MRD
AND LR41110              ; 真空ﾁｪｯｸ1
SET MR7212               ; 注入部 真空引き1
MRD
AND LR41111              ; 真空ﾁｪｯｸ2
SET MR7214               ; 注入部 真空引き2
MRD
AND LR41111              ; 真空ﾁｪｯｸ2
SET MR7300               ; 注入部 真空引き3
MRD
AND LR41111              ; 真空ﾁｪｯｸ2
SET MR7302               ; 注入部 真空引き4
MPP
TMR @17 #1
CON
AND @T17
JMP @MR2402              ; 7402
STG @MR2402              ; 7402
TMR @3 #300
CON
AND @T3
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2500              ; 注入上昇
;***** STEP 真空ﾁｪｯｸ ﾓｰﾄﾞ / Vacuum check mode *****
;
;***** 注入UT 上昇 / Infusion UT up *****
;
STG @MR2500              ; 注入上昇
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7600               ; 注入ﾍｯﾄﾞ　下降
CON
SET MR7601               ; 注入ﾍｯﾄﾞ　上昇
CON
ANB R4600                ; 注入ﾍｯﾄﾞ 下限
AND R4601                ; 注入ﾍｯﾄﾞ 上限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2501              ; 7701
STG @MR2501              ; 7701
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7604               ; 供給孔ｸﾗﾝﾌﾟ　閉
CON
ANB R4604                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　閉限
AND R4605                ; 供給孔ｸﾗﾝﾌﾟ位置決め側　開限
ANB R4606                ; 供給孔ｸﾗﾝﾌﾟ基準側　閉限
AND R4607                ; 供給孔ｸﾗﾝﾌﾟ基準側　開限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2502              ; 7702
STG @MR2502              ; 7702
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
RES MR7602               ; 供給孔ｸﾗﾝﾌﾟ　下降
CON
ANB R4603                ; 供給孔ｸﾗﾝﾌﾟ　上昇限
AND R4602                ; 供給孔ｸﾗﾝﾌﾟ　下降限
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR2503              ; 大気開放
;***** 大気開放ﾁｪｯｸ / air rerease check *****
;
STG @MR2503              ; 大気開放
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
SET @MR4000              ; 大気開放ﾁｪｯｸ
CON
JMP @MR2504              ; 7501
STG @MR2504              ; 7501
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND @MR4001              ; 大気開放ﾁｪｯｸ 完了
RES @MR4001              ; 大気開放ﾁｪｯｸ 完了
CON
JMP @MR2008              ; STEP終了処理
;<h1/>ｻﾌﾞﾙｰﾁﾝ
;Subroutine
;<h1/>  SUB 大気開放&確認
;  SUB Air rerease & check
STG @MR4000              ; 大気開放ﾁｪｯｸ
ANB R50113               ; Err ST3
RES MR7304               ; 注入部 元真空1
CON
RES MR7305               ; 注入部 元真空2
CON
RES MR7306               ; 注入部 元真空3
CON
RES MR7307               ; 注入部 元真空4
CON
SET MR7212               ; 注入部 真空引き1
CON
SET MR7214               ; 注入部 真空引き2
CON
SET MR7300               ; 注入部 真空引き3
CON
SET MR7302               ; 注入部 真空引き4
CON
SET MR7213               ; 注入部 大気開放1
CON
SET MR7215               ; 注入部 大気開放2
CON
SET MR7301               ; 注入部 大気開放3
CON
SET MR7303               ; 注入部 大気開放4
CON
JMP @MR4003
STG @MR4003
ANB R50113               ; Err ST3
ANB R4700                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) HI
ANB R4701                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) GO
ANB R4702                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) LO
ANB R4703                ; ﾊﾟﾙﾐﾙ真空計2(中1側) HI
ANB R4704                ; ﾊﾟﾙﾐﾙ真空計2(中1側) GO
ANB R4705                ; ﾊﾟﾙﾐﾙ真空計2(中1側) LO
ANB R4706                ; ﾊﾟﾙﾐﾙ真空計3(中2側) HI
ANB R4707                ; ﾊﾟﾙﾐﾙ真空計3(中2側) GO
ANB R4708                ; ﾊﾟﾙﾐﾙ真空計3(中2側) LO
ANB R4709                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) HI
ANB R4710                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) GO
ANB R4711                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) LO
TMR @25 #1
CON
AND @T25
JMP @MR4004
STG @MR4004
ANB R50113               ; Err ST3
RES MR7212               ; 注入部 真空引き1
CON
RES MR7214               ; 注入部 真空引き2
CON
RES MR7300               ; 注入部 真空引き3
CON
RES MR7302               ; 注入部 真空引き4
CON
JMP @MR4005
STG @MR4005
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
SET @MR4001              ; 大気開放ﾁｪｯｸ 完了
CON
ENDS
;ｻﾌﾞﾙｰﾁﾝ  /  Subroutine
;
;*****　真空引き & 真空保持時間 / Vacuum & Vacuum keep time 　@MR4600〜@MR46515　*****
;
;真空保持点検
;Counter03のｶｳﾝﾄｱｯﾌﾟで真空保持をT25の時間保持する
;ﾊﾟﾙﾐﾙ HI信号　ONでOK、OFFでNG　→　ｴﾗｰ表示後非常停止にする
LDP @MR4102              ; 実行中ﾌﾗｸﾞ
DW #0 TM100
CON
DW #0 TM101
CON
DW #0 TM102
CON
DW #0 TM103
LD CR2002                ; 常時ON
MPS
LD @MR100                ; ﾜｰｸ1処理有
ANP R7212                ; 注入部 真空引き1
ANL
SET @MR4104              ; ﾜｰｸ1 真空到達計測中
MRD
LD @MR4104               ; ﾜｰｸ1 真空到達計測中
ANP CR2004               ; 10msｸﾛｯｸﾊﾟﾙｽ
ANL
INC TM100
MPP
AND R4701                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) GO
RES @MR4104              ; ﾜｰｸ1 真空到達計測中
LD CR2002                ; 常時ON
MPS
LD @MR101                ; ﾜｰｸ2処理有
ANP R7214                ; 注入部 真空引き2
ANL
SET @MR4105              ; ﾜｰｸ2 真空到達計測中
MRD
LD @MR4105               ; ﾜｰｸ2 真空到達計測中
ANP CR2004               ; 10msｸﾛｯｸﾊﾟﾙｽ
ANL
INC TM101
MPP
AND R4704                ; ﾊﾟﾙﾐﾙ真空計2(中1側) GO
RES @MR4105              ; ﾜｰｸ2 真空到達計測中
LD CR2002                ; 常時ON
MPS
LD @MR102                ; ﾜｰｸ3処理有
ANP R7300                ; 注入部 真空引き3
ANL
SET @MR4106              ; ﾜｰｸ3 真空到達計測中
MRD
LD @MR4106               ; ﾜｰｸ3 真空到達計測中
ANP CR2004               ; 10msｸﾛｯｸﾊﾟﾙｽ
ANL
INC TM102
MPP
AND R4707                ; ﾊﾟﾙﾐﾙ真空計3(中2側) GO
RES @MR4106              ; ﾜｰｸ3 真空到達計測中
LD CR2002                ; 常時ON
MPS
LD @MR103                ; ﾜｰｸ4処理有
ANP R7302                ; 注入部 真空引き4
ANL
SET @MR4107              ; ﾜｰｸ4 真空到達計測中
MRD
LD @MR4107               ; ﾜｰｸ4 真空到達計測中
ANP CR2004               ; 10msｸﾛｯｸﾊﾟﾙｽ
ANL
INC TM103
MPP
AND R4710                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) GO
RES @MR4107              ; ﾜｰｸ4 真空到達計測中
;<h1/>  SUB 真空引き & 真空保持時間
;  SUB Vacuum & Vacuum keep time
STG @MR4100              ; 真空引き&真空保持
ZRES MR7212 MR7307       ; 注入部 真空引き1  注入部 元真空4
CON
ZRES @MR4108 @MR4115     ; 真空到達1OK  真空保持ﾁｪｯｸ4OK
CON
SET @MR4102              ; 実行中ﾌﾗｸﾞ
CON
JMP @MR4300
STG @MR4300
MPS
LD LR41100               ; AUTO-0 全ﾕﾆｯﾄ動作
OR LR41103               ; AUTO-3 IND1 4UT
OR LR41106               ; AUTO-6
OR LR41114               ; 真空ﾁｪｯｸ1-4(日常点検用)
OR LR41115               ; 真空ﾁｪｯｸ1-4(調整用)
ANL
MPS
AND @MR100               ; ﾜｰｸ1処理有
SET MR7212               ; 注入部 真空引き1
CON
SET MR7304               ; 注入部 元真空1
MRD
AND @MR101               ; ﾜｰｸ2処理有
SET MR7214               ; 注入部 真空引き2
CON
SET MR7305               ; 注入部 元真空2
MRD
AND @MR102               ; ﾜｰｸ3処理有
SET MR7300               ; 注入部 真空引き3
CON
SET MR7306               ; 注入部 元真空3
MPP
AND @MR103               ; ﾜｰｸ4処理有
SET MR7302               ; 注入部 真空引き4
CON
SET MR7307               ; 注入部 元真空4
MRD
AND LR41110              ; 真空ﾁｪｯｸ1
SET MR7212               ; 注入部 真空引き1
CON
SET MR7304               ; 注入部 元真空1
MRD
AND LR41111              ; 真空ﾁｪｯｸ2
SET MR7214               ; 注入部 真空引き2
CON
SET MR7305               ; 注入部 元真空2
MRD
AND LR41112              ; 真空ﾁｪｯｸ3
SET MR7300               ; 注入部 真空引き3
CON
SET MR7306               ; 注入部 元真空3
MRD
AND LR41113              ; 真空ﾁｪｯｸ4
SET MR7302               ; 注入部 真空引き4
CON
SET MR7307               ; 注入部 元真空4
MPP
TMR @14 #10
CON
AND @T14
JMP @MR4303
STG @MR4303
MPS
AND @MR100               ; ﾜｰｸ1処理有
MPS
AND R4700                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) HI
MPS
AND R4701                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) GO
SET @MR4108              ; 真空到達1OK
CON
SET @MR4200              ; 1側到達確認終了
MPP
ANB R4701                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) GO
TMR @34 #150
CON
AND @T34
DW #3 DM3451             ; ST3-No1 NGﾜｰｸ 0=OK
CON
SET @MR4200              ; 1側到達確認終了
MPP
ANB R4700                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) HI
TMR @20 #150
CON
AND @T20
DW #3 DM3451             ; ST3-No1 NGﾜｰｸ 0=OK
CON
SET @MR4200              ; 1側到達確認終了
MRD
AND @MR101               ; ﾜｰｸ2処理有
MPS
AND R4703                ; ﾊﾟﾙﾐﾙ真空計2(中1側) HI
MPS
AND R4704                ; ﾊﾟﾙﾐﾙ真空計2(中1側) GO
SET @MR4109              ; 真空到達2OK
CON
SET @MR4201              ; 2側到達確認終了
MPP
ANB R4704                ; ﾊﾟﾙﾐﾙ真空計2(中1側) GO
TMR @35 #150
CON
AND @T35
DW #3 DM3471             ; ST3-No2 NGﾜｰｸ 0=OK
CON
SET @MR4201              ; 2側到達確認終了
MPP
ANB R4703                ; ﾊﾟﾙﾐﾙ真空計2(中1側) HI
TMR @21 #150
CON
AND @T21
DW #3 DM3471             ; ST3-No2 NGﾜｰｸ 0=OK
CON
SET @MR4201              ; 2側到達確認終了
MRD
AND @MR102               ; ﾜｰｸ3処理有
MPS
AND R4706                ; ﾊﾟﾙﾐﾙ真空計3(中2側) HI
MPS
AND R4707                ; ﾊﾟﾙﾐﾙ真空計3(中2側) GO
SET @MR4110              ; 真空到達3OK
CON
SET @MR4202              ; 3側到達確認終了
MPP
ANB R4707                ; ﾊﾟﾙﾐﾙ真空計3(中2側) GO
TMR @36 #150
CON
AND @T36
DW #3 DM3491             ; ST3-No3 NGﾜｰｸ 0=OK
CON
SET @MR4202              ; 3側到達確認終了
MPP
ANB R4706                ; ﾊﾟﾙﾐﾙ真空計3(中2側) HI
TMR @22 #150
CON
AND @T22
DW #3 DM3491             ; ST3-No3 NGﾜｰｸ 0=OK
CON
SET @MR4202              ; 3側到達確認終了
MRD
AND @MR103               ; ﾜｰｸ4処理有
MPS
AND R4709                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) HI
MPS
AND R4710                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) GO
SET @MR4111              ; 真空到達4OK
CON
SET @MR4203              ; 4側到達確認終了
MPP
ANB R4710                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) GO
TMR @37 #150
CON
AND @T37
DW #3 DM3511             ; ST3-No4 NGﾜｰｸ 0=OK
CON
SET @MR4203              ; 4側到達確認終了
MPP
ANB R4709                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) HI
TMR @23 #150
CON
AND @T23
DW #3 DM3511             ; ST3-No4 NGﾜｰｸ 0=OK
CON
SET @MR4203              ; 4側到達確認終了
MPP
LD @MR4200               ; 1側到達確認終了
ORB @MR100               ; ﾜｰｸ1処理有
LD @MR4201               ; 2側到達確認終了
ORB @MR101               ; ﾜｰｸ2処理有
ANL
LD @MR4202               ; 3側到達確認終了
ORB @MR102               ; ﾜｰｸ3処理有
ANL
LD @MR4203               ; 4側到達確認終了
ORB @MR103               ; ﾜｰｸ4処理有
ANL
ANL
JMP @MR4304
STG @MR4304
MPS
AND MR111                ; Sｻｲｽﾞ
TMR #80 #9999            ; 注入真空引き安定時間
CON
AND T80                  ; 注入真空引き安定時間
JMP @MR4305
MPP
AND MR112                ; Lｻｲｽﾞ
TMR #81 #9999            ; 注入真空引き安定時間(S2)
CON
AND T81                  ; 注入真空引き安定時間(S2)
JMP @MR4305
STG @MR4305
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
JMP @MR4306
STG @MR4306
RES MR7304               ; 注入部 元真空1
CON
RES MR7305               ; 注入部 元真空2
CON
RES MR7306               ; 注入部 元真空3
CON
RES MR7307               ; 注入部 元真空4
CON
TMR #82 #9999            ; 真空監視WAIT
CON
AND T82                  ; 真空監視WAIT
SET MR9810               ; 真空到達時間計測終了
CON
JMP @MR4307
STG @MR4307
MPS
AND @MR100               ; ﾜｰｸ1処理有
MPS
LD R4702                 ; ﾊﾟﾙﾐﾙ真空計1(ST2側) LO
AND @MR4108              ; 真空到達1OK
ANL
SET @MR4112              ; 真空保持ﾁｪｯｸ1OK
CON
SET @MR4204              ; 1側保持確認終了
MPP
LDB R4702                ; ﾊﾟﾙﾐﾙ真空計1(ST2側) LO
ORB @MR4108              ; 真空到達1OK
ANL
DW #3 DM3451             ; ST3-No1 NGﾜｰｸ 0=OK
CON
RES @MR4112              ; 真空保持ﾁｪｯｸ1OK
CON
SET @MR4204              ; 1側保持確認終了
MRD
AND @MR101               ; ﾜｰｸ2処理有
MPS
LD R4705                 ; ﾊﾟﾙﾐﾙ真空計2(中1側) LO
AND @MR4109              ; 真空到達2OK
ANL
SET @MR4113              ; 真空保持ﾁｪｯｸ2OK
CON
SET @MR4205              ; 2側保持確認終了
MPP
LDB R4705                ; ﾊﾟﾙﾐﾙ真空計2(中1側) LO
ORB @MR4109              ; 真空到達2OK
ANL
DW #3 DM3471             ; ST3-No2 NGﾜｰｸ 0=OK
CON
RES @MR4113              ; 真空保持ﾁｪｯｸ2OK
CON
SET @MR4205              ; 2側保持確認終了
MRD
AND @MR102               ; ﾜｰｸ3処理有
MPS
LD R4708                 ; ﾊﾟﾙﾐﾙ真空計3(中2側) LO
AND @MR4110              ; 真空到達3OK
ANL
SET @MR4114              ; 真空保持ﾁｪｯｸ3OK
CON
SET @MR4206              ; 3側保持確認終了
MPP
LDB R4708                ; ﾊﾟﾙﾐﾙ真空計3(中2側) LO
ORB @MR4110              ; 真空到達3OK
ANL
DW #3 DM3491             ; ST3-No3 NGﾜｰｸ 0=OK
CON
RES @MR4114              ; 真空保持ﾁｪｯｸ3OK
CON
SET @MR4206              ; 3側保持確認終了
MRD
AND @MR103               ; ﾜｰｸ4処理有
MPS
LD R4711                 ; ﾊﾟﾙﾐﾙ真空計4(ST4側) LO
AND @MR4111              ; 真空到達4OK
ANL
SET @MR4115              ; 真空保持ﾁｪｯｸ4OK
CON
SET @MR4207              ; 4側保持確認終了
MPP
LDB R4711                ; ﾊﾟﾙﾐﾙ真空計4(ST4側) LO
ORB @MR4111              ; 真空到達4OK
ANL
DW #3 DM3511             ; ST3-No4 NGﾜｰｸ 0=OK
CON
RES @MR4115              ; 真空保持ﾁｪｯｸ4OK
CON
SET @MR4207              ; 4側保持確認終了
MPP
LD @MR4204               ; 1側保持確認終了
ORB @MR100               ; ﾜｰｸ1処理有
LD @MR4205               ; 2側保持確認終了
ORB @MR101               ; ﾜｰｸ2処理有
ANL
LD @MR4206               ; 3側保持確認終了
ORB @MR102               ; ﾜｰｸ3処理有
ANL
LD @MR4207               ; 4側保持確認終了
ORB @MR103               ; ﾜｰｸ4処理有
ANL
ANL
JMP @MR4308
STG @MR4308
MPS
LDB LR41114              ; 真空ﾁｪｯｸ1-4(日常点検用)
ANB LR41115              ; 真空ﾁｪｯｸ1-4(調整用)
ANL
RES MR7212               ; 注入部 真空引き1
CON
RES MR7214               ; 注入部 真空引き2
CON
RES MR7300               ; 注入部 真空引き3
CON
RES MR7302               ; 注入部 真空引き4
CON
JMP @MR4309
MPP
LD LR41114               ; 真空ﾁｪｯｸ1-4(日常点検用)
OR LR41115               ; 真空ﾁｪｯｸ1-4(調整用)
ANL
JMP @MR4309
MPS
ANB @MR100               ; ﾜｰｸ1処理有
RES MR7212               ; 注入部 真空引き1
MRD
ANB @MR101               ; ﾜｰｸ2処理有
RES MR7214               ; 注入部 真空引き2
MRD
ANB @MR102               ; ﾜｰｸ3処理有
RES MR7300               ; 注入部 真空引き3
MPP
ANB @MR103               ; ﾜｰｸ4処理有
RES MR7302               ; 注入部 真空引き4
STG @MR4309
OUT R50400               ; Call Post
CON
AND R50402               ; Post Ok
ZRES @MR4200 @MR4207     ; 1側到達確認終了  4側保持確認終了
CON
SET @MR4101              ; 真空引き&真空保持 完了
CON
RES @MR4102              ; 実行中ﾌﾗｸﾞ
CON
ENDS
;
;<h1/>  SUB PLG1 注入
;  SUB PLG1 Infusion
;*****  1注入開始 / 1 infusion start *****
STG @MR4500              ; PP1 注入
MPS
SET @MR4502              ; PP1 注入中
CON
JMP @MR4503              ; PP1前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +6000      ; RB6_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +7000      ; RB6_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2720 +7000      ; RB6_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2720 DM2726      ; RB6_P2 位置ﾃﾞｰﾀ  PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR4503              ; PP1前進
SET MR11804              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call FLG
CON
JMP @MR4504
STG @MR4504
MPS
LD>.L DM2720 TM10        ; RB6_P2 位置ﾃﾞｰﾀ  Inf-1 Vacuum release point
AND>=.L DM2000 TM10      ; RB6現在位置  Inf-1 Vacuum release point
LD<=.L DM2720 TM10       ; RB6_P2 位置ﾃﾞｰﾀ  Inf-1 Vacuum release point
AND>=.L DM2000 DM2730    ; RB6現在位置  RB6_P3 位置ﾃﾞｰﾀ(大気開放開始)
ORL
OR MR19001               ; 注入1異常
OR MR11805               ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 完了
ANL
RES MR7212               ; 注入部 真空引き1
CON
SET MR7213               ; 注入部 大気開放1
MPP
AND MR11805              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 完了
RES MR11805              ; ﾌﾟﾗﾝｼﾞｬｰ 1 前進call 完了
CON
JMP @MR4505
STG @MR4505
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
@STA.L DM2726            ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM10               ; Inf-1 Vacuum release point
CON
SUB.L +6000
CON
@STA.L TM10              ; Inf-1 Vacuum release point
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2726            ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM10               ; Inf-1 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM10              ; Inf-1 Vacuum release point
MRD
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2726             ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2726            ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM10               ; Inf-1 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM10              ; Inf-1 Vacuum release point
MRD
LD>.L DM2726 +0          ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
ANB MR19001              ; 注入1異常
ANL
DW.L +0 DM2726           ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SET MR28000              ; Err counting RB6
CON
JMP @MR3505
MPP
LD<=.L DM2726 +0         ; PP1  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
OR MR19001               ; 注入1異常
ANL
RES MR7212               ; 注入部 真空引き1
CON
SET MR7213               ; 注入部 大気開放1
CON
RES MR19000              ; 注入中
CON
RES MR19001              ; 注入1異常
CON
JMP @MR4508
STG @MR3505
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR28001              ; err 266 release
RES MR28001              ; err 266 release
CON
JMP @MR4506
STG @MR4506
SET MR11800              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call FLG
CON
JMP @MR4507
STG @MR4507
AND MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
RES MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
CON
JMP @MR4508
;*****  大気開放& ﾌﾟﾗﾝｼﾞｬｰ1 後退 / vacuum rerease & pulunger1 back *****
STG @MR4508
SET MR11800              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call FLG
CON
JMP @MR4509
STG @MR4509
MPS
AND R50001               ; AUTO
JMP @MR4510
MPP
LD R50002                ; STEP
AND MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
ANL
RES MR11801              ; ﾌﾟﾗﾝｼﾞｬｰ 1 後退call 完了
CON
JMP @MR4510
STG @MR4510
RES @MR4502              ; PP1 注入中
CON
SET @MR4501              ; PP1 注入完了
CON
ENDS
;<h1/>  SUB PLG2 注入
;  SUB PLG2 Infusion
;*****  2注入開始 / 2 infusion start *****
STG @MR4600              ; PP2 注入
MPS
SET @MR4602              ; PP2 注入中
CON
JMP @MR4603              ; PP2 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +6000      ; RB7_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +7000      ; RB7_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2770 +7000      ; RB7_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2770 DM2776      ; RB7_P2 位置ﾃﾞｰﾀ  PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR4603              ; PP2 前進
SET MR11812              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call FLG
CON
JMP @MR4604
STG @MR4604
MPS
LD>.L DM2770 TM20        ; RB7_P2 位置ﾃﾞｰﾀ  Inf-2 Vacuum release point
AND>=.L DM2008 TM20      ; RB7 現在位置  Inf-2 Vacuum release point
LD<=.L DM2770 TM20       ; RB7_P2 位置ﾃﾞｰﾀ  Inf-2 Vacuum release point
AND>=.L DM2008 DM2780    ; RB7 現在位置  RB7_P3 位置ﾃﾞｰﾀ(大気開放開始)
ORL
OR MR19002               ; 注入2異常
OR MR11813               ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 完了
ANL
RES MR7300               ; 注入部 真空引き3
CON
SET MR7301               ; 注入部 大気開放3
MPP
AND MR11813              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 完了
RES MR11813              ; ﾌﾟﾗﾝｼﾞｬｰ 2 前進call 完了
CON
JMP @MR4605
STG @MR4605
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
@STA.L DM2776            ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM20               ; Inf-2 Vacuum release point
CON
SUB.L +6000
CON
@STA.L TM20              ; Inf-2 Vacuum release point
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2776            ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM20               ; Inf-2 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM20              ; Inf-2 Vacuum release point
MRD
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2776             ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2776            ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM20               ; Inf-2 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM20              ; Inf-2 Vacuum release point
MRD
LD>.L DM2776 +0          ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
ANB MR19002              ; 注入2異常
ANL
DW.L +0 DM2776           ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SET MR28005              ; Err counting RB7
CON
JMP @MR3506
MPP
LD<=.L DM2776 +0         ; PP2  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
OR MR19002               ; 注入2異常
ANL
RES MR7300               ; 注入部 真空引き3
CON
SET MR7301               ; 注入部 大気開放3
CON
RES MR19000              ; 注入中
CON
RES MR19002              ; 注入2異常
CON
JMP @MR4608
STG @MR3506
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR28006              ; err 267 release
RES MR28006              ; err 267 release
CON
JMP @MR4606
STG @MR4606
SET MR11808              ; ﾌﾟﾗﾝｼﾞｬｰ 2 後退call FLG
CON
JMP @MR4607
STG @MR4607
AND MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
RES MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
CON
JMP @MR4608
;*****  大気開放& ﾌﾟﾗﾝｼﾞｬｰ2 後退 / vacuum rerease & pulunger1 back *****
STG @MR4608
SET MR11808              ; ﾌﾟﾗﾝｼﾞｬｰ 2 後退call FLG
CON
JMP @MR4609
STG @MR4609
MPS
AND R50001               ; AUTO
JMP @MR4610
MPP
LD R50002                ; STEP
AND MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
ANL
RES MR11809              ; ﾌﾟﾗﾝｼﾞｬｰ 2  後退call 完了
CON
JMP @MR4610
STG @MR4610
RES @MR4602              ; PP2 注入中
CON
SET @MR4601              ; PP2 注入完了
CON
ENDS
;<h1/>  SUB PLG3 注入
;  SUB PLG3 Infusion
;*****  3注入開始 / 3 infusion start *****
STG @MR4700              ; PP3 注入
MPS
SET @MR4702              ; PP3 注入中
CON
JMP @MR4703              ; PP3前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +6000      ; RB8_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +7000      ; RB8_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2820 +7000      ; RB8_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2820 DM2826      ; RB8_P2 位置ﾃﾞｰﾀ  PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR4703              ; PP3前進
SET MR11904              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call FLG
CON
JMP @MR4704
STG @MR4704
MPS
LD>.L DM2820 TM30        ; RB8_P2 位置ﾃﾞｰﾀ  Inf-3 Vacuum release point
AND>=.L DM2016 TM30      ; RB8現在位置  Inf-3 Vacuum release point
LD<=.L DM2820 TM30       ; RB8_P2 位置ﾃﾞｰﾀ  Inf-3 Vacuum release point
AND>=.L DM2016 DM2830    ; RB8現在位置  RB8_P3 位置ﾃﾞｰﾀ(大気開放開始)
ORL
OR MR19007               ; 注入3異常
OR MR11905               ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 完了
ANL
RES MR7214               ; 注入部 真空引き2
CON
SET MR7215               ; 注入部 大気開放2
MPP
AND MR11905              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 完了
RES MR11905              ; ﾌﾟﾗﾝｼﾞｬｰ 3 前進call 完了
CON
JMP @MR4705
STG @MR4705
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
@STA.L DM2826            ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM30               ; Inf-3 Vacuum release point
CON
SUB.L +6000
CON
@STA.L TM30              ; Inf-3 Vacuum release point
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2826            ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM30               ; Inf-3 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM30              ; Inf-3 Vacuum release point
MRD
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2826             ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2826            ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM30               ; Inf-3 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM30              ; Inf-3 Vacuum release point
MRD
LD>.L DM2826 +0          ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
ANB MR19007              ; 注入3異常
ANL
DW.L +0 DM2826           ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SET MR28010              ; Err counting RB8
CON
JMP @MR3507
MPP
LD<=.L DM2826 +0         ; PP3  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
OR MR19007               ; 注入3異常
ANL
RES MR7214               ; 注入部 真空引き2
CON
SET MR7215               ; 注入部 大気開放2
CON
RES MR19000              ; 注入中
CON
RES MR19007              ; 注入3異常
CON
JMP @MR4708
STG @MR3507
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR28011              ; err 268 release
RES MR28011              ; err 268 release
CON
JMP @MR4706
STG @MR4706
SET MR11900              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call FLG
CON
JMP @MR4707
STG @MR4707
AND MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
RES MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
CON
JMP @MR4708
;*****  大気開放& ﾌﾟﾗﾝｼﾞｬｰ3 後退 / vacuum rerease & pulunger1 back *****
STG @MR4708
SET MR11900              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call FLG
CON
JMP @MR4709
STG @MR4709
MPS
AND R50001               ; AUTO
JMP @MR4710
MPP
LD R50002                ; STEP
AND MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
ANL
RES MR11901              ; ﾌﾟﾗﾝｼﾞｬｰ 3 後退call 完了
CON
JMP @MR4710
STG @MR4710
RES @MR4702              ; PP3 注入中
CON
SET @MR4701              ; PP3 注入完了
CON
ENDS
;<h1/>  SUB PLG4 注入
;  SUB PLG4 Infusion
;*****  4注入開始 / 4 infusion start *****
STG @MR4800              ; PP4 注入
MPS
SET @MR4802              ; PP4 注入中
CON
JMP @MR4803              ; PP4 前進
MPP
LD< W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +6000      ; RB9_P2 位置ﾃﾞｰﾀ
LD= W1BC6 #5             ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +7000      ; RB9_P2 位置ﾃﾞｰﾀ
ORL
LD>= W1BC6 #6            ; ｻﾃﾗｲﾄNo_from Host
AND>.L DM2870 +7000      ; RB9_P2 位置ﾃﾞｰﾀ
ORL
ANL
MOV.L DM2870 DM2876      ; RB9_P2 位置ﾃﾞｰﾀ  PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
STG @MR4803              ; PP4 前進
SET MR11912              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call FLG
CON
JMP @MR4804
STG @MR4804
MPS
LD>.L DM2870 TM40        ; RB9_P2 位置ﾃﾞｰﾀ  Inf-4 Vacuum release point
AND>=.L DM2024 TM40      ; RB9 現在位置  Inf-4 Vacuum release point
LD<=.L DM2870 TM40       ; RB9_P2 位置ﾃﾞｰﾀ  Inf-4 Vacuum release point
AND>=.L DM2024 DM2880    ; RB9 現在位置  RB9_P3 位置ﾃﾞｰﾀ(大気開放開始)
ORL
OR MR19008               ; 注入4異常
OR MR11913               ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 完了
ANL
RES MR7302               ; 注入部 真空引き4
CON
SET MR7303               ; 注入部 大気開放4
MPP
AND MR11913              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 完了
RES MR11913              ; ﾌﾟﾗﾝｼﾞｬｰ 4 前進call 完了
CON
JMP @MR4805
STG @MR4805
MPS
AND< W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +6000
CON
@STA.L DM2876            ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM40               ; Inf-4 Vacuum release point
CON
SUB.L +6000
CON
@STA.L TM40              ; Inf-4 Vacuum release point
MRD
AND= W1BC6 #5            ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2876            ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM40               ; Inf-4 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM40              ; Inf-4 Vacuum release point
MRD
AND>= W1BC6 #6           ; ｻﾃﾗｲﾄNo_from Host
MPS
LDA.L DM2876             ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SUB.L +7000
CON
@STA.L DM2876            ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
MPP
LDA.L TM40               ; Inf-4 Vacuum release point
CON
SUB.L +7000
CON
@STA.L TM40              ; Inf-4 Vacuum release point
MRD
LD>.L DM2876 +0          ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
ANB MR19008              ; 注入4異常
ANL
DW.L +0 DM2876           ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
CON
SET MR28015              ; Err counting RB9
CON
JMP @MR3508
MPP
LD<=.L DM2876 +0         ; PP4  複数回ｽﾄﾛｰｸ用位置ﾃﾞｰﾀ
OR MR19008               ; 注入4異常
ANL
RES MR7302               ; 注入部 真空引き4
CON
SET MR7303               ; 注入部 大気開放4
CON
RES MR19000              ; 注入中
CON
RES MR19008              ; 注入4異常
CON
JMP @MR4808
STG @MR3508
AND @MR015               ; ST3 ﾎﾟｰｽﾞ&ｴﾗｰ無
AND MR28100              ; err 269 release
RES MR28100              ; err 269 release
CON
JMP @MR4806
STG @MR4806
SET MR11908              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call FLG
CON
JMP @MR4807
STG @MR4807
AND MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
RES MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
CON
JMP @MR4808
;*****  大気開放& ﾌﾟﾗﾝｼﾞｬｰ4 後退 / vacuum rerease & pulunger1 back *****
STG @MR4808
SET MR11908              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call FLG
CON
JMP @MR4809
STG @MR4809
MPS
AND R50001               ; AUTO
JMP @MR4810
MPP
LD R50002                ; STEP
AND MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
ANL
RES MR11909              ; ﾌﾟﾗﾝｼﾞｬｰ 4 後退call 完了
CON
JMP @MR4810
STG @MR4810
RES @MR4802              ; PP4 注入中
CON
SET @MR4801              ; PP4 注入完了
CON
ENDS
;
;<h1/>Err
;Err62 KDｲﾝｸ循環未完了
;Err62 KD Ink discharge non-finishing
STG @MR104               ; Err62 KDｲﾝｸ循環未完了
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
SET LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
JMP @MR105               ; 105
MOV #62 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR105               ; 105
AND R50008               ; Error
JMP @MR106               ; 106
STG @MR106               ; 106
ANB R50008               ; Error
SET @MR107               ; Err62 ST3 Err2解除完了
CON
ENDS
;Err63 ｻﾃﾗｲﾄ循環未完了
;Err63 Consective discharge non-finishing
STG @MR600
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
SET LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
JMP @MR601
MOV #63 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR601
AND R50008               ; Error
JMP @MR602
STG @MR602
ANB R50008               ; Error
SET @MR603
CON
ENDS
;Err64 連続吐出未完了
;Err64 Consective discharge non-finishing
STG @MR108               ; Err63 連続吐出未完了
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
SET LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
JMP @MR109               ; 109
MOV #64 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR109               ; 109
AND R50008               ; Error
JMP @MR110               ; 110
STG @MR110               ; 110
ANB R50008               ; Error
SET @MR111               ; Err63 ST3 Err3解除完了
CON
ENDS
;Err65 ﾃﾞｼｹｰﾀUT 圧NGｴﾗｰ
;Err65 DC-UT pressure NG
STG @MR200               ; Err65 ST3 Err5
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR201               ; 201
MOV #65 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR201               ; 201
AND R50008               ; Error
JMP @MR202               ; 202
STG @MR202               ; 202
ANB R50008               ; Error
SET @MR203               ; Err65 ST3 Err5解除完了
CON
ENDS
;Err66 真空到達異常1表示 
;Err66 Time over to reach vacuum 1
STG @MR204               ; Err66
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR205               ; 205
MOV #66 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR205               ; 205
AND R50008               ; Error
JMP @MR206               ; 206
STG @MR206               ; 206
ANB R50008               ; Error
SET @MR207               ; Err66解除完了
CON
ENDS
;Err67 真空到達異常2表示 
;Err67 Time over to reach vacuum 2
STG @MR208               ; Err67
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR209               ; 209
MOV #67 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR209               ; 209
AND R50008               ; Error
JMP @MR210               ; 210
STG @MR210               ; 210
ANB R50008               ; Error
SET @MR211               ; Err67解除完了
CON
ENDS
;Err68 真空保持1ｴﾗｰ 
;Err68 Vaccum error during Ink Infusion 1
STG @MR212               ; Err68
MPS
LD= DM609 #2             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR213               ; 213
MOV #68 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #3             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR213               ; 213
MOV #270 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #0             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR213               ; 213
MOV #271 DM400           ; ﾒｯｾｰｼﾞNo.
MPP
LD= DM609 #1             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR213               ; 213
MOV #272 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR213               ; 213
AND R50008               ; Error
JMP @MR214               ; 214
STG @MR214               ; 214
ANB R50008               ; Error
SET @MR215               ; Err68解除完了
CON
ENDS
;Err69 真空保持2ｴﾗｰ 
;Err69 Vaccum error during Ink Infusion 2
STG @MR300               ; Err69
MPS
LD= DM609 #2             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR301               ; 301
MOV #69 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #3             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR301               ; 301
MOV #273 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #0             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR301               ; 301
MOV #274 DM400           ; ﾒｯｾｰｼﾞNo.
MPP
LD= DM609 #1             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR301               ; 301
MOV #275 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR301               ; 301
AND R50008               ; Error
JMP @MR302               ; 302
STG @MR302               ; 302
ANB R50008               ; Error
SET @MR303               ; Err69解除完了
CON
ENDS
;Err70 ﾌﾟﾗﾝｼﾞｬｰﾎﾟﾝﾌﾟ ｲﾝｸ注入速度ｴﾗｰ 
;Err70 Ink infusion error of plunger pump
STG @MR304               ; Err70 ST3 Err10
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
SET R48803
CON
JMP @MR305               ; 305
MOV #70 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR305               ; 305
AND R50008               ; Error
JMP @MR306               ; 306
STG @MR306               ; 306
ANB R50008               ; Error
RES R48803
CON
SET @MR307               ; Err70 ST3 Err10解除完了
CON
ENDS
;Err71 ﾜｰｸ状態異常
;Err71 Cartridge status Error
STG @MR308               ; Err71 ST3 Err11
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR309               ; 309
MOV #71 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR309               ; 309
AND R50008               ; Error
JMP @MR310               ; 310
STG @MR310               ; 310
ANB R50008               ; Error
SET @MR311               ; Err71 ST3 Err11解除完了
CON
ENDS
;Err72 ﾜｰｸ浮き
;Err72 Work flotage
STG @MR312               ; Err72 ST3 Err12
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR313               ; 313
MOV #72 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR313               ; 313
AND R50008               ; Error
JMP @MR314               ; 314
STG @MR314               ; 314
ANB R50008               ; Error
SET @MR315               ; Err72 ST3 Err12解除完了
CON
ENDS
;Err73 真空到達異常3表示 
;Err73 Time over to reach vacuum 3
STG @MR408               ; Err73
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR409               ; 409
MOV #73 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR409               ; 409
AND R50008               ; Error
JMP @MR410               ; 410
STG @MR410               ; 410
ANB R50008               ; Error
SET @MR411               ; Err73解除完了
CON
ENDS
;Err74 真空到達異常4表示 
;Err74 Time over to reach vacuum 4
STG @MR412               ; Err74
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR413               ; 413
MOV #74 DM400            ; ﾒｯｾｰｼﾞNo.
STG @MR413               ; 413
AND R50008               ; Error
JMP @MR414               ; 414
STG @MR414               ; 414
ANB R50008               ; Error
SET @MR415               ; Err74解除完了
CON
ENDS
;Err75 真空保持3ｴﾗｰ 
;Err75 Vaccum error during Ink Infusion 3
STG @MR500               ; Err75
MPS
LD= DM609 #2             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR501               ; 501
MOV #75 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #3             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR501               ; 501
MOV #276 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #0             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR501               ; 501
MOV #277 DM400           ; ﾒｯｾｰｼﾞNo.
MPP
LD= DM609 #1             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR501               ; 501
MOV #278 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR501               ; 501
AND R50008               ; Error
JMP @MR502               ; 502
STG @MR502               ; 502
ANB R50008               ; Error
SET @MR503               ; Err75解除完了
CON
ENDS
;Err76 真空保持4ｴﾗｰ 
;Err76 Vaccum error during Ink Infusion 4
STG @MR504               ; Err76
MPS
LD= DM609 #2             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR505               ; 505
MOV #76 DM400            ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #3             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR505               ; 505
MOV #279 DM400           ; ﾒｯｾｰｼﾞNo.
MRD
LD= DM609 #0             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR505               ; 505
MOV #280 DM400           ; ﾒｯｾｰｼﾞNo.
MPP
LD= DM609 #1             ; INDEX位置記憶
ANB R50008               ; Error
ANL
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR505               ; 505
MOV #281 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR505               ; 505
AND R50008               ; Error
JMP @MR506               ; 506
STG @MR506               ; 506
ANB R50008               ; Error
SET @MR507               ; Err76解除完了
CON
ENDS
;Err 177 ﾜｰｸ状態異常
;Err 177 Case State Error
STG @MR400               ; Err73 ST3 Err13
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
JMP @MR401               ; 401
MOV #177 DM400           ; ﾒｯｾｰｼﾞNo.
MPS
LD @MR100                ; ﾜｰｸ1処理有
ANB R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
LDB @MR100               ; ﾜｰｸ1処理有
AND R4206                ; IND1 ST3 ﾜｰｸ1検出(ST2側)
ORL
ANL
DW #3 DM3451             ; ST3-No1 NGﾜｰｸ 0=OK
MRD
LD @MR101                ; ﾜｰｸ2処理有
ANB R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
LDB @MR101               ; ﾜｰｸ2処理有
AND R4207                ; IND1 ST3 ﾜｰｸ2検出(中1側)
ORL
ANL
DW #3 DM3471             ; ST3-No2 NGﾜｰｸ 0=OK
MRD
LD @MR102                ; ﾜｰｸ3処理有
ANB R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
LDB @MR102               ; ﾜｰｸ3処理有
AND R4208                ; IND1 ST3 ﾜｰｸ3検出(中2側)
ORL
ANL
DW #3 DM3491             ; ST3-No3 NGﾜｰｸ 0=OK
MPP
LD @MR103                ; ﾜｰｸ4処理有
ANB R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
LDB @MR103               ; ﾜｰｸ4処理有
AND R4209                ; IND1 ST3 ﾜｰｸ4検出(ST4側)
ORL
ANL
DW #3 DM3511             ; ST3-No4 NGﾜｰｸ 0=OK
STG @MR401               ; 401
AND R50008               ; Error
JMP @MR402               ; 402
STG @MR402               ; 402
ANB R50008               ; Error
SET @MR403               ; Err73 ST3 Err13解除完了
CON
ENDS
;Err130 重量調整吐出確認要求
;Err130 Weight adjust exhaust check request
STG @MR404               ; Err74 ST3 Err14
ANB R50008               ; Error
SET R50008               ; Error
CON
SET R50113               ; Err ST3
CON
SET LR49914              ; ｴﾗｰﾘｾｯﾄｷｰ要求
CON
JMP @MR405               ; 405
MOV #130 DM400           ; ﾒｯｾｰｼﾞNo.
STG @MR405               ; 405
AND R50008               ; Error
JMP @MR406               ; 406
STG @MR406               ; 406
ANB R50008               ; Error
SET @MR407               ; Err74 ST3 Err14解除完了
CON
ENDS
;PACKｾｯﾄ
;Pack Set
;
END
ENDH
