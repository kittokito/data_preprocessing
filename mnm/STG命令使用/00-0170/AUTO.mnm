DEVICE:51
;MODULE:AUTO
;MODULE_TYPE:0
STG MR5500               ; 自動運転STG
ANB MR5501               ; 自動運転中
SET MR5501               ; 自動運転中
CON
JMP @MR000
STG @MR000
RES MR9004               ; Cover Open
CON
MPS
AND @T10                 ; 遅延
JMP @MR002
MPP
TMR @10 #1               ; 遅延
STG @MR002
MPS
AND T40                  ; ワーク有無検出（有）
SET @MR501               ; ワーク有無検出（有）STG
CON
ENDS
MPP
AND T41                  ; ワーク有無検出（無）
SET @MR502               ; ワーク有無検出（無）STG
CON
ENDS
STG @MR501               ; ワーク有無検出（有）STG
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
SET MR9108               ; 溶着前シートだれ防止上下　上昇
CON
SET MR9102               ; ワークセット治具前後　前進
CON
JMP @MR004
STG @MR004
AND T10                  ; ワークセット治具前後　前進限
AND T22                  ; 溶着前シートだれ防止上下　上昇限
JMP @MR006
STG @MR006
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
JMP @MR010
STG @MR010
JMP @MR012
STG @MR012
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
@SET @MR505              ; ﾌｨﾙﾑ送り　STEP2(位置決め)
CON
SET MR9110               ; ワーククランプ　前進
CON
JMP @MR013
STG @MR013
AND T28                  ; ワーククランプ　前進限
JMP @MR014
STG @MR014
SET MR9109               ; 溶着後シートだれ防止上下　下降
CON
JMP @MR015
STG @MR015
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
AND T25                  ; 溶着後シートだれ防止上下　下降限
JMP @MR100
STG @MR100
RES @MR505               ; ﾌｨﾙﾑ送り　STEP2(位置決め)
CON
JMP @MR101
STG @MR101
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
RES MR9108               ; 溶着前シートだれ防止上下　上昇
CON
ANB T22                  ; 溶着前シートだれ防止上下　上昇限
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
@SET @MR503              ; ﾌｨﾙﾑ送り　STEP1（JOG）
CON
JMP @MR102
STG @MR102
JMP @MR103
STG @MR103
AND MR113                ; ｼｰﾄ検出
RES @MR503               ; ﾌｨﾙﾑ送り　STEP1（JOG）
CON
JMP @MR104
STG @MR104
JMP @MR105
STG @MR105
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
RES MR9108               ; 溶着前シートだれ防止上下　上昇
CON
RES MR9109               ; 溶着後シートだれ防止上下　下降
CON
JMP @MR106
STG @MR106
AND T23                  ; 溶着前シートだれ防止上下　下降限
AND T26                  ; 溶着後シートだれ防止上下　上昇限
JMP @MR108
STG @MR108
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
@SET @MR504              ; ﾌｨﾙﾑ送り　STEP2(微戻り)
CON
JMP @MR110
STG @MR110
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
SET MR9005               ; TMR1 RESET
CON
RES @MR504               ; ﾌｨﾙﾑ送り　STEP2(微戻り)
CON
JMP @MR112
STG @MR112
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR112                ; time Up
SET MR9106               ; 溶着ヘッド上下　下降
CON
JMP @MR114
STG @MR114
AND T16                  ; 溶着ヘッド上下　下降限
SET MR9006               ; TMR1 SET
CON
TMR @18 #3
CON
AND @T18
JMP @MR200
STG @MR200
SET MR9107               ; 穴開けヘッド上下　下降
CON
JMP @MR201
STG @MR201
AND T19                  ; 穴開けヘッド上下　下降限
JMP @MR203
STG @MR203
RES MR9107               ; 穴開けヘッド上下　下降
CON
JMP @MR202
STG @MR202
AND MR112                ; time Up
JMP @MR204
STG @MR204
RES MR9106               ; 溶着ヘッド上下　下降
CON
SET MR9108               ; 溶着前シートだれ防止上下　上昇
CON
JMP @MR206
STG @MR206
AND T17                  ; 溶着ヘッド上下　上昇限
AND T22                  ; 溶着前シートだれ防止上下　上昇限
JMP @MR208
STG @MR208
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
RES MR9107               ; 穴開けヘッド上下　下降
CON
SET MR9104               ; カッター前後　前進
CON
JMP @MR210
STG @MR210
AND T20                  ; 穴開けヘッド上下　上昇限
AND T13                  ; カッター前後　前進限
JMP @MR212
STG @MR212
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
RES MR9108               ; 溶着前シートだれ防止上下　上昇
CON
SET MR9105               ; カッター前後　後退
CON
SET MR9111               ; ワーククランプ　後退
CON
JMP @MR214
STG @MR214
AND T29                  ; ワーククランプ　後退限
AND T23                  ; 溶着前シートだれ防止上下　下降限
JMP @MR300
STG @MR300
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
OUT MR5300               ; ｶｳﾝﾄINC
CON
SET MR9103               ; ワークセット治具前後　後退
CON
JMP @MR302
STG @MR302
SET @MR502               ; ワーク有無検出（無）STG
CON
ENDS
STG @MR502               ; ワーク有無検出（無）STG
@SET MR6505              ; ｼｰｹﾝｽSTOP完了
CON
ANB MR6502               ; ｼｰｹﾝｽSTOP
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
SET MR9103               ; ワークセット治具前後　後退
CON
JMP @MR312
STG @MR312
AND T11                  ; ワークセット治具前後　後退限
AND T14                  ; カッター前後　後退限
JMP @MR314
STG @MR314
SET MR9004               ; Cover Open
CON
JMP @MR400
STG @MR400
SET MR9007               ; 溶着完了　取出し警告ﾌﾞｻﾞｰON
CON
SET @MR405               ; ﾌﾞｻﾞｰON時間設定
CON
JMP @MR402
STG @MR402
@RES MR6505              ; ｼｰｹﾝｽSTOP完了
CON
AND T41                  ; ワーク有無検出（無）
JMP @MR403
STG @MR405               ; ﾌﾞｻﾞｰON時間設定
TMR #35 #20              ; ﾌﾞｻﾞｰON時間
CON
AND T35                  ; ﾌﾞｻﾞｰON時間
RES MR9007               ; 溶着完了　取出し警告ﾌﾞｻﾞｰON
CON
ENDS
STG @MR403
RES MR5501               ; 自動運転中
CON
SET MR5502               ; 自動運転完了
CON
ENDS
;停止センサがＯＮするまで、ＪＯＧ運転
LDB CR2002               ; 常時ON
LD @MR503                ; ﾌｨﾙﾑ送り　STEP1（JOG）
ANB CR3303               ; ｱﾗｰﾑ3
LDB CR2002               ; 常時ON
JOGX
;僅かにバックさせる
LD @MR504                ; ﾌｨﾙﾑ送り　STEP2(微戻り)
ANB CR2002               ; 常時ON
MOV #1 CM2025            ; X軸指定ﾎﾟｲﾝﾄ番号
LD @MR504                ; ﾌｨﾙﾑ送り　STEP2(微戻り)
PLSX #1
LD @MR505                ; ﾌｨﾙﾑ送り　STEP2(位置決め)
PLSX #2
LDF MR5501               ; 自動運転中
OR MR11000               ; 急停止
ZRES @MR000 @MR515
CON
ZRES @MR501 @MR505       ; ワーク有無検出（有）STG  ﾌｨﾙﾑ送り　STEP2(位置決め)
LD @MR503                ; ﾌｨﾙﾑ送り　STEP1（JOG）
TMR #50 #30              ; 送り時間監視ﾀｲﾏ(AUTO)
CON
AND T50                  ; 送り時間監視ﾀｲﾏ(AUTO)
SET MR503                ; ﾌｨﾙﾑ送り　監視異常
CON
RES @MR503               ; ﾌｨﾙﾑ送り　STEP1（JOG）
END
ENDH
