DEVICE:51
;MODULE:STEP
;MODULE_TYPE:0
;ステップ回路
STG MR8500               ; ステップSTG
SET MR8501               ; ステップ運転中
CON
JMP @MR000
STG @MR000
RES MR9004               ; Cover Open
CON
MPS
AND @T10                 ; 遅延
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR002
MPP
TMR @10 #5               ; 遅延
STG @MR002
MPS
AND T40                  ; ワーク有無検出（有）
SET @MR501               ; ワーク有無検出（有）STG
CON
ENDS
MPP
AND T41                  ; ワーク有無検出（無）
SET @MR502               ; ワーク有無検出（無）STG
CON
ENDS
STG @MR501               ; ワーク有無検出（有）STG
SET MR9102               ; ワークセット治具前後　前進
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR003
STG @MR003
AND T10                  ; ワークセット治具前後　前進限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR004
STG @MR004
SET MR9108               ; 溶着前シートだれ防止上下　上昇
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR005
STG @MR005
AND T22                  ; 溶着前シートだれ防止上下　上昇限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR006
STG @MR006
SET MR9110               ; ワーククランプ　前進
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR007
STG @MR007
AND T28                  ; ワーククランプ　前進限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR008
STG @MR008
SET MR9109               ; 溶着後シートだれ防止上下　下降
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR009
STG @MR009
AND T25                  ; 溶着後シートだれ防止上下　下降限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR014
STG @MR014
@SET @MR505              ; ﾌｨﾙﾑ送り　STEP2(位置決め)
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR015
STG @MR015
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
RES @MR505               ; ﾌｨﾙﾑ送り　STEP2(位置決め)
CON
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR100
STG @MR100
@SET @MR503              ; ﾌｨﾙﾑ送り　STEP1（JOG）
CON
ANB R2000                ; ｽﾀｰﾄSW
TMR @5 #10
CON
AND @T5
RES MR9108               ; 溶着前シートだれ防止上下　上昇
CON
JMP @MR102
STG @MR102
AND MR113                ; ｼｰﾄ検出
RES @MR503               ; ﾌｨﾙﾑ送り　STEP1（JOG）
CON
AND T23                  ; 溶着前シートだれ防止上下　下降限
JMP @MR103
STG @MR103
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR104
STG @MR104
RES MR9109               ; 溶着後シートだれ防止上下　下降
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR106
STG @MR106
AND T26                  ; 溶着後シートだれ防止上下　上昇限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR108
STG @MR108
@SET @MR504              ; ﾌｨﾙﾑ送り　STEP2（微戻り）
CON
SET MR9005               ; TMR1 RESET
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR110
STG @MR110
AND CR3006               ; X軸位置決め完了ﾘﾚｰ
ANB MR112                ; time Up
RES @MR504               ; ﾌｨﾙﾑ送り　STEP2（微戻り）
CON
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR112
STG @MR112
SET MR9106               ; 溶着ヘッド上下　下降
CON
SET MR9005               ; TMR1 RESET
CON
JMP @MR114
STG @MR114
AND T16                  ; 溶着ヘッド上下　下降限
SET MR9006               ; TMR1 SET
CON
TMR @18 #10
CON
AND @T18
JMP @MR200
STG @MR200
SET MR9107               ; 穴開けヘッド上下　下降
CON
JMP @MR201
STG @MR201
AND T19                  ; 穴開けヘッド上下　下降限
JMP @MR202
STG @MR202
RES MR9107               ; 穴開けヘッド上下　下降
CON
JMP @MR203
STG @MR203
AND MR112                ; time Up
SET MR9005               ; TMR1 RESET
CON
JMP @MR204
STG @MR204
RES MR9106               ; 溶着ヘッド上下　下降
CON
RES MR9107               ; 穴開けヘッド上下　下降
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR205
STG @MR205
AND T17                  ; 溶着ヘッド上下　上昇限
AND T20                  ; 穴開けヘッド上下　上昇限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR206
STG @MR206
SET MR9108               ; 溶着前シートだれ防止上下　上昇
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR207
STG @MR207
AND T22                  ; 溶着前シートだれ防止上下　上昇限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR208
STG @MR208
SET MR9104               ; カッター前後　前進
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR210
STG @MR210
AND T13                  ; カッター前後　前進限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR212
STG @MR212
SET MR9105               ; カッター前後　後退
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR214
STG @MR214
AND T14                  ; カッター前後　後退限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR300
STG @MR300
RES MR9108               ; 溶着前シートだれ防止上下　上昇
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR301
STG @MR301
AND T23                  ; 溶着前シートだれ防止上下　下降限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR302
STG @MR302
SET MR9111               ; ワーククランプ　後退
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR303
STG @MR303
AND T29                  ; ワーククランプ　後退限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
SET @MR502               ; ワーク有無検出（無）STG
CON
ENDS
STG @MR502               ; ワーク有無検出（無）STG
SET MR9103               ; ワークセット治具前後　後退
CON
ANB R2000                ; ｽﾀｰﾄSW
JMP @MR312
STG @MR312
AND T11                  ; ワークセット治具前後　後退限
OUT MR8503               ; 1ｽﾃｯﾌﾟ動作完了
CON
ANP R2000                ; ｽﾀｰﾄSW
JMP @MR314
STG @MR314
JMP @MR400
STG @MR400
JMP @MR402
STG @MR402
JMP @MR403
STG @MR403
SET MR9004               ; Cover Open
CON
JMP @MR404
STG @MR404
RES MR8501               ; ステップ運転中
CON
SET MR8502               ; ステップ運転完了
CON
ENDS
;停止センサがＯＮするまで、ＪＯＧ運転
LDB CR2002               ; 常時ON
LD @MR503                ; ﾌｨﾙﾑ送り　STEP1（JOG）
ANB CR3303               ; ｱﾗｰﾑ3
LDB CR2002               ; 常時ON
JOGX
;僅かにバックさせる
;＃1=　+800
;＃2=
;＃3=
;＃4=
;＃5=
;＃6=
LD @MR504                ; ﾌｨﾙﾑ送り　STEP2（微戻り）
PLSX #1
LD @MR505                ; ﾌｨﾙﾑ送り　STEP2(位置決め)
PLSX #2
LD @MR503                ; ﾌｨﾙﾑ送り　STEP1（JOG）
TMR #51 #30              ; 送り時間監視ﾀｲﾏ(STEP)
CON
AND T51                  ; 送り時間監視ﾀｲﾏ(STEP)
SET MR503                ; ﾌｨﾙﾑ送り　監視異常
CON
RES @MR503               ; ﾌｨﾙﾑ送り　STEP1（JOG）
LDF MR8501               ; ステップ運転中
OR MR11000               ; 急停止
ZRES @MR000 @MR515
CON
ZRES @MR501 @MR505       ; ワーク有無検出（有）STG  ﾌｨﾙﾑ送り　STEP2(位置決め)
END
ENDH
