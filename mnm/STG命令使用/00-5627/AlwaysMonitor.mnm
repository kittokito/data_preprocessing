DEVICE:53
;MODULE:AlwaysMonitor
;MODULE_TYPE:0
;SCRIPT_TYPE:
;OneSystem Sub-Module
;
;---------------------------------------
;ModuleName	:	AlwaysMonitor
;ModuleType	:	Sub Module
;Function	:	常時監視
;---------------------------------------
;<使用方法>
;常時監視が必要な物は本ﾓｼﾞｭｰﾙ内に記述して下さい
;・ﾋｰﾀｰ過昇温検知による非常停止
;・ﾁｬﾝﾊﾞｰ排気量低下によるｴﾗｰ出力
;など
LD CR2002                ; 常時ON
BMOV EM30006 W0600 #10   ; Wafer ID/CR フレームID1
BMOV EM30056 W060A #10   ; Wafer ID/CR フレームID1
;D47001 =0 
;FOR D47000 = 0 TO 500 STEP 50
;	BMOV(E30006:D47000,W600:D47001,10)
;	D47001 = D47001+10
;NEXT	
;
;D47001 =0 
;FOR D47000 = 0 TO 500 STEP 50
;	BMOV(E30506:D47000,W670:D47001,10)
;	D47001 = D47001+10
;NEXT
;
;D47001 =0 
;FOR D47000 = 0 TO 500 STEP 50
;	BMOV(E31006:D47000,W6E0:D47001,10)
;	D47001 = D47001+10
;NEXT
;
;D47001 =0 
;FOR D47000 = 0 TO 500 STEP 50
;	BMOV(E31506:D47000,W750:D47001,10)
;	D47001 = D47001+10
;NEXT
;
; 
LD CR2002                ; 常時ON
NCJ #1000
;D47001 =0 
;
LD CR2002                ; 常時ON
MOV #0 DM47001
;FOR D47000 = 0 TO 500 STEP 50
;
LD CR2002                ; 常時ON
MOV #0 DM47000
LABEL #2000
LD> DM47000 #500
CJ #2001
;	BMOV(E30006:D47000,W600:D47001,10)
;
LD CR2002                ; 常時ON
LDA DM47000
CON
EXT
CON
STA.L Z12
CON
ADRSET EM30006:Z12 @VM0  ; Wafer ID/CR フレームID1
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
STA.L Z12
BMOV *@VM0 W0600:Z12 #10
;	D47001 = D47001+10
;
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
ADD.L +10
CON
STA DM47001
;NEXT	
;
LD CR2002                ; 常時ON
LDA DM47000
CON
ADD #50
CON
STA DM47000
LDB CR2009               ; 演算結果が負
CJ #2000
LABEL #2001
;D47001 =0 
;
LD CR2002                ; 常時ON
MOV #0 DM47001
;FOR D47000 = 0 TO 500 STEP 50
;
LD CR2002                ; 常時ON
MOV #0 DM47000
LABEL #2002
LD> DM47000 #500
CJ #2003
;	BMOV(E30506:D47000,W670:D47001,10)
;
LD CR2002                ; 常時ON
LDA DM47000
CON
EXT
CON
STA.L Z12
CON
ADRSET EM30506:Z12 @VM2  ; Wafer ID/CR フレームID1
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
STA.L Z12
BMOV *@VM2 W0670:Z12 #10
;	D47001 = D47001+10
;
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
ADD.L +10
CON
STA DM47001
;NEXT
;
LD CR2002                ; 常時ON
LDA DM47000
CON
ADD #50
CON
STA DM47000
LDB CR2009               ; 演算結果が負
CJ #2002
LABEL #2003
;D47001 =0 
;
LD CR2002                ; 常時ON
MOV #0 DM47001
;FOR D47000 = 0 TO 500 STEP 50
;
LD CR2002                ; 常時ON
MOV #0 DM47000
LABEL #2004
LD> DM47000 #500
CJ #2005
;	BMOV(E31006:D47000,W6E0:D47001,10)
;
LD CR2002                ; 常時ON
LDA DM47000
CON
EXT
CON
STA.L Z12
CON
ADRSET EM31006:Z12 @VM4  ; Wafer ID/CR フレームID1
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
STA.L Z12
BMOV *@VM4 W06E0:Z12 #10
;	D47001 = D47001+10
;
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
ADD.L +10
CON
STA DM47001
;NEXT
;
LD CR2002                ; 常時ON
LDA DM47000
CON
ADD #50
CON
STA DM47000
LDB CR2009               ; 演算結果が負
CJ #2004
LABEL #2005
;D47001 =0 
;
LD CR2002                ; 常時ON
MOV #0 DM47001
;FOR D47000 = 0 TO 500 STEP 50
;
LD CR2002                ; 常時ON
MOV #0 DM47000
LABEL #2006
LD> DM47000 #500
CJ #2007
;	BMOV(E31506:D47000,W750:D47001,10)
;
LD CR2002                ; 常時ON
LDA DM47000
CON
EXT
CON
STA.L Z12
CON
ADRSET EM31506:Z12 @VM6  ; Wafer ID/CR フレームID1
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
STA.L Z12
BMOV *@VM6 W0750:Z12 #10
;	D47001 = D47001+10
;
LD CR2002                ; 常時ON
LDA DM47001
CON
EXT
CON
ADD.L +10
CON
STA DM47001
;NEXT
;
LD CR2002                ; 常時ON
LDA DM47000
CON
ADD #50
CON
STA DM47000
LDB CR2009               ; 演算結果が負
CJ #2006
LABEL #2007
LABEL #1000
;
;Error/ｴﾗｰ
LD CR2002                ; 常時ON
TMR #1267 #30            ; PLC立上がり後ｳｪｲﾄ
LD T1267                 ; PLC立上がり後ｳｪｲﾄ
AND CR3905               ; 重度ｴﾗｰ発生中
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #2 @DM1               ; ErrorNo /ERROR_DISP
CON
DW #0 @DM9               ; ReturnSW /ERROR_DISP
CON
LDA DM60009
CON
STA @DM2                 ; SensorNo /ERROR_DISP
CON
SET @R100                ; ｱﾗｰﾑ発生
CON
SET @R200
STG @R200
AND @R101                ; ERROR_End
RES @R101                ; ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;ｻﾌﾞｶﾊﾞｰ閉要求
LDB R7014                ; ｽｸﾚｰﾊﾟｰ清掃ｻﾌﾞｶﾊﾞｰ開閉状態(ON閉)
ANB MR10214              ; ｽｸﾚｰﾊﾟｰ清掃ｻﾌﾞｶﾊﾞｰ開
LDB R7015                ; ｼﾘﾝｼﾞ交換ｻﾌﾞｶﾊﾞｰ開閉状態(ON閉)
ANB MR10215              ; ｼﾘﾝｼﾞ交換ｻﾌﾞｶﾊﾞｰ開
ORL
ANB MR10103              ; ｻﾌﾞｶﾊﾞｰ閉要求ｴﾗｰ
AND T1267                ; PLC立上がり後ｳｪｲﾄ
TMR @0 #10
CON
AND @T0
@SET MR16810             ; ﾎﾟｰｽﾞ要求
CON
SET MR10103              ; ｻﾌﾞｶﾊﾞｰ閉要求ｴﾗｰ
CON
SET @R201
STG @R201
ANB R39004               ; ｴﾗｰ中
SET R39004               ; ｴﾗｰ中
CON
DW #1000 @DM9            ; ReturnSW /ERROR_DISP
CON
MPS
ANB R7014                ; ｽｸﾚｰﾊﾟｰ清掃ｻﾌﾞｶﾊﾞｰ開閉状態(ON閉)
DW #7014 @DM2            ; SensorNo /ERROR_DISP
CON
DW #141 @DM1             ; ErrorNo /ERROR_DISP
MRD
ANB R7015                ; ｼﾘﾝｼﾞ交換ｻﾌﾞｶﾊﾞｰ開閉状態(ON閉)
DW #7015 @DM2            ; SensorNo /ERROR_DISP
CON
DW #140 @DM1             ; ErrorNo /ERROR_DISP
MPP
SET @R100                ; ｱﾗｰﾑ発生
CON
JMP @R202
STG @R202
AND @R101                ; ERROR_End
RES MR10103              ; ｻﾌﾞｶﾊﾞｰ閉要求ｴﾗｰ
CON
RES @R101                ; ERROR_End
CON
RES R39004               ; ｴﾗｰ中
CON
ENDS
;MyTask Error Process Substance/ｴﾗｰ処理実体
STG @R100                ; ｱﾗｰﾑ発生
ANB R39002               ; ERROR_DISP Busy
MPS
ZRES @R105 @R108         ; SW1
CON
LDA @DM9                 ; ReturnSW /ERROR_DISP
CON
TBCD
CON
STA @DM10
CON
DISN @DM10 @DM3 #4
MRD
DW #0 @DM0
CON
BMOV @DM0 DM60000 #7     ; TaskNo /ERROR_DISP
MPP
SET R39000               ; ERROR_DISP Start
CON
SET @R102
CON
JMP @R103
STG @R103
AND R39002               ; ERROR_DISP Busy
AND= DM60008 @DM1        ; ReturnNo /ERROR_DISP  ErrorNo /ERROR_DISP
AND= DM60007 @DM6        ; ReturnSW /ERROR_DISP
SET @R105                ; SW1
CON
JMP @R104
STG @R104
ANB R39002               ; ERROR_DISP Busy
RES @R102
CON
SET @R101                ; ERROR_End
CON
ENDS
;Index Interlock Error
LD R7608                 ; 治具ｴｱｰ真空  上限
ORB R7609                ; 治具ｴｱｰ真空  下限
OR R11410                ; 治具ｴｱｰ真空  上昇
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
MSTRT F_ERROR_DISP #1
LD R7514                 ; ﾌｨﾙﾑ受け部  F受け 下限
ORB R7515                ; ﾌｨﾙﾑ受け部  F受け 上限
OR R11402                ; ﾌｨﾙﾑ受け 下降
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
MSTRT F_ERROR_DISP #2
LDB MR609                ; 給材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済 ﾗﾝﾌﾟ
OR>.L DM10556 +100       ; MSEP Axis-6 現在位置（下位8bit）
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
MSTRT F_ERROR_DISP #5
LDB MR3307               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ 原点復帰済
OR>.L DM10564 +100       ; MSEP Axis-7 現在位置（下位8bit）
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
MSTRT F_ERROR_DISP #6
LDB R7604                ; 転写部  転写RB原点位置
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
MSTRT F_ERROR_DISP #9
LDB DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
ANB R5502                ; I_ｲﾝﾀｰﾛｯｸ信号1（隣ｾﾙ1）
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
LDB DM2000.14            ; 上流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
ANB R5502                ; I_ｲﾝﾀｰﾛｯｸ信号1（隣ｾﾙ1）
ANB R5602                ; O_ｲﾝﾀｰﾛｯｸ信号1
AND CR2003               ; 常時OFF
ORL
MSTRT F_ERROR_DISP #10
;Transcript RB Interlock Error
LD R11202                ; ｽｸﾚｰﾊﾟｰ（小） 下降
OR R7406                 ; ｽｷｰｼﾞ部 ｽｸﾚｰﾊﾟｰ（小） 下限
ORB R7407                ; ｽｷｰｼﾞ部 ｽｸﾚｰﾊﾟｰ（小） 上限
AND<=.L DM21790 +25000   ; 軸1 現在座標
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #21
LD R11204                ; ｽｸﾚｰﾊﾟｰ（大） 下降
OR R7408                 ; ｽｷｰｼﾞ部 ｽｸﾚｰﾊﾟｰ（大） 下限
ORB R7409                ; ｽｷｰｼﾞ部 ｽｸﾚｰﾊﾟｰ（大） 上限
AND<=.L DM21790 +25000   ; 軸1 現在座標
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #22
LD R11206                ; ｽｷｰｼﾞ台 上昇
OR R7400                 ; ｽｷｰｼﾞ台部 ｽｷｰｼﾞ台 上限
ORB R7401                ; ｽｷｰｼﾞ台部 ｽｷｰｼﾞ台 下限
AND<=.L DM21790 +25000   ; 軸1 現在座標
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #23
LD R11404                ; ﾍｯﾄﾞ前後 前進
OR R7602                 ; 接着剤塗布部 ﾍｯﾄﾞ 前限
OR R8106                 ; 接着剤塗布ﾍｯﾄﾞ(子)前進限
ORB R7603                ; 接着剤塗布部 ﾍｯﾄﾞ 後限
ORB R8107                ; 接着剤塗布ﾍｯﾄﾞ(子)後退限
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #24
LD>.L DM10524 +7850      ; MSEP Axis-2 現在位置（下位8bit）
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #25
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
AND MR20110              ; MC1 BUSY
MSTRT F_ERROR_DISP #26
;RB1ｽｷｰｼﾞ
LD R8112                 ; ｽｸﾚｰﾊﾟｰ部水平ｼｬｯﾀｰ 閉限
ORB R8113                ; ｽｸﾚｰﾊﾟｰ部水平ｼｬｯﾀｰ 開限
AND DM10523.2
MSTRT F_ERROR_DISP #27
;RB2接着剤塗布
LD R8114                 ; ｼﾘﾝｼﾞ部ｼｬｯﾀｰ上下 下降限
ORB R8115                ; ｼﾘﾝｼﾞ部ｼｬｯﾀｰ上下 上昇限
AND DM10531.2
MSTRT F_ERROR_DISP #28
;下流
LD MR2907                ; 搬送X軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR2908               ; 搬送Y軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR3113               ; 搬送θ軸RB原点復帰済み ﾗﾝﾌﾟ
AND MR23501              ; 旋回軸_給材PIN_P2
ANB LR11006              ; 3cellｲﾝﾀﾛｯｸ信号無視
ANB LR11007              ; 3cellｲﾝﾀﾛｯｸ信号無視
OUT MR4410
LDB DM2000.15            ; 下流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
AND MR4410
AND>=.L DM10572 +5000    ; SCON-1 現在位置（下位8bit）
AND<=.L +550 DM10548     ; MSEP Axis-5 現在位置（下位8bit）
AND<=.L DM10548 +1500    ; MSEP Axis-5 現在位置（下位8bit）
AND>=.L DM10580 +6800    ; SCON-2 現在位置（下位8bit）
ANB R5503                ; I_ｲﾝﾀｰﾛｯｸ信号2（隣ｾﾙ2）
LDB DM2000.15            ; 下流ﾊﾝﾄﾞｼｪｲｸ 有効/無効
ANB R5603                ; O_ｲﾝﾀｰﾛｯｸ信号2
ANB R5503                ; I_ｲﾝﾀｰﾛｯｸ信号2（隣ｾﾙ2）
AND CR2003               ; 常時OFF
ORL
MSTRT F_ERROR_DISP #36
;元真空圧
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R008                 ; 元真空圧確認
MSTRT F_ERROR_DISP #50
;元圧検出
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
ANB R006                 ; 元圧検出
MSTRT F_ERROR_DISP #51
;<h1/>20140916_ｾﾝｻﾘﾝｸ異常追加
LDB DM50026.0            ; ｻｲｸﾘｯｸ通信正常 SQ7302_7410
ORB DM50026.1            ; ｻｲｸﾘｯｸ通信正常 SQ8101_8102
OR B3000
OR B30B0
TMR @1 #30
CON
AND @T1
SET @MR001
LD @MR001
MSTRT F_ERROR_DISP #11
;<h1/>2014/09/17_ﾛﾎﾞｯﾄｲﾝﾀｰﾛｯｸ追加
LD= DM4110 #26           ; _Group1　ﾒﾝﾃ動作番号
AND R46102               ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
OR R46103                ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
;ｴﾘｱ
LD< DM10572 #450         ; SCON-1 現在位置（下位8bit）
OUT @MR003               ; X軸範囲外下限
LD> DM10572 #450         ; SCON-1 現在位置（下位8bit）
AND< DM10572 #700        ; SCON-1 現在位置（下位8bit）
OUT @MR004               ; X軸取り出し範囲
LD> DM10572 #9000        ; SCON-1 現在位置（下位8bit）
AND< DM10572 #11000      ; SCON-1 現在位置（下位8bit）
OUT @MR005               ; X軸ﾀﾞﾐｰ捨て範囲
LD>.L DM10580 +3500      ; SCON-2 現在位置（下位8bit）
OUT @MR006               ; Y軸前進範囲
LD< DM10540 #1000        ; MSEP Axis-4 現在位置（下位8bit）
OUT @MR007               ; θ軸取り出し側
LD>.L DM10548 +11000     ; MSEP Axis-5 現在位置（下位8bit）
OUT @MR008               ; Z軸範囲外（下降過剰)
LD> DM10564 #2000        ; MSEP Axis-7 現在位置（下位8bit）
OUT @MR009               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ上昇中
;X軸移動時
;①ﾜｰｸ取り出し範囲内 ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ干渉防止
;②ﾀﾞﾐｰ捨て範囲内 ﾀﾞﾐｰBOX干渉防止
;③Z軸範囲外
LD @MR004                ; X軸取り出し範囲
AND @MR006               ; Y軸前進範囲
AND>.L DM10548 +6000     ; MSEP Axis-5 現在位置（下位8bit）
AND @MR007               ; θ軸取り出し側
AND @MR009               ; 除材ﾊﾞｯｸｱｯﾌﾟﾋﾟﾝ上昇中
LD @MR005                ; X軸ﾀﾞﾐｰ捨て範囲
AND>.L DM10580 +3000     ; SCON-2 現在位置（下位8bit）
AND>.L DM10548 +9500     ; MSEP Axis-5 現在位置（下位8bit）
AND @MR007               ; θ軸取り出し側
ORL
OR @MR008                ; Z軸範囲外（下降過剰)
AND DM10579.2
ANB @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
MSTRT F_ERROR_DISP #12
;Y軸移動時
;①X軸範囲外
;②Z軸範囲外
LD @MR003                ; X軸範囲外下限
OR @MR008                ; Z軸範囲外（下降過剰)
AND DM10587.2
ANB @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
MSTRT F_ERROR_DISP #13
;θ軸移動時Z軸範囲監視
;①Z軸範囲外_上側
;②Z軸範囲外_下側
LD< DM10548 #6500        ; MSEP Axis-5 現在位置（下位8bit）
OR> DM10548 #9500        ; MSEP Axis-5 現在位置（下位8bit）
AND DM10547.2
ANB @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
MSTRT F_ERROR_DISP #16
;Z軸移動時
;①ﾀﾞﾐｰBOX位置 
;②下降過剰
;③取り出し時下降過剰
LD @MR005                ; X軸ﾀﾞﾐｰ捨て範囲
AND @MR006               ; Y軸前進範囲
AND>.L DM10548 +10500    ; MSEP Axis-5 現在位置（下位8bit）
OR @MR008                ; Z軸範囲外（下降過剰)
LD @MR004                ; X軸取り出し範囲
AND @MR006               ; Y軸前進範囲
AND>.L DM10548 +8200     ; MSEP Axis-5 現在位置（下位8bit）
ORL
AND DM10555.2
ANB @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
MSTRT F_ERROR_DISP #14
;除材ﾛﾎﾞｯﾄ_ｲﾝﾃﾞｯｸｽとの干渉監視
;条件：XZ範囲内、θ取り出し側でｲﾝﾃﾞｯｸｽが回転
LD< DM10572 #5600        ; SCON-1 現在位置（下位8bit）
AND>.L DM10548 +7700     ; MSEP Axis-5 現在位置（下位8bit）
AND< DM10540 #4500       ; MSEP Axis-4 現在位置（下位8bit）
LD MR002                 ; ｲﾝﾃﾞｯｸｽ回転中
ORB R5307                ; INDEX 起動入力待ち
ANL
ANB @MR002               ; ｲﾝﾀｰﾛｯｸ監視外
MSTRT F_ERROR_DISP #15
;Induction Motor Interlock Error
LD CR2002                ; 常時ON
MPS
ANB R5310                ; ﾌｨﾙﾑ巻出しﾓｰﾀ温度過昇検出
MSTRT F_ERROR_DISP #31
MPP
ANB R5311                ; ﾌｨﾙﾑ巻取りﾓｰﾀ温度過昇検出
MSTRT F_ERROR_DISP #32
;TASK PAUSE/TASK 一時停止処理
;TASK0 一時停止処理 (ｲﾝﾃﾞｯｸｽ制御>
LD R44200                ; _Grp1 ﾎﾟｰｽﾞ要求
LDB DM2000.10            ; 上流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
AND B044                 ; ｾﾙ1よりPAUSE要求
ORL
LDB DM2000.11            ; 下流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
AND B0D4                 ; ｾﾙ4よりPAUSE要求
ORL
OUT R41200               ; TASK0 PAUSE 
;TASK2 一時停止処理 (ｲﾝﾃﾞｯｸｽへの給材制御)
LD R44200                ; _Grp1 ﾎﾟｰｽﾞ要求
LDB DM2000.10            ; 上流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
AND B044                 ; ｾﾙ1よりPAUSE要求
ORL
OUT R41202               ; TASK2  PAUSE 
;TASK4 一時停止処理 (ｲﾝﾃﾞｯｸｽへの除材制御)
LD R44200                ; _Grp1 ﾎﾟｰｽﾞ要求
LDB DM2000.11            ; 下流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
AND B0D4                 ; ｾﾙ4よりPAUSE要求
ORL
OUT R41204               ; TASK4 PAUSE 
;TASK5 一時停止処理 (転写制御)
LD R44200                ; _Grp1 ﾎﾟｰｽﾞ要求
OUT R41205               ; TASK5 PAUSE 
;上流ｾﾙ(ｾﾙ1)への一時停止許可
LD R42602                ; _Grp1_Task2_ﾎﾟｰｽﾞ許可
ORB R41002               ; _Grp1_Task2_起動中ﾌﾗｸﾞ
LD R42600                ; _Grp1_Task0_ﾎﾟｰｽﾞ許可
ORB R41000               ; _Grp1_Task0_起動中ﾌﾗｸﾞ
ANL
AND B044                 ; ｾﾙ1よりPAUSE要求
OUT B075                 ; ｾﾙ1へPAUSE許可
;下流ｾﾙ(<CR>:ｾﾙ3 ･ <NR>:ｾﾙ4)への一時停止許可
LD R42604                ; _Grp1_Task4_ﾎﾟｰｽﾞ許可
ORB R41004               ; _Grp1_Task4_起動中ﾌﾗｸﾞ
AND B0D4                 ; ｾﾙ4よりPAUSE要求
OUT B077                 ; <CR>ｾﾙ3へ  <NR>ｾﾙ4へ  PAUSE許可
;上流/下流ｾﾙへの一時停止中 表示制御
;@EM10.T = "CELL1 ポーズ中"
;@EM50.T = "CELL3 ポーズ中"
;@EM70.T = "CELL4 ポーズ中"
;@EM90.T = "CELL1より ポーズ許可待ち"
;@EM110.T = "CELL3より ポーズ許可待ち"
;@EM130.T = "CELL4より ポーズ許可待ち"
;
LD CR2002                ; 常時ON
NCJ #1001
;@EM10.T = "CELL1 ポーズ中"
;
LD CR2002                ; 常時ON
SMOV "CELL1 ポーズ中" @EM10
;@EM50.T = "CELL3 ポーズ中"
;
LD CR2002                ; 常時ON
SMOV "CELL3 ポーズ中" @EM50
;@EM70.T = "CELL4 ポーズ中"
;
LD CR2002                ; 常時ON
SMOV "CELL4 ポーズ中" @EM70
;@EM90.T = "CELL1より ポーズ許可待ち"
;
LD CR2002                ; 常時ON
SMOV "CELL1より ポーズ許可待ち" @EM90
;@EM110.T = "CELL3より ポーズ許可待ち"
;
LD CR2002                ; 常時ON
SMOV "CELL3より ポーズ許可待ち" @EM110
;@EM130.T = "CELL4より ポーズ許可待ち"
;
LD CR2002                ; 常時ON
SMOV "CELL4より ポーズ許可待ち" @EM130
LABEL #1001
;
LDB DM2000.10            ; 上流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MPS
AND B044                 ; ｾﾙ1よりPAUSE要求
MSTRT BBS_MSG_W #1 #1 @EM10
MPP
ANF B044                 ; ｾﾙ1よりPAUSE要求
MSTRT BBS_MSG_C #1 #1
LDP DM2000.10            ; 上流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MSTRT BBS_MSG_C #1 #1
LD CR2002                ; 常時ON
MPS
ANB DM2000.11            ; 下流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MPS
AND B0D4                 ; ｾﾙ4よりPAUSE要求
MSTRT BBS_MSG_W #1 #2 @EM70
MPP
ANF B0D4                 ; ｾﾙ4よりPAUSE要求
MSTRT BBS_MSG_C #1 #2
MPP
ANP DM2000.11            ; 下流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MSTRT BBS_MSG_C #1 #2
LDB DM2000.10            ; 上流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MPS
LDB B044                 ; ｾﾙ1よりPAUSE要求
AND B074                 ; ｾﾙ1へPAUSE要求
ANB B045                 ; ｾﾙ1よりPAUSE許可
ANL
MSTRT BBS_MSG_W #1 #1 @EM90
MPP
LDB B044                 ; ｾﾙ1よりPAUSE要求
AND B074                 ; ｾﾙ1へPAUSE要求
ANP B045                 ; ｾﾙ1よりPAUSE許可
ANL
MSTRT BBS_MSG_C #1 #1
LDB DM2000.11            ; 下流ｾﾙﾎﾟｰｽﾞ処理 有効/無効
MPS
LDB B0D4                 ; ｾﾙ4よりPAUSE要求
AND B076                 ; ｾﾙ3へPAUSE要求
ANB B0D5                 ; ｾﾙ4よりPAUSE許可
ANL
MSTRT BBS_MSG_W #1 #2 @EM130
MPP
LDB B0D4                 ; ｾﾙ4よりPAUSE要求
AND B076                 ; ｾﾙ3へPAUSE要求
ANP B0D5                 ; ｾﾙ4よりPAUSE許可
ANL
MSTRT BBS_MSG_C #1 #2
;<h1/>2013/4
;ﾗｲﾝPLCへ各ｾﾙのｽﾃｰﾀｽを送る
;
;※ｾﾙ毎に割り当てﾃﾞﾊﾞｲｽが異なるので変更する事
;ｾﾙ2
LD R46100                ; _自動運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT B07A                 ; ｽﾃｰﾀｽ　AUTO
LD R46101                ; _原点復帰中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT B07B                 ; ｽﾃｰﾀｽ　HOME
LD R46102                ; _ﾒﾝﾃﾅﾝｽ運転中　ﾓｰﾄﾞﾌﾗｸﾞ
OUT B07C                 ; ｽﾃｰﾀｽ　MAINTENANCE
LD R44200                ; _Grp1 ﾎﾟｰｽﾞ要求
OUT B07D                 ; ｽﾃｰﾀｽ　PAUSE
LD R46208                ; _Group1　ｴﾗｰ発生中
OUT B07E                 ; ｽﾃｰﾀｽ　ERROR
LDB DM2000.12            ; ON-LINE/OFF-LINE
ANB @R215                ; 定停止時 ﾜｰｸ残有り
AND= DM3000 #10          ; _MainTP　表示中ﾍﾟｰｼﾞNo
OUT B07F                 ; ｽﾃｰﾀｽ　ONLINEﾓｰﾄﾞ
LD R46103                ; _停止中　ﾓｰﾄﾞﾌﾗｸﾞ
AND<> W08F #0
OUT @R215                ; 定停止時 ﾜｰｸ残有り
;<h1/>2014/7  機種ﾚｼﾋﾟﾃﾞｰﾀの一部をEM2300～とか、装置共通ﾃﾞｰﾀへｺﾋﾟｰしているおかしな事を修正した
;<h1/>2013/4
;ﾚｼﾋﾟﾃﾞｰﾀ保存領域と実際に使用しているﾃﾞﾊﾞｲｽとの整合性を取る。
;（そもそもNATのｿﾌﾄが良ければ、こんな事する必要はない）
;<h1/>機種切替対応ｿﾌﾄを初めてﾀﾞｳﾝﾛｰﾄﾞした際にLR19915をONさせて１回実行させる
LD= DM3000 #1110         ; _MainTP　表示中ﾍﾟｰｼﾞNo
AND= DM8156 #8           ; _Y_Nﾒｯｾｰｼﾞ番号
@INC DM50                ; 受け台清掃回数
MPS
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
@INC DM51                ; 受け台清掃時間（秒）
MPP
MEF
LDA DM51                 ; 受け台清掃時間（秒）
CON
FLOAT
CON
STA.F DM5300             ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ1_1
CON
SET R46500               ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ1収集ﾄﾘｶﾞ
LD= DM3000 #1110         ; _MainTP　表示中ﾍﾟｰｼﾞNo
AND= DM8156 #9           ; _Y_Nﾒｯｾｰｼﾞ番号
@INC DM53                ; 接着剤交換回数
MPS
AND CR2006               ; 1sｸﾛｯｸﾊﾟﾙｽ
@INC DM54                ; 接着剤交換時間（秒）
MPP
MEF
LDA DM54                 ; 接着剤交換時間（秒）
CON
FLOAT
CON
STA.F DM5320             ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ2_1
CON
SET R46501               ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ2収集ﾄﾘｶﾞ
LDF R46500               ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ1収集ﾄﾘｶﾞ
FMOV #0 DM50 #2          ; 受け台清掃回数
FMOV.D #0 DM5300 #2      ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ1_1
LDF R46501               ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ2収集ﾄﾘｶﾞ
FMOV #0 DM53 #2          ; 接着剤交換回数
FMOV.D #0 DM5320 #2      ; _ﾃﾞｰﾀ収集　ﾕｰｻﾞｰﾃﾞｰﾀ2_1
;
END
ENDH
